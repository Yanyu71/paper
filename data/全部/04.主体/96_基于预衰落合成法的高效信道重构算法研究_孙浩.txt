第一章绪论
1.1课题背景与意义
我国通信产业发展历经3G突破、4G同步，在标准研制、产业链打造和大 规模商用的方面建立坚实基础。在此基础上，面对全球5G激烈竞争的战略局势， 贯彻党中央五大发展理念，全力推动信息通信技术对经济社会的引领作用，我国 果断提出5G引领的战略目标。当前，在工业和信息化部和有关部委的领导下, IMT-2020推进组的有序组织下，我国运营商、系统、终端、芯片、仪表、研究 院所、高校等产学研用各环节紧密配合，全面推进5G关键技术研究、制定全球 统一的国际标准、打造自主研发设备和产业链、进行5G技术研发试验和产品研 发试验等大量工作。
为推动5G关键技术研发，促进标准与产业发展，在IMT-2020的组织下， 我国于2016年1月全面正式启动了 5G技术研发试验，提出了明确的试验总体 规划，我国5G试验分两步实施，第一步为5G技术研发试验(2016年至2018 年)，主要目标是支撑5G国际标准研制，第二步为5G产品研发试验(2018年 至2020年)，主要目标是基于3GPP标准的第一版本，开展5G预商用测试。经 过第一阶段国内厂商、高校、研究院的技术攻关和通力合作，目前已经完成了 5G技术研发实验以及大量5G相关国际标准制定工作，当前阶段主要面向5G商 用产品研发实验工作。5G产品测试作为商用产品研发实验的最后一环，负责5G 设备通信性能和射频指标评估和验证，对产品研发工作起着至关重要的作用。然 而，5G通信系统中新技术的引入，给5G商用设备测试工作带来了新的挑战和 要求。
从技术上看，5G通信系统采用大规模多入多出(Massive Multiple Input Multiple Output, Massive MIMO)技术⑴和高频段毫米波技术作为新一代通信的 标志性核心技术，使得测试的技术复杂度和验证评估难度大幅提高。为提高通信 系统的通信速率和频谱效率，大规模MIMO阵列装备了数以百计的天线，如果 全部采用线缆连接的方式进行测试，天线数量的大幅增加导致了传导测试中线路 连接操作难度和测试不确定度都急剧上升。毫米波技术使得5G设备能够工作在 更高的频段以及更大的带宽上，但是毫米波频段的设备通常都采用了天线射频一 体化技术来降低设备的不确定性，这使得被测设备(Device-Under-Test, DUT) 的测试接口引出工作变得难以实现［2］。因此，新技术引入使得传统面向4G设备 的测试技术和仪表方案均不能支撑5G商用设备的测试。为了满足5G设备的产
1 业功能研发以及测试评估验证的需求，全面验证5G设备的射频和性能指标，亟 需创新研发采用空中接口(Over-the-Air, OTA)方式的支持新一代设备验证的 测试关键技术、验证评估方案和暗室环境。
MIMO OTA测试能够以空间辐射的形式将信号通过自由空间传播到被测设 备中，避免了破坏被测设备完整性和繁杂的接线操作，大幅降低了测试中的操作 复杂度和不确定度。另外，MIMO OTA测试将被测设备的天线部分纳入到整机 测试中，这有利于提升测试结果的准确度，克服了传导测试不适用于波束赋形设 备的缺点。因此，MIMO OTA测试已经成为在业内占据主导地位的5G设备测试 方案。主流的OTA测试方案有暗室多探头法(Multi-Probe Anechoic Chamber, MPAC)⑶、混响室法(Reverberation Chamber, RC)⑷以及两步法⑸，这三种方 式均具有自己的优点和缺点。其中，暗室多探头法由于其具有较好的可控性和适 用性，己经成5G Massive MIMO设备测试最具有前景的可行方案。
暗室多探头法的目的是在测试区域内部进行目标信道的重构，即复现目标信 道的电磁传播环境，目前主流的信道重构方法有平面波合成法和预衰落合成法两 种。其中，预衰落合成法由于无需事先进行相位校准、所需探头数量较少等优点 成为目前工业界和学术界的研究热点。预衰落合成法以信道的空间特性作为评判 标准，旨在重构目标信道的空间相关性。随着5G Massive MIMO设备的性能测 试需求大幅上升，如何以更高效率、更高精度、更低成本的方法在测试区域内部 进行目标信道的空间相关性的重构成为了研究的热点和难点。因此，针对预衰落 合成法的信道重构理论和算法的研究，对于MIMI OTA测试系统和理论的发展 至关重要。
目前，国内高校、研究院、厂商等机构针对5GMIMOOTA测试关键技术和 理论的研究、应用和实践等工作已经处于深度推进阶段，并且取得了阶段性的成 果，有力填补了国内乃至全球范围内5G毫米波OTA测试的空白。以北京邮电 大学、成都电子科技大学为例的国内高校的科研团队针对OTA测试开展大量的 理论研究工作，取得众多理论突破，为OTA商用测试系统的研发和投产提供了 理论支撑。2020年10月，中国信息通信研究院宣布建成全球首套5G毫米波OTA 端到端性能测试平台——“玉衡”系统，并且联合华为、中兴、vivo、高通等基 站和终端厂商，完成了 5G毫米波基站、终端以及芯片测试，有力推动了国内5G 毫米波产业发展。于此同时，华为、vivo等具有5G基站、终端和芯片研发实力 的国内厂商陆续组建5G OTA测试实验室，进行5G商用设备的射频和性能的测 试工作，为我国5G商用产品发展提供了验证支撑。因此，5G MIMOOTA测试 已经大规模进入商业阶段，具有广阔的应用前景，符合我国“产学研”结合的科
2
技发展战略，对于推动国内5G关键技术研究、支撑商用设备产业化、填补国内 相关领域空白具有重要意义。
1.2国内外研究现状
目前，OTA测试作为评估5G设备性能和射频指标的唯一可行方案，已经在 工业界和学术界引起了广泛的关注［6〕。与传导测试相比，OTA测试将信号以空口 辐射的形式传送到被测设备中，无需破坏被测设备的完整性。这避免了在大规模 MIMO阵列设备测试过程中繁琐的接线操作，提升了测试结果的准确性。经过多 年的研究和发展，主流的OTA测试方案可以分为三类，分别是：混响室法、两 步法以及暗室多探头法。
混响室是一个封闭的金属腔体，通过内置金属搅拌浆和拨片的旋转来营造混 响室内的多径环境，从而进行通信设备的测试〔7］。混响室法的研究已经持续了许 多年，由最初用于单入单出(Single Input Single Output, SISO)设备的测试，延 续到现在进行5G大规模MIMO的测试。目前，混响室法的研究主要分为几个方 面，分别是射频指标的测试方法研究、MIMO设备性能测试方法研究以及新一代 通信场景和频段的测试研究。研究［8］采用了混响室法模拟真实多径环境，进行 了通信链路的测试，测试指标包括吞吐量、信噪比等，并且给出了如何在混响室 中调节被模拟信道的时延、带宽、莱斯因子等参数的指导性建议。研究［9］提出 了一种“信道模拟器+混响室”的测试系统架构，通过信道模拟器给测试系统引 入对多普勒等信道参数的控制，改进了混响室测试系统在多径信道特性控制方面 的弱点。在研究［10］中，通过控制可接受功率、可分辨的多径分量(Multi-Path Components, MPC)数量、角度扩展(Angular Spread, AS)以及到达角(Angle of Arrival, AoA)等参数，模拟了一个非各项同向性的衰落信道。研究［11］首次 利用混响室模拟了高铁环境下多个场景的无线传播信道，并进行了实际测试，表 明混响室法可以用于高速移动场景的设备测试，为混响室法在5G高速移动场景 的测试验证提供了依据。研究［12卜［13］尝试在毫米波频段进行混响室的研究，将 混响室法的适用频段扩充到毫米波频段，为5G设备的测试验证工作提供支持。
两步法是由3GPP组织提出的标准MIMO OTA测试技术〔⑷，将整个测试流 程分为两步进行：首先进行被测设备天线方向图的测试，包括对方向图的幅度和 相位的测试；接着利用测得的方向图进行信道建模，利用空口传播或者射频导线 的方式将经过信道模拟器衰落后的信号传输到被测设备中去。由于5G设备自身 的特性，目前学术界和工业界的研究重点主要在以空口辐射作为信号传输方式的 两步法，即辐射两步法(Radiated Two-Stage, RTS)。针对辐射两步法的研究主 要集中暗室中空口传输矩阵的求解方法、更高阶MIMO设备的测试方法等。研 3
究［15］提出了一种适用于辐射两步法的快速逆矩阵求解算法，将逆矩阵求解时间 从几个小时缩短至几分钟，大幅提升了测试效率。针对辐射两步法中，高阶MIMO 设备测试时，信道模拟器端口到设备天线端口的传输矩阵难以求解的问题，研究 ［16］提出了基于粒子群的求解算法，可以快速地求解出传输矩阵，大幅降低了测 试复杂度，为高阶MIMO设备的测试工作提供了基础。研究［17］提出了一种改进 的RTS方法，利用信道的互异性对设备方向图进行测试，从而克服了 RTS必须 要求被测设备的芯片具有数据上报能力的缺点，并针对无线局域网(Wireless Local Area Network, WLAN) MIMO设备进行了吞吐量测试。该研究降低了传 统辐射两步法对被测设备的要求，提高了辐射两步法适用性。研究［18］将辐射两 步法应用到多载波设备的测试中去，并选取了多种射频屏蔽设备作为对比，扩展 了辐射两步法的应用场景。
暗室多探头法是目前工业界进行5G Massive MIMO设备性能测试的主流方 法，已经成为目前MIMO OTA测试研究的热点。暗室多探头法在被测设备周围 放置多个天线探头，通过给各个探头赋上合适的权重，从而在被测设备周围复现 目标的电磁传播环境［⑼。暗室多探头法的相关理论研究已经趋于成熟，早在2012 年，Pekka Kyosti就已经对基于暗室多探头法的信道建模技术进行了探究，阐述 了预衰落合成法(Pre-Faded Signal synthesis, PFS)和平面波合成法(Plane Wave Synthesis, PWS)这两种建模思想⑶。目前，暗室多探头的研究主要在于5G Massive MIMO设备测试的算法、理论和应用系统研究。研究［20］针对5G信道的稀疏特 性以及大规模天线设备的波束赋形测试需求，在MPAC的算法理论方面进行了 改进，提出了一种以功率角度谱相似性为评价因子的信道重构方法。为了进行 5G大规模天线设备的测试，结合实际的测试场景和需求，研究［21卜［22］提出了 一种扇形结构的5G Massive MIMO OTA测试系统，并通过仿真验证了测试可行 性。暗室多探头法的挑战之一在于其系统成本较高，由于每一探头天线接入到一 个信道模拟器的端口上，过多的探头天线会导致所需信道模拟器资源上升，增加 测试系统的成本。因此针对测试系统的另一个研究方向就是在保证信道复现精度 的情况下，尽可能选取较小数量的探头来进行信道的复现，也就是所谓的探头选 择。研究［23］在大规模MIMO设备测试的场景下，提出了以梯度下降为基础的探 头选择算法，降低了算法的复杂度，保证算法能够运用于5G Massive MIMO设 备测试场景。研究［24］提出在一种基于调相网络的测试方案，通过在信道模拟器 置入一个相位补偿矩阵，能够以较小的探头进行测试大规模天线设备的测试。随 着大规模MIMO技术在5G通信中的应用，5G基站设备的天线往往数以百计， 基站设备的尺寸也大幅度增加，因此满足远场条件需要更大的暗室，而这意味着
4
更高的系统成本。研究［25］提出了一种提出了一种暗室补偿方法，通过在信道模 拟器中对近场传输矩阵进行补偿，可以使得暗室无需满足远场条件，大幅减小暗 室尺寸。随着5G信道研究的深入，需要对适合5G设备测试的信道模型进行研 究，研究［26］通过对3GPP标准信道模型0］进行改进，提出了适用于5G MIMO OTA测试的信道模型修改准则。
1.3本文的研究工作
对前文说到的5GMIM0设备测试系统，本课题以暗室多探头系统中的预衰 落合成法为基础，研究如何提升系统内部信道重构的精度和效率。本文将从以下 几个方面内容展开研究。
1) Massive MIMO OTA测试中的探头选择算法
Massive MIMO OTA测试系统抛弃了 4G OTA测试的环形结构，采用了新颖 的扇形探头墙结构，从而导致备选探头的数量急剧上升。然而，目前主流的探头 选择算法的复杂度随着备选探头数量的上升急剧增高。在Massive MIMO OTA 测试中，由于测试精度的提高以及信道复杂度的提升，备选探头集通常是数以百 计，因此主流的探头选择算法难以适用于实际测试之中。本研究点的研究目的是 设计并实现具有高精度、低复杂度的探头选择算法，提高信道重构的效率。本研 究点针对探头选择问题，提出了一种基于梯度下降的算法。该算法的主要思想是 通过求解目标函数中的梯度，不断进行迭代更新探头的权重向量，最后求得符合 要求的探头权重。为了提高迭代过程中算法搜寻最优解的速率，本算法采用动量 梯度下降方法来进行权重的更新。除此之外，本算法还采用了批次迭代策略来降 低算法每一步迭代的计算复杂度。为了达到探头选择的目的，本算法在原有的问 题之上引入了正则化函数，使得非零功率的探头数量达到预期。最后，选取主流 凸优化算法作为参考，进行理论公式推导和数学实验仿真，结果表明，本研究点 提出的算法在大幅减少计算复杂度的同时，能够达到相似的精确度。
2) 基于预衰落合成法的信道重构方法研究
预衰落合成法的目的是在测试区域内部进行目标信道的空间相关性的复现， 从而测试设备的性能指标。然而，在基于预衰落合成法的合成信道模型中，由于 各个探头携带由相同的子径信息，使得各个探头携带的信号具有一定的相关性。 这导致了预衰落合成法在重构目标信道的空间相关性上存在着误差，因此会造成 实际测试中被测设备性能的评估误差。本研究点首先基于目标信道和基于预衰落 合成法的OTA信道模型，对其空时联合相关性进行公式推导，分析各个维度的 信道重构效果。理论推导结果显示，探头中各个子径的初始相位对于测试区域内 5
部的空间相关性具有不可忽视的影响，可能会造成较大的误差。在此基础上，接 着对原有的信道模型进行改进，提出了一种改进的信道建模方法，该方法可以使 得各个探头携带的信号的相关性趋近于零，从而在实际测试中准确地复现被测设 备端的空间相关性。该方法的主要思想在于利用离散傅里叶变换矩阵的正交性, 将矩阵中的各个列向量作为各个探头的初始相位向量，保证了各探头所携带的信 号之间的相关性为零。接着本文基于实际测试中的多簇信道场景进行扩展，使得 该方法能够适用于各个组织定义的标准MIMO信道。最后，本文进行仿真和分 析，仿真结果表明，该方法能够提升预衰落合成法的性能，使得空间相关性复现 精度大幅提高。
1.4论文的结构安排
本文一共分为五章，内容结构安排如下：
第一章，绪论。本章介绍了 5GMIMOOTA测试的研究背景与意义，梳理了 目前国内外的研究现状，概述了本文所做的主要研究内容和创新点；
第二章，MIMO OTA测试理论概述。本章首先对混响室法、暗室多探头法 和两步法这三种主流的MIMO OTA测试方法进行了概述，分别对这三种方法的 优劣进行了分析。接着，对主流的信道建模技术进行了介绍，并对其中基于几何 的随机信道模型进行详细阐述。最后详细阐述了 MIMO OTA中的两种信道建模 方法一预衰落合成法和平面波合成法；
第三章,Massive MIMO OTA测试中探头选择算法研究。本章首先对Massive MIMO OTA测试系统进行了阐述，着重介绍了测试系统架构和信道的重构理论， 体现出Massive MIMO OTA测试与4G MIMO OTA测试的不同之处。接着对梯 度下降理论进行介绍，并基于此提出了一种基于梯度下降的探头选择算法。最后， 通过选取主流的Multi-shot算法与所提岀的算法进行仿真验证和复杂度分析，说 明了本算法具有较低的复杂度，适用于5G Massive MIMO OTA测试；
第四章，基于预衰落合成法的信道重构研究。本章首先对预衰落合成法的信 道重构理论进行了理论阐述，并针对基于预衰落合成法的信道模型和目标信道模 型分别进行了公式推导，指出了预衰落合成法的缺陷，即预衰落合成法无法有效 地复现信道的空时相关性。接着基于公式推导的结果，本章提出了一种改进的信 道建模方法，理论显示该方法能够准确地复现信道的空间相关性。最后，本章对 不同场景下的信道环境进行了仿真验证，说明了本方法的鲁棒性和准确性。
第五章，总结和展望。本章对论文所做的研究工作和创新成果进行了总结，
6
并对下一步的研究工作进行展望。
1.5本章小结
本章首先介绍了课题的研究背景与意义，对国内外MIMO OTA测试技术做 了简要的介绍，并对研究现状进行了概括和总结。接着在本文的研究工作部分, 对本文的研究方向和内容进行了阐述。最后对全文中各个章节的内容和结构进行 了介绍。
第二章MIMO OTA测试理论概述
本章针对MIMO OTA测试理论进行概述，首先分别对三种主要的OTA测试 方y—两步法、混响室法和暗室多探头法进行了详细说明，并给出了三种方法 的优劣对比。接着，本章对MIMO信道建模技术进行了介绍，其中主要阐述了 基于几何关系的随机信道模型，包括建模思想、信道公式等。最后对暗室多探头 法的信道重构技术——预衰落合成法和平面波合成法进行了介绍，说明了这两种 方法的主要思想、模型公式和优化目标等。
2.1 MIMO OTA测试方法
经过长时间的理论演进和实际发展，OTA测试已经由2G、3G时代的针对 SISO设备的测试发展成为了 4G、5G时代的针对MIMO设备的测试。与SISO 设备测试中关注总辐射功率(Total Radiated Power, TRP)和总辐射灵敏度(Total Radiated Sensitivity, TRS)等指标不同的是，MIMO设备测试更多地关注于吞吐 率、误码率等反应整机性能的指标。因此，MIMO OTA测试的关键在于如何在 被测设备周围创建目标信道的无线电衰落信道环境，从而得到被测设备相应的指 标数据。目前MIMO OTA主要有三种主流的测试方案，分别是混响室法、两步 法以及暗室多探头法。
2.1.1混响室法
混响室是一个富含有丰富反射环境的封闭金属腔体，其内部通常配有金属搅 拌器和转台，在测试时通过转动搅拌器和转台来改变内部的电磁场环境，信号经 过腔体内壁的多次反射，从而在混响室内部形成一个统计均匀和各向同向性的电 磁场。因此，混响室法利用了混响室内部均匀衰落的电磁场环境，对被测设备进 行测试。目前，混响室法在MIMO设备的射频和性能指标的测试上都有运用。 在射频测试方面，通过利用混响室内部电磁场的统计均匀特性，可以得到近似于 定点扫描测试的测试结果，因此被广泛地运用到TRP、TIS等射频指标的测试中 去。在性能测试方面，由于混响室法能够在被测设备周围形成各项均匀的瑞利衰 落信号，因此能够进行MIMO设备在衰落信道下的吞吐率等性能指标的测试。
基于混响室法的MIMO OTA测试系统如图2-1所示，整个系统由基站模拟 器、混响室和被测设备组成。基站模拟器将信号传输到混响室内部的天线上，接
9

着通过控制搅拌器和转台进行模式搅拌改变混响室内部的电磁场结构，信号在混 响室内部经过多次反射之后，形成均匀的瑞利衰落信号传输至被测设备中。此外, 还有一种基于混响室和信道模拟器的测试方案，该方案通过信道模拟器引入多普 勒和时延等参数的控制，满足特定场景下的测试需求【％
基站模拟器
图2-1混响室测试系统
混响室法是一种操作简单、快速有效、成本经济的MIMO OTA测试解决方 案。它的优点在于测试系统较为简单，只需通过控制混响室内部的搅拌器就能形 成一个均匀的瑞利衰落信道。其次，由于混响室的制造成本要比暗室和信道模拟 器的成本小得多，因此相较于其他两种MIM0 01A测试方法，混响室法无疑是 一种更加经济的方法。然而，由于混响室本身只能产生均匀的瑞利衰落信号，不 能像暗室多探头和合两步法那样针对特定的场景进行建模和测试，无法满足特定 场景下的测试需求。另外，由于混响室自身的缺陷，导致混响室法不能很好地控 制交叉极化比、多普勒、到达角等信道参数，因此当对这些信道参数的准确性要 求较高的时候，混响室法不再适用。
2.1.2两步法
两步法最早由美国安捷伦公司提出，经过研究和发展，目前已经在3GPP 中被认定为和暗室多探头法具有相同效果的MIMO OTA测试方法［⑷。两步法的 测试分为两个阶段进行：在第一阶段进行被测设备天线方向图的测试，该阶段的 测试必须是非侵入式的测量，这就需要被测设备的芯片具有上报数据的能力；在 第二个阶段，首先将测得的天线方向图放入信道模型里面进行建模，接着将信道 模拟器与被测设备进行连接，再进行设备性能的测试。根据连接方式的不同，两 步法又可以分为传导两步法和辐射两步法。传导两步法指的是用射频导线将信道 模拟器的端口与被测设备的天线端口连接起来，由于5G中射频天线一体化技术 和大规模MIMO技术的采用，传导两步法已经不适用于5G设备的测试了。辐射
10
两步法需要测量出暗室内部信道模拟器端口到被测设备之间的传输矩阵，接着使 用传输矩阵的逆矩阵对信道模拟器的输出信号进行预编码，保证信道模拟器各个 端口的信号可以直接传输到被测设备的天线端口处，达到类似于导线连接的效果。 因此在一些文献中，辐射两步法又被称之为无线电缆法〔対。图2-2展示了辐射两 步法的系统架构。
暗窒

图2-2辐射两步法测试系统
两步法的核心思想在于重复利用SISO OTA暗室对被测设备进行方向图的 测量，然后将方向图代入至信道模拟器进行信道建模，从而提供一种较为经济的 MIMO OTA测试方案。因此，基于两步法本身的特性，它是一种优点和缺点都 很明显的测试方法。它的优点在于，能够利用SISO暗室对MIMO设备进行测量， 省去了高昂的暗室建造成本。然而第一阶段中方向图的测量需要被测设备的芯片 支持数据上报功能，这对被测设备提出了更多的要求。其次，在辐射两步法中需 要对信道模拟器和被测设备之间的传输矩阵进行测量，尽管一些文献提出了较为 高效的测量方法[15H16],但是对于高阶MIMO设备(天线数量在8个以上)的传 输矩阵的测量还是比较困难。另外，两步法要求信道模拟器的端口数量高于或者 等于被测设备的天线数量，因此在测量大规模天线设备的时候，成本会变得十分 高昂。最后，由于被测设备的方向图是在第一阶段固定好的，因此对于支持波束 赋形的设备来说，两步法并不适用。
2.1.3暗室多探头法
暗室多探头法最早由Oulu大学的Pekka Kyosti提出，经过长期的理论发展 和实际验证之后，已经成为当前热门的MIMO OTA测试技术，目前被3GPP等 组织列为OTA测试的标准方法之一。如图2-3所示，暗室多探头法的测试系统 由基站模拟器、信道模拟器、功率放大器(Power Amplifier, PA)、OTA探头和 暗室组成。基站模拟器的信号经过信道模拟器的多径衰落之后，被PA进行放大
11 增强，通过射频导线传输到暗室内部的OTA探头上去。最终，探头的信号经过 暗室内部的自由空间辐射至被测设备。
在整个系统中，基站模拟器是用来产生测试信号，与被测设备建立连接。信 道模拟器是系统的重要组成部分，负责创建和模拟多径衰落环境，包括信道的路 径损耗、时延、多普勒和交叉极化比等参数。功率放大器是对衰落后的信号进行 增强，用以补偿暗室内部的传输损耗。由于远场条件的限制，暗室的尺寸一般较 大，因此在大规模MIMO设备测试系统中，对功放的要求较高。被测设备通常 放置在暗室的中心的测试区域内部，周围环绕着一圈OTA探头，通过选择合适 的探头位置和权重，可以在测试区域内部模拟任意的到达角和角度扩展，从而复 现DUT侧的空间信息。OTA探头通常为双极化探头，每个探头分别保证在不同 极化方向上的衰落。根据被测设备和信道维度的不同，OTA探头也呈现不同的 摆放方式。当被测设备是终端设备的时候，由于实际场景中终端附近的散射体呈 现均匀分布，此时OTA探头通常均匀分布在被测设备四周，用以模拟不同来波 角度的多径信号。当被测设备是基站设备的时候，由于基站只能接收到来波角度 位于基站面板前方的信号，因此Pekka等学者提出了一种扇形的OTA放置方式， 用以节省暗室空间QI。

图2-3暗室多探头法测试系统
作为学术界和工业界主流的MIMO OTA测试方案，暗室多探头法具有混响 室法和两步法不具备的优势。首先，暗室多探头法利用探头和信道模拟器来进行 信道的重构，探头可以复现信道的空间特性，信道模拟器可以控制信道的极化、 时延、多普勒等特性，因此暗室多探头法可以在理论上复现任意的信道。其次, 暗室多探头法在暗室内部以空口辐射的形式进行信道的传输，能够适用于波束赋 形设备的测试。最后，暗室多探头法无需进行繁琐的空口传输矩阵的测量，适用 于高阶MIMO设备的测试。暗室多探头法的主要挑战在于整个系统的成本过高,
12
测试环境的搭建也较为繁琐。由于每一个OTA探头需要连接到一个信道模拟器 端口，因此探头数量决定着所需的信道模拟器的资源数量。在5GMassiveMIMO 测试中，由于DUT尺寸变大以及目标信道从2D变成3D等影响，需要更多的探 头来保证测试区域内部信道复现的准确度，导致整个系统成本大幅上升。
2.1.4三种方法对比
前文已经针对三种主流的MIMOOTA测试方法的系统、原理、优缺点进行 了介绍，接下来对这三种方法进行对比分析，归纳出各个方法的适用场景，最后 对三种方法的技术挑战进行总结。
首先从系统复杂度上来说,MPAC由于包含众多的组件，系统架构最为复杂, RTS次之，而RC的系统结构最为简单。接着从适用场景上来说，MPAC目前是 唯一适用于Massive MIMO设备测试的方法，适用性最广；RTS在理论上能够进 行任何几何随机信道的测试，但是RTS的探头数量要高于被测设备的天线数量， 这限制了 RTS在Massive MIMO设备测试的运用；RC由于混响室本身的限制， 不能完整地控制多径信道的众多特性，因此适用场景较少。从系统成本上来说， MPAC由于暗室和信道模拟器的高昂成本，系统造价最高；RTS利用SISO暗室 进行测试，减少了暗室的建造成本；RC无需暗室和信道模拟器，系统成本最低。 从对被测设备的要求上来说,RTS需要在第一阶段对被测设备进行非侵入式的方 向图测试，因此需要被测设备的芯片具有数据上报能力，而MPAC和RC对被测 设备没有要求。最后，由于混响室自身的限制，RC不能对特定的信道进行复现， 而MPAC和RTS可以可控地复现特定场景下的传输环境。现将三种方法的对比 总结于表2-1 o
表2-1三种MIMOOTA测试方法对比
对比角度
暗室多探头法
辐射两步法
混响室法
系统复杂度
高
中
低
适用性
高
中
低
系统成本
高
中
低
是都支持Massive
MIMO设备测试
是
否
否
是否要求被测设 备具有上报能力
否
是
否
是否能对特定信 道进行复现
是
是
否
接着针对各个方法的适用场景进行分析：MPAC的应用场景最广，能够支持
13
Massive MIMO设备的性能测试，目前业界对于基于MPAC的5G的基站和终端 测试都有较为成熟的解决方案，因此MPAC是最具潜力的5G测试方案；RC不 能完整地控制多径信道的特性，且混响室内部丰富的电磁反射环境与毫米波频段 信道的稀疏特性相违背，因此RC适用于Sub-6GHz的设备测试；RTS由于所测 得的设备方向图是固定的，不支持波束赋形设备的测试。此外，由于所需探头数 量必须要大于被测设备的天线数量，Massive MIMO设备测试会使得系统的成本 过高。因此RTS适用于终端设备的测试。现将三种方法的适用场景总结于表2-2。
表2-2三种MIMO OTA测试方法对比
测试方法
适用场景
暗室多探头法
适用于终端和基站在Sub-6GHz和毫米波频段的性能测 试，支持Massive MIMO设备的测试。
辐射两步法
适用于终端等低阶MIMO设备的测试。
混响室法
适用于终端或者基站在Sub-6GHz频段的性能测试。
最后分别对这三种方法在未来发展上的技术挑战进行总结：对于MPAC来 说，由于整个系统的所需的硬件资源较多，暗室体积较大，导致测试系统成本过 高，因此首要的挑战是需要降低整个测试系统的成本，其次针对支持波束赋形的 Massive MIMO设备测试，基于空间相关性的信道复现目标已经不再适用，空间 谱相似度已经成为人们更加关心的指标，需要提出一种基于功率角度谱的信道复 现评判因子㈤］。RC在支持5G设备测试上主要面临两个挑战：首先，需要在混 响室以及系统架构的设计上进行研究来支持毫米波频段MIMO设备测试;其次， 如何在混响室内部以可控的方式复现多径信道的特性是一个巨大的挑战，这意味 着需要在测试方法、系统架构以及混响室设计上进行改进。RTS主要面临的挑战 有：需要设计一种无需数据上报的天线方向图测试方法，降低对被测设备的芯片 要求；其次，需要一种快速、便捷、准确的方法来进行探头到被测设备之间传输 矩阵的测量；最后，针对Masisve MIMO设备的测试，如何减少系统所需的信道 模拟器的资源数量是一个巨大的挑战。
2.2 MIMO信道建模技术
本节主要对MIMO信道的建模技术进行阐述，首先对主流的MIMO信道建 模技术进行了分类，根据建模思想的不同，可以分为确定性信道建模和随机性信 道建模两类。接着，本节对这两中信道建模方法的思想、原理以及特性进行了介
14
绍。接着本节针对在MIMO OTA测试中使用到的信道模型——基于几何的随机 信道模型(Geometry-Based Stochastic Model, GBSM)进行了详细的阐述。
2.2.1 MIMO信道模型
MIMO系统如图2-4所示，发送数据经过调制、编码、映射等操作之后，由 发送端的若干个发射天线发射到自由空间当中，信号在经过自由空间中的无线信 道之后，在接收端被多个接收天线所接收，通过相应的信号处理技术进行处理之 后，在收端获得初始的传输数据。在实际传输场景中，无线信道作为信号传输的 承载通道，极易受到多种因素的影响，例如天气变化、车辆和人的移动、建筑体 的遮挡和反射等。这些因素会导致到达接收机的信号在功率、相位、角度以及时 延等方面上发生变化，从而产生信道衰落。信道衰落对整个通信链路的性能会产 生巨大影响，因此为了研究通信系统在不同的传输环境下的性能，需要无线传输 信道进行数学建模，也就是信道建模技术。
BS 1	MS 1

图2-4 MIMO系统模型

信道建模是在信道测量的基础上，对无线传播信道的一种抽象表示〔2叽移动 通信经过多年的发展，众多的组织和机构在对信道模型的研究上已经取得众多成 果。在对无线信道进行特性分析、参数提取和数学建模的过程中，产生了不同的 信道建模方法。如图2-5所示，目前主要的信道建模方法有两类，分别是确定性
信道建模和随机性信道建模。





-
时域有限差分1


-
确定性模型
-









射线追踪

Ml MO信道模型
-











-
基于相关性模型1



随机性模型
-








基于几何模型

图2-5 MIMO信道模型分类


15
确定性信道建模是一种能够精确描述特定场景下无线信道环境的建模方法， 它通过处理信道测量所得的数据，从而建立该场景下的信道模型。确定性模型有 较高的准确性，但是它仅仅描述了典型场景的无线信道，不具有一般性。因此, 对于不同的场景，常常需要重新进行信道测量、参数提取和数学建模。此外，确 定性建模虽然具有较高的准确度，但是计算复杂度往往随着散射体数量呈指数型 增加。常见的确定性信道建模方法包括时域有限差分(Finite-Difference Time-Domain, FDTD)和射线追踪(Ray Tracing, RT)两种。FDTD 是 K. S. Yee 在1966年提出的一种信道建模方法，通过麦克斯韦方程组在时域和空域上对电 磁波进行差分，将连续的电磁波问题转换成离散的数值问题，再进行迭代求解［29】。 FDTD的建模结果精确度高，但是计算量大，过程比较复杂，在实际中很少用到。 RT是一种快速有效的确定性建模方法，最早提岀于20世纪90年代，其主要思 想是通过几何光学(Geometry Optic, GO)理论来处理信号传播过程中的反射、 透射和衍射㈤］。射线追踪的主要方法有镜像法(Image Based, IM)㈤入射及反 弹射线法(Shooting and Bouncing Ray, SBR)卩习两种。镜像法先查找发射点于 反射面的镜像点，再通过镜像点和接受点的连线与反射面的夹角来确定反射点， 以此来预测信号的传播路径。入射及反弹射线法在发射点以一定的角度发射出一 系列具有相同规则的射线管，覆盖三维的球形空间，再通过射线追踪管形成射线 追踪树，从而计算空间任意一点的场强。
确定性建模只能反应某个特定的无线传输信道，但是在实际中，由于环境的 复杂性和不确定性，确定性建模往往过于理想化，无法反应普适场景下的信道传 环境。因此人们引入了随机性信道建模，通过概率函数来对无线信道的内在特征 进行表述，从而得到一般性场景下的信道模型。常见的随即向信道模型有基于几 何的随机模型和基于相关性的随机模型(Correlation-Based Stochastic Model, CBSM)o GBSM能够表征无线信道的几何特性，解释发射体、散射体和接收体 之间的位置关系，是一种最常见的随机性信道模型，如SCM模型［呵、WINNER II模型【珂以及3GPP模型［27】等。关于GBSM的具体原理将在下一小节进行阐述。 CBSM的主要思想是确定先收发两端的空间相关性，再通过克罗内克积 (Kronecker Product)求得收端和发端之间的MIM0信道矩阵。CBSM的计算复 杂度较低，但是其缺点在于不能揭示MIM0信道的几何特性，在系统级仿真里 面有较大的误差，仅仅用于MIM0信道容量的理论分析以及通信算法的链路级 仿真验证。
2.2.2基于几何的随机信道模型
16

GBSM模型是一种较为常见的的随机性信道模型，它的主要思想在于将整个 信道划分为发送端、接收端和散射体三个部分，并通过建立坐标系的方式对各个 组成部分之间的几何关系进行表征。根据散射体分布位置的不同又可以将GBSM 模型分为规则形状和非规则形状模型，前者的散射体分布在环形、球形、圆形以 及圆柱形等规则几何体上，后者的散射体则分布在不规则的几何体之上。由于 GBSM模型能够将收端、发端和传播环境进行分割，这使得MIMOOTA测试系 统中的各个组件可以与信道模型对应起来，因此GBSM模型也被广泛地运用到 MIMO OTA测试中卩习。

如图2-6所示，整个信道模型分为三部分构成：基站（Base Station, BS）端、 移动（Move Station, MS）端和传输环境国］。基站端和移动端分别含有C7和S个 天线，呈线性排布。根据实际的信道测量结果，GBSM模型广泛地采用“簇-子 径”的结构来表示多径信道。GBSM模型将时延相同、角度相近的子径划分成一 个簇，多个簇一起构成整个多径信道。每个簇相对于基站端和移动端有一个离开 角（Arrival of Departure, AoD）和到达角，簇内的子径的角度通常呈一定规律 的分布，例如拉普拉斯分布、高斯分布等。将各个参数的含义总结于表2-3。

类似于表2-3,信道公式也可以分成基站端、移动端和传播环境这三个部分, 下面分别对每个部分进行解释。
17
基站端的公式由两部分组成，分别是天线增益和相位差。 Fge（0”2D，0”",她）和Fg（0”,”,Z°Q,0”,SQ ）分别表示第n个簇的第m条子径在 基站端第s个天线的0和0极化方向上的天线增益，其中0表示的是子径在垂直方
T
向上的相应角度。exp（）2”二"-心M）代表了第”个簇的第〃条子径在基站 端第s个天线上相对于参考天线之间的相位差，其中二和d和是三维向量，分 别表示第"个簇的第加条子径离开角的单位角度矢量和基站端第s个天线的位 置矢量，2表示波长。
表2-3基于几何的随机信道模型参数表
模型构成
参数及含义
基站端
S：基站端的天线数量
。朋：基站的阵列方向，指的是基站的天线整列法线方向与参 考线之间的夹角。
0BS：基站端与移动端直射径的离开角，指的是直射径与基站法 线方向的夹角。
传输环境
N:簇的个数。
M：子径的个数。
&",A°A：第”个簇相对于基站端的离开角。
0”,“：第”个簇内第加条相对于基站端的离开角。 6”,A°D：第“个簇相对于移动端的到达角 氏十：第"个簇内第加条相对于移动端的到达角。
移动端
U :移动端的天线数量
GMS：基站的阵列方向，指的是移动端的天线阵列法线方向与 参考线之间的夹角。
鶴s：基站端与移动端直射径的到达角，指的是直射径与移动端 法线方向的夹角。
V：移动端的速度矢量。
移动端的公式由三部分组成，分别是天线增益、相位差以及运动引起的多普 勒频偏。F“,e （盒“）和Fg（4,®，0”,s）分别表示第"个簇的第m条 子径在移动端第“个天线的0和0极化方向上的天线增益，其中0表示的是子径 在垂直方向上的相应角度。代表了第"个簇的第刃条子径 在移动端第“个天线上相对于参考天线之间的相位差,其中；和0牛是三维向 量，分别表示第"个簇的第初条子径到达角的单位角度矢量和移动端第"个天线
18
的位置矢量。exp（y2^；L„-v/A）指的是运动引起的多普勒频偏，其中V代表移 动端的运动矢量。
传播环境部分包含了簇内各子径的累加以及各个子径在自由空间传播过程 中造成的相位偏移。乙表示的是第”个簇的功率，血"代表第匕个簇的第刃条子 径的极化泄露比。exp（j①為）表示的是第n个簇的第m条子径在基站端的0极化 传输到移动端的0极化过程中的初始随机相位，expQ•①爲）、exp（妙代）和 exp（j^m）同理，且①代表在0〜2”之间均匀分布的随机数。
最后，对整个信号在信道中的传输过程进行总结。首先，信号在发送端会受 到发送天线在不同极化上的天线增益。接着，信号被发射到自由空间中，在自由 空间传播的时候，由于反射和折射等现象的存在，会形成多径信号，GBSM模型 中以子径作为最小单位来反映信道的多径特征。在自由空间传播过程中，信号的 极化特征也会发生变化，信号在某个极化方向上的部分分量会转换到另一个极化 方向上，在GBSM模型中通过极化泄露比来控制两个极化分量的比例。此外， 由于信号在自由空间传输的不确定性，信号的相位是一个随机变量，这在信道模 型中的随机相位①中有所体现。最后，在接收端，天线会接收到双极化方向上 的信号，经过接收天线在特定到达角上的增益之后，输入到接收机内部。
2.3暗室多探头法中的信道重构技术
2.2节中对MIMO信道模型的架构、原理和数学公式进行了详细的阐述，而 MIMO OTA测试的实质就是在测试区域内部进行目标信道的重构。因此，本节 主要介绍暗室多探头法中的两种信道重构技术——平面波合成法和预衰落合成 法。
2.3.1平面波合成法
平面波合成法的主要思想是在电磁场的角度来复现目标信道，通过给每个探 头赋上合适的复权重系数，从而在测试区域内部复现任意角度的平面波。由2.2 节中对GBSM模型的介绍可知,整个信道是多个以子径为基本单位的簇构成的。 对于接收端来说，由于实际环境中散射体通常满足远场条件，每一条子径相当于 一个以固定角度入射的平面波。因此，只需针对多个子径分别进行复权重系数的 求解，即可复现目标信道的电磁场环境。
19


如图2-7所示，在一个2DMIM0 0TA测试系统中，一共有K个探头均匀地 围绕着测试区域分布，测试区域内部一共有M个采样点，现有一个到达角为0的 平面波入射到测试区域，则测试区域内部第加个采样点的电磁场可以表示为式 2-2,其中£表示第刃个采样点的位置矢量，7表示平面波的波数，且E0=l.
e(q) = EQ exp(j 広 rm)	(2-2)
第上个探头到第加个采样点的传输因子可以表示为式2-3,其中乙”,为第尢 个探头到第m个采样点的路径损耗，dk m为第丘个探头到第刃个采样点的距离, 而|卜||表示取模操作。

(2-3)
假设第玄个探头的复权重因子为g”，结合式2-2和式2-3,可以得到式2-4, 其中G是所有探头的复权重矢量，F是传输因子矩阵，T是所有采样点的目标电 磁场矢量。通过解出式2-4就可以求出探头的复权重向量G ,求解方法有凸优化、 矩阵求逆法等。
min||FG-Tg	(2-4)
平面波合成法的优势在于它能够进行信道中直射径的合成，并且可以精确地 对子径的极化方式进行控制。然而，平面波合成法也存在一些缺点：文献［36］的 研究表明，平面波合成法所需的探头数量与测试区域的半径以及频率成正比。因 此，平面波合成法并不适用于5G Massive MIMO设备的测试。此外，由于探头 的权重系数是包含了相位信息的复数，这需要对系统中各个探头进行相位校准。 在传统的4G终端测试中，相位校准工作可以较为轻松地完成。然而，在5G设
20
备的OTA测试中，由于射频器件在毫米波频段的相位漂移等非理想因素的存在, 相位校准工作几乎很难完成。
2.3.2预衰落合成法
由2.2.2节中对GBSM模型的介绍可知，整个信道模型是由多个簇组成的, 每个簇都包含有多条时延相同、角度相近的子径，通常簇内子径在空间上的功率 —角度分布通过功率角度谱(Power Angular Spectrum, PAS)来定义。预衰落合 成法的主要思想就是通过给每个探头赋上合适的权重，通过还原每个簇的PAS 来进行整个信道的复现。直观意义上来说，可以直接对连续的PAS进行离散采 样来获得探头的权重，但是这种方法没有考虑到测试区域的大小，在实际测试当 作不可行。因此，为了在测试区域内部精确还原目标信道的PAS,预衰落合成法 利用了空间相关性(Spatial Correlation Function, SCF)和PAS是一对傅里叶变 换对这一性质，通过在测试区域内部复现目标信道的空间相关性来进行探头权重 的求解。
功率角度谱是在信道模型中广泛使用的一个概念，指的是子径的功率和角度 的分布函数，它描述了簇内子径在空间中的分布信息。本章使用卩(卩)来表示功 率角度谱，且满足如=1。功率角度谱的形状由簇的到达角和角度扩展决定, 通常服从均匀、高斯和拉普拉斯分布。典型的呈拉普拉斯分布的PAS表达式如 式2-5所示，其中0表示归一化因子，b表示标准差，也就是簇的角度扩展。％ 表示的是功率角度谱的中心角，也就是簇的AoA。图2-8描述了一个到达角为0°, 角度扩展为35。的拉普拉斯分布的角度功率谱。
=	(2-5)

-150	-100	-50	0	50	100	150
图2-8呈拉普拉斯分布的PAS
21
空间相关性指的是信道某一端各个天线之间的相关性，它表述了信道的空间 特征。信道某一端的两个天线的空间相关性如式2-6所示，其中”（•）表示的是天 线的方向图。MIMO信道的性能很大一部分上取决于所处的空间环境，因此在预 衰落合成法中，通过复现信道的空间相关性来进行MIMO设备的性能测试。
_	JA（0）E（0）P（0）加
P J 闪	巧（0）|5（莎巾	（2_6）
在介绍了功率角度谱和空间相关性这两个概念之后，接下来对预衰落合成法 的原理进行介绍。预衰落合成法的目标是在测试区域内部进行空间相关性的还原, 首先需要在测试区域内进行虚拟天线对的采样。一些文献针对虚拟天线对的采样 方式进行了研究，提出了不同的采样方式。本章将测试区域均匀地切割成多个圆 环，并在圆环上进行均匀采样，这样可以得到相对于中心点对称的虚拟天线“和 Vo在各项同向性天线的假设下，可以由式2-6进一步推出在目标信道中，虚拟
—> —>
天线黠和卩的空间相关性如式2-7所示，其中©和人代表的是天线况和卩的位置矢 量，Q表示的是空间角度矢量。
p„v=（fexp 丿心―J可P（O）cZG	（2-7）
类似地，假设有K个OTA探头均匀环绕在测试区域周围，那么此时OTA环 境下虚拟弐线"和v的拟合空间相关性如式2-8所示，其中©是第丘个探头的权 重系数，示斤是第丘个探头的所在位置的角度矢量。可见，OTA环境下的拟合空 间相关性是与探头的权重系数相关的函数。
A K	了 - f f、
Pu.v	exp U也 - 7；） •①*	（2-8）
在求得某一个虚拟天线对的空间相关性之后，针对测试区域内部所有的虚拟 天线对进行空间相关性的拟合，就可以求出探头的权重系数。假设一共在测试区 域内部采得了M个虚拟天线对，那么目标空间相关性可以表示为 P'arge产{QJWMXI ,拟合空间相关性可以表示为卩皿={ Q” } W M X 1。因此可以通 过求解式2-9中的凸优化问题，来得到探头权重。
剛％3）一％』	（2_9）
s.t. 0W© Sl,Vk w[1，K]
对于一个AoA = 0. AS = 35的拉普拉斯分布的PAS来说，分别用8个和16个 探头对进行空间相关性进行拟合，可以得到结果如图2・9所示。观察结果可知,
22
随着天线间距的增加，天线的目标空间相关性逐渐减小。当探头数量为8个时， 前半段拟合效果较好，但是后半段的空间相关性呈现上升趋势，也就是文献[37] 所说的“flyback”现象。而当探头数量增加到16个时，空间相关性与目标曲线 完全贴合。这说明，探头数量越大，空间相关性拟合效果越好，支持的测试区域 半径也越大。具体需要的探头数量由测试所需的测试区域大小和信道的功率角度 谱共同决定。
预衰落合成法的优点在于它求得的探头权重是一个实数，不包含相位信息， 因此在实际测试中无需进行相位校准工作，大幅降低了测试的复杂度。另一方面， 预衰落合成法所需的探头数量远远低于平面波合成法，这节省了系统的成本。基 于以上优势，预衰落合成法更加适用于5GMassiveMIMO设备的OTA测试。然 而，由于预衰落合成法的理论前提是空间相关性和功率角度谱互为傅里叶变换对。 由于在毫米波频段下，信道呈现稀疏特性，这导致两者的关系不再成立。因此， 预衰落合成法在毫米波频段下并不适用【2叭

图2-9空间相关性

2.4本章小结
本章首先介绍了三种主流的MIMO OTA测试方法的原理、架构和优缺点， 并对这三种方法做了对比，分析了其适用场景和未来发展的挑战，说明了暗室多 探头法是唯一能够用于5G Massive MIMO OTA测试的方法。接着，本章对MIMO 信道的建模技术做了介绍，其中详细介绍了暗室多探头法中用到的信道模型—— 基于几何关系的随机信道模型-最后针对暗室多探头法的两种信道重构技术—— 预衰落合成法和平面波合成法，本章详细地介绍了两种方法的思想和原理，并通 过仿真结果，对预衰落合成法的效果进行了验证。
23


























































24


第三章Massive MIMO OTA测试中探头选择算法研究
本章主要研究了 Massive MIMO OTA测试中探头选择的问题。首先，在第 一节中详细阐述了探头选择在Massive MIMO OTA测试中的重要性，并说明了 现有的multi-shot算法不适用于5G大规模MIMO设备测试场景。在第二节中， 本章对暗室多探头法的Massive MIMO OTA测试系统架构进行了详细的介绍。 在第三节中，本章提出了一种基于梯度下降的探头选择算法，详细介绍了算法的 思想、原理和步骤。最后在第四节中，首先介绍了主流的multi-shot算法的原理 和步骤，并以此作为对比，将精确度和复杂度作为评判标准，从仿真验证的角度 验证了本章所提出算法的优越性。
3.1概述
Massive MIMO技术通过在信道的接收端和发送端使用大规模的天线阵列， 来进一步提升链路速率和系统容量，能够满足人们日益增长的数据传输速率的要 求。目前，3GPP等标准化组织已经初步规定了在Sub-6GHz频段下，支持高达 196个天线和基站设备和8个天线的终端设备。国内各个厂商如华为、中兴等也 已经研发并开始部署5G Massive MIMO基站设备。
Massive MIMO设备的测试是其商业化过程中的一个重大挑战。由于Massive MIMO设备的天线数量众多,且毫米波频段下射频器件体积小、集成度高的特点= 基于射频导线连接的传导测试已经不再适用于5G设备的测试，基于空口辐射的 OTA测试己经成为唯一的解决方案。在MIMO OTA测试的各种方法中，多探头 暗室方法被认为是最有希望进行5G Massive MIMO OTA测试的方法。在典型的 MPAC装置中，OTA探头天线安装在被测设备的周围，而被测设备放置被测设 备的暗室中心区域（称为测试区域）中。然而，MPAC方案的一个主要挑战在于 其较高的系统成本。因为每个探头天线都要分配一个非零的功率系数，从而合成 目标信道，这些探头天线都需要连接到昂贵的信道模拟器的输出端口，大大提升 了系统的成本。然而，由于实际信道模型通常具有方向性，所以并非所有的探头 天线都必须参与到信道的合成当中。因此，为了减少系统所需的探头数量，如何 从大量的备选探头中选出合成信道所必须的探头已经成为一个亟需研究的问题， 也就是探头选择问题。
文献［36］提出了几种探头选择算法，如暴力算法、one-shot算法、multi-shot 算法和连续探头消除算法。上述算法都依赖于文献［19］中提出的凸优化框架。其
25
中暴力算法将对所有可能的探头天线组合执行凸优化，因此当候选天线的数目很 大时，计算复杂度会变得及其巨大；one-shot算法在对所有候选探头进行凸优化 后，选择多个功率权重最大的探头，这是最简单但性能明显较差的算法;multi-shot 算法和连续探头消除算法分别在每次优化中去除贡献最小和最大的探头，并对剩 余探头重复进行凸优化，兼顾了计算复杂度和仿真精度。
Massive MIMO OTA测试系统需要考虑到5G设备的新特性。基站设备是一 个定向接受信号的设备，因此Massive MIMO OTA测试系统抛弃了 4G LTE OTA 测试系统的环形或者球形的探头布置结构，而采用了扇形的探头墙设置，仅仅覆 盖基站面板的前方区域。5G的基站通常装备有数以百计的天线，采用Massive MIMO技术作为通信的关键技术。大规模天线的使用，会导致被测设备尺寸的增 加，从而对于测试区域的要求也会增加。因此，在Massive MIMO OTA测试系 统中，需要更加准确地对目标信道进行重构。在OTA测试中，无论是预衰落合 成法还是平面波合成法，由于测试成本的限制，都需要在所有的备选探头中选择 出较小数量的探头，也就是探头选择工作。在Massive MIMO OTA测试系统中， 为了考虑水平区域和垂直区域中的信道分散，暗室内将配备更多的探头天线作为 候选探头。而在高频段（例如，28GHz）工作的探头天线，其制造成本较低；因 此，在MPAC设置中安装数百个探头在经济上是可行的国】，然而，由于备选探 头数量的增加，从数百个候选探头中选择出较少数量的目标探头将成为一个巨大 的挑战。此外，由于动态波束赋形测试需求的日益增长，如何在测试过程中根据 信道的动态参数快速进行探头选择是一个亟需解决的问题。因此，迫切需要一种 更加快速有效的探头选择算法，提升预衰落合成法中的信道重构效率，满足5G MIMO设备的测试需求。
3.2系统架构及优化问题
3.2.1 Massive MIMO OTA 测试系统架构
文献［21］介绍了一种基于MPAC的Massive MIMO OTA测试系统，具体架构 如图3-1所示，可以发现，该系统与传统4GMIMOOTA测试存在着许多不同之 处。首先，考虑到实际信道在垂直方向上也有分散，且垂直方向上的波束赋形能 力也是测试指标之一，因此探头墙由2D扩充成了 3D结构。与终端设备所处的 无线电环境不同的是，Massive MIMO设备所处的信道环境具有很强的指向性， 通常大部分的多径信号来自于基站面板的前方。因此，探头由4G测试中环绕被
26
测设备的环状或者球形结构，变成了扇形结构。最后，由于需要支持动态波束赋 形测试，因此在信道模拟器和探头墙之间加上了开关电路，用于动态控制测试过 程中探头的变化。
下行

上行
图 3-1 Massive MIMO OTA 测试系统
整个测试系统包括被测设备、暗室、探头墙、OTA探头、开关电路、功率 放大器、信道模拟器以及终端模拟器组成。终端模拟器发出的信号经过信道模拟 器衰落之后，被功率放大器放大，用以补偿链路的损耗。放大后的衰落信号经过 开关电路之后，被传输到特定的探头上，再经过暗室内的自由空间辐射至被测设 备，完成上行链路的通信。与此同理，下行链路的通信过程类似。接下来，对测 试系统中各个组件的作用进行介绍。
被测设备：被测设备是待测的Massive MIMO设备，通常放置于测试区域的 中心位置。在实际测试中，通常关注被测设备的波束赋形、吞吐率以及误码率等 指标。
暗室：暗室的内部铺满了吸波材料，用以屏蔽外部电磁波的干扰和消除内部 信号的反射。此外，暗室的尺寸还需要满足远场条件。因此Massive MIMO设备 测试所需的暗室尺寸较大，建造成本高昂，是测试系统成本较高的原因之一。
探头墙：探头墙上是放置OTA探头的固定装置。在Massive MIMO OTA测 试系统中，探头墙是一个扇形结构，覆盖了信道中大部分子径的来波方向。扇形 结构的探头墙符合实际的信道环境，并且能够节省一半的暗室空间，有利于降低 系统的成本。探头墙上OTA探头的放置方式有两种：一种是固定角度间隔放置 探头，探头布满整个探头墙；另一种是通过步进式运动装置，将少量探头移动到 合适的位置上去。此外，由于探头间耦合的存在，探头墙上的OTA探头不能放 置的过于靠近。
OTA探头：探头用于向被测设备辐射信号和接收信号。OTA探头天线一般 为成本较为低廉的贴片天线，能够大量地安装和使用，有利于减小整个系统的成 本。此外，为了保证不同位置的探头到被测区域中心的增益是一致的，应该使用
27
全向或者近似全向的天线。
开关电路：开关电路是整个测试系统中重要的一环，用于将信道模拟器端口 和特定位置的探头连接起来。从控制信道模拟器资源的角度来说，实际测试中只 能使用部分探头进行信道的合成，因此采用开关电路进行连接。除此之外，通过 使用开关电路在不同的时刻连接不同位置的探头，使得系统能够支持动态波束赋 形的测试。开关电路主要有机械式、透镜式等，关键参数包括开关速度、插入损 耗、隔离度、成本、尺寸和线性度等，应该综合测试需求和系统成本来进行选择。
功率放大器：功率放大器用于放大信道模拟器的衰落信号。由于暗室的尺寸 需要满足远场条件，因此暗室的尺寸一般较大，这就造成了暗室内部的自由传输 损耗较大，功率放大器的作用就是为了补偿此部分的损耗。因此，功放的选择要 考虑到整个系统的损耗，使得系统工作在功放的线性区间。
信道模拟器:信道模拟器用于创建多径衰落环境，包括信道的时延、多普勒、 极化等信息。信道模拟器是测试系统的重要组成部分，也是测试系统成本高昂的 原因之一。由于信道模拟器的端口数量有限，因此如何在有限的端口资源下进行 高效的信道重构成为研究的热点。目前，Massive MIMO OTA测试对信道模拟器 提出了新的需求。毫米波频段的测试需要支持高达28GHz的频点，宽达400MHz 的频带，如何满足苛刻的测试需要也成为了信道模拟器厂商亟需解决的问题。
终端模拟器：终端模拟器用于模拟终端信号的发射、接收以及信令控制等行 为。
3.2.2问题表述
本小节采用3.2.1小节所描述的Massive MIMO OTA测试系统架构，并采用 预衰落合成法进行信道重构。假设被测设备是一个8x8的MIMO天线阵列，因 此测试区域的半径设置为2.5个波长。接着以文献［22］所示的采样方式对测试区 域球面进行采样，使得虚拟天线”和虚拟天线v处于椭圆球面的对称位置，采得 的共M个虚拟天线对如图3-2所示。
将2D的PAS在垂直域上进行扩充，那么能够得到3D的球形功率谱 (Spherical Power Spectrum, SPS),有 P(0,0) = P(O)P(0)。与 2D 的 PAS 不同的 是，SPS在垂直方向也存在子径的分布，因此它的形状由水平到达角、水平角度 扩展(Azimuth angle Spread of Arrival, ASA)以及垂直方向的垂直到达角(Zenith angle of Arrival, ZoA)和垂直角度扩展(Zenith angle Spread of Arrival, ZSA) 共同决定。此外，SPS应该满足［工;P(0)P(0)cos(0)矽朋=1。则第加个采样对之间 的目标空间相关性如式3-1所示，式中，2表示波长，二,，”和二"分别表示第加
28
个采样对中天线单元”和V的位置矢量，G表示立体角矢量。


图3-2测试区域采样示意图
「 —
pm = <J»exp(j—(rw>m- rv,m)-Q)P(Q)JQ	(3-1)
图 3-3 表示了一个 AoA = 0,ASA = 15,ZoA ^90,ZSA = 1 的 SPS 下，M 个虚拟 天线对的空间相关性。


图3-3虚拟天线对空间相关性
设N为候选探头天线数，◎仝［①卩…，①订‘表示N个探头天线的角度方位的 谷量。因此第”个探头在第刃个天线对的空间相关性中的贡献可以由 给出。其中叫是第"个探头的功率值，且0”,”表示的是第"个探头 对第加对虚拟天线对之间的传输因子，有：
2 龙 T	->	T
0”." =expQ 丁 (九旳-八”)•①”)	(3-2)
其中示”表示第"个备选探头的单位角度矢量。
因此，推导出的第加个天线对的拟合空间相关性可以表示为：
(3-3)
29
式中有 W = [w1,...,wj7' 和莒=[0”」,...,0”鼎丁。
由于探头的功率之和应该等于1且每个探头的功率大于等于0,因此权重向 量应该加上厶范数和非负约束。约束公式如式3-4所示。
llwj] =1,0<W<1	(3-4)
式中汕表示厶范数。此外，探头选择的目的是寻找探头的最佳子集，子集的数量 不应大于信道仿真器可用输出端口的数量(用K表示)；因此，进一步得到约束：
(3-5)
式中，操作符IHI。表示取零阶范数，也就是矢量中非零值的个数。
对于M个采样点来说，探头选择的目标是最小化目标信道空间性和合成空 间相关性的误差平方和。因此，该问题可以表示为：
min E(w) = |lp(w) - p(w) w	II	2	(3-6)
sJ,(3 - 4)and(3 - 5)
式中有卜林，…,心T，p=[”，…,◎『，且〔汕表示取二阶范数。此外，式3-6 是一个组右非凸优驶问题，由于式3-5中的零阶范数约束，它是一个NP-hard问 题。当N很大时，暴力算法在计算复杂度上变得难以承受。
3.3基于梯度下降的探头选择算法
本节针对3.2节提出的问题，提出了一种基于梯度下降的算法。该算法的主 要思想是通过求解式3-6中的梯度，不断进行迭代更新探头的权重向量，最后求 得符合要求的探头权重。为了提高迭代过程中算法搜寻最优解的速率，本算法采 用动量梯度下降方法来进行权重的更新。除此之外，本算法还采用了批次迭代策 略来降低算法每一步迭代的计算复杂度。为了达到探头选择的目的，本算法在原 有的问题之上引入了正则化，使得非零功率探头的数量达到预期。本节首先对正 则化、梯度计算以及权重更新策略进行说明，接着介绍算法的整体流程。最后， 对算法的计算复杂度进行分析，理论上证明了本算法的优越性。
3.3.1正则化
正则化是一种用于神经网络模型训练的技术，它通过给网络的目标函数加上 正则化约束，对网络的内部权重的范数进行约束卩刃。本算法通过在公式3-6中的
30

误差函数上添加一个正则化项，修正后的误差函数可以表示为E(W)+A||w||；,其中 2是正则化参数，用于平衡结果精度和权重向量中非零值的个数，|比表示取卩阶 范数。文献结果表明，当OSpSl时，正则化函数可以达到稀疏效果，当卩越 小时，稀疏效果越好购。然而，由于厶范数的NP-hard性质，直接利用厶范数求 解是不可行的。相反，对于0<^<1,基于厶/2范数的正则化函数已被证明在所有 仃正则化函数中最具有代表性的函数，并且最近在稀疏表示领域获得了广泛的关 注⑷]。因此，通过添加仏正则化函数，公式3-6中的误差函数可以改写为：
£(w)=E(w)+2||w 监	(3-7)
3.3.2梯度计算
令Pm和為=P„~Pm分别表示第m个虚拟天线对的拟合空间相关性以及拟 合空间相关性与目标空间相关性的复数误差。那么对于第加个虚拟天线对，拟 合空间相关性与目标空间相关性之间的误差函数可以表示为：
A	人
Em = (Pm- Pm)(PnT PmY	(3-8)
接着，令(a£m(w))/aw表示为误差函数氏相对于权重向量w的梯度，则有： (馮(w))/ dw= [(dEm (w)) / (列)，…,{dEm (w))/ (dwN )f	(3-9)
最后，进行梯度的求解。根据链式法则，误差函数E,”相对于权重的梯度可以
求得为：
%(w)
_a{9?2K]+32K]}
dwn
(3-10)
=2珂爲]警J + 2乖订警1
亦”	dw„
= 29?KWm,„] + 23[^P[/?mJ
其中说(・)和3(.)分别表示复数的实部和虚部。
为了简便表示，本章将T'eT定义为算法迭代过程中每次迭代使用到的数 据子集，那么公式3-7中的梯度可以改写为

为了使算法在迭代过程中达到更高的效率，算法在每一次迭代计算的时候, 并不是使用全部M个虚拟天线对的数据进行梯度的计算，而是每次随机选取固 定大小的批次进行迭代计算。这样做的好处有两个，首先能够大幅减少每次 迭代的计算复杂度；其次是每次选取不同的数据集合进行梯度计算，可以增加梯 度的随机性，从而获得更快的收敛速度。因此，批次迭代的方法在计算速率和收 敛性之间达到了较好的平衡。
3.3.3权重更新
与标准的梯度下降法相比，动量梯度下降法通过计算梯度在时间上的指数衰 减的平均值来进行权重的更新，它可以达到更快的收敛速度。其动量更新公式为: V(/)*V(/-1) +"卑乎	(3-12)
式中，y是控制指数加权平均值的动量参数，9是学习速率。最后，权重更新公 式可以表示为：
w(r) = w(r-l)-V(O	(3-13)
此外，正则化参数;I是用来控制权值的稀疏性的，在训练开始时它的最佳值 是未知的，必须在训练过程中加以调整。
3.3.4算法流程
根据上述描写的关键步骤，本章所提出的算法流程如算法3-1所示。在算法 3-1中，T是训练的总迭代次数，AT是更新正则化参数2的迭代次数的间隔，M 表示每次更新2的增加值。值得注意的是，算法采用了两种不同的方式来动态调 整正则化系数的值。在剩余的非零权重个数大于K的情况下，算法采用“慢启 动”策略逐步增大2,以避免过正则化现象的出现。而在剩余的非零权重个数小 于K的情况下，算法采用“指数减小”策略减小2,以帮助快速从过正则化中恢 复过来，使得非零功率的探头的个数增加。此外，运算符［丁表示将权重投影到 非负象限上去，用于保证式3-4中w的非负约束。因为较小的权重会产生更大的 梯度分量，如式3-10中的第二项子式所示。由于正则化项的存在，通过式3-12 进行更新后，较小的权重更可能小于零，令这些权重等于零可以避免它们在零附 近振荡，达到快速收敛的效果。
3.3.5复杂度分析
32
计算复杂度决定了算法的适用性，特别是对于动态信道仿真，计算复杂度越 小代表着每次探头选择的时间越少，其适用性越高。在本小节中，选择主流的 multi-shot算法作为基准，并比较两种方法的计算复杂度。
算法3-1基于梯度下降的探头选择算法 输入：目标相关性，传输因子;
初始化参数：/ = l,w(l),V(l)，z2』
While / <7 Do
随机选取固定大小的子集
根据公式3-10和3-11计算梯度和动量
根据公式3-12更新权重向量w
调整权重向量：w=[w]+,w = w/||w||i
If t mod AT = 0 then
If ||w||0 > K then
2=2/2
Else if ||w||o < K then
End If
End If
End While
输出：权重向量w
Multi-shot算法基于式3-6中定义的目标函数进行凸优化，并在每次迭代时 移除功率权重最小的探头，直到剩余的探头数量达到目标为止。Multi-shot算法 的流程如图3-4所示。文献[42]证明了式3-6中的优化问题本质上是一个二阶锥 规划问题。因此，每一次迭代都可以等效为二阶锥规划问题，在第，次迭代中， 二阶锥的维度为M + 1,且一阶等式约束的维度为N-z + lo因此，根据文献[43], multi-shot算法在第i次迭代中最坏情况下的计算复杂度可以表示为：
O((N-Z + 1)3 + (7V-Z+1)2 (M +1) + (M +1)2)	(3-14)
很明显，multi-shot算法的计算复杂度与探头数的立方成正比，对于具有数 百个候选探头的3D探头配置来说，计算复杂度将变得难以承受。
在本章提出的算法中，主要的计算开销是每次迭代中的梯度计算。因此，该 方法的复杂度可以用O(SN)表示，其中S表示每次训练中批量的大小。因此，与 multi-shot算法相比，本章提出的算法具有更低的计算复杂度，更适合应用于三 维的探头选择。
33

图3-4 multi-shot算法流程

3.4仿真结果与性能分析
本节进行数学仿真时延，并利用仿真结果来验证本章提出的方法在仿真精度 和计算效率方面的性能。Multi-shot算法作为凸优化类算法的代表，在本节中被 当作仿真的对比算法。在最后，本节还给出了算法迭代过程中参数的变化曲线, 并对算法的运行过程做出了解释。
3.4.1仿真设置
由于5G移动通信系统中应用的毫米波信道的方向性和镜面反射特性，因此 本章仿真采用文献［22］中提出的扇形MPAC设置。如图3-5所示，黑色球面表示 探头墙，探头墙上的每个红点表示探头天线。蓝色圆点包围的区域表示测试区域。 注意，为了更好的可视化，测试区域被放大了。与传统的二维探头环结构的MPAC OTA测试系统不同的是，DUT位于测试区域内部，放置在暗室的边缘位置。扇 形探头墙上的每个点到测试区域中心的距离相等。显然，扇形的探头墙结构可以 充分利用暗室的空间，并减少所需的硬件资源，如探头天线等，从而为大尺寸的 被测设备（例如5G大规模MIMO设备）提供更具成本效益的测试方案。
34
探头墙



图3-5仿真配置
本章假设两种不同的探头配置。在第一种探头配置中，探头墙覆盖的角度范 围在仰角方向为60°,在水平方向为120°,相邻探头之间的间距为10°,因此有 N = 91个候选探头。在第二种探头配置中，探头墙的角度覆盖范围相同，但是探 头间距减小到5。；因此，候选探头的个数为N = 325个。将测试区域的半径设为 2.5个波长，测试区域中一共含有M = 2592个采样天线对。选择一个均匀分布的 初始权重向量，使得w”⑴=\lN对于任意”w{l,...,N}成立。表3-1列出了算法 的初始参数。
表3-1算法初始参数设置
符号
含义
数值
T
迭代次数
10000
S
批量大小
128
7
学习速率
0.00001
7
动量参数
0.99
A(l)
初始正则化参数
0.8
△T
2的更新间隔
400
A2
2的更新步长
0.05
3.4.2运行效果
首先对算法的运行效果进行探究，本小节分别采用3.4.1节中描述的两种探 头配置进行实验。在本小节中，分别设置信道只有单个簇和多个簇的情况，运行 本章所提出的算法，探究算法在不同的信道条件下的效果。
首先是单簇情况下的信道合成，假设某一 SPS的水平和垂直方向的到达角 都设置为0。，水平和垂直方向的扩展角为15。和10。，采用第一种探头配置进行 实验。SPS的形状与所选的探头位置如图3-6所示，黑色空心圆圈指的是所有备
35
选探头的空间角度，红色的实心圆指的是算法运行后选择出来的探头。可见所选 的探头处于SPS覆盖范围的内部，这表明所选探头的角度与SPS的中心角度接 近，在空间上复现了目标的SPS。


图3-6单簇环境下所选探头位置示意图
图3-7表示了采样球面的拟合空间相关性和目标空间相关性绝对值误差，可 以看见整体的误差较小，说明所选的探头成功地复现了目标信道的相关性。


图3-7单簇环境下空间相关性误差
接着进行多簇环境下的仿真实验,将垂直和水平方向的扩展角固定为5。和3。, 随机产生6个不同到达角度的簇，采用第二种探头配置进行实验。得到的SPS 形状和探头位置如图3-8所示。可以看见，探头的位置与大部分簇的位置相重合。 然而由于某些簇的功率较小且探头的数量有限，导致算法在优化的时候，忽略了 这些簇。
图3-9表示了拟合空间相关性和目标空间相关性之间误差的绝对值，可见图 中大部分采样点的误差是较小的，但是某些地方的误差仍然较高，这是因为探头 数量较小造成的，需要增加探头数量来减少误差。
36


3.4.3运行速度
本小节利用Matlab的内置探查器命令对实际执行时间进行了跟踪，比较了 本章所提出的算法和multi-shot算法的实际执行速度，证明该算法在信道重构效 率上的优越性。本小节一共进行了两种情况的仿真。在情况A中，在第一种探 头配置下复现由单个簇组成的目标信道，簇内子径的角度呈拉普拉斯分布，目标 探头数量为K = 8；在情况B中，在第二种探头配置下，选择文献［27冲定义的 CDL-A信道模型作为更复杂信道环境下的目标信道，目标探头数量为K = \6 o
可以预期，由于算法本身的随机性，算法多次运行的结果可能会有所不同。 因此，在这两种情况下，这两种方法都进行了五次独立运行，其执行时间以及以 均方根偏差(Root Mean Square Deviation, RMSD)如表3-2所示。可以观察到， 由于本章出的算法会在每次迭代中从相关性集合中随机选择一个子集，因此在不 同的运行批次中，算法的RMSD结果之间会有细微的差别。
37
表3-2算法运行结果对比


运行次数
1
2
3
4
5
情况
A
Multi-shot
RMSD




执行时间（秒）


梯度下降
RMSD



执行时间（秒）

情况
B
Multi-shot
RMSD



执行时间（秒）


梯度下降



执行时间（秒）

对比两种算法的表现可以看出，基于梯度下降的算法的仿真精度可以非常接 近甚至优于multi-shot算法，但其计算复杂度在执行时间上比multi-shot算法低 几个数量级。除此之外，随着需要求解的问题的规模逐渐增加，例如从情况A 到情况B, multi-shot算法的执行时间比梯度下降算法增加得更快。这是因为 multi-shot算法的额外计算复杂度会随着迭代次数和和优化问题规模的增加而增 加。与之相反的是，本章提出的算法的计算复杂度只会随着训练过程中权值数量 的增加而线性增加。值得注意的是，实际执行时间的结果与第3.3.5小节中的计 算复杂度的理论分析结果是一致的。
3.4.4鲁棒性
为了验证本章所提出的算法的鲁棒性，本小节分别采用了不同的信道环境来 进行仿真实验。在本小节中，采用第二种探头配置作为仿真设置
对于单簇环境，本小节生成了具有不同角度参数的SPS进行实验。如表3-3
所示，一共生成了六种不同SPS形状的单簇信道模型，簇内子径都遵循拉普拉
斯分布，具有不同的到达角和角度扩展。考虑到单簇情况下所需的探头数量较小，
因此将目标探头数设置为K = 8。表3-3中的RMSD结果表明，在单簇情况下，
与multi-shot算法相比，本章提出的方法可以达到相似的精度。此外，观察表3-3
可以发现，随着簇的扩展角度的增加，拟合误差也在不断增加，这说明所需探头
的数量随着簇的扩展角增加而上升。对于多簇情况，本小节利用文献［27］中定义
的非视距场景下的CDL信道模型进行仿真实验。在仿真过程中，忽略到达角超
38

出探头墙覆盖范围的簇。考虑到多簇信道中的子径数量较多，需要的探头数量也 增加，因此将目标探头数量设置为K = l6o
表3-3和表3-4中的仿真结果表明，与multi-shot算法相比，本章提出的算 法在不同的信道环境可以达到较高精度。因此，该算法适用于普遍性的信道环境。
表3-3单簇信道下算法运行结果



表3-4多簇信道下算法运行结果
信道
CDL-A
CDL-B
CDL-C
Multi-shot

梯度下降

3.4.5参数变化情况


为了更深入地了解本章提出的算法是如何工作的，本小节对算法运行过程中 一些重要参数的变化进行分析。图3-10说明了在迭代过程中正则化参数2的调 整，图3-11显示了训练过程中非零权重个数的变化。当初始2太大的时候，会
39

出现过正则化的现象，即初始阶段数值大于0的权重个数小于目标探头个数。因 此，在接下来的迭代中，采用“指数减小”的策略来减小正则化系数2的值，这 将使得更多数量的权重变为非霎，以接近目标探头数量。仿真结果表明，只需对 2进行少量调整就可以达到最终的收敛。在本次迭代过程中，仿真误差最终收敛 到0.083o算法执行完成之后，可以得到一组非零权值，每个权值对应一个探头 及其功率权重。如表3-3所示，在几乎所有的仿真情况下，任意一个迭代过程也 可以在计算复杂度大大降低的情况下达到与multi-shot算法相同的性能。

图3-12相关性误差值变化示意图
如图3-11和图3-12所示，由于学习速率是固定的，当非零探头数量变化时， 仿真误差波动更剧烈，并且随着非零探头数量的增加而变得稳定。在算法的运行 过程中，探头的数量（权重向量中非零值的个数）与误差是一个反向关系，当探 头数量越多的时候，误差越少，反之则类似。两者在迭代的过程中不断变换，最 后探头数量达到目标值，误差也趋于稳定。此外，在迭代过程中。如果学习参数
40
（如学习速率卩）可以自适应调整，则所提出的算法的收敛性可能会更平稳而迅 速。
3.5本章小结
本章主要讨论了大规模多入多出天线空口测试下的探头选择问题。首先指出 由于备选探头数量激增导致原先的multi-shot算法不再适用，说明了研究该问题 的必要性。接着对Massive MIMO OTA系统架构做了简要的介绍，并在该系统 下对探头选择问题进行建模，给出优化问题。基于此，本章提出了一种基于梯度 下降的探头选择算法。在该算法中，将探头选择问题当作一个稀疏约束问题，通 过在目标函数上加入一个正则化约束项来进行探头的求解。通过在迭代过程中动 态地调节参数，来使得算法的瞬时稀疏状态符合预期。最后，通过与主流的凸优 化算法进行对比，说明该算法能够在获得相似的仿真精度的同时，可以大幅减少 计算的复杂度。


























































42


第四章基于预衰落合成法的信道重构研究
本章主要研究了基于预衰落合成法的信道重构问题。首先对预衰落合成法中 进行信道重构研究的必要性进行分析。接着分别就目标信道和预衰落合成法的重 构信道，以基于时间平均的方式，对信道的空时相关性进行推导。公式推导结果 说明，两者在空时相关性的复现上存在一定的误差。根据公式推导结果，本章提 出了一种改进方法，该方法针对原有的PFS重构信道中各个探头的初始相位进 行修改，使得改进后的模型能够精确地复现目标信道的空时相关性。最后，根据 仿真结果对改进后的模型进行验证，说明了本章所提出方法的有效性。
4.1概述
MIMO OTA测试的关键点在于测试区域内部还原真实传输环境的空间特性, 从而在被测设备上复现出真实环境下的性能。MPAC法通过利用暗室中不同角度 的探头进行目标信道的重构，达到对合成信道的空间多径结构的细粒度控制。如 果选取的探头位置和权重合适，MPAC法能够在理论上复现任何信道。PFS和 PWS是MPAC法中两种不同的信道重构方式，其中PFS由于无需相位校准且所 需探头数量更少等优点，吸引了更多的学者和机构对其进行研究。因此本章主要 讨论基于PFS的信道重构研究。
PFS方法的目的是根据功率角度谱在簇的维度上进行空间特性的重构，这需 要在MPAC设置中合适的探头配置。由于PAS和空间相关性是一个傅里叶变换 对，因此通常采用空间相关函数作为确定探头功率权重的准则，使得目标SCF 和模拟SCF之间的差值最小。文献［44］通过推导联合空时相关函数(space-time correlation function, STCF)对PFS方法进行了全面的总结，并且说明了基于PFS 的合成信道是一个克罗内克结构的信道。值得注意的是，在以往研究PFS方法 的文献中，SCF的推导都依赖于一个共同的假设——从不同的探头天线到DUT 的信道传输函数是不相关的。
然而，如果考虑到MPAC配置中信道模拟器的实际使用情况，会发现这种 前提是不成立的。由于信道模型中的每个随机参数都要预先配置好，因此由信道 模拟器生成的信道时间序列实际上是确定不变的。因此，对于任何给定的时间序 列，从统计平均的意义上推导SCF是没有意义的。相反，应从平均时间的意义 上重新对相关性进行分析。从这一新的角度推导出的SCF表明，在PFS方法中 应用于每个探头内部的每个子径的初始相位，对于测试区域内部合成的SCF中 发挥着不可忽视的作用，这可能使得不同探头的信道传递函数不再是不相关的。
43
这一发现进一步揭示了用PFS方法模拟的合成信道可能在SCF方面与目标信道 存在偏差的问题。因此，如何在实际的MPAC配置中，精确地复现测试区域内 部的空间相关性，是一个亟需解决的问题。
4.2基于预衰落合成法的信道重构理论 4.2.1目标信道的空时相关性推导
在各种MIMO信道模型中，GBSM模型具有物理解释清晰、传播参数和天 线效应分离等优点。在GBSM模型中，收端和发端之间的信道由多个簇组成， 每个簇对应于真实传播通道中的一条路径，并具有不同的到达角和离开角。每个 簇由M个子径组成，每个子径都具有相同的功率。实际上，每个子径表示簇中 的单个散射点的散射，并且相对于簇的中心到达角和离开角有一定的角度偏移。 从接收端观测到的簇的空间结构如图4-1所示。注意，簇中的每个点都对应于一 条子径，并且只包含一个多普勒分量。

与2.2.2节中介绍的双极化的GBSM模型不同的是，在本章中，为了简便起 见，本章只讨论单极化的GBSM模型。因此，从收端第"个天线到发端s个天线 的第n个簇的信道传输函数可以表示为：
[p M
方\ 诂工比(％)GG9””)expG2禅”讣 + 阀 ”)	(4-1)
V M 切=i
其中，/表示时间采样点，此表示为第"个簇的平均功率。九(•)和G”(・)分别表示 第s个发端天线和第”个收端天线的天线方向图。为了简便起见，本章假设收端 和发端都是各项同向性天线，即|^(-)|=1对于所有的s都成立、|G„(-)|=1对于所有
44
的”都成立。％,”、9“、札"和0””分别表示第"个簇内第也条子径的AoD、AoA、 多普勒频移以及初始相位。对于簇内不同的子径来说，其AoD、AoA和多普勒 频移通常是不同的。第“个簇中第刃条子径的初始相位是一个在[0-2^]之间 均匀分布的随机变量。值得注意的是，在实际的OTA测试中，％”、色”、0”,” 和盒”，的值都是预先生成并设置在信道模拟器中的。因此，一旦信道的初始参数 被确定了，那么信道的时间相应函数％,.”(/)就是确定的。所以在统计平均上进 行空时联合相关性的求解没有实际意义。
接着，利用时间平均函数对空时联合相关性求解。需要说明的是，一旦信道 的初始参数被固定下来，那么对于信道时间序列中的所有快拍，各个子径的初始 相位是固定的。这就意味着，各个子径的初始相位是固定的常数。这样，在基于 信道的遍历性的假设之上，就可以在时间平均上对信道的空时联合相关性进行求 解。首先，时间平均函数的定义如式4-2所示。
1 CT
基于信道的广义平稳假设，目标信道在收端天线对和发端天线对之间的空时 联合相关性可以求得为：
口 ("],©；“2，$2；丁)
£%山 + 丁)傀/)"]	件3)
—M工XL {坨，$2，九加「°珂血”则	+ ◎[①GO]}
M加=1羽‘=1
在式4-3中，各个表达式的含义为:
坨仏“仝化(％) £2 (% J
(4-4)

(4-5)
仝 exp(疋”)expO。”,)*
(4-6)
'""“2)- expC/27r0/)expC/2 勿討2)"
(4-7)
对于同一个簇下任意两个不同的子径来说，在遍历的前提下，两者的相关性 为0。即对于任意的m^m',两者的相关性可以表示为：
=£ [exp(_/2 哦,(t + r)) exp(j2^m,Z)*]	(4-8)
=0
对于任意两个相同的子径来说，在遍历的前提下，两者的相关性为1,即对 于任意的m=m',两者的相关性可以表示为：
45

E [①"(+,/)]
=6 [exp(7'2^OT (t + T)) exp(j2^w，0* ] =®[exp(_/2 勿尹)]
=exp(j2^wr)
因此，式4-3中的必2个相加的子项可以简化为M个子项，则公式4-3可以 简化为：
P,(M1,51；M2,52；T)
]M
=77 工坨-- exp(_/2翊初
值得注意的是，公式4-10中的结果不依赖于信道的初始相位，也就是说, 在目标信道中，子径的初始相位对空时联合相关性的推导结果没有影响。
4.2.2合成信道的空时相关性推导
在本章中，为了简便起见，只考虑2D场景下的单极化MPAC配置，具体如 图4-2所示。一共有K个探头均匀地分布在被测区域的四周，第£个探头的角度 表示为散,”表示的是第上个探头在第“个簇上的权重系数，对于任意的neN 来说，都有辛成立。此外，&”曲表示的是第丘个探头中第"个簇内部的第加 条子径的初始相位，服从在［0-2刃上的均匀分布。注意，在实际的OTA测试中, 仇旳”是预先设置好并固定不变的。观察图4-2可知，不同的探头都携带相同的 多普勒分量，在被测设备上合成为最终的合成信道。

从发端的第s个天线到第k个探头天线的信道传输函数可以表示为式4-11.
46

C.„（0 = J 警 fZ（%）exp（丿2网加+岡曲
在暗室内部来说，从第k个探头到第”个收端天线的传输函数是一个固定的 大小为KxU的矩阵，其中第丘行第”个元素可以表示为：
忙G”偲）
其中，G”（$）表示的从第丘个探头到第"个收端天线的传输时延引起的相位旋转。 为了简便考虑，本章忽略了从OTA探头到被测设备的自由空间传输损耗。
最终，结合所有的探头天线上所携带的信道传输函数，则在基于预衰落合成 法的合成信道中，从收端第“个天线到发端s个天线的第“个簇的信道传输函数 可以表示为：
磴mix遽》

基于信道的广义平稳假设，合成信道在收端天线对和发端天线对之间的空时 联合相关性可以求得为：
Pt （"i,旺,"2, *2 ； T）
T［曙（+）•磴；（忙	也皿



其中，有:

①篇（^i^2）= exp（/2 磁） exp（_/2 磁右）"
同样地，在合成信道中，有式4-19和式4-20成立。
吕［①:第（' + "/）］ = °，f°r mfm'

因此，通过省去不同子径之间相关性为0的部分，则可以将式4-14简化为 式 4-22 o
p\ (%] 5 $1 5 “2，$2，厂)
=£工工工{J叫叫'F：爲m -或；爲•	-exp(j2^mT)} (4_22)
A/ k=l /rM
4.2.3信道重构分析
前两个小节分别对目标信道和基于PFS的合成信道的空时联合相关性进行 了探究，并给出了详细的公式推导结果。本小节基于上述的推导结果，分别从空 间和时间两个维度上，对合成信道的信道重构结果进行分析。指出传统的PFS 的合成信道在信道重构方面的不足之处，并给出可能改进的方向。
首先，从空间相关性上对信道重构的效果进行分析。首先令勺=见/ = 0, 那么可以得到目标信道的收端天线的空间相关性为如式4-23所示。可以看见， 利用时间平均求出的空间相关性和以往文献中利用统计平均求出的空间相关性 是一致的，这进一步说明了利用时间平均进行信道高阶特性的分析方法的正确性。 进一步观察式子可以发现，收端的空间相关性于信道中各个子径的初始相位无关。
(4-23)
同样地，通过令$严$2，丁 = 0,可以得到合成信道的收端的空间相关性为式 4-24 和式 4-25。
]K
M —
* K K
+—ZX 阿T •纯 ⑻G如歸・xgk -)
k'^k
X(k,k") = L®	(4-25)
m=l
观察上式可以得到，PFS合成信道的空间相关性与由两个子式相加构成， 第一个子式是目标信道的相关性，第二个子式是多个交叉项的累加。如果忽略第 二个子式，那么该空间相关性就与目标信道的相同。然而，在实际的OTA测试 中，由于信道参数生成的随机性，第二个子式不一定会等于0。因此合成信道的 空间相关性与目标信道不一致，其结果依赖于探头中各个子径的初始相位
图4-3显示了目标信道和PFS合成信道的空间相关性仿真结果，其中曲线表
48

示的是使用公式4-23和4-24计算出来的相关性，称之为模拟SCF,圆圈代表的 是对信道序列使用时间平均求出来的相关性，称之为解析SCF。观察仿真图可知， 曲线和圆圈保持一致，这说明两种方法求得的空间相关性的方法相同。接着本小 节采用了两种不同的初始相位集合来生成PFS合成信道，分别是集合1和集合2, 注意这两个集合的内部参数都是随机生成的。观察图4-3可以发现，初始相位不 同，得到的相关性也不同，这与上文分析的结果一致。再一次说明了传统PFS 方法在复现空间相关性的缺陷。

接着，从时间相关性的角度上进行信道重构的分析。令s^s2,ux=u2,可以 得到目标信道的时间相关性如式4-26所示。同样可以发现，目标信道的时间相 关性与子径的初始相位无关。由于多普勒频谱和时间相关性是一对傅里叶变换对, 因此可以得出目标信道的多普勒频谱由M个频谱分量=	构成，
每个频谱分量含有相同的功率1 / M。

通过令必=52,WI= “2，可以得到合成信道的时间相关性如式子4-27所示。观 察公式可以发现，合成时间相关性并不严格地与目标信道的时间相关性保持一致, 这是因为合成信道是由多个探头的信道相加构成的。尽管每个探头都携带有相同 的多普勒分量，但是各个探头的子径的初始相位不同，造成了多个探头在合成相 同的多普勒分量时，会出现相位叠加的现象。式4-27中各个频谱分量后面的系
数反映了这一现象。

为了探究移动端运动速度对时间相关性的影响，本小节设置了移动端速度分 别为3km/h以及30km/h这两个场景进行仿真实验。每个场景分别探究了目标信 道和两种不同初始相位下的PFS合成信道的时间相关性。为了验证上文公式推 导的正确性，本小节针对每个信道，首先使用时间自相关函数求得信道时间序列 的自相关函数，接着使用公式4-26和公式4-27进行时间相关性的求解。将前者 称为模拟TCF,在图中以圆圈表示，后者称为解析TCF,在图中以曲线表示。 类似于图4-3,本章采用了两种不同的初始相位集合来生成PFS合成信道，分别 是集合1和集合2,且这两个集合的内部参数都是随机生成的。图4-4中a和b 分别显示了两种运动速度下的时间相关性。首先分析单个信道可以发现，解析 TCF和模拟TCF保持一致，验证了公式推导的正确性。接着对比不同速度下的 时间相关性可以发现，移动端的运动速度越大，导致时间相关性下降的越快，震 荡地越剧烈。最后，观察目标信道和合成信道的时间相关性，可以尽管发现这两 条曲线的数值不是相等的，但是后者的曲线一直在前者附近进行震荡，保证了两 者的时间相关性一直处于接近的水平。

a) 3 km/h	b) 30km/h
图4・4传统PFS的时间相关性仿真结果
经过上文的分析和仿真验证，可以发现在实际的基于PFS方法的OTA测试 中，由于信道初始参数是随机生成的，导致合成的信道不能精确地复现目标信道 的空间和时间相关性。根据式4-23和式4-24的结果显示，合成信道的空间相关 性的误差主要取决于探头中各个子径的初始相位。由于初始相位是在测试开始前 随机生成的，具有很大的不确定性，甚至会造成测试区域内部的空间相关性与目 标信道相差过大，导致测试失败。因此，需要对原有PFS合成信道做出改进， 保证PFS方法能够准确复现目标信道的相关性。
4.3基于预衰落合成法的改进信道建模方法
50

4.3.1改进的信道建模方法
观察式4-23和式4-24可以发现，目标信道和传统的PFS合成信道在空间相 关性上的区别是由于第二个子式引起的，该子式包含了 K(K-1)个交叉项，其中， 可以接着将公式22改写为：
= (exp(j0J,exp(jOt.))	(4-28)
其中，色是第丘个探头内部所有的子径的初始相位向量，可以表示为 纵叽叶1,2”。
显而易见，如果能够使得〈exp(兀”),exp(7典,))=0对于所有的丰炉都成立的 话，那么式4-24中的第二个子式就会变成0,从而使得改进后的实际的基于预衰 落合成法信道的空间相关性与式4-23所示的目标信道的空间相关性相等，这样 对于信道模型的改进就转换为对于各个探头的子径的初始相位的改进。
基于上述推导，本章采用了离散傅里叶变换(Discrete Fourier Transform, DFT)矩阵来达到该目标，DFT矩阵是一种广泛使用的实现快速傅里叶算法的矩 阵，一个MxM大小的DFT矩阵可以表示为式4-29,其中WM = exp(/2^/Af)= DFT矩阵具有以下两个特性：
•矩阵的每个元素都是一个复数，且是单位向量。
•矩阵中的每一列都是相互正交的。

护…护(M 一 1),(必一1)
因此DFT矩阵的所有列向量可以构成M个维度为M的正交基，对于任意的 沖八都有(w.,w.) = 0成立，其中w,和屯分别是离散傅里叶矩阵中第i个和第j 个列向量。
基于上述DFT矩阵的优点，本章提出了一种改进的信道建模方法来提升传 统PFS方法的性能。该方通过给每个OTA探头分配一个DFT矩阵中的列向量, 并将列向量中的所有元素当作该探头中各个子径的初始相位。由于傅里叶矩阵的 各个元素的模都是1,因此使用DFT矩阵的元素并没有改变各个子径的功率。 其次，利用了 DFT矩阵的正交性质，使得各个探头所携带的信道时间序列相互 正交。然而，由于使用确定的DFT矩阵作为子径的初始相位，使得信道的初始 相位失去了随机性，造成时间相关性会产生畸变。为了增加相位的随机性，本章 将DFT矩阵中的前K个列向量点乘上一个随机生成的相位旋转因子 51
expUak),k = l,...,K ,其中匕为均匀分布在［0,2兀］之间的随机变量。因此最后 运用在第丘个探头上的向量为WR=w”expC/aJ。值得注意的是，在列向量上点 乘相位旋转因子，并没有改变向量之间的正交性，即对于任意的k'^k,都有式 4-30成立。
X(k,k、= (exp(jOt), exp(j0t,))=/ w;., w7 \ = 0	(4-30)
因此，基于上述方法，可以使得公式4-24中的第二个子式结果为0,消除原 有的PFS合成信道中的空间相关性误差，提高PFS方法复现目标信道的准确性。 综上所述，本章提出的改进方法可以总结为算法4-1。DFT矩阵中列向量到各个 探头的初始相位之间的映射关系如图4-5所示。
算法4-1： PFS改进算法
输入：探头数量K,子径数量M
生成M阶DFT矩阵W
提取K个列向量，分别为W］,..., WK
遍历K个列向量，将每个列向量点乘上相位旋转因子 输出：K个探头内部所有子径的初始相位集合{&“}


4.3.2多簇场景下扩展
上一个小节对本章提出的改进方法做了详细的阐述，但是仅仅考虑到了信道 中只有单个簇的场景。在真实的无线传输环境中，散射体一般随机分布在接收端 的周围，所以信道中通常包含多个簇。相应的，在常见的标准信道中也都是包含 多个簇的，例如WINNER信道有6个簇，而3GPP定义的CDL信道则含有高达
52
20个以上的簇。实际的MIMO OTA测试工作基本上都是基于各个通信标准定义 的信道来实行，因此基于实际的OTA测试考虑，有必要进行多簇信道环境下的 扩展和讨论。
观察WINNER、3GPP等标准信道，可以发现信道的大部分簇的角度信息都 是不同的。然而由于“中簇”的概念的提出，一个时延扩展较大的簇在信道模型 中会分成多个时延不同、角度相同的中簇。因此在进行多簇场景的讨论时，需要 对信道内部是否含有相同角度信息的簇分别进行分析。为了简便起见，假设信道 内部只含有两个簇，用1和2来表示簇的序号。在此小节中，只考虑空间相关性 的推导。
首先讨论这两个簇含有不同的角度信息的场景，忽略簇之间的时延，那么信 道传输函数可以表示为：
K	K
hg 工 i,k Y yJW2,k
*=1	A-l
其中，为了简便起见，本小节令：
rr M
接着令S]=S2，r = 0,可以求得到合成信道的空间相关性为：
口（"1，“2）
J	K	K	~
（7^"工 Jw* 川 +	工 J叫R 41] ,2虫）
=£	E	M
!	K	K
•（昭工（叫 2 ,以 + X』W2,k 2,2* ）
-	*=1	*=1	-
由于两个簇含有不同的角度信息，即含有多普勒分量不同，那么对于任意的 \<m<M来说，都有九/02“成立。因此，可以利用式4-8的结论，得到第1 个簇和第2个簇之间的交叉项的值为0,即如式4-34所示。
'K   K   '
_k=\	k=\	_
討£耐:"龙尺s]	（4'34）
_ k=\	*=1	_
=0
那么式4-33就变成个两个空间相关性的线性相加，利用4.3.1节中的结论, 通过采用DFT矩阵的列向量作为各个探头中子径的初始相位，式4-33可以化简 为式4-35o因此，对于信道中含有两个或者多个角度信息不同的簇的场景，只需
53
针对每个簇重复利用4.3.1节中的算法即可。
口（"1，”2）
K	K
奋工叫&檢准（$*）"+马工叫G偲乓
«=1	Zr=l
接下来讨论信道内含有两个相同角度信息的簇的场景，此时对于任意的 \<m<M来说，都有05=0”成立。因此，第1个簇和第2个簇之间的交叉项 可以表示为：

类似地，利用4.3.1节中的结论，只需保证第1个簇和第2个簇中各个探头 的初始相位矢量正交即可。因此，针对簇的角度信息相同的情况，需要对DFT 矩阵进行复用，即每个簇使用DFT矩阵的部分列向量集合，且需要保证这两个 集合无交集。具体操作如图4-6所示。
簇2


图4-6多簇场景下DFT映射示意图
综上所述，可以直观地将上述结果推广至信道中含有多个簇的场景。针对具 有不同来波角度的簇，可以重复利用DFT矩阵内的相同列向量进行4.3.1小节中 算法的操作，而针对来波角度相同的簇，需要将DFT矩阵划分为多个不重复的 子集，每个子集分配给不同的簇。
54

4.4仿真结果与分析
本小节将通过仿真实验，来验证本章所提出方法的有效性。整个仿真实验分 为两部分，分别是单簇场景和多簇场景。在单簇场景中，仿真将会随机生成任意 形状的簇，然后分别求出目标信道、改进PFS合成信道的空间相关性，并对比 空间相关性曲线的差别，验证方法在单簇场景下的效果。接着分别求三种信道下 的时间相关性，查看本章所提出的方法对时间相关性的影响。最后，对不同探头 所携带信号的相关性进行求解，验证所提出方法的有效性。在多簇场景下，本小 节以3GPP中的CDL模型为例，探究在该方法针对于标准信道模型的适用性。
表4-1仿真参数设置
参数名称
参数值
频率

测试区域半径
1个波长
探头数量

探头分布方式
均匀分布
暗室设置
2D
首先在单簇场景下进行仿真实验，生成一个任意形状的簇，在2D MIMO OTA的配置下，用16个探头对其进行拟合，得到相应的探头权重，然后分别构 造目标信道、改进的PFS合成信道，具体的设置参数如表4-1所示。此外，为了 便于对比，采用式4-24进行PFS方法的理论空间相关性的计算。注意，为了探 究算法中随机相位旋转因子对结果的影响，实验对是否添加相位旋转因子的两个 情况分别进行了仿真。

a) SCF	b) TCF
图4-7单簇场景下仿真结果
求得的空间相关性如图4-7的左图所示，对比图4-3可以发现，采用了改进 的PFS合成信道的空间相关性和理论空间相关性完全一致，并且与目标信道的 空间相关性相似，这说明本章利用提出的方法生成的PFS合成信道，能够改正
55

传统PFS信道在复现空间相关性方面的缺点。图中PFS信道与目标信道的空间 相关性之差随着天线间距逐渐增大，这是由于PFS方法在拟合空间相关性过程 中的误差造成的。此外可以发现，是否添加相位旋转因子对空间相关性曲线无任 何影响。
表4-2 CDL信道参数总结

CDL-A
CDL-B
CDL-C
簇个数
23
24
24
中径个数
2
2
2
扩展角
11
22
15
直射/非直射
非直射
非直射
非直射
接着继续探究本章提出的方法对时间相关性的影响。同样地，本次仿真设置 了 3km/h和30km/h两种场景，得到的结果如图4-7的右图所示。可以发现，速 度越快，时间相关性就下降的越快。此外，可以发现使用了相位旋转因子之后， PFS合成信道时间相关性与目标信道保持相似，两者之间的误差较小。如果不使 用相位旋转因子，那么时间相关性会出现畸变。这是因为相位旋转因子的随机性 可以有效减缓由于探头以特定相位叠加造成内部子径的功率发生变化的现象。

为了验证OTA测试中各个探头所携带的信道之间的相关性对测试区域内部 的拟合空间相关性的影响，本节对使用算法前后的探头信号相关性进行求解。如 图4-8所示，在传统的PFS方法中，探头内部子径的初始相位是随机生成的，导 致各个探头信号之间存在较大的相关性，从而在测试区域内部的空间相关性的合 成上引起了较大的误差。采用本章提出的改进方法之后，大幅度减小了不同探头 信号之间的相关性，保证了测试区域内部空间相关性的准确合成。
最后，继续探究本章提出的改进方法在多簇信道下的适用性。为了更加贴近 真实的OTA测试，本节选取了 3GPP标准中定义的CDL-A、CDL-B以及CDL-C
56

信道进行仿真实验，其信道参数如表4-2所示。图4-9、图4-10以及图4-11分别 表示了三种信道下的TCF和SCF仿真结果，结果表明本章提出的改进方法能够 使得合成空间相关性与PFS期望的空间相关性相吻合。然而，CDL-A和CDL-B 信道的合成空间相关性与目标空间相关性存在差别，这是因为探头数量不够造成 的，增加探头数量可以使得二者更加贴合。因此，本章提出的方法可以较好地适 用于多簇信道，符合实际OTA测试要求。

a) SCF	b) TCF
图4-9 CDL-A信道仿真结果

a) SCF	b) TCF
图4-10 CDL-B信道仿真结果

图4-11 CDL-C信道仿真结果
57
4.5本章小结
本章在信道空时相关性重构方面，对PFS方法做了深入研究。首先基于实 际的MIMO OTA测试中信道参数固定不变的情况，提出了一种基于时间平均对 信道的空时相关性进行评估的方法。针对目标信道和PFS合成信道的空时联合 相关性，本章给出了详细的公式推导。接着，本章提出了一种基于DFT矩阵的 信道改进方法，用于消除各个探头所携带的信道传递函数之间的相关性，从而消 除传统PFS方法中空间相关性复现的误差。最后，通过仿真对本章提出的方法 进行验证，验证结果表明，该方法能够提升预衰落合成法的信道重构精度。
58
第五章总结和展望
5.1研究工作总结
大规模天线技术由于能够大幅提升链路速率和频谱效率，已经成为5G通信 的标志性技术之一。随着5G大规模商业化的开展，我国也已经在各大主要城市 部署5G基站设备。在未来的几年内，国内和全球市场针对大规模天线设备的生 产和部署需求会大幅提高。而性能测试作为大规模天线设备从研发走向量产的重 要阶段，其关键技术已经成为工业界和学术界的研究重点。尽管MIMOOTA测 试技术经过多年的发展，己经逐渐发展为三种不同的方法，然而大规模天线设备 的特性决定了暗室多探头法是最有潜力进行5G大规模天线测试的方法。其中预 衰落合成法由于无需相位校准和所需探头数量较少的优点，成为暗室多探头法中 最常见的信道重构方法，具有重大的研究价值。因此本文主要针对预衰落合成法 的信道重构技术和原理进行研究，主要的研究工作如下：
1）	本文针对MIMOOTA测试做了概述，针对混响室法、暗室多探头法和两 步法这三种MIMOOTA测试方案，分别对其测试系统和原理进行了介绍。并对 这三种测试方法的优缺点进行了对比，总结了在5G大规模天线设备测试中的挑 战和适用性。接着，介绍了用于MIMO OTA测试的信道模型——基于几何关系 的随机信道模型，详细介绍了该信道模型的公式以及各个参数的含义。最后，针 对暗室多探头法中的两种信道重构技术，即平面波合成法和预衰落合成法，做了 详细的介绍和分析，分析表明预衰落合成法较为适用于大规模天线设备的测试。
2）	针对大规模天线设备测试系统中备选探头数量大幅度增加，导致主流的 凸优化探头选择算法计算复杂度过高的问题，本文提出了一种基于梯度下降的探 头选择算法。首先，本文对大规模天线OTA测试系统做了介绍和分析，对系统 中各个部件的作用进行详细介绍。接着，针对5GMassiveMIMO OTA配置，介 绍了复现目标空间相关性的优化目标。基于上述的优化问题，本文提出了一种新 的探头选择算法。算法采用梯度下降的思想对探头权重进行优化，为了达到探头 选择的目的，在原有目标函数加上正则化函数，进行探头权重的稀疏化。此外， 算法还采用了动态参数调节策略，用以在迭代过程中实时控制探头稀疏化的程度。 最后，本文将该算法与主流的multi-shot算法进行对比，从计算复杂度、精确度 以及鲁棒性上验证了该算法的优越性。
3）	针对实际OTA测试中信道参数固定不变的特性，本文提出了一种基于时 间平均进行空时联合相关性求解的方法。首先，本文针对目标信道和PFS合成
59
信道的空时联合相关性进行了详细的公式推导。并将公式推导结果与以往文献中 基于统计平均的推导结果进行对比，验证了本文分析方法的正确性。接着，本文 针对传统PFS方法中合成空间相关性存在误差的问题，提出了一种基于DFT矩 阵的改进方法，并通过公式验证了该方法在单簇和多簇信道下的适用性。该方法 通过利用DFT矩阵中各个列向量的正交性，能够消除各个探头所携带的信道时 间响应的相关性，从而消除空间相关性的复现误差。最后，通过仿真实验对本文 所描述的方法进行验证，仿真结果显示，该方法可以提升PFS方法的信道重构 性能，解决传统PFS方法中信道重构存在误差的问题。
5.2工作展望
本文针对预衰落合成法的信道重构技术进行了一些研究，主要在探头选择算 法和信道高阶特性重构方法上取得了一些进展。尽管已经有了一些相关的研究成 果，但是仍然存在一些需要解决的问题。根据本文已有的研究成果和后续技术发 展，后续的研究工作还可以从以下几个方面进行：
1）	本文提出的探头选择算法虽然采用了动态参数调整的策略进行了部分参 数的调节，但是对于在迭代过程中较为重要的参数如遗忘因子以及学习速率等， 仍然是固定不变的形式。因此，接下来的工作可以针对这些参数的自调节策略进 行设计，使得算法在性能上达到更好的效果。
2）	本文提出的基于DFT矩阵的改进方法，在实际实施过程中受到矩阵规模 的限制，即探头的数量必须要比子径的数量小。该条件在单簇条件下很容易满足， 然而在多簇信道中，由于存在相同角度信息的簇，因此DFT矩阵中列向量的数 量可能不足。因此，如何突破探头数量和DFT矩阵规模的限制是一个需要解决 的问题。
60
文献
[1] Li 乂 Xin L, Liu X, et al. Dual anechoic chamber setup for over-the-air radiated testing of 5G devices[J]. IEEE Transactions on Antennas and Propagation, 2019, 68(3): 2469-2474.
[2] Larsson E G, Tufvesson F, Edfors O, et al. Massive MIMO for next generation wireless systems[J]. IEEE Communications Magazine, 2013, 52(2): 186・195.
[3] Kyoesti P, Jaemsae T, Nuutinen J P. Channel modelling for multiprobe over-the-air MIMO testing[J]. International Journal of Antennas and Propagation, 2012, 2012(PT.3): 22.1-22.11.
[4] Chen X・ Throughput modeling and measurement in an isotropic-scattering reverberation chamber[J]. IEEE Transactions on Antennas and Propagation, 2014, 62(4):2130-2139.
[5] Yu W, Qi Y, Liu K, et al. Radiated two-stage method for LTE MIMO user equipment performance evaluation[J]. IEEE Transactions on Electromagnetic Compatibility, 2014, 56(6): 1691-1696.
[6] Wang R, Wu X, Yang Y et al. 5G OTA testing: challenges and standardization progress[A]. // Proc of 2018 IEEE Asia-Pacific Conference on Antennas and Propagation (APCAP)[C], Auckland: IEEE Press, 201 & 469-470.
[7] Alhorr F, Wiles M, Ferminanrodriguez S, et al. On the comparison between anechoic and reverberation chambers for wireless OTA testing[A]. // Proc of 2013 7th European Conference on Antennas and Propagation (EuCAP)[C]? Gothenburg: IEEE Press, 2013: 1852-1856.
[8] Primiani V M, Barazzetta M, Bastianelli L, et al. Reverberation chambers for testing wireless devices and systems [J]. IEEE Electromagnetic Compatibility Magazine, 2020, 9(2): 45-55.
[9] Patane L, Christian S, Skarbratt, Anton, Orlenius C. Extending the reverberation chamber using a channel emulator for characterisation of over-the-air performance of multiple-input-multiple-output wireless devices [J]. IET Science Measurement and Technology, 2015, 9(5): 555-562.
[10] Valenzuela-Valdes J F, Martinez-Gonzalez A M, Sanchez-Hemandez D A. emulation of MIMO nonisotropic fading environments with reverberation chambers [J]. IEEE Antennas and Wireless Propagation Letters, 2008, 7: 325-328.
61
[11] Micheli D? Barazzetta M, Diamanti R, et al. Over-the-air tests of high-speed moving LTE users in a reverberation chamber[J]. IEEE Transactions on Vehicular Technology, 2018, 67(5): 4340-4349.
[12] Fall A K, Besnier P? Lemoine C, et al. Design and experimental validation of a mode-stirred reverberation chamber at millimeterwavesfJ]. IEEE Transactions on Electromagnetic Compatibility, 2015, 57(1): 12-21.
[13] Lotback Patane C S. Extending the frequency range of reverberation chamber to millimeter waves for 5G over-the-air testing[A]. // Proc of 2017 11th European Conference on Antennas and Propagation (EuCAP)[C], Paris: IEEE Press, 2017: 3012-3016・
[14] 3GPP TR 37.977 VI.0.0, Evolved universal terrestrial radio access; verification of radiated multi-antenna reception performance of user equipment [R]. Sophia Antipolis: 3GPR 2017.
[15] Shen P, Qi Yu W, Li F. Inverse matrix autosearch technique for the RTS MIMO OTA test [J]. IEEE Transactions on Electromagnetic Compatibility, doi: 10.1109/TEMC.2020.3029909.
[16] Fan W, Zhang F, Kysti P, et al. Wireless cable method for high-order MIMO terminals based on particle swarm optimization algorithm [J], IEEE Transactions on Antennas and Propagation, 2018, 66(10): 5536-5545.
[17] Chen Q, Chen X・ WLAN MIMO Device performance evaluation using improved RTS measurement [J]. IEEE Transactions on Instrumentation and Measurement, 2021, 70: 1 ■&
[18] Gao H, Wang W, Fan W, et aL Over-the・Air testing for carrier aggregation enabled MIMO terminals using radiated two-stage method[J]. IEEE Access, 2018, 6:71622-71631 ・
[19] Fan W, Lisbona C B D, et aL Emulating spatial characteristics of MIMO channels for OTA testing[J]. IEEE Transactions on Antennas and Propagation, 2013, 61(8): 4306-4314.
[20] Li y Xin L，Zhang X. On probe weighting for massive MIMO OTA testing based on angular spectrum similarity [J]・ IEEE Antennas and Wireless Propagation Letters, 2019,18(7): 1497-1501.
[21] Wei F, Pekka K, Moray R, et aL Over・the-air radiated testing of millimeter-wave beam-steerable devices in a cost-effective measurement setup[J]. IEEE
62
Communications Magazine, 2018, 56(7): 64-71.
[22] Pekka K, Wei F, Pedersen G F, et al. On dimensions of OTA setups for massive MIMO base stations radiated testing[J]. IEEE Access, 2017,4: 5971-5981.
[23] Li Y, Sun H，Chen X, et al. Probe selection and power weighting in multiprobe OTA testing: A neural network-based approach[J]. International Journal of Antennas and Propagation, 2019, 2019: 1-&
[24] Xin L, Li Y, Sun H, et al. OTA testing for massive MIMO devices using cascaded APM networks and channel emulators [J]. International Journal of Antennas and Propagation, 2019, 2019(10): 1-14.
[25] Llorente I C, Fan W9 Pedersen G F. MIMO OTA testing in small multi-probe anechoic chamber setups[J]. IEEE Antennas and Wireless Propagation Letters, 2016, 15: 1167-1170.
[26] Reed D. On channel model tap reduction for 5G NR mmW testing[A]. // 2018 IEEE Asia-Pacific Conference on Antennas and Propagation (APCAP)[C], Auckland, 201 & 464-468.
[27] 3GPP TR 38.901 V15.1.0, Study on channel model for frequencies from 0.5 to 100 GHz[R]. Sophia Antipolis: 3GPP, 2017.
[28] 黄杰・5G无线通信中的多频段毫米波信道测量与建模[D].山东大学,201&
[29] Yee K S・ Numerical solution of initial boundary value problems involving maxwelfs equations in isotropic media[J]. IEEE Transactions on Antennas and Propagation, 19665 14(5): 302-307.
[30] Laurenson D, Mclaughlin S, Sheikh A* A ray tracing approach to channel modelling for the indoor environment [A]. // Proc of IEEE 43rd Vehicular Technology Conference (VTC)[C], Secaucus: IEEE Press, 1993: 246-249.
[31] Athanasiadou G E, Nix A R, Mcgeehan J P. A ray tracing algorithm for microcellular and indoor propagation modelling[A]. // Proc of 1995 Ninth International Conference on Antennas and Propagation[C], Eindhoven: IEEE Press, 1995:231-235・
卩2] Ling H, Chou R, Lee S・ Shooting and bouncing rays: calculating the RCS of an arbitrarily shaped cavity卩].IEEE Transactions on Antennas and Propagation, 1989,37(2): 194-205 ・
[33] 3GPP TR 25.996 VI 2.0.0, Spatial channel model for multiple input multiple output simulations[R]・ Sophia Antipolis: 3GPP, 2014.
[34] Dottling M，Mohr W, Osseiran A. WINNER II channel models [J]・ Radio
63
Technologies and Concepts for IMT-Advanced, Wiley, 2010, 39-92.
[35] 乔尚兵.基于暗室多探头的Massive MIM0空口测试方法研究[D].北京邮 电大学,2019.
[36] Fan W, Nielsen J O, Franek 0, et al. Antenna pattern impact on MIMO OTA testing[J]. IEEE Transactions on Antennas and Propagation, 2013, 61(11): 5714-5723.
[37] Fan W, Sun F, Nielsen J O9 et al. Probe selection in multiprobe OTA setups [J]・ IEEE Transactions on Antennas and Propagation, 2014, 62(4): 2109-2120.
[38] Pekka K, Lassi H, Wei F, et al. On radiated performance evaluation of massive MIMO devices in multi-probe anechoic chamber OTA setups [J]. IEEE Transactions on Antennas and Propagation, 2018, 66(10): 5485-5497.
[39] Zhang H，Wu W. Boundedness and convergence of online gradient method with penalty for feedforward neural networks [J]・ Neural Processing Letters, 2009, 29(3): 205-212.
[40] Gnecco G, Sanguineti M. Regularization techniques and suboptimal solutions to optimization problems in learning from data[J]. Neural Computation, 2010, 22(3): 793-829.
[41] Zongben, Xu, Xiangyu, et aL L1/2 regularization: a thresholding representation theory and a fast solver[J], IEEE Transactions on Neural Networks and Learning Systems, 2012, 23(7): 1013-1027.
[42] Miguel S L, Lieven V et aL Applications of second-order cone programming[J]. Linear Algebra and its Applications, 1998, 284(1-3): 193-22&
[43] Tomic S, Beko M, Dinis R. RSS-based localization in wireless sensor networks using convex relaxation: noncooperative and cooperative schemes [J]. IEEE Transactions on Vehicular Technology, 2015, 64(5): 2037-2050.
[44] Ji Y, Fan W, Pedersen G F, et al. On channel emulation methods in multiprobe anechoic chamber setups for over-the-air testing[J]. IEEE Transactions on Vehicular Technology, 2018, 67(8): 6740-6751.
64
