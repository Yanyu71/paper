

第一章绪论
1.1移动通信LTE系统概述
UMTS（universal mobile telecom system,通用移动通信系统）作为第三代移动通信的 技术标准，由3GPP （第三代合作伙伴计划）制定，也被认为是GSM系统的3G技术延 续⑴。LTE是由3GPP组织制定，是UMTS的长期演进，也被称为准4G技术。LTE技 术推动了移动通信系统向前发展，也推动了人类社会的科技发展。互联网技术和移动通 信技术现如今使人们生活发生前所未有的改变，人们享受着互联网和移动通信带来的快 速与便利。通佶系统的发展是这种便利的根本。
LTE延续了 3GPP中的GSM和UMTS技术优势，并完成了 3GPP中的业务扩展， 从简单的语音业务转变到建立多业务空中接口。LTE基于OFDM技术的全球通用的标 准，支持TDD模式和FDD模式两种模式，TD-LTE是LTE的TDD模式。在2005年6 月，LTE系统需求得到了完善和细化，具体需求为包括减少连接建立和传输的延时、提 高用户数据传输速率、提高小区边界的比特率以保证业务的一致性、提高频谱效率、频 谱利用灵活、简化网络结构、实现无缝的移动性、终端的功耗合理等。
3GPP LTE的具体技术特征如下〔ID］：
1）	LTE适用于不同的带宽，灵活支持1.4MHz、3MHz、5MHz、10MHz和20MHz 的带宽。
2）	卜行使川OFDMA技术，速率可达100Mbit/s；上行使用SC-FDMA技术，速率 可达 50Mbit/s<,
3）	下行频谱效率为5bit/s/Hz,接近于R6 HSDPA的3到4倍；上行频谱效率 2.5bit/s/Hz,是 R6 HSUPA 的 2 到 3 倍。
4）	充分利用信道对称性等TDD特点，在简化系统设计的同时提高系统性能；
5）	以分组域业务为主要目标。
6）	每个小IX可以支持多个用户，仅5M带宽下就能够支持多达200个用丿"，并提 高小区边缘的用户吞吐量。
7）	进行时间/空冋/频率二维的快速无线资源调度，保证了系统吞吐量和服务质量。
在2014年，TD-LTE展现出爆发式的增长，尤其在中国，中国移动已经建成了全球 最大的4G网络，而如此快速的发展，得益于技术和产业的全面成熟。无论是系统网络 解决方案，还是用户终端，TD-LTE都展现了惊人的发展速度。在中国，TD-LTE实现 了绝大部分城市的连续覆盖，包括室外、室内和高铁环境等多种复杂场景的解决方案， 这也将推进LTE-Advanced的商用进程。
LTE不仅仅是接入技术，同时完成了向多业务的扩展，在网络架构上也进行了演进 （SAE）o LTE网络结构呈现“扁平化”、“分散化”的发展趋势，目的是为简化网络
和减小延时，实现低复杂度、低时延和低成本团，LTE在eNodeB中整合了原来在上层 中负责ARQ、无线资源控制以及小区无线资源管理等功能，形成LTE “扁平化”的 E-UTRAN 结构。


图1-1 E-UTRAN网络架构〔5]
较HSPA-evolution相比，LTE将RNC与NodeB合并为eNodeB来实现，使LTE的 网络架构扁平化。E-UTRAN是LTE的移动通信系统网络的接入网，仅由eNodeB网络 组成，EPC和E-UTRAN 一起根据业务请求建立和释放承载。
LTE和SAE共同构成了演进分组系统（EPS）,用户通过EPS承载利用IP连接通过 公共数据网PDN连接到互联网，以及V6IP等服务。一个用户设备可以建立多个EPS 承载，分别负责语音通信，网页浏览等业务【1】。
| -S6a	 HSS

图1-2 EPC网元拓扑结构
EPC是LTE网络架构演进中的核心网，负责对用户终端进行全面控制和有关承载 的建立。上图给出了 EPC网元拓扑结构。在EPC中主要有PDN网关（PGW）,业务网 关（SGW）,移动性管理实体（MME）三部分。除了以上主要逻辑节点，EPC还包括如 用户归属服务器，策略控制和计费规则功能等逻辑节点。LTE是全IP网络，UE的IP 数据包封装在EPC特定的协议中，在PGW和eNodeB之间通过隧道协议发送到用户终 端【6】。
1.2 TD-LTE检测接收算法研究现状
本文研究PUCCH的与SRS的检测接收算法。目前针对PUCCH的检测接收算法主 要有利用导频信号进行信道估计，然后通过估计的信道冲击响应恢复发送控制信息的检 测方法，全盲检测和半盲检测方法，以及利用假设检验理论提出的广义似然比检验 (GLRT)算法。针对利用辅助导频进行信道估计的检测接收算法，信道估计算法目前主要 研究算法包括LS信道估计、基于DFT的信道估计、MMSE信道估计、LMMSE估计, 利用插值进行信道估计以及通过扩展虚子载波的信道估计(VCFR)算法。需要指出的是由 于PUCCH占用带宽小，基于DFT的信道估计等算法并不适用。SRS本身就是参考信号， 其检测接收目标是在eNodeB端获得信道的状态信息，包括信道冲击响应和噪声干扰， 以及定时估计等信息。上述介绍的信道估计算法同样适用于SRS的检测接收。
文献［7］针对OFDM系统提出半盲信道估计和检测算法，文献［8］对文献［9］提出的基 于PUCCH控制信息的半存检测进行了进一步的推优演算，通过减少信道估计计算中冗 余降低半盲检测的运算复杂度。在文献［10］［11］中，作者提岀针对PUCCH上ACK/NACK 的基于广义似然比检验的检测接收算法，利用接收信号的似然函数最大化，以及信道和 千扰及噪声的最大似然估计进行似然函数的参数估计，这种算法能够对PUCCH占据带 宽边缘的特性有很好的适应性，但同半盲检测算法一样，随UCI长度运算复杂度成指数 增长。
对于SRS的检测接收算法研究，本文主要研究基于SRS的信噪比估计，SRS是一 种梳状导频，因此OFDM系统的信道估计算法同样适用于SRS。Boumard算法卩句是常 见的噪声方差估计算法，该算法假设在慢衰落信道下相邻子载波的信道冲击响应是不变 的，因此相邻于载波的接收信号差异来源于噪声。文献［12］提出针对OFDM系统利用辅 助导频进行基于DFT的信道估计算法。目前存在很多基于DFT的信道估计算法的去噪 策略。文献［13］在DFT信道估计算法基础上提出了噪声方差估计的方法。但是DFT算 法的边缘效应依旧不容忽视。为解决DFT算法的边缘效应，基于VCFR的信道估计算 法被提出，文献［15］对VFCR算法进行了优化，通过线性虚子载波和平滑窗函数以及时 域差异性去噪等处理进行信道估计。
本文涉及DSP实现，讨论工程实践的可行性要同时考虑较高的检测接收性能和算 法的复杂度。因此工程实践需要平衡检测性能和复杂度，以满足通信系统的实时性。
1.3论文研究工作及内容安排
本文以TD-LTE系统物理上行信道和探测参考信号的检测接收作为重点研究方向， 主要研究PUCCH上承载信息的检测和利用SRS进行信道和信噪比估计。最后在TI的 TMS320C6670多核DSP上设计实现这两个信道。
本文以PUCCH和SRS的检测接收作为出发点，从介绍TD-LTE系统的物理层为开 端，对TD-LTE的帧结构，物理资源映射等知识进行了详细介绍，以此引出TD-LTE的 物理上行信道和探测参考信号的物理资源映射。然后依次对PUCCH和SRS的承载信息 和作用进行了详尽介绍，并分析了 PUCCH和SRS正确高效检测接收的重要性。随后依 次对PUCCH和SRS的检测接收算法进行了研究。目前PUCCH检测接收算法主要有基 于快速哈达玛变换的Reed-Muller (RM)译码检测接收算法，半盲检测接收算法和广义 似然比检测。这三种算法中基于快速哈达玛变换的RM译码算法直观有效，并且实现广 泛。半盲检测算法和广义似然比检测算法都是同时利用了数据符号的信息进行信号检测 的算法。这两种算法由于要遍历所有候选发送信号序列，因此复杂度明显增大，但是由 于其较好的检测性能，使我们试图在降低运算复杂度上进行探索。最后在TMS320C6670 DSP平台上对PUCCH和SRS进行了设计实现，通过多组测试用例验证平台的正确性。
本文重点研究TD-LTE系统物理上行控制信道和探测参考信号的检测接收技术研究 与实现。实现平台是TMS320C6670多核数字信号处理器。
本论文内容章节安排如下：
第一章——绪论，对TD-LTE系统的背景做了简要介绍，针对PUCCH和SRS检测 接收研究发展现状做了总结，并安排论文结构；
第二章——TD-LTE系统物理层、物理上行控制信道和探测参考信号，主要介绍了 TD-LTE系统物理层帧结构、物理资源。并详细介绍了 PUCCH的结构组成及发送过程， 以及SRS构成方法和物理资源映射。
第三章——TD-LTE系统PUCCH检测接收算法的研究，介绍了传统利用基于快速哈 达玛变换的Reed-Muller译码进行检测接收、同时利用数据符号和导频符号进行信道估 计的半盲检测算法，以及基于广义似然比检验的检测接收算法。并在广义似然比检验的 算法基础上进行了算法优化，提高了检测性能，并使其更适用于工程实践。最后在 PUCCH的格式lb和格式2上进行了算法的仿真验证。
第四章——TD-LTE系统SRS的检测接收与信噪比估计算法的研究。介绍了 SRS的 主流信道估计与信噪比估计算法。同时在VCFR信道估计的基础上总结信噪比估计公式。
第五章——TD-LTE系统PUCCH与SRS检测接收的实现，在TMS320C6670多核 数字信号处理器平台上对PUCCH和SRS进行了实现，给出了模块实现细节及耗时；
第六章——总结与展望，对本论文的研究内容和完成的工作新型总结，并提出文章 的理论研究和实现能够更加完善的地方。
第二章TD-LTE物理上行控制信道及探测参考信号
2.1 TD-LTE
2.1.1帧结构
LTE在上下行物理信道支持两种帧结构。FDD模式釆用帧结构类型1,帧结构类型 2是根据TD-SCDMA的子帧结构演变而来，适用于TDD模式。帧结构类型2的一个无 线帧是由两个长度为153600.7； =5ms的半帧组成，因此一个无线帧的长度为 7} =307200-7；= 10ms,半帧由五个长度为1ms的子帧构成。子帧又分为常规子帧和特 殊子帧。常规子帧有下行子帧和上行子帧两种格式，特殊子帧又包括DwPTS, GP,和 UpPTS三部分，常规子帧和特殊子帧的持续时间都是1ms. TD-LTE的帧结构如图2-1 所示。每个子帧/对应于2个时隙2，和2/ + 1,每个时隙长为7^ =0.5 ms。
无线帧,Tr = 3072007, = 10 ms
I
I 半倾，lS36()0r. = 5 ms

1
时隙、
7^=153607,	.	3〃72如
~1	1 -
子帧枷
1	1	　　　　子辆	子小	子怕
了帧.307207；	1 B	\
DwPTS GP UpPTS

图2-1 TD-LTE帧结构 表2-1特殊子帧配置mi
特殊子帧配置	常规循环前缀，下行	常规循环前缀，下行
DwPTS	UpPTS	DwPTS	UpPTS
常规循环前 缀，上行	扩展循环前 缀，上行		常规循环前 缀，上行	扩展循环前 缀，上行
0	6592-7；	2192*4	2560 7；	7680-7；	2192 主	2560-7；
1	　　19760-7；			20480-7；
2	　　21952-7；			23040?孔
3	　　24144-7；			25600 ? 7；
4	　　26336-7；			7680 主	4384?义	5120-7；
5	6592-7；	4384-7；	5120-7；	20480?4
6	　　19760-7；			23040-7；
7	　　21952-7；			-	-	-
8	　　24144-7；			-	-	-

特殊子帧的DwPTS、GP和UpPTS的长度见表2-1, DwPTS用于下行传输，特殊子帧UpPTS用于上行传输，当SRS配置在特殊子帧上传输，即会在UpPTS上发送用户 的SRS信息。GP不传输任何信号，只是上下行切换的保护间隔。TDD模式支持多种上 下行配置，具体可支持的配置见表2-2。表2-2中，符号D表示用于下行传输的子帧， 符号U表示上行传输的子帧，符号S表示特殊子帧,DwPTS和UpPTS的长度见表2-1 o 如果在UpPTS配置了 SRS,用户终端会根据上层配置信息UpPTS的一个或者两个符号 上发送。
LTE TDD模式支持两种上下行切换周期，上下行配置0,1,2,6指定切换周期为5ms, 配置3,4,5指定切换周期为10ms。特殊子帧的位置与上下行的切换周期有关。如果下行 和上行切换周期为10ms,则特殊子帧位于无线帧的第一个半帧中，第二个半帧中不存 在特殊子帧；同时如果下行到上行切换周期为5ms,第二个子帧和第七个子帧中都是特 殊子帧；分别位于无线帧的前半帧和后半帧中。
由于TD-LTE不需要成对的频谱资源，因此能够使用在零散的频段上进行配置，频 谱配置相对于FDD来说相当灵活，频谱利用率也较高。从表2-2还可以看出，无线帧 的上下配比可以进行灵活的配置，支持不同的上下行业务需求。表2-2中下行上行转换 点周期为5ms也表示在-个无线帧中转换次数为2,转换周期为10ms,则在…个无线 帧中下行上行转换…次，用乂艙表示一个无线帧中上下行切换次数。


2.1.2物理资源
LTE物理资源使用资源格来描述一个时隙中的传输信号，物理资源格由物理资源块 组成，时域中连续的祝爲个SC-FDMA符号和频域中连续的TVf =12个子载波定义为 一个物理资源块(Resource block, RB)。系统根据配置的上行的物理资源块数A,皓决定 上行占用的物理资源格。因此一个上行时隙占用耕个子载波和N岩个SC-FDMA 符号。资源格的格式如图2-2所示。N矗的值由小区中配置的上行传输带宽决定，其值 满足式2-1 o
馈七费帰成	(2-1)
其中，N齢UL = 6和N端1匚=110是R9协议规范中支持的最小和最大上行链路带宽。
一个时隙中SC-FDMA符号数取决于高层配置的循环前缀(CP)长度，在常规CP

的情况下，一个时隙中SC-FDMA的符号数为7O





N 战 bSC-FDMA symbols




l = o	5骚 T
图2-2 TD-LTE物理资源格"J
资源格中的每个单元称为资源单元(RE),每个RE对应一对(k,l)序号。在物理资源 映射映射时，上行在频域产生单载波频分复用符号(SC-FDMA),将映射在一个RE上。 一个物理资源块(RB)表示为N蠢xNg个RE组成的资源块。PUCCH域位于两个时隙频 带边缘的两个RB上。
2.2物理上行控制信道PUCCH
2.2.1 PUCCH的传输信息
在LTE系统中，PUCCH上承载的上行控制信息UCI,主要包括以下五种信息。
1)上行调度请求SR。
UE通过向eNodeB发送缓冲状态报告协助eNodeB进行上行无线资源的分 配。在PUCCH上，UE通过发送一个单比特的SR触发请求来申请上行无线资 源，基站收到SR请求就会根据具体的调度算法分配相应的物理资源。同时，SR 只负责告诉网络端是否有资源需求，而需要资源的具体数量则由之后的信令交 互告诉网络端卩］。
2）	混合自动重传请求的HARQ应答（ACK/NACK）。
在单码字情况下，PUCCH发送一个比特的ACK/NACK信息，并按照协议 要求调制成一个符号。在双码字情况下，传输2个比特的ACK7NACK信息，同 样调制为一个符号。
UE在PUCCH上上报HARQ反馈信息ACK/NACK,如果UE正确接收解 调PDSCH上发送的数据，就在PUCCH上HARQ反馈信息资源处发送ACK信 息，反之，发送NACK信息，基站根据PUCCH上的HARQ反馈信息及相关协 议决定是否重传或者放弃重传数据及何时重传。如果基站需要重传数据，将会 发送与错误帧不同冗余版本的下行数据，来降低UE端的误码率。
3）	用于下行编码方案和调制方式选择的信道质量指示器CQI。
包括用于下行MIMO传输的秩指示器RI和预编码指示器PML
TD-LTE系统支持两种上报格式，即周期性和非周期上报。周期上报发生在 PUCCH上，非周期上报则通过PUSCH进行。在LTE支持的8种传输模式下， 不同的传输模式适用于不同的传输场合，如针对小区边缘复杂场景和高速环境 等。采用不同的传输模式能够提高分集增益，小区容量和抵抗干扰和提升数据 传输速率。不同的传输模式下PMI和RI格式也不同。
PUCCH上非周期CQL PMI以及RI上报的最小间隔是1个子帧，非周期 CQI上报模式由高层信令配置的参数cqi-ReportingModeAperiodic给出卩,。在 PUCCH周期上报情况下，不同的传输模式支持不同的上报模式。而CQI也分 为宽带CQI和终端选择的子带CQI,终端选择的子带CQI,描述了带宽中一个 或一系列特定区域的信道质量。
TD-LTE系统中设计了多种PUCCH格式⑹，在R9中主要划分为formatl和format2 两种格式。不同的格式规定了 PUCCH上承载的控制信息。
表2-3 PUCCH传输格式
PUCCH格式	调制方案	每子帧比特数A/bl,	上行控制信息
1	N/A	N/A	SR
la	BPSK	1	ACK/NACK+SR
lb	QPSK	2	ACK/NACK+SR
2	　　　QPSK	20	CSI(CQI/PMI/RI)
2a	QPSK+BPSK	21	CSI+ACK/NACK
2b	QPSK+QPSK	22	CSI+ACK/NACK
首先介绍PUCCH的循环移位，该循环移位并不是ZC序列的循环移位，而是用以 产生PUCCH所有格式的ZC序列的循环移位，所有的PUCCH格式在每一个符号中都 要用到该循环移位序列，其中"辭(如/)用于计算不同格式的循环移位值【I，
成版”=江。(8理b?传+&+》2'	(2-2)
其中伪随机序列W)的产生见参考文献[16]7.2节，该序列由gold序列产生，初始值 为仁硕=N* °
格式1/la/lb的控制信息
根据表2-3指示了 PUCCH不同传输格式的发送信息比特数。对PUCCH格式1,假 定t/(0) = 1, PUCCH格式la和lb,分别传输1和2个比特信息。比特块5(0),...-1) 按首先按照[16]中表5.4.4-1进行调制，山珈表示控制信息长度,对格式la/lb,Mbn =52。 生成复值符号d(0)。该符号是长度为1的调制复值符号。
然后d(0)乘以一个长度为咁翊=12的循环移位序列卷)(”):
= d(0)/%3),	〃 = 0,1,.. W賢領-1	(2-3)
其中#)(")同参考信号一样，是ZC基序列的循环移位，JV^cch=12o ZC序列的循
环移位a在符号和时隙间变化，用以实现用户在同一 RB传输PUCCH的码分复用。
复值符号块*(0),?..,*(嶙E-i)按照如下方式使用s(”,)和正交序列％。)进行加扰 和块扩频：
1版瘁3.鴻cch +股.間鮮負+加、州).%(时.市)	(2-4)
其中，
m = 0,..., 7V?cch-1;± 行 SC-FDMA 符号
? = 0,...,^CCH-l；PUCCH 占用子载波数	(2-5)
冰= 0,1;时隙号
和
[1	if r^(ns) mod 2 = 0
S(%)= [//2 othenvise	伽)
由于SRS的存在，SRS可能会在PUCCH配置的物理资源块上发送。短PUCCH就 是为支持SRS和PUCCH在相同的RB上发送。当配置SRS和ACK/NACK同时传输， 如果PUCCH和SRS又映射到相同RB,那么就在第二个时隙的最后一个符号发送SRS, 因此只有13个符号用来发送PUCCH域。如果不支持同时传输SRS和ACKVNACK,或 者SRS和PUCCH并没有在同一个RB上承载。那么将采用常规PUCCH格式。短PUCCH 只存在于格式1/la/lb中。常规PUCCH在两个时隙都有N保cch =人 对短PUCCH格式
1/la/lb,第一个时隙磚7曲=4,第二个时隙喂cch = 3 ,序列“农0）见文献［16］中表
是长度为僧"h的正交序列。〃，（冬）将在后面定义。
用于PUCCH格式1/la/lb传输的资源由资源索引"需cch确定，正交序列索引
%c（"s）和循环移位。（久,/）根据下面的式子由〃需CCH确定，"黑CCH由高层配置:

其中,
M? if 屬 cch<C'?M?/驾*
otherwise
3 normal CP 2 extended CP
式中”'（,%）在一个子帧的两个时隙计算不同:
当 ns mod 2 = 0 ,有:



当 % mod 2 = 1 ,有:



其中，/? = 3（X — 1） + d）mod（cN'/ &囂5），对常规CP有d = 2而对扩展CP有d = 0。
参数 如口-PtTCCMs硕 △驚饵CH由高层给出。
表2-4： PUCCH格式la和lb调制符号d(0)
PUCCH格式	炒…奶说-1)	d(0)
la	0	1
1	-1
lb	00	1
01	-j
10	j
11	-1

格式2/2a/2b的控制信息
格式2/2a/2b上承载的信息在表2.3中给出。格式2/2a/2b较格式1/la/lb,不仅在映 射符号上有所不同，映射在每个时隙的符号1和符号5两个SC-FDMA符号上，所传输 的控制信息也增加了指示信道传输质量的CSI比特。由CQI、PMI、RI等一个或几个构 成的CSI信息通过(20,13)的Reed Muller(RM)编码成长度为20的3(0)>...双19)比特块；
首先比特块方(0),...1(19)由UE指定的扰码序列c(z)进行加扰。按下式产生一个扰码比特 块片(0，..,片(19):
b(I)= (b(i) 4- c(z))mod2	(2-11)
其中扰码序列①)由gold码产生，初始化值为冬t =3/2」+1)?(22普+l).216 + WRNn , 式中〃rnh釆用C-RNTI。
然后按文献［16］的7.1.2节中规定的QPSK对经过加扰的比特块8(0),...方(19)进行
QPSK调制，得到一个长度为10的复值调制符号块d(0),.../(9)。其长度即格式2/2a/2b 在一个子帧中分配给控制信息的SC-FDMA符号数。
然后复值符号序列d(0),...,d(9)中的每一个符号乘以一个长度为2賢如=12的循环移位序列
Z(N 斜 CCH.f)= mE《)(，)
M = 0丄.9	(2-12)
7=0,1,..MJ
此处甫)。)与formatl/la/lb中一样，是ZC基序列的循环移位，长度林$=鴻沏为⑵
资源指示“常cch指定用于格式2/2a/2b传输的资源，循环移位ag/)由〃澎cch通过 下面的式子计算得到：
a(ns, /) = 2zr ■ ncs (ns, /) /	(2-13)
其中，
%( "s, /)=(〃::"(久 1) + 〃 3)) mod	(2-14)
且当"s mod2 = 0时有：
,()=网ccijmodTC	if 嘱cch<M?幅
、[(咀 cch + 祝)+ l)mod TV’b otherwise
ns mod 2 = 1 时有：
=	- 1)+ l)]mod(^ + 1)- 1 if 漏cch< 就&湄
S	1 讪八 2-冶"jmod 诚15	othewise
PUCCH格式2a和2b只支持常规CP,比特流/>(20),...,Z>(Mbit-1)按表2.5方式调制，
产生一个调制符号以10)。
表2-5：PUCCH格式2a和2b的调制符号刀(10)
PUCCH格式	顷20),..*(A/bit T)	d(10)
2a	0	　　1
1	　　-1
2b	00	　　1
01	-j
10	　　j
11	　　-1

2.2.2 PUCCH的参考信号
PUCCH的ZC序列
在TD-LTE系统中的参考信号由Zadoff-Chu （ZC）序列来产生，ZC序列同时还作 为随机接入信号、主同步信号和PUCCH的码分复用序列。ZC序列具有非常好的自相 关性和很低的互相关性，这种性能是其用来产生同步信号的根本原因。在LTE中ZC序 列广泛应用与物理上行信道中的参考信号，包括PUSCH、PUCCH中的解调参考信号以 及探测参考信号。ZC序列经过DFT后仍然是ZC序列，仍然具有良好的自相关性和很 低的互相关性。
参考信号序列**）（〃）为ZC基序列r?.v（/7）的循环移位，按下式计算：
《？（〃）= ejanr,<y{n\ 0<n <12	（2-17）
u是ZC序列的组号，v是组内序号。u和v的计算PUCCH在…个时隙中占用边缘 的-个RB,因此使用的参考信号长度为12o文献［16］中规定，当参考信号长度小于3滯, 基序列ru,v （〃）定义为：
《、（〃）=醉"，0</?<12 其中（p（n）由［16］中表5.5.1.2-1给出。
PUCCH格式1/la/lb的参考信号的循环移位与传输的控制信息上的循环移位有所不
同。控制信息上的循环移位在E节已经介绍，参考信号的循环移位a（，，,,/）随时隙号久和
符号』变化，表示为： 財）=前〃）*7叫
［■*（〃"）+ （“'（久）-△辭"+ （肅〃，）mod A"，）） mod y ］ ［城"（"，） + （〃'（％） ? A："" + 农（其））mod V］ mod 迎
其中"S）, N', A" 和，"，,/）定义见2.2.1节。
对PUCCH格式2/2a/2b,参考信号的循环移位与控制信息上的循环移位相同, 具体生成见2.2.1节中PUCCH格式2/2a/2b的循环移位。
ZC序列组跳转
PUCCH ±承载的控制信息中的循环移位序列以及解调参考信号均是长度为12的
ZC序列。ZC基序列划分为多组。组序号”由组跳转样式扃/,%）和序列移位样式人定义:

” = (/gh("s)+ /ss)mod30
组跳转样式决定于序列组跳转开关是否开启。在TD-LTE中PUCCH和PUSCH使
用相同的跳转样式。PUCCH和PUSCH的组跳转样式国。2为:



但是PUCCH和PUSCH采用不同的序列移位样式，其中PUCCH的序列移位样式 虞CCH由式APuccH=7vSnmod30给岀，从式中可以看出该序列移位样式只与小区ID有关。
组内序列跳转只支持序列长度大于的6此？的ZC序列。因此PUCCH的ZC序列不支持 组内序列跳转，v=0。
2.2.3物理上行控制信道结构
表2.6给出了不同PUCCH格式中解调参考信号在每个时隙的位置。剩余的位置即 PUCCH控制信息映射的位置。
表26 PUCCH解调参考信号位置
PUCCH格式	/值集合
常规循环前缀	扩展循环前缀
1, la, lb	2, 3,4	2,3
2	L5	3
2a, 2b	1,5	N/A

在上一节中介绍了 LTE中的物理资源映射。在上行系统中的多址接入方案采用 SC-FDMA,因此每个SC-FMDA的符号周期内，所W SC-FDMA的子载波都携带了每 个数据符号的分量。在PUCCH中，控制信息经过编码扩频调制后映射在上行物理资源 的两个时隙中。与其他上行信道不同的是，PUCCH的控制信息映射在系统带宽边缘， 并占据两个时隙的两端。
下图中的两个RB的位置仅指示两个RB占据了两个时隙的带宽两端。从图中可以 看出，PUCCH在-个子帧中采用跳频，从而获得频率分集增益。具体映射的物理资源 块取决于PUCCH的格式。PUCCH调制符号的映射方式如图2-4所示。



图2-3:PUCCH子帧结构
如果当该子帧配置了 SRS,并且上层配置允许探测参考信号和PUCCH同时传输,
且配置的SRS也在带宽边缘，即发生了 PUCCH和SRS冲突的情况，那么PUCCH第
二个时隙的最后一个符号将承载探测参考信号。



图2-4: PUCCH映射到物理资源块
对格式1, la和lb有:
if假CH <。彼/驾*

3 normal cyclic prefix 2 extended cyclic prefix
而对格式2, 2a和2b有:
^ = LCcchMBJ	（2-23）
在release9中规定一个用户在一个子帧中不可以同时发送PUCCH和PUSCH两个物 理信道，但在releaselO以后，已经支持这两个信道在同一个子帧同时发送，这种设计可 以最大化PUSCH的传输速率。同时在不同的频率上发送两个子帧的控制信息，可以提 高频率分集增益。
2.3探测参考信号
LTE上行利用参考信号进行数据解调和信道探测，这也解释了 LTE上行中两种参考 信号-解调参考信号和探测参考信号。
解调参考信号（DMRS）在PUSCH和PUCCH中承载，DMRS和承载它的信道上的 数据或者控制信息共同传输，根据DMRS的已知性对E行信道进行估计，从而解调上 行数据或者控制信息。
探测参考信号主要用于对上行信道做信道质量探测，eNodeB根据SRS探测到的信 道质量信息，对上行数据信道进行频率调度。SRS还可以用来进行功率控制，定时估计 和支持下行波束成形的到达方向估计等。SRS不与上行数据和控制信息关联，是独立的 数据块。本章对探测参考信号做主要介绍。
2.3.1 SRS中的ZC序列
SRS序列同PUSCH和PUCCH的DMRS一样，是ZC基序列的循环移位，他们的 区别是长度、循环移位以及物理资源映射的方式不同。
ZC基序列时）被分为多组,ne{0,l,---,29}表示组号，在同…个小区，用户间 PUCCH上的DMRS和SRS的ZC序列在一个时隙内的组号相同。组内有1到2个ZC 基序列，v表示组内序号，当参考信号的长度小于6叫？，每组ZC基序列，只包含一个 序列（v=0）。当参考信号长度大于等于67V辭时，每组内包含两个基序列。
基序列當（0）,…，富（也匕？ -1）的定义取决于序列长度M"，长度小于3M?的基序列的 产生在222节中介绍，长度为2“辭的基序列的伊伽）由表5.5.1.2-2给出。
对祐5 =3滯,基序列％,（0）,...,糸（山辭-1）由下式得到：
私，（"）= Xg（〃modN￡（?）, 0<n<M^s	（2-24）
其中，％表示第g个ZC根序列：
.m + 1）
xq（m} = eJ , 05〈相-1	（2必）
其中g组号和组内序号决定：

0=厅+ 1/2」+小(-1膏」 亦N券(" + 1)/31
ZC基序列的长度N鑒为满足滤 ＜妃的最大素数。
探测参考信号中ZC基序列的循环移位a为：
a = 2勿也	(2-27)
8
其中n&s由高层配置给每个终端，且n靠s = 0, L 2,3,4,5,6,7
SRS中ZC序列的序列组跳转同PUCCH中参考信号的序列组跳转，在2.222节已 经介绍。当ZC序列长度小于6憧，组内只有一个基序列，v=0；对长度大于等于6理 的参考信号，时隙％中基序列组内的基序列号v为：
c(〃s) if group hopping is disabled and sequence hopping is enabled


2.3.2 SRS物理资源映射
SRS的长度
UE发送SRS所使用的带宽取决于系统上行带宽，UE的发送功率，小区中发送SRS 的UE数目等。使用较大的发送带宽可以获得更为精确的上行信道质量测量，然而在上 行路径损耗较大的情况下，UE需要更大的发射功率来维持SRS的发射功率密度31。
表2-7上行带寛80〈溫＜ 110,哈踏和= 0,1,2,3的值
SRS带宽配置
CsRS	SRS 带宽 Bsrs = 0	SRS 带宽 Bg = 1	SRS 带宽 Bgs = 2	SRS带宽呂rs =3
mSRSt0	N。	WSRS,1	M	^SRSN		mSRS,3
0	96	　　1	48	　　2	24	2	　　4	　　6
1	　　96	　　1	32	　　3	16	　　2	　　4	　　4
2	80	1	40	　　2	20	2	　　4	　　5
3	72	　　1	24	　　3	12	2	　　4	　　3
4	　　64	　　1	32	　　2	16	2	　　4	　　4
5	60	　　1	20	　　3	　　4	5	　　4	　　1
6	48	　　1	　　24	　　2	12	　　2	　　4	　　3
7	48	　　1	16	　　3	　　8	　　2	　　4	　　2
17
在一个小区内，基站配置一个SRS带宽配置Csrs,不同的上行带宽具有不同的SRS 带宽配置集合。小区内用户被划分为四种SRS带宽。表2-7给出了上行带宽80-110RB 时SRS带宽配置情况。
SRS带宽配置参数《实$是小区级别的参数，SRS带宽％s参数是用户级参数，都是 由高层配置。用户具体使用哪种带宽由两个参数共同决定。
SRS起始子载波位置
在前面的章节中已经介绍SRS的时域位置即SRS在指定子帧的最后一个SC-FDMA 符号上发送，而频域起点統定义为：
幻=灼+矣飾	(2-29)
虹0
对配置了 SRS的常规上行和特殊子帧中的UpPTS域，比；的计算方法不同。其中， 对常规上行子帧，=(L^/2j-?7SRS0/2>V^+^r ;
对UpPTS,可以配置在UpPTS的1个或者两个符号同时发送SRS,其频域起始位 置化相同，表示为：
?(N竈-心辭 + 噂 if ((?, mod 2) x (2 - Nsp) + nhf) mod 2 = 0
佑)=［	'	'	(2-30)
kTC	otherwise
k? e (0,1)是高层为UE配置的参数transmissionComb,当两个用户配置了相同的SRS 带宽和频率位置索引，可以通过不同的月在相同的RB进行频分复用。o是频率位置 索引，/根据［16］中5.5.3 2节中依据高层配置跳频带宽等参数计算，此处不做详述。在 前半帧的UpPTS域”侦取值为0,在后半帧的UpPTS域％取值为1。NSP是一个无线帧 中下上行转换点的个数，表2-2中下行-上行转换点周期为5ms,表示一个无线帧中下上 行转换点个数为2；周期为10ms,表示一个无线帧下上行转换点个数为1。
SRS多用户复用
SRS和DMRS的区别之一是两个的物理资源映射位置不同。上一节中PUCCH的解 调参考信号的映射位置根据格式的不同分布在7个SC-FDMA符号的中间，这种符号分 18
散的导频信号有利于对整个时域进行准确的信道质量估计。而且解调参考信号映射的子 载波是连续的。探测参考信号是同上行信道独立的，用于探测信道质量的导频信号，它 将探测信号映射到子帧的最后一个符号，即第二个时隙的最后一个符号。同时子载波上 釆用梳状导频方式，即每个RB上只有6个子载波承载SRS的发送。
不同用户传输的SRS虽然都在子帧最后一个符号上，但是可以釆用频分复用或者码 分复用方式共同在最后一个符号的不同子载波或者相同的子载波上传输。下图中用户1 和用户2的SRS映射在不同的子载波上，是采用频分复用在最后一个符号上传输。而用 户3和用户4,在相同的子载波上传输相同长度的SRS,这样就可以采用码分复用实现 多用户的SRS的正交性，从而实现多用户复用频谱传输SRS。

图2-5:多用户SRS时隙2时频映射

2.4本章小结
本章首先从TD-LTE物理层开始展开介绍，主要包括TD-LTE的帧结构，上行物理 信道结构以及物理资源的划分和组成。其次介绍LTE的物理上行控制信道PUCCH承载 的信息，包括PUCCH不同发送格式上的控制信息、调制方式、PUCCH上负责信道估 计的参考信号以及PUCCH的物理资源映射。同时介绍了 LTE探测参考信号SRS的产 生，以及物理资源映射。

第三章TD-LTE系统PUCCH检测接收算法的研究
3.1PUCCH发送流程
本章由介绍PUCCH的发送流程开始展开，引出PUCCH的检测接收算法。由于 PUCCH不同格式的参考信号位置和密度不同，控制信息的编码和调制也不同，因此在 PUCCH接收端的检测算法也不同，考虑格式2/2a/2b较格式1/la/lb复杂，并涵盖了格 式1/la/lb中的调制和物理资源映射等过程，因此本章中介绍的检测接收算法主要针对 格式2/2a/2b推导。
PUCCH不同格式控制信息的加扰调制以及物理资源映射已经在上一节中介绍。在 发送端,UE侧将PUCCH上承载的控制信息ACK/NACK或者CSI等比特经过信道编码 调制加扰等处理，然后经过ZC序列的扩频同解调参考信号一起映射到响应的物理资源 块上，再经过IFFT变换到时域，在每个符号上添加循环前缀后经天线发送出去o PUCCH 的发送端流程如下图所示，图中虚线框中模块只应用于某具体发送格式。

图3.1 PUCCH发送过程

3.2 PUCCH接收算法
本文主要研究PUCCH上承载的ACK/NACK以及CSI的检测接收，不考虑PUCCH 格式1/la/lb ±DTX的检测。
PUCCH主要的检测接收算法包括与发送端逆向的传统解调解扰和解码算法，半盲 检测接收算法以及基于广义似然比检验的检测接收算法，常规解调解扰解码的检测接收 算法建立在高效的信道估计算法下，前人在PUCCH上提出了利用LS信道估计以及三 次样值插值［19】以及较复杂的MMSE信道估计算法。本节在基于广义似然比检验的检测 接收算法基础上做了有价值的优化。
本小节主要针对格式2/2a/2b进行PUCCH检测接收算法的介绍和推导。包括传统 算法——基于快速哈达玛变换的Reed-Muller(RM)译码算法㈣則㈣，这种方法需要经过 20
与发送端逆向的过程做信道估计后均衡得到经过编码的控制信息。经过RM译码后最终 得到CSI信息；半盲检测算法利用所有的接收信息来进行信道估计，将数据符号也看做 己知的导频符号，最后认为相关值最大数据符号为所求的CSI信息。基于广义似然比的 检测接收算法利用似然函数中的求解信道冲击响应和噪声的最大似然估计，值得指出的 是，GLRT中信道冲击响应和噪声方差估计是隐含计算的，这就在一定程度上减小了最 终表达式的复杂度。我们在第三种方法一基于广义似然比检验的PUCCH检测接收算法 的基础上做了一定的优化，在性能提高和降低复杂度上都有显著提升。
对于PUCCH格式1/la/lb,也同样具有以上三种方法，因其编码方式比较简单，译 码时只通过BPSK或者QPSK解调生成0/1比特即可。格式1/la/lb的控制信息 ACK/NACK只在最后进行解调就可以实现第一种传统的逆向检测接收算法。本文主要 研究格式2/2a/2b的控制信息的检测接收，同时对格式1/la/lb也进行了 GLRT检测的仿 真验证。
在PUCCH接收端，eNodeB需要将天线接收的时域信号恢复到频域进行信道估计 处理。在接收端PUCCH的处理流程如下：
V	I
去CP	-? FFT变换到时域 一A	解资源映射	一?	PUCCH域
时域 	I 	?频域
图3-2从接收信号到PUCCH域流程
format1/la/lb


图3-3 PUCCH域的处理流程
图3-3所示在接收端PUCCH域的处理流程，格式1/la/lb的控制信息在发送端经过 正交序列w奴进行扩展，在接收端，去掉正交序列和ZC序列的相关性，对于格式1/la/lb 还需去掉时隙扰码S(ns)的影响的接收信号可以表示为：

r(/9 幻二￡ R(L 幻* 再(/) * ZC.U (/, k) + N(l,幻,/ = 0…13* = 0…11
U
= 2HN，k)sN，k) + N(l,k)	g)
其中R7,盼表示PUCCH域的频域信号，包含两个时隙的两个RB的PUCCH信号； 式中〃为用户编号，/为符号索引，&为子载波索引，云4,k)表示接收端与发送端共轴 的正交循环移位序列，N(l,k)为噪声和干扰，w (/)为每个符号上的与发送端共轴的时 域扩频序列。H“Q,k)表示用户u对应的信道冲击响应。s"Q,k)表示用户包括控制信息 和参考信号的发送序列。
3.2.1基于快速哈达玛变换的RM译码检测
该算法是针对PUCCH格式2/2a/2b上承载的的CQI信息采用RM编码提出的。RM 编码的解码算法有硬比特和软比特解码两种方法。针对性能要求较高的LTE系统，通常 栗用基于快速哈达玛变换的软比特解码算法。
LS信道估计
PUCCH因其仅在带宽边缘的一个物理资源块传输，和较大比例的参考信号，传统 的LS信道估计即可满足协议［26］要求。因此本文中对格式1/la/lb和2/2a/2b均采用简 洁高效的LS信道估计。
格式2/2a/2b在两个时隙上具有两个解调参考信号，在常规CP情况下，分别位于时 隙的第二个和第六个符号上。由于格式2a/2b除了发送信道质量信息CQI外，还需传输 l/2bit的ACKVNACK,因此将第二个时隙的第六个符号，也就是第二个时隙的第二个用 来发送参考信号的位置被占用，用来承载ACK/NACKo这样在格式2a/2b在第二个时隙 上只有一个解调参考信号可以用来做信道估计。
PUCCH在接收端经过解资源映射后得到2根天线上两个时隙位于带宽两端的2个 RB的信号后，利用ZC序列的恒包络零自相关特性，与用户发送端共轴的ZC序列相乘， 去除ZC相关影响，就可以得到12个子载波14个SC-FDMA符号的去除ZC相关后的 接收信息，用Y(l,k)表示。
之后将12个子载波上的信道冲击响应相加，去除ZC序列的影响和其他用户的干扰。 在低速环境中，--个时隙内可以将信道响应近似保持不变。因此可以得到一个时隙的信 道频域冲击响应。本文已经在上一小节中介绍了 YQ,k)的计算流程，PUCCH的导频信 号去掉ZC相关性后，在每个导频映射的符号位置上即为“1”，根据LS信道估计算法, 信道冲击响应表示为接收信号与发送导频的共轴相乘，格式2/2a/2b的LS信道估计可以 用下图表示：
由于近似信道在一个时隙内保持不变，因此将两个解调参考信号的信道相加近似为 这个时隙的信道冲击响应。格式2的信道冲击响应可以表示如下。
方妳=￡支印，4)
1=1,6 Ar=O
瓦s=z ix")
/=8,12 k=0
对于格式2a/2b,在第二个时隙，符号6用来承载ACK/NACK符号，因此时隙2 的信道估计用下式表示。
噸=%Y0k)
A=0
均衡、解调和解扰
PUCCH均衡的过程由图3-5表示，将多根天线上与信道冲击响应共轴相乘的结果 合并，即是：

图3-5: PUCCH格式2均衡
根据图3-5所示流程，PUCCH格式2的接收端控制信息调制符号由式3-15给出,
n ant
仰=￡ ￡丫(小)片:如，/ = 0,2,3,4,6
1 白=0
n ant 11
m(l)= ￡	盼片:.板2，/ = 7,9,10,ll,13
1	k=0
[d (0),..d ⑼]=[?J(0), m(2), m(3), w(4),m(6),w(7), m(9),m(l 0),m(ll), m(l 3)]
在格式2中，d(0),...,d(9)是按照［16］中7.1节进行兰相位的QPSK调制后的符号,
4
d(0),...,d(9)按照式3-5的方式进行解调。
及2 */) = */(如))
片(2* 7 + 1) =
按照与发送端逆向流程，调制符号d(0),…,d(9)解调之后得到长为20的加扰序列
片(0),...,片(19),接着对片(0),...,片(19)解扰，就可以得到Reed-muller编码比特块

8(0),...,3(19)。由于接收端QPSK解调采用软解调方式，解调后的加扰序列是带有幅值 的解调序列。解扰按照如下方式进行。
6(z) = 6(/)(l-2c(z))	(3-6)
式中c(z)的产生同发送端，是长度为20的0-1扰码序列，由gold码产生，初始化值 为编t =3/2」+ 1).伽辭+1)?2拓+〃用。
RM译码
RM译码通常使用全搜索译码和基于快速哈达玛变换(FHT)的译码两种算法。全搜 索译码算法即在接收端将进行解调后硬判决后生成的单极性｛0,1｝比特进行解扰，解扰过 程同发送端一样，将单极性序列同扰码序列相加后对2取模，得到解扰后的｛0,1｝序列， 并将该序列作为接收序列。接收端对所有码字进行编码，并将编码序列与接收序列对比， 编码序列与接收序列的对比采用计算两个序列的汉明距离，取汉明距离最小的发送码字 作为译码结果。因此在接收端对于长度为n使用RM编码的的CSI序列，在接收端需要 将2"个发送序列进行RM编码，并比较与接收序列的汉明距离。
基于FHT的RM译码算法则是利用RM编码矩阵和哈达玛矩阵的性质同时采用FHT 进行的快速高效的译码算法。下面对该算法详细介绍。
表3-1 RM编码矩阵MOI
I	Mi,0	Mi,l	Mi,2	Mi,3	Mi,4	Mi,5	Mi,6	Mi,7	Mi,8	Mi,9	Mi, 10	Mi, 11	Mi, 12
0	　　1	　1	　0	　0	　0	　0	0	　0	　0	　0	1	　　I	　　0
1	　　1	　1	　1	　0	　0	　0	()	　()	　0	　1	1	　　1	　　0
2	　　1	　0	　0	　1	　0	　0	　1	　0	　1	　1	1	　　1	　　1
3	　　1	　0	　1	　1	　0	　0	()	0	　1	　0	1	　　1	　　1
4	　　1	　1	　1	　1	　0	　0	()	　1	　0	　0	1	　　1	　　1
5	　　1	　1	　0	　0	　1	　0	1	　1	　1	　0	1	　　1	　　1
6	　　1	　0	　1	　0	　1	　0	]	0	　1	　1	1	　　1	　　1
7	　　1	　0	　0	　1	　1	　0	0	　1	　1	　0	1	1	　　1
8	　　1	　1	　0	　1	　1	　0	0	　1	　0	　1	1	　　1	　　1
9	　　1	　0	　1	　1	　1	　0	1	　0	　0	　1	1	　　1	　　1
10	　　1	　0	　1	　0	　0	　1	1	1	　0	　1	1	1	　　1
11	　　1	　1	　1	　0	　0	　1	1	　0	　1	　0	1	　　1	　　1
12	　　1	　0	　0	　1	　0	　1	0	1	　1	　1	1	1	　　1
13	　　1	　1	　0	　1	　0	　1	0	　1	　0	　1	1	　　1	　　1
14	　　1	　0	　0	　0	　1	　1	0	I	　0	　0	1	0	　　1
15	　　1	　1	　0	　0	　1	　1	1	1	　0	　1	1	0	　　1
16	　　1	　1	　1	　0	　1	　1	1	　0	　0	　1	0	　　1	　　1
17	　　1	　0	　0	　1	　1	　1	0	0	　1	　0	0	　　1	　　1
18	　　1	　1	　0	　1	　1	　1	1	　1	　0	　0	0	　　0	　　0
19	　　1	　0	　0	　0	　0	　1	1	0	　0	　0	0	0	　　0

LTE系统中采用了两种RM编码方式，其中PUSCH上非周期上报的CQI采用

(32,11)RM编码，而本文研究的PUCCH釆用(20,13)RM编码方式。(32,11 )RM编码矩阵 中第1列为全1序列，第2列到第6列是长度为32的经过块交织后Walsh码，剰余的 第7列到第11列，是5个基本掩码序列；PUCCH中(20,13)RM编码矩阵中，第1列同
(32,11)M矩阵一样为全1序列，第2列到第6列是截短的交织Walsh码，第7列之 后是7个基本掩码序列。
RM译码流程如下：
1)高位扩展
在解(20,13)的RM编码时，由于RM矩阵中第2列到第6列是截断的交织后 的Walsh码，因此要利用快速哈达玛变换进行RM译码，首先要将输入序列扩展 至32位。扩展的方法是在高位补12个0。
RM 编码序列》(0),..盘(19)扩展为8(0),6(19),0,0,0,0,0,0,0,0,0,0,0,0。
2)交织
M矩阵中第2列到第6列是截断的交织后的Walsh码，将该Walsh码补齐至 32位后，进行交织。以第2列为例，进行补零后序列为：
1100110 01 0010101 1 0 1 0 0 0 0 0 0.0 0 0 0 0 0 0
按照同PUSCH的(32,11)RM中相同的交织顺序，交织后的序列为：
01010001010001000001010001010100
序列中点型下划线符号是扩展的“0”符号。对扩展的“0”符号进行转换，使 交织后的序列成为Walsh码：
01010101010101010101010101010101 同理，对第3列到第6列做同样的处理，处理后的序列如下表。
01010101010101010101010101010101
? ??? ???< *?? ???> ???| ???' ???' ??????? ??????
00110011001100110011001100110011 00001111000011110000111100001111
????!	> ???> ? ? ?1	????■?
00000000111111110000000011111111
■ ???< ???' ???? ????■?
00000000000000001111111111111111
????< ???■ ???> ???> ???' ??????
可以看出是第2到第6列是截短的Walsh码的交织序列。因此接收的处理是 将M矩阵同扩展后的接收序列同时进行交织处理
3)掩码消除
M矩阵第7列到第13列是7个掩码序列，这7个掩码序列可以组合成2, =128 个掩码矢量。因此将解交织后的长度为32的发送序列与这128个掩码矢量相乘为 128个长度为32的序列，必有一个序列是与发送端相同的掩码组合，达到了掩码 消除的作用［2。】。
4)BFHT
将这128个序列进行32阶FHT,得到32*128的相关值矩阵。下图给出了 8 阶IFHT的蝶形图。
25


图3-6: 8阶IFHT蝶形图
5)相关值映射
M矩阵的第1列是全1序列，因此第1列对相关值矩阵的影响在于相关值的 符号[20],通过在32*128的相关值矩阵中找到模值最大的相关值，该相关值在相 关值矩阵中位于(i,j),即第i行第j列，那么解码序列第2到第6位为i的二进制｛0, 1｝比特，第7到13位是j的二进制｛0,1｝比特，该相关值的符号，表示了解码序列 的第1位，如果相关值为正数，表示解码序列第1位为0,反之为1。
在LTE系统PUCCH中，长度为13的CSI的相关值矩阵映射如下：
相关值的索引i
对应的二进制

相关值	相关值的索引j
的符号	对应的二进制

图3-7: RM译码映射
根据上图中的映射关系,可以对这种算法进行计算量的优化。在eNodeB-方， 经过高层的配置可以知道CSI的长度。如果CSI的长度小于7,发送端并没有掩 码序列的参与，因此不需要128种掩码序列的组合所构成的32*128的相关值矩阵, 只需要在一个长度为32的相关值集合中找打最大的相关值，若第i个相关值最大， 则长度小于7的CSI就可以用相关值的符号和i的二进制表示。同样。若CSI长 度为7,则在掩码组合为2中，那么相关值矩阵为2*32。下表给出了长度小于13 的CSI的基于FHT的RM译码算法的相关值矩阵的大小。
26
表3-2: RM译码相关矩阵大小
CSI长度	相关值矩阵大小	CSI长度	相关值矩阵大小
小于7	32*1	10	32*16
7	32*2	11	32*32
8	32*4	12	32*64
9	32*8	13	32*128

3.2.2 PUCCH的半盲检测
基于快速哈达玛变换的RM译码算法依赖于高质量的信道估计，通过性能较好的信 道估计算法得到较为准确的信道冲击响应，然后利用均衡，解调解扰才能进行RM译码 处理得到CSI序列。因此基于FHT的RM译码的检测接收算法误码率依赖于信道估计 和RM译码算法两个模块的性能。
而在PUCCH的格式2只在…个时隙的第2个和第6个符号」：发送DMRS,在格式 2a/2b中,又在时隙2中减少了个DMRS,参考信号的占用率仅为21.4%,因此在格 式2/2a/2b中DMRS的减少会降低利用导频信号进行信道估计的性能㈣。半盲检测算法 就是在这样的条件下提出。
半盲检测算法充分利用发送的控制数据信号和解调参考信号同时来做信道估计。其 中DMRS在接收端是己知的，因此这种算法叫做半盲检测算法。通过仿真发现，半盲 检测算法比较适用于低参考信号占用率、低码率、低移动速度的情况下【24】。按照文献[9], 将半盲检测算法划分为半盲检信道估计，最大比合并和相关系数比较二个模块。
半盲检信道估计
半盲检测算法的主要思想是，将数据信号同参考信号一起做信道估计，而数据信息 作为PUCCH需要检测的序列，在接收端是未知的，因此需要假设发送序列以及己知的 参考序列进行信道估计。信道估计采用LS信道估计算法。
同RM的全搜索译码算法类似，在接收端对长度为N的CSI序列进行全部遍历， 对每一种假设发送序列估计信道冲击响应。长度为N的CSI有2'中发送序列｛0,1｝比特 序列，再经过RM编码同样为20种长度为20的假设发送序列。
接收端解资源映射之后的PUCCH域可以表示为：
U
R(l,幻=￡ S,, (/)* ZQ 5*HW)+ N(l, k)
"=i	(3-7)
= S]0)*ZG(/*)*H](/*)+M7,幻,/=0 丄...,13,k=0,l,...ll
以第一个用户为检测目标，那么其他用户的干扰和噪声用式中N(l9k)表示，将接收 端信号与检测目标用户的ZC序列的共轴相乘，依据ZC序列的自相关性，NQ,k)中的

其他用户的干扰将被目标用户的ZC序列的共轴抵消掉。因此接收端去除ZC相关后的 信号可以用下式表示：
= Si(l)*ZCi(l,k)*H&,k)* 云 iQ,k)+N(l,k)* 云	(3-8)
=H")S[(l,k) + N(/,k)* 云"),1 = Q..A3,k = 0...11
对于第n种假设序列51>n(Z),对应第n种信道估计值％,“(，幻。利用LS信道估计， 目标用户的信道冲击响应可以表示为：

//戚0上)=-(饭)*51”(/),/ = 0,1,...,13,1< = 0,1,. .11	(3-9)
基于时隙的信道估计采用将的一个时隙的7个符号求均值。下式中用
%心紳)表示第1个时隙的信道估计值，%?眼佔)表示第2个时隙的信道估计。
1 6
(k) =	= 0,1,... 11
/ 顷)	，	、
13	(3-10)
伍信〃孙)亏二°，LT 1
/顷
最大比合并
LTE中的关键技术之一是实现多天线技术。多天线是在密集多径散射环境下，在发 射机和接收机一侧部署多根天线的技术网。在接收端采用分别对两个时隙最大比合并多 根天线上.信道估计，最大比合并的加权系数采用PUCCH多根天线上信号幅度和噪声功 率之比。噪声功率按下式计算：
1	116	-
=林2；2>(罹)一日顷成(局电(/)|
1Z /心】=0
1	1)13	2
b抵补=古石zzk")-%,聞(幻錦(/)|
1Z / k=o 1=7
Nr根天线上的信号的最大比合并可以在噪声方差估计之后获得：
r=} (a 1,,7,成)
幻=另),/ = 7,8,…,13
E 仁 \,n,2nd)
相关系数的计算与比较
最后计算Km*/)、Ki,〃神0幻与s(/)l n的相关系数，相关值最大的假设发送序列即是CSI检测值。第n种假设序列的相关值用下式计算：
6 11	 	 13 11
=￡￡九,侦（仆）*Si”（/） + ￡￡ri,”,2nd（/#）*Si"（/）	（3-13）
1=0 k=0	1=1 k=0
若第n中假设序列的对应的相关值最大，那么CSI的检测值为n的二进制比特序列。
这里认为第n个假设发送序列是n的二进制表示，n从0开始。
3.2.3PUCCH的基于广义似然比检验的检测接收
PUCCH的半盲检测接收算法虽然可以在低密度的参考信号情况下取得较好的检测 性能，但是因其较高的计算复杂度，很难在实际工程应用中被采纳。
PUCCH通过配置在两个时隙的频带两端，来获得不同时隙之间的频率分集增益。 但也因此，在小区边缘PUCCH很容易受到相邻小区的用户的干扰，如果相邻小区配置 的PUCCH的发送功率同当前小区的发送功率相差较大，那么功率较大的小区就会对功 率小的小区边缘PUCCH用户产生较大的干扰，使得PUCCH两个时隙上的2个RB b 的F扰和噪声之和相差较大。
PUCCH的广义似然比检验虽然同样需要遍历长度为n的所有2"个发送候选序列， 但经过优化，其运算复杂度和检测性能都有较大提升。
基于广义似然比检验的检测接收算法需要得到检测接收的似然比函数，通过替换似 然比函数中的未知参量得到使得似然比函数最大的发送序列［2习。该算法与半盲检算法相 似，在接收端利用参考信号信息和控制符号信息共同进行数据处理，且需要遍历所有控 制信息的发送候选序列，但是两者理论依据不同。
基于广义似然比检验的检测接收算法能够隐含的对信道冲击响应和噪声情况作出 估计，在最终的表达式上并没有显示计算信道冲击响应和噪声方差，在算法上能够减少 计算复杂度。保持了半盲检算法的性能优势的同时，检测性能在高速高信噪比情况下有 '-定提升。
以二维广义似然比检验为例，接收信号样本戸=（乂,巧况,…见）的概率密度函数为 p（y,0\0e@,其中。表示未知参数，G）是参数空间，设发送信号为孤和》2，对应参 数子空间为0和。2。那么广义似然比检验统计量表示为：
sup P（y,0）

人顷）=
supMj）;。）
其中&和。表示Q参数在参数空间。和参数子空间@的最大似然估计。因此可以认 为二维广义似然比检验结果是在各自参数子空间进行参数最大似然估计下概率密度最 大的发送信号。同样多维广义似然比检验，是多维信号在多个参数子空间上进行参数最 大似然估计的概率密度最大的发送信号。

广义似然比检验的似然函数
在广义似然比检验的接收公式的推导之前，我们对PUCCH的信道模型做必要假设。 假设两个时隙上的噪声和信道冲击响应是相互独立的，并在一个时隙内保持一致。因为 PUCCH两个时隙上的物理资源块在系统带宽的两端，做出这样的种假设是合理的。同 时也可以做出两个天线上的噪声和信道冲击响应是独立的假设。
在接收端，经过前端处理，去除CP,做DFT、IDFT处理之后，获得时频资源信息， 根据PUCCH不同格式资源映射规则，获取PUCCH两个物理资源块的信息，这两个不 同时隙的物理资源块分布在带宽的两端。接收端这两个RB的信息可以表示如下：
=h?j.冏 +Nra；,7n = 1,2,1 = 1,2
m和1分别表示天线和时隙的索引。式中s是经过编码和调制后的发送序列，对于 formatl/la/ab不涉及到发送序列的编码过程，只是调制后的发送序列。对于不同的format
格式，由于参考信号映射的符号位置不同，s的格式也不同。s具有以下格式
s> =禺(0)藐(1)丄1,1叫(2)為(3)] 1
s2 =[叫(4)总(5),1丄1/4(6小,,(7)][
s小禺(5),1由(6)由(7)鸟(8),1点(9)][
式中表示信道的噪声和干扰的和，假设N,”/服从均值为0,方差为b二的复高斯 分布。
对于未知参量的估计，由于未知参量，即信道冲击响应和噪声方差的的分布未知， 所以最大后验概率（MAP）估计是不能运用的，而一般采用最大似然估计，就是通过最 大似然估计出似然函数中的未知参量，并替换似然函数中的该未知参量。
根据推导前的假设，我们可以得到两个天线和两个时隙上的联合广义似然比检验的 似然函数，各个时隙上的似然函数用接收信号的条件概率分布函数表示。由于两根天线 上的两个时隙的接收信号是独立的，因此发送信号即PUCCH上承载的上行控制信息可 以表示为两天线上两个时隙的似然函数比的最大值。该似然函数是时隙和天线上的似然 比函数的乘积。
2	2
§ = arg max 门门	)
/??=! Z-l
由式3-17,信道冲击响应h録和发送信号*可以通过最大似然估计得出，因此假设 这两个参数是已知的，根据随机分布函数的性质，由于噪声及干扰服从均值为0, 方差为or二的复高斯分布，因此接收信号Y“,j服从均值为h.,,两，方差为b,的复高斯分布。用概率密度函数描述似然函数以丫眦蠕,％兄）。
P(Y?Jhw，s”4,) =曲昂exp.-	(3-18)



检测可以用下式表示:
Largnyn是文日。｛可?砌)
S, m=\ /-I
信道冲击响应和噪声方差的最大似然估计
任实际通信系统中，接收端并不知道信号所经过信道的分布和噪声方差等信息。因 此，式3-19中的信道冲击响应和噪声方差是未知的。因此需要对进行准确的信道估计 和噪声方差不及才能实现式3-19的相关检测算法，本文对信道和噪声采用最大似然估 计方法。用户在不同天线和不同时隙上的信道冲击响应的最大似然估计可以如式3-20 表示。由于假设信道在一个时隙内保持不变，因此信道冲击响应在不同天线、时隙上是 维度为12*1的矩阵。
虬尸窩-Y,“/S；=0
将式3-20带入式3-18,条件概率密度函数即似然函数可以表示为

且似然函数的未知参数只剩下噪声方差，条件概率密度函数也将条件退化为s,和 亦/两个参数。同样通过最大化似然函数，对未知参数为噪声方差的似然函数式3-21求 导数，令导数为0,就可以得到噪声方差的最大似然估计。表示如下
Ygs；Y：（s：s：）"） LN , o	（3_22）
b神	b.J
化简上式，得到噪声方差b二的最大似然估计。
4	质 Yf-YqsWs））	323）
mJ	LN
将似然函数中的噪声方差用最大似然估计替换，就可以得到似然函数的表达式：

（功）方 exp {-5}
[””（丫时丫「丫牌般綽：）-，）广
条件概率密度函数的条件只剩下发送信号，式3-24中分子是常数，带入式3-17并 化简，广义似然比检测可以表示如下：
臨=糅吁文力og{〃(Yc，Y： 一 Y"S；s"(s；s：)t)}
.《孔 冬白 〃 、j 瞄(-〃瓶侬,〃)『、
=argmyi?log(?g,0/)| ->			 )
' m=l /=! k=l n-1
可以看出上式中公式简洁，并没有出现信道冲击响应和噪声方差，而是在推导过程 中隐含估计两个未知参数，这样在接收端降低了计算误差和计算复杂度。
3.2.4基于广义似然比检验的检测接收算法优化
本小节主要介绍针对上一节广义似然比检验的检测接收算法的优化，该优化算法在 性能和复杂度上都较上一节算法有了改进。该优化算法针对系统模型中的信道冲击响应 在一个时隙内保持不变的假设做了更细致的推导。通过合并12个子载波的接收数据， 以替换基于广义似然比检验的检测接收算法中的接收信号，显著提高了检测接收性能， 并通过复数加运算减少复数乘运算的数量，以降低算法复杂度。
在上节中推导广义似然比检验的检测接收算法时我们假设，信道在…个时隙内保持 不变，但信道的冲击响应仍分布在12个子载波上，对于PUCCH,无论是format 1/la/lb 还是format2/2a/2b,发送端在同一个SC-FDMA符号上的12个子载波上的信号是调制 符号的重复编码。在接收端，经过前端去CP, IDFT和去除lE交序列和ZC扩频序列的 影响，12个子载波的接收数据是重复的。因此，在低速情况下，忽略子载波间干扰，可 以将12个子载波上的接收数据进行合并，再进行接收端的信道估计。
接收端子载波合并
在接收端，表示经过前端去CP, IDFT处理，以及去除ZC扩频序列相关性和
正交序列时域扩展的接收信号，可以用下式表示：
Y" =hm/s, + Nm; = （y mll ； y 2' ? ■ > y mj.K= 12	（3-26）
由于在低速环境中，近似忽略子载波间干扰和多用户间干扰，相邻子载波上的信道 冲击响应可以近似看做相等。在发送端，CSI信息经过编码调制后的长度为10,即两个 时隙的SC-FDMA符号数减去调制参考信号符号数，每个调制符号乘以长度为12的ZC 序列进行扩频编码。’（”）表示发送端经过ZC序列扩频编码后的发送序列。
概率密度函数中噪声方差项是未知参数，釆用最大似然估计法进行噪声方差的估计。 逃兰!也笠匕 丄=o
廿广宜d也1笠"
微分求导得到未知参量噪声方差的最大似然估计，并带入到上式，就可以得到优化 后的基于广义似然比检验的pucch检测接收算法。式中yx-y^s；sX（sX）-因子载波 的合并降为一维矩阵。


重E =呼 nyn ￡￡log {y?x - y,qs V, (s：s；尸}
1 m=l 1=1
2	2	L
=argmin￡￡log(￡|_y臨妍—
5{ ffl=l 1=1	虹】
比较该检测算法和优化前算法，发现两种检测方法的表达式类似，只是对接收信号 的形式有了一些变化，仿真结果证明，优化后的检测接收算法较优化前有近2.6dB的性 能提升。在低速情况下，信道的频域响应在一个时隙内基本保持不变，且由于PUCCH 的特性，在12个子载波上发送的信号是相同的，因此将12个子载波进行合并，可以消 除噪声和干扰的影响，检测性能更好。
在计算复杂度上，虽然基于GLRT的检测算法也需要遍历发送信号分集，但在实际 匸程应用中，可以将上式中需要反复计算的y”,」y：独立出来，在接收端只计算…次。考 虑发送信号s,是通过QPSK调制的信号，只有4种取值，可以将y成与4种QPSK调制 符号的复数乘积…次性全部计算出来，再组合成y,,”s；,以减少计算量。由于虽然每次 遍历发送候选序列时s,不同，但（s；s；）的结果是不变的，为固定值7。
3.3 PUCCH检测算法仿真性能与对比
在上述数小节中，首先对信道模型进行先验假设，并对传统解调接收算法，半盲检 测算法和广义似然比检验算法做了详细的介绍和推导。本节对上述提出的检测算法进行 matlab仿真验证，并对比检测性能和计算复杂度。
3.3.1仿真参数设置
LTE常见三种MIMO信道模型，包括扩展步行者信道模型（EPA）,扩展车辆信道 模型（EVA）,扩展典型城市信道模型（ETU）,三种信道模型对应的多径衰落参数如下 表㈣：
表3-3: LTE常见信道模型【26】
信道模型	多径时延[ns]	相对功率[dB]
EPA	delay =[0,30,70,90』10,190,410]	fade=[0.0r10r2.()r3.0,-8.0,-17.2,-20.8]
EVA	delay =[0,30,150,310,370,710,1090,17302510]	fade=[0.0r1.5,-1.4,-3.6,-0.6,-9.1,-7.0,-12.0,-16.9]
ETU	delay=[0,50,120,200,230,500,1600^300,5000]	fhde=[-].()广 L0,-1Q0.0,0.0,00-3.0,-5.0,-7.0]
本文针对格式lb进行了 EVA70的检测性能仿真和CSI长度为4的格式2的性能仿


真，并对格式2在低速和高速两种信道模型下进行了检测性能仿真。具体模型参数设置
如下表:



3.3.2仿真结果分析
格式lb仿真结果
下图3-8给出了格式lb在两个时隙噪声相差不大的情况下常规解调接收，广义似 然比检验和优化后的广义似然比检验三种算法在EVV70,带宽5M的条件下仿真。如图 所示，传统解调接收在该条件下的检测性能较好。优化前的GLRT算法远远差于传统解 调接收检测算法。而优化后的GLRT方法可以大大提高检测性能，虽不及传统算法，但 也较为接近。



图3-8:格式lb0-2 J =*,2的检测误比特率
如图3-8所示，优化后的GLRT检测接收算法在两个时隙噪声一致前提下比传统的 导频估计均衡检测算法差0.5dB左右(BER=1%),分析两种算法可知，优化的GLRT算 法将数据符号部分同时参与信道估计，因此统计三种算法的信道估计的均方误差(MSE), 如图3-9,可以看出优化的GLRT算法的信道估计的MSE要差于传统导频估计均衡检测 算法。

图3-9:格式lb。；』=氏2的信道估计MSE

传统导频估计均衡检测算法没有考虑PUCCH的频率分集特点，默认两个时隙的干 扰噪声在同一水平，这种假设是不合理的。图3-9给出了当两个时隙噪声相差10dB,其 他条件不变的情况下，三种方法的仿真性能。该情况模拟在小区边缘，由于PUCCH分 布在频带边缘，极易受到相邻小区的的同频干扰，或者快速衰落条件下，会出现两个时 隙噪声相差较大的情况。由于接收端对信道状态信息并不知情，而广义似然比检验可以 在这样的条件下近似传统算法的检测性能，采用优化后的GLRT算法大约有2.6dB的性 能增益。
同时由于传统导频估计均衡检测算法默认2个时隙的2个RB上干扰及噪声在同一 水平，因此没有考虑噪声的影响，因此在两个RB噪声相差10dB的情况下性能下降明 显。

格式2仿真结果
下图给出了格式2采用半盲检测算法，GLRT和优化后的GLRT三种方法的仿真。

图3-10:格式2上，=o-2,ETU3km/s下检测误码块率
在高速情况下，通常信噪比都较高，GLRT同样表现了很好的性能，在下图中GLRT 在高信噪比情况下，比半盲检好0.5-1.5dbo
因此均衡两种检测方法，我们得出结论，虽然GLRT在相同信噪比情况下性能要差 于传统方法，但是这种差异并不十分明显，从图中可以看出GLRT要比传统方法差大概 0.5dB,同时满足LTE协议要求，但是在不同信噪比情况下，GLRT会有2.8dB的优势， 因此GLRT是可以采用的。

图3-11格式2b2, =CT2,ETU350km/s下检测误码块率

下表统计了针对CSI长度为4的PUCCH格式2的三种检测算法的复数乘运算数量。
表3-5:格式2三种检测算法的计算复杂度比较(n=4)
算法	半盲检【27]	GLRT	优化后的GLRT
信道估计	12*14*4*Nr	0	0
噪声方差估计	12*2 *2n*NR+12*14* Nr	0	0
最大比合并		0	0
相关系数		(12*142+(12*14+12*12)*2。)* Nr	(14+ (14+1 )*2?* Nr
总计	(70+2*2n)*12 Nr	(142+26*2n)*12*NR	(14+15*2。)* Nr
在式3-25中，通过合并12个子载波接收信号，降低接收数据维度，从而在后续相 干算法中显著降低运算复杂度。以4比特CSI为例，发送端的CSI共有16种发送序列， 在接收端需要遍历这16种发送序列进行似然比检验，同时我们发现式3-29中ymJyl每 种发送序列检测中是重复计算的，因此在接收端只需计算一次。
从表中可以看出，由于基于GLRT的检测接收算法隐含估计了信道情况和噪声方差, 在推导过程中对两个位置参数做了估计，并替换了似然函数中的两个位置参数，因此减 少了两个中间变量的计算过程。
3.4本章小结
在本章中，从PUCCH发送流程开始介绍，引出PUCCH上控制信息的检测接收算 法，重点关注格式2的检测接收算法。主要介绍了基于FHT的RM译码算法，半盲检测算法，以及广义似然比检测接收算法。并在广义似然比检验的基础上做了性能和计算 复杂度的优化，该优化算法通过将PUCCH域子载波上接收数据进行合并，降低子载波 间干扰，合并后的并对其优点和缺点进行了说明。最后对这三种算法进行了仿真验证, 给出了仿真结果及分析。

第四章TD-LTE系统SRS检测接收的研究
4.1接收端探测参考信号子帧分析
eNodeB并非配置用户在所有子帧进行SRS探测发送，而是配置SRS发送周期指示 在指定子帧的最后一个符号发送探测参考信号。因此在eNodeB接收端需要根据配置信 息进行判断接收信号是否承载了 SRS的传输，并进行信道探测。
上行配置的SRS需要满足--定条件才能在确定的子帧发送，在物理上行信道中，包 括PUSCH, PUCCH和PRACH的配置都会影响SRS的发送与否。
在SRS发送子帧配置中，存在以下三种冲突情况将不发送SRSo
1）	如果当前子帧对应-个随机接入响应赋予的PUSCH传输，或者是基于冲突的随 机接入进程中的同个传输块的重传那么当前子帧就会不发送SRS【S, PUSCH 会占据对应RB的所有符号，而不会为映射RB与PUSCH重合的SRS占据的于 帧的最后…个符号保留位置。
2）	对于 PUCCH,高层配置的参数 ackNackSRS-SimultaneousTransmission 指示 了 PUCCH和SRS是否同时发送。当当前子帧配置发送PUCCH和SRS,如果高层 配置了 ackNackSRS-SimultaneousTransmission 这个参数，即配置了 SRS 和 ACK/NACK同时发送，那么PUCCH和SRS将同时发送，如果PUCCH发送的 格式为formatl系列，且SRS发送的RB与PUCCH重叠，那么PUCCH将采用 短的格式，即空出最后一个符号留给SRS传输。
3）	在UpPTS中，当SRS传输与前导格式4的PRACH区域重叠时，或者超出小区 配置的上行系统带宽的范围，UE不传输SRS。
除了以上三种信道的冲突情况，UE的SRS传输遵循-下模式：
（一）小区级子帧配置
探测参考信号小区指定的子帧配置周期Lfc和小区指定的子帧偏移量Ash■见下表。 承载探测参考信号的子帧满足L?4./2jmod7；K?GAs/；co对TDD,探测参考信号仅在配置 的UL子帧或UpPTS中发送。
表4-1 ： TDD模式探测参考信号子帧配置
SRS子帧配置	一二进制比特	配置周期TSPC
(subframes)	传输偏移△ sfc
(subframes)
0	0000	5	⑴
1	0001	5	*2}
2	0010	5	{1,3}
40

3	0011	5	{1,4}
4	0100	5	{1,2,3}
5	0101	5	{1,2,4}
6	0110	5	{1,3,4}
7	0111	5	{1,2, 3,4}
8	1000	10	{1,2,6}
9	1001	10	{1,3,6}
10	1010	10	{1,6, 7}
11	1011	10	{1,2,6,8}
12	1100	10	　　　{1,3,6,9}
13	1101	10	　　　{】,4,6,7}
14	1110	Inf	N/A
15	1111	reserved	reserved

（二）链路级SRS于帧配置
对于UE专属SRS配置周期&S，以及SRS子帧偏移％“，通过高层配置的SRS 配置序号Isrs确定。SRS传输的周期&s从集合修,5, 10, 20, 40, 80, 160, 320} ms中选择。 SRS^MH7SRS^2ms时，在一个包含上行子帧的半帧中配置两个SRS资源。
对于传输周期7srs > 2的SRS传输，其子帧满足（10-+々SRS - 7；>e,）mod7；RS = 0，ASRS定 义在表8.2-3o周期&s = 2的SRS传输为子帧满足（4sRs-%E）mod5 = （"例如当配置SRS 配置序号Isrs为3,对应SRS周期为2, SRS子帧偏移是[0,3],根据表4-3,若Uppts 域包含两个符号，则在半帧的uppts域的第一个符号和子帧3的最后-个符号配置SRS。
表4-2:用户配置的SRS周期Tsrs和SRS子帧偏移T航
SRS配置序号】srs	SRS周期乌rs (ms)	SRS子帧偏移Toffset
0	2	0,1
1	2	0,2
2	2	1,2
3	2	0,3
4	2	1,3
5	2	0,4
41


6	2	1,4
7	2	2,3
8	2	2,4
9	2	3,4
10-14	5	IsRS- 10
15-24	10	Isrs - 15
25-44	20	Isrs -25
45-84	40	Isrs -45
85 - 164	80	Isrs - 85
165-324	160	Isrs - 165
325-644	320	Isrs -325
645 - 1023	保留	保留


表4-3: TDD模式下*srs配置
子帧序号n
0	1	2	3	4	5	6	　7	8	9
UpPTS域的
第一个符号	UpPTS域的
第二个符号					UpPTS域的
第一个符号	UpPTS域的
第二个符号
当UpPTS域
长为2个符号 时的％		　　　　0	　　　　1	2	3	4		5	6	　7	8	9
当UpPTS域
长为1个符号 时的临		　　　　1		2	3	4		6		　7	8	9

真正发送SRS的子帧需要同时满足小区级和用户链路级SRS配置子帧的要求，同 时去掉SRS与其他上行信道冲突的子帧。
4.2 SRS信道探测技术
上行探测参考信号主要用于对上行信道进行探测，进行信道质量估计来获得信道状 态信息，如信道延时，信噪比等，基站通过解析这些信息，在后续子帧中发送控制信息 配置用户的频域资源，实现频率资源调度。信噪比是衡量信道质量的一个重要参数。本 文主要研究SRS的信噪比估计。
4.2.1 SRS信噪比估计
信噪比表示信号在传输过程中信号功率与噪声功率的比。因此探测参考信号的信噪 比估计，依赖于上行信道估计和噪声方差估计。常用的信道估计方法包括LS估计,MLE, LMMSE等。一个性能良好的信道估计算法将决定基站对上行资源更准确的调度，提高 上行传输质量。同样，糟糕的SRS信道估计将会严重影响上行传输质量。经典的噪声功 率估计方法有Boumard算法，时域截断窗外噪声估计法，空闲子载波方法，以及利用有 效的信道估计来计算噪声方差。
SRS的信噪比可以表示如下：
一个资源块上每一个子载波上的信道估计的功率为：
f =Re（H）+ Im（H）	（4-1）
乩表示子载波i上的信道频域响应。在接收端需要利用高效的信道估计算法得到频
域信道冲击响应。SRS采用梳状子载波映射，一个RB的12个子载波上占用6个子载 波。资源块估计的功率为
5
^RBj =	（4-2）
i=0
信号与干扰噪声之比表示为：
Pw SINRg=玖 5	（4-3）
丽表示干扰信号和噪声功率之和。上式中中信号功率可以表示为：
Ng =Re（H,.S + Im（H‘Seg,）2	（4-4）
如*可以表示为：
Numlle	'
we=l
如果利用估计信道中的噪声，计算信道的信噪比，可以用下式表示：
基于Boumard的噪声方差估计
Boumard噪声方差估计算法建立在相邻子载波的信道衰落是相同的前提下，这样的 假设在慢衰落信道下是合理的，在慢衰落情况下，可以假设信道在频域上是缓慢变化的。 Boumard算法是在MIMO-OFDM系统上提出的一种信噪比估计方法。后人也将该算法 推广到SISO, SIMO系统中。当信道时延扩展较小时，频域上相邻子载波上的信道响应 可以近似相等，Boumard算法即建立在这样的假设前提下。
LTE系统接收信号可以表示为：
Ym(k) = Hm(k)sm(k)+N(k)	(4-7)
其中匕(蜀表示天线m上第k个子载波的接收参考信号，幻表示天线m上第k 个子载波的信道响应，s,“(A)表示发送参考信号,N表示高斯白噪声,k表示于载波索引。 用接收参考信号乘以发送参考信号的共辄，用下式表示
寫 k)s，k) = H *)s ”(k)s*) + N	(48)
Ym (S l)s； (S1) =	(k -1)4 (k-l) + N(k_l)s； (SI)	'
在本文中我们研究的参考信号是ZC序列，满足自身共粧相乘为1。即
(丿) = ]['.，.	(4-9)
Boumard算法假设在k和k-1子载波上的信道响应近似相等，因此将两式相减得到：
Y“(k)s，k) - YJk — l)s：(S 1) = N(k)s：(k) - N(S l)s；(S 1)	(4-10)
等号两边信号的功率的均值可以表示为：
硏％(炊；(幻-臨 Sl)s；(Sl)|2}
=硏”(幻s泌)-*Sl)s；(Sl)|2}
=EMN(k)s*) - N(k 一 l)s：。_ 1))(7V(幻島。)-N(k -	}	(队】)
=研”妙泌)|2} + 硏 |N(S l)s； {k -i)|2}
-E(N(k)s：(k)s：(k_l)N? -1)} -E{N(Sl)s：侦 -l)s：(k)N("
=E(|W)|2) + 网N(Sl)f} = 2ct2
然后利用式4-6计算系统平均信噪比。
上式中第三步，假设发送的参考信号与信道的高斯白噪声是相互独立的，才有
研网幻《(幻|2}=研四"}的推导。同样利用ZC序列正交性质，消除相邻子载波上的相关功率。
该方法建立在慢衰落信道情况下，在频率选择性衰落信道下，相邻子载波的信道冲 击响应不能简单近似相等，因此性能较差。
基于DFT的信道探测
基于DFT的噪声估计利用时域信道冲击响应长度小于系统循环前缀长度的特点， 将频域通过LS信道估计得到的频域信道冲击响应（CFR）进行IFFT变换到时域，时域 的信道冲击响应全部集中在一段采样点中，认为采样点之外的即是噪声。
接收端信号用式4-7表示,LS信道估计表示为接收端信号与发送参考信号共轴的乘 积。
如⑴=「(幻=HO.闵s,；(k) + N(k)s,；(k) = H,,,(k) + N(k)s,：(k)
其中恥诉）是LS频域信道估计值，Hn（k）是实际信道频域冲击响应。从上式中可 以看出，LS信道估计没有考虑噪声影响，在信噪比较低时，噪声影响大，LS性能较差。
然后将LS信道估计通过IFFT变换到时域，信号能量集中时域的首尾两端，可以理 解为信号集中在时域的“低频”部分（0和N-1附近），而噪声分量是分布在整个时域 上的，可以理解为分布在整个时域“频段"上。
利用时域信道冲击响应不大于循环前缀，将L长度之后的采样点看做噪声。
农(〃)== /?(〃) + 〃(〃)
“DFT (”)=
将如时（〃）用FFT变换到频域得到基于DFT的信道估计值HDFT（k）o
-般情况下，L取该符号的CP长度，但是实际多径信道多是非整数点采样，多径 能量会泄露到整个时域采样点上。在信噪比较高的情况，信号也向噪声区域泄露。许多 改进的DFT算法保留时域信道响应的尾端信号，实际信道情况下，时域最大值并非突 变过程，在最大值周围同样存在有效信号【28】，因此很多基于DFT信道估计算法保留时 域首尾两端信号，并在多径能量集中区域设置去噪门限人，达到去除信号区域的-部分 噪声的目的。

预估噪声功率为:

(4-15)
通常情况下，设置去噪门限为；1 = 2。；，即在时域信道相应的前L长度和后L长度
中将能量小于去噪门限的信号置0,看做噪声去除。因此改进的DFT时域信道有如下表 示：
如*)= <
0,(?e[0,Z,-l]o[7V-￡,#-l])chLS(w)< A hLS(n),others
(4-16)
这样通过去噪的DFT算法的hDFT{ri）进行FFT变换到频域HDFT（k）B因此基于DFT
的噪声方差估计可以表示如下:
艺=r ￡万注（幻$（幻一瓦初■（幻S。） aN 钉\	1
1 — 2L
a
N
(4-17)
信噪比按式4-6计算。
基于虚子载波扩展的信道探测
经典DFT估计在CFR边缘会出现估计不准的边缘效应㈣。文献[15][29]中提出的- 种基于虚频域信道冲击响应扩展的信道估计，将CFR进行扩展，使得由于DFT信道估 计中出现的边缘效应落在扩展子载波上，有效减少了边缘效应对CFR估计的误差，同 时在频域加窗函数进行平滑滤波因此信道估计更加准确。

图4-1 DFT信道估计的边缘效应
虚子载波扩展的频域信道冲击响应的估计流程如下：
1）虚子载波扩展
将长度为N.的LS信道估计进行虚子载波扩展H^r（k）,扩展的虚子载波的
长度为使得扩展后频域信道长度为大于心的2的最小次幕，这样可以采 用FFT替代DFT变换到时域。将虚子载波添加到频域首尾两端，做到使扩展处 信道系数连续变化。因此用百"左右边界值产生线性的虚子载波信道系数， 用下式表示
疗E（幻=丸3“）+ 寺（乱（0）-庞（皿））/ = 0,1?5『1	（4-18）
* * wr
虚子载波扩展过程如下，将生成的线性虚子载波分成两截接在方置两端，这
样在扩展点的信道系数仍能保持平滑连续。
频域加窗处理
频域加窗处理有助于信道信息能量集中，同时对添加的虚子载波进行平滑滤 波冋。
%) = 0.8+0.2* cos
经过频域加窗平滑之后的，其结果用式表示如下，其中育expsd。)表示经过 虚子载波扩展后的信道频域响应。
Hw.n (■) = H^and (沪何* = 0,L W_1	(4-20)
3)变换到时域
经过VCFR拓展之后，CFR的点数由Nac变为M, M为与添加的虚信道 冲激响应丿Vvc的和。加窗处理之后需要通过一个离散傅里叶反变换将频域信道冲 激响应编程时域的信道冲激响应，其表达式如下：
A	A	,	、
hwi?(k) = IDFT(HwiR(k)),k = 0,1-■■Nac + Nvc~l	(4-21)
4)时域去噪。
由于对频域信号进行了扩展，因此在时域变换域，信道冲击响应集中的区域 较原来的循环前缀的长度有所扩展。采用等效的CP长度表示信道时域冲击响应 集中的采样点。
r	z_r ，-. 160	、
妬“ cp_B = (Ng + Nvc)x赤於	(4-22)
采用差异化去噪策略完成去噪步骤之后，CFR用第咖表示，去噪过程数学 表达式如下：
2
hyVin(Zr)	k = 0,1 …I^cp 次一】,力助力(&) >Threshold}
hdeno = ' "w” (")	~	- 晶皿…ac + N、，c) - 1	(4-23)
a p
and hwin (Aj > Threshold!
0	others
文献［29］中分析，在CIR的前端区域的信号有效径较尾端多，且集中了较多 能量较小的信号，因此对首尾两端信号集中区域进行去噪釆用不同的策略。 77/g所如 表示首端去噪门限，用下式表示。

Threshold =件正伽砂冲膈辺 / Maxpo^rnoise < 5。	皿”
Maxpowernoise, others
Threshold!表示尾端去噪门限。
Threshold?. = 2 勇	（4-25）
5）	去噪后的CIR做DFT转换，同时完成去除窗函数和添加的VCFR。
去噪处理后，需要将CIR变回频域，并去除之前加窗函数影响，完成DFT 转换，并去除窗后，可表示为：
斉"*） =庞广阵。9））归-1,阵0,1...心 + 斗-1	（4-26）
完成去窗操作后，去除两侧添加的VCFR,即得到最后的频域信道冲激响应 估计值*k）。
6）	计算基于虚于载波扩展的信噪比。
噪声是分布在整个频带上的，在VCFR信道估计中噪声去除的比例大致是
接收信号的口 = 1-（一.縁）2x.V*如,因此利用VCFR的噪声方差估 Ng + N、，c Nac + Nvc
计可以用下式表示

信噪比按式4-6计算。
比例系数a可由下图所示过程得到。VCFR信道估计中窗函数的的作用是平 滑滤波，并当IFFT变换到时域时，信道响应更集中在时域低通部分。窗函数还 要在最后变换到频域时去除。为计算渐变，在计算比例系数a时不考虑窗函数 对噪声的影响。
LS信道估计中分布着噪声分量，经过在两端补充虚于载波信道相应后，频
域扩展。因此频域噪声分量是时域的芸"时域去噪中主要噪声来自’‘中
带"，因此剩余土^牛苛3声分量；变换到频域，噪声重新分布
与整个频带，当去除虚子载波时，剩余（""…y/x'esexp呷噪声分量。 戏+电 N/N*

因此去除的噪声分量大致是説茅倍。




频域冲击响应长度

图4-3 VCFR噪声处理流程
4.2.2仿真结果及分析
为了评估利用上述算法进行信噪比估计的性能，本文利用SRS进行信噪比估计，并 在不同SRS长度，不同信道模型下进行了仿真验证。
设计如下仿真参数：
表4-4 SRS信噪比估计仿真参数设置
仿真参数	仿真值
系统带宽	20M
信道模型	EVV70HZ, EPA5HZ
SRS带宽（长度，子载波数）	192, 576

下图了给出了 EVA70,系统带宽为20M, SRS为192个子载波长度下，釆Boumard怎 算法，DFT信道估计和VCFR信道估计进行信噪比估计的性能仿真。图例中VCFR表 示利用VCFR中滤除噪声的比例系数a进行信噪比估计的结果。可以看出利用VCFR信 道估计得到的信噪比与理论值相当接近。




图4-4 SRS长度为192, EVA70信噪比估计性能
从图中可以看出SRS长度为192个子载波，EVA70信道情况下利用VCFR信道估 计求噪声方差算法的性能较接近理论值。Boumard's算法和简单DFT算法的性能在高信 噪比时估计的噪声方差较大，使得信噪比估计值偏小。


图4-5 SRS长度为576, EVA70信噪比估计性能


图4-6 SRS长度为576, EPA5信噪比估计性能
在实际信道条件下，多径信道并非是整数点釆样，多径能量会泄露到冲击响应的所 有釆样点上，尤其在高信噪比情况下，信号能量泄露严重，因此利用DFT信道估计得 到的噪声方差估计值更大，因此DFT算法的信噪比在高信噪比处误差较大。同时高信 噪比下会出现天花板效应。
4.3本章小结
本章重点关注利用SRS进行信噪比估计的测量。并简要介绍了 Boumard's噪声方差 算法，利用DFT进行信道估计的算法，重点介绍了 VCFR信道估计算法以及去噪比例 系数的计算。最后仿真验证算法性能，分析得到利用VCFR以及考虑去噪比例进行噪声 方差估计可以很好接近理论值。

第五章PUCCH与SRS在DSP上的实现
5.1TMS320C6670多核DSP和开发环境
5.1.1TMS320C6670芯片简介
DSP实现釆用德州仪器TMS320C66X数字信号处理器(DSP),该系列内核不仅为 C64x+指令集架构(ISA)带来了显著的性能提升，同时还在同一处理内核中高度集成了 针对浮点运算的支持。该C66x DSP的ISA同时支持单精度和双精度浮点操作。C66x DSP每个局域L1存储器均为32KB,局域L2存储器是高达1MB的统一存储器，并 具有高效的共享存储器执行效率。

图5-l:C66x芯片结构
TIC66xDSP芯片同时支持定点与浮点运算，能以两种模式逐条处理指令，不但可
以取消从定点到浮点运算之间的高成本，还是得开发人员在高性能器件上实现高精度运
算㈣。
5.1.2CCS5开发环境
CCS(Code Composer Studio)是TI公司DSP的集成开发环境(IDE),具有支持TI 系列设备的编译环境，以及环境配置、源代码编辑工具、代码调试工具、可执行代码生 成工具、跟踪、实时分析和仿真等一系列功能OH。
CCS5是基于Eclipse开源软件开发框架搭建的集成开发环境oEclipse开源框架通过 插件组建构建开发环境，因此DSP开发者不仅可以在TI公司的CCS集成开发环境上进 行DSP开发，也可以编写自己需要的插件安装到CCS上。
对于多核DSP芯片，CCS5提供多核全局断点的添加，以简化DSP开发流程，同 时支持条件断点和硬件断点的添加。CCS分析器能够在调试和开发过程中交互式对代码 性能进行分析，能够在代码优化过程中分析函数及应用程序的cycle数，为开发者提供 代码性能数据及分析图表。
5.2PUCCH检测接收单核DSP实现的详细设计
在前面章节中，详细介绍了 PUCCH的数据符号和参考信号的发送，详细阐述并推 导了基于优化的GLRT的PUCCH接收端检测接收算法。在这一基础上，本节给出 PUCCH在DSP实现的细节。
PUCCH整体实现框架如下图所示。
在符号3中断到来时，计算ZC序列的相关参数，包括PUCCH映射物理资源位置， ZC序列组号，ZC序列循环移位等参数。然后即可以在每个符号中断处理中，通过查表 得到的ZC序列对接收信号进行去ZC相关操作。


图5-2: PUCCH单核DSP实现任务分配
如果PUCCH传输格式是2/2a/2b,经过Reed-Muller编码和QPSK调制后的调制复 数序列需要经过Gold码的加扰。在符号6到来时，进行Gold扰码产生和调制成复制序列的操作。
在符号13中断到来时，己经得到了两个时隙所有信息，进行PUCCH检测接收操 作，获得ACK/NACK, CSI等信息。
5.2.1 ZC序列参数计算模块
在符号3到来时，eNodeB已知PUCCH所有小区及用户配置信息，可以根据本文
在2.2章节介绍的内容计算PUCCH中ZC序列的组号“（冬），循环移位撰）以及。以及
PUCCH映射的RB位置。其中组号u和循环移位ncs（ns,l）是小区级参数。并不需要在每 帧的符号3到来时计算。如果高层重新配置了小区参数，则更新组号和循环移位两个参 数。
表5-1： ZC序列相关参数计算模块函数描述
函数原型	void eNBRxPucch_NcsNocCal(TsIdx, siibtrmBufldx)
函数输入	函数参数	Tsldx：时隙号
subthnBufldx：缓存索引
全局变量	PucchNCellCs：指向PUCCH所有符号用到的循环移位的指针，参考式2-2
UlSubFrmlnfb：指向子帧参数信息结构体的指针
UlPhyRLIntb：指向用户链路级信息结构体的指针
函数输出	全局变量	PucchU： ZC序列组序号
PucchNcs：指向PUCC1I匕ZC序列的循环移位数组的指针
S_ns：指向fonnatl/la/lb h控制信息的时隙扰码数组的指针，参考式2<
PucchPRBIdx：指向PUCCH映射RB位置数组的指针
返回值	无

5.2.2去除ZC相关及子载波合并模块
该模块实现在4个符号终端处理中，将接收数据与ZC共轴序列相乘，去除ZC序 列的影响。并将12个子载波解相关后的信号进行合并。
下表给岀了该模块的函数描述。

表5-2:去ZC相关模块函数描述
函数原型	void eNBRxPucch_ZcDeCorr(TsIdx, SymNo, subfrmBufldx)
函数输入	函数参数	Tsldx：时隙号
SymNo：符号数 subfirnBufldx：缓存索引
全局变量	FRONTOUT_POOL_ANT1:天线］解前端输出
FRONTOUT_POOL_ANT2:天线2解前端输出
UlSubFrmlnfb：子帧配置信息
PnPhaseTable：指向PUCCH的ZC基序列元素在PnElemTable表上的索引
PnElemTable： ZC基序列的组成
PucchNcs：指向ZC序列循环移位数组的指针
CsTable：指向ZC序列的相位数组的指针
PucchPRBIdx：指向PUCCH映射RB数组的指针
函数输出	全局变量	PucchZCedDatal；指向天线1上PUCCH域去ZC相关后信号数组的指针
PucchZCedData2：指向天线2上PUCCH域去ZC相关后信号数组的指针
返回值	无

该模块处理流程图如下:


图5-3:去ZC相关模块处理流程

5.2.3格式2/2a/2b加扰调制模块
该模块主要实现发送序列的加扰调制功能，扰码由gold码产生函数生成，数组 RMTable存储UCI经RM编码后序列，将QPSK调制后的I路和Q路符号存表，用数 组QPSKTable存储。通过査表得到CSI的调制后序列。
表5-3: CSI加扰调制模块函数描述
函数原型	void eNBRXPUCCH_ScnnbMod(UCILength,subfrmBufIdx)
函数输入	函数参数	UCILengthiUCI 长度 subfnnBufldx：缓存索引
全局变量	RMTable：指向UCI序列RM编码之后的数组的指针
QPSKTable：指向组成QPSK四个相位的数组的指针
函数输出	全局变量	ModCode：指向经过调制的控制信息数组的指针
返回值	无

5.2.4 PUCCH检测接收模块
PUCCH检测接收模块计算流程：
该模块实现在符号6和符号13到来时进行PUCCH检测接收计算。符号6到来时, 已经接收到完整的时隙。的数据。加扰调制模块已经得到发送端调制符号，可以对第一 个时隙进行PUCCH检测操作。当符号13到来，接收到完整的时隙1的数据，进行第 二个时隙的检测接收处理。
下表给出了 PUCCCH检测接收模块的函数描述。
表5-4: PUCCH检测接收模块函数描述
函数原型	void eNBRxPucch_DTXDetection (DataInl,DataIn2, PucchDtxDetPara, PucchDtxFlag,DataOut)
函数输入	函数参数	Datalnl：天线1上去ZC相关后的PUCCH域数据
Datalnl：天线2上去ZC相关后的PUCCH域数据
PucchDtxDetPara：模块控制信息参数，包括UCI长度，时隙号，缓存索引等成员
全局变量	UlSubFrmInfb：指向子帧信息结构体的指针
ModCode：指向经过调制的控制信息数组的指针
函数输出	全局变量	PucchDtxFlag：标识格式1/la/lb上DTX的标志位
DataOut： PUCCH上承载控制信息
返回值	无

该模块实现流程如下:


5.3 SRS检测接收单核DSP实现
本文在DSP平台上实现SRS的检测接收，得到信道的信噪比。SRS主要划分参数 计算和信噪比估计两个模块，分别在符号3到来时和符号13到来时处理。参数计算模 块负责在做信噪比估计之前判断当前子帧是否有用户发送了 SRS,并计算SRS长度和 子载波映射位置的计算。如果没有用户发送SRS,则无需进行信噪比估计。本文设计在 符号3到来时，进行小区子帧判断和用户级子帧判断。如果存在用户发送SRS,在符号 13到来时，可以得到用户发送的SRS信息，进行信噪比估计。
本文将参数计算模块分为三个子模块，分别实现小区级SRS子帧判断、用户链路级 子帧判断，以及SRS长度和子载波映射位置计算。三个模块依次利用上一个模块的计算 参数。
下图给出了 SRS时序及模块设计。


图5-5 SRS单核DSP实现模块划分及流程

5.3.1小区级子帧偏移判断及參数计算模块
该模块实现小区级子帧判断及SRS后续所需的小区级参数的计算。该模块只需在小 区建立或者重新配置了小区参数时调用。并保存该小区SRS配置子帧信息及相关参数。
下表给出了该模块函数描述
表5-5:小区级子帧偏移判断及参数计算函数描述
函数原型	void eNbRxSRS_CellFrameParamCal(UlPhyCellInfb, DICpType)
函数输入	函数参数	UlPhyCelUnfb：高层配置小区级参数
DICpType：下行循环前缀类型
全局变量	subConfigtable：全局变量，指向子帧配置表的指针，标识上行下行还是特殊子帧
SRSsubConfigtable：指向SRS子帧配置表的指针
函数输出	全局变量	UlPhyCelUnfb： UlPhyCelUnfb结构体中非高层配置的小区级SRS相关参数
CellSRSFrame：小区级的SRS子帧
返回值	无
判断流程如下：
1）	根据小区指定LTE上下行配比参数判断该子帧是上行子帧，下行子帧，还是特 殊子帧。只有上行子帧和特殊子帧会传输SRSo
2）	根据小区指定参数SRS子帧配置及式判断当前子帧是否是小区配置SRS子帧。
3）若该子帧既是上行子帧或者特殊子帧又满足步骤2,则用户在该子帧可能含有 SRS,将子帧对应数组CellSRSFrame下标置1。
5.3.2用户级子帧偏移判断及参数计算模块
判断用户在当前子帧是否传输SRS,还需判断用户级SRS子帧配置。可以表述为， 用户级配置的SRS子帧和SRS传输周期需分别是小区级配置子帧及周期的子集和倍数。 才能满足用户真正配置了 SRS的要求。该模块在上一模块的基础上进行用户级别的SRS 子帧判断，最终要得到每个用户在一个无线帧上可能配置SRS的子帧。
表5-6:用户级子帧偏移判断及参数计算函数描述
函数原型	int eNBRxSRS_RI,ParainCal(RadioFraineNuni7 SubP'ranieNum)
函数输入	函数参数	RadioFraineNurn：无线帧号
SubFrameNum:子帧号
全局变量	UffhyCelUnfo：高层配置的小区级参数
ULPhyRLInfo：高层配置的用户链路级参数，用以计算SRS用户参数和判断UE在当前子帧 是否发送SRS
SrsUserlnfo：用户SRS相关参数
函数输出	全局变量	SrsFramelnd；全局变量，用户在无线帧的10个子帧上是否发送SRS的标识
返回值	Rlflag：指示SRS是否在当前子帧发送

5.3.3 SRS子载波映射位置及长度计算模块
LTE在上行子帧的最后最后一个SC-FDMA符号上传输SRS,本模块负责计算子载 波位置和SRS长度以供后续SRS信道探测模块中取出SRS信号。
表5-7: SRS子载波映射位置及长度计算函数描述
函数原型	void eNBRxSRS_SCIdxCal(UeMId, SubFrameNum, RadioFrameNum, SrsUserlnfo, SRSBufldx)
函数输入	函数参数	UeMId：用户 ID
SubFrameNum：子帧号
RadioFrameNum：无线帧号
SRSBufldx： SRS缓存索引
SrsUserlnfo：全局变量，指向用户SRS参数的指针
函数输岀	全局变量	SrsScIdx： SRS物理资源映射起始子载波
SrsLength：用户 SRS 长度
返回值	无

5.3.4 SRS信道探测模块
本文SRS实现信道探测统计信号平均功率和信噪比两个参数。釆用虚子载波扩展信 道估计及相应噪声估计算法进行信噪比探测，得到信号平均功率和信噪比两个信道测量 值。VCFR信道估计算法中FFT运算通过调用TI的FFT协处理器(FFTC)来实现，FFTC 通过读取配置寄存器的参数来配置是运算FFT还是IFFT, FFT/IFFT点数，是否包含循 环前缀，幅值缩放模式，FFT/IFFT补零等参数。
信道探测模块计算流程如下：

图5-6: SRS信道探测流程


表5-8给出了 SRS信道探测模块的函数描述：
表5-8: SRS信道探测函数描述
函数原型	void eNBRxSRS_SRSMeasure( ns, SRSBufldx, PhyMacUIC hanCsilnd)
函数输入	函数参数	ns：时隙号
SRSBufldx： SRS缓存索引
全局变量	SreUserlnfb；全局变量，指向用户SRS参数的指针
SrsScIdx： SRS物理资源映射起始子载波
SrsLength： SRS 长度
函数输出	函数参数	PhyMacUlChanCsilnd：指向包含SRS测量结果的结构体的指针
返回值	无
5.4 DSP实现正确性验证及时间分析
5.4.1 PUCCH实现的正确性验证及时间分析
本文对PUCCH格式1, la, lb以及格式2, 2a, 2b分别配置多组测试用例。利用 Matlab仿真平台解前端处理得到两根天线物理资源块的信息，流入到DSP平台，按照 PUCCH单元划分的符号分段处理解前端数据。通过将Matlab平台各模块的输出与 PUCCH各个模块结果进行比较以覆盖功能模块。
为验证DSP平台实现的正确性，在每个模块进行测试，将Matlab仿真平台模拟的 定点化模块输出与硬件平台输出进行比较。下图给出了两个平台符号3到来时4个符号 长度为12*4的天线0的去ZC相关之后的数据，比较时将Matlab仿真平台的去ZC相 关的复数数据实部与虚部分离，同时比较实部和虚部。星型点为Matlab仿真平台数据， 空心圆点为DSP模块输出，基本吻合。验证了 DSP平台定点化处理的正确性。



图5-7:符号3去ZC相关模块DSP平台与Matlab仿真平台输出比较
本文分别在符号3,符号6,符号10,符号13到来时分块处理PUCCH数据，也依
次设定运行时间的测量节点。
去ZC相关和子载波
syml3 —	好 合并
苻号行时间	‘
图5-8:时间统计节点说明
表5-10给岀了 PUCCH格式la发送IbitACK和格式2发送4bitCSI两个测试用例
在各个符号间隙的运行时间及检测接收结果：
表5-1(): PUCCH运行时间统计
用例配置	Sym3	Sym6	SymlO	Syml3	检测结果
Casel:格式：format I a 控制信息长度：Ibit 控制信息：l(ACK)	6.775us	11 244us	6.577us	9.664us	1
正确检测IbitACK
Case2：格式：format2 控制信息长度：4bit 控制信息：0110	6.678us	27.578us	7.591us	26.783us	0110
正确检测4bitCSI

5.4.2 SRS实现的正确性验证及时间分析
下图给出了 SRS长度为192个子载波的测试用例1的DSP平台和Matlab仿真平台 的VCFR信道估计输出的比较，从图中可以看出，两者相差不大。从而证明DSP平台 的正确性。

图5-9: SRS长度为192子载波DSP平台和Matlab仿真的VCFR输出
SRS只位于指定子帧的最后一个符号，如果是UpPTS,可能存在于子帧的最后两个 符号中的一个或两个。因此只需提前计算好SRS所需参数，在符号13到来时进行信噪 比估计即可。下表给出SRS检测的DSP实现的运行时间，给出两个测试用例的运行时 间及信噪比检测结果，包括前期参数计算和信噪比估计两部分。
表5-11: SRS运行时间统计
用例配置	Sym3	Syml3	检测信噪比
Casel：子帧号：3, SRS长度192, SRS映射子
载波位置：408,信噪比：10dB	6.047us	254.547us	9.23dB
Case2：子帧号：1 （特殊子帧，uppts）, SRS长 度96, SRS映射子载波位置：49,信噪比：5dB	5.816us	220.776us	Matlab： 6.5 IdB

5.5本章小结
本章介绍了 TMS320C6670多核芯片的架构，存储层级划分及其开发环境CCS5。 并详细的给出了 PUCCH及SRS的DSP实现的任务划分及模块功能，介绍了各模块的 函数原型以及函数输入输出。给出了两个信道DSP实现的时间分析，验证了工程实现 的可行性。
第六章总结与展望
6.1论文工作总结
本文首先介绍了移动通信系统LTE的发展演进过程，然后提出本文研究内容——物 理上行控制信道以及探测参考信号的背景技术知识，包括PUCCH的控制信息和参考信 号的生成及物理资源映射方法，SRS的生成及映射资源映射，并介绍了 SRS的子帧配 置。
接着重点介绍了 PUCCH的检测接收算法，着重介绍PUCCH传统基于FHT的RM 译码接收算法，半盲检测算法以及GLRT检测接收算法。基于FHT的RM检测接收算 法依赖于有效的信道估计和准确的RM译码两部分的性能，并通常利用复杂度低的LS 信道估计算法实现前一部分。而半盲检测和GLRT是依赖于假设的检测接收算法，需要 在接收端遍历所有可能发送序列。基于GLRT的检测接收算法可以在计算过程中进行信 道冲击响应和干扰噪声方差的最大似然估计，属于中间变量，从而降低最终检验值的计 算量。GLRT算法充分考虑PUCCH在两个时隙上跳频的特点，对两个时隙干扰噪声水 平不一致的情况下进行干扰噪声的估计。本文还给出了 GLRT检测接收算法的优化，在 检测性能和计算复杂度上有一定的提升。同时对PUCCH的三种检测接收算法在Matlab 平台上进行了仿真验证。最后在这基础上利用TI多核DSP平台实现了物理上行控制信 道和探测参考信号的检测接收。在本文第四章，介绍了针对SRS的检测接收算法，主要 是利用SRS进行信噪比估计。给出了 Boumard、基于DFT和基于VCFR的信噪比估计。
最后第五章给出了在TI多核DSP平台上PUCCH和SRS检测接收的实现，介绍 了两个信道的实现方案和流程。
6.2 未来展望
本文主要研究了利用GLRT进行PUCCH的上承载的HARQ反馈以及CS1的检测。 本文在讨论基于GLRT的检测时将HARQ反馈以及CSI独立开。在格式2a/2b上,PUCCH 同时承载CSI和HARQ反馈信息，对这样的情况，本文没有使用Matlab仿真验证GLRT 算法性能。后续可以将CSI检测后作为已知数据信息，进行迭代的信道估计，从而对承 载的HARQ反馈的符号均衡检测，也可以HARQ反馈和CSI信息同时进行GLRT比检 验。
本文针对SRS给出了利用VCFR信道估计和信噪比估计的方法，并在最后给出了 VCFR算法去除的噪声的比例系数，修正了噪声估计性能。

参考文献
[1]Stefania Sesia, Issam Toufik, Matthew Baker,LTE-The UMTS Long Term Evolution From Theory to Practice, New York: John Wileys& Sons Inc,2009
[2]丁源.TD—LTE的发展概况[J].科技风,2009, 12期(12).
[3]赵训威,3GPP长期演进(LTE)系统架构与技术规范[M].人民邮电岀版社,2010.
[4]蓝俊锋,LTE融合发展之道.人民邮电出版社,2014.
[5]Erik Dahlman, Stefan Parkvall, Johan Skold and Per Berning. 3G evolution: HSPA and LTE for Mobile Broadband[M]. 2nd ed.2008 Elsevier Ltd. ISBN: 978-0-12-374538-5.
[6]真才基.TD-LTE移动宽带系统.人民邮电岀版社,2013.
[7]Cui. T, Tellambura. C. Semiblind channel estimation and data detection fbr OFDM sytems with optimal pilot design[J]. IEEE Transcations on Communications, vol. 55, pp. 1053-1062, May 2007.
[8]Yilong Pang; Chunjing Hu; Tao Peng; Deping Lin; Yinxin Wang, nPoster: An optimization based on semi-blind detection fbr LTE PLJCCH format 2,” in Communications and Networking in China (CHINACOM), 2014 9th International Conference on , vol., no., pp.656-657, 14-16 Aug. 2014
[9]Hu Yang, Astely.D. Semi-Blind Multi-User Detection for LTE PUCCH[C]. IEEE. Wireless Communications and Networking Conference, pp. 1-5, April 2009.
[10]Yi Wu; Danev, D.; Larsson, E.G., "Improved Detection of ACK/NACK Messages in the LTE Uplink Control Channel,M in Vehicular Technology Conference (VTC Spring), 2012 IEEE 75th , vol., no., pp.1-5, 6-9 May 2012
[11]Wu Y, Danev D, Larsson E G. On ACK/NACK messages detection in the LTE PUCCH with multiple receive antennas[C] Signal Processing Conference (EUSIPCO), 2012 Proceedings of the 20th European. IEEE, 2012:994-998.
[12]Kang, Y.; Kim, K.; Park, H., "Efficient DFT-based channel estimation fbr OFDM systems on multipath channels," in Communications, IET , vol.l, no.2, pp. 197-202, April 2007
[13]Huang, G.; Nix, A.; Armour, S., "DFT-Based Channel Estimation and Noise Variance Estimation Techniques fbr Single-Carrier FDMA,” in Vehicular Technology Conference Fall (VTC 2010-Fall), 2010 IEEE 72nd , vol., no., pp. 1 -5, 6-9 Sept. 2010
[14]Sandrine Boumard. Novel noise variance and SNR estimation algorithm for wireless MIMO OFDM systems[C]. GLOBECOM 2003. IEEE, 2003, vol. 3: 1330-1334.
[15]Chong Ma; Tao Peng; Zhonghua He; Muhua Chen, "An improved channel estimation method for LTE PUSCH," in Communications and Networking in China (CHFNACOM), 2014 9th International Conference on , vol., no., pp.52-57, 14-16 Aug. 2014
[16]3GPP TS 36.211 V9.I.0 (2010-03), Evolved Universal Terrestrial Radio Access (E-UTRA); Physical channels and modulation (Release 9)[S],
[17]3GPP TS 36.213 V9.3.0 (2010-09) Evolved Universal Terrestrial Radio Access (E-UTRA); Physical layer procedures (Release 9)[S].
[18]王天孜.基于GPP的LTE PUCCH和SRS的发送与接收实现[D].北京邮电大学,2013.
[19]李小文，邓雪梅，倪鑫，等.LTE-A系统PUCCH传输分集信道估计算法[JJ.重庆邮电大学学报： 自然科学版,2015,27(3).
[20]陈发堂，何坚龙.LTE系统中Reed-Muller编译码算法[N].重庆邮电大学学报,2010.8,Vol.22,N0.8.
[21]F Yang. Soft-decision decoding of Reed-Muller codes based on simple multi-stepSISO module[J].IEE Proc.-Commun 2005, 152(2):144-150.
[22]吴湛击，吴伟陵.3GPP中的Reed_-Muller编译码算法㈤ 电子学报,2005, 01期⑴J47-149.
[23]3GPP TS 36.212 V9.4.0 (2011-09) Evolved Universal Terrestrial Radio Access (E-UTRA);
67
Multiplexing and channel coding (Release 9)[S].
[24]Hu Yang, Astely.D. Semi-Blind Multi-User Detection for LTE PUCCH[C]. IEEE. Wireless Communications and Networking Conference, pp. 1-5, April 2009.
[25]李道本.信号的统计检测与估计理论.科学出版社,2004.
[26]3GPPTS 36.104 V9.13.0 (2012-09) Evolved Universal Terrestrial Radio Access (E-UTRA); Base Station (BS) radio transmission and reception(Release 9)[S].
[27]庞亦龙.TD-LTE系统PUCCH检测接收算法的研究与实现[D].北京邮电大学,2015.
[28]邱石.LTE系统中基于SRS的信道探测技术研究[D].武汉理工大学,2013.
[29]马崇.TD.LTE上行信道估计算法研究与实现[D].北京邮电大学,2015.
[30]DSP,基准测试，浮点性能.德州仪器最新TMS320C66X DSP实现业界最高定点与浮点性能卩].电 脑与电信,2010,第 12 期(11):78-78.
[31]尹勇.DSP集成开发环境CCS开发指南.北京航空航天大学出版社,2003.


