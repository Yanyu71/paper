第一章绪论
1.1	Zigbee无线传感器网络概述
随着研究的深入和技术的不断进步，无线通信技术由于本身具有的动态自组织、低 功耗等特点，逐渐取代了有线通信技术，实际应用范围越来越广泛。无线传感器网络是 一种新型的无基础设施的无线网络。传感器节点收集监测各类用户需求数据，并利用内 嵌处理器对数据进行一定处理之后，通过无线信道传输给用户。随着互联网概念的兴起， 万物皆可连通。物联网成为当前的一个热门概念。而无线传感器网络自身特性与物联网 概念匹配度高，在国际上越来越受关注。
无线网络按照网络结构可以分为具有基础设施的网络(Infrastructure-based networks) 和没有基础设施的网络(Infrastructureless networks)两大类。卫星通信系统和蜂窝移动 通信系统等是有基础设施网络的典型例子。这类网络的特点是具有固定的基站，基站之 间通过有线的方式相连，网络中的基站作为业务控制的核心设备，负责与终端设备进行 通信，完成数据收发；由移动交换机进行全网路由的管控。然而，具有固定基础设施的 网络的布置往往会受到地理因素、经济条件和能源供给的限制，无法实现全球的无缝覆 盖，如果已经建设好的基础设施因为战争、灾难、恐怖袭击等原因遭到破坏，通信网络 将陷入瘫痪。人们对一种能满足随时随地通信的网络需求日益高涨。于是，作为固定基 础设施网络的补充，自组织网络应运而生。在一定程度上弥补了固定基础设施移动通信 网络的不足。
自组织网络，又称为Ad hoc网络⑴⑵，是由具有无线通信能力的终端构成的动态自 治网络。与具有固定基础设施移动的无线网络相比，自组织网络的优势在于节点可以通 过动态自组织，在没有任何中心控制节点的情况下，快速完成网络的构建过程，网络健 壮性高、抗毁性强。自组织网络与其他移动通信网络的最根本区别在于，所有节点地位 平等，无需外力干预，通过自身的相关协议和算法即可完成网络组建和运行。自组织网 络中的节点既担任通信终端，向邻居节点发送和转发分组数据；同时又是路山设备，负 责发现和维护到其他节点的路由。自组织网络的短板-无线通信距离限制，也可以通过 多跳通信予以解决。无法直接通信的节点通过网络中的其他节点转发数据消息，通过多 次转发，最终到达目的节点。将自组织网络通过网关接入到有线网络，使自组织网络成 为当前有线网络的外延，适应更多更复杂的场合。总之，自组织网络是一种独立于固定
1
基础设施，自行组建网络的，作为有基础设施网络补充的多跳无线通信网络。
自组织网络与有线网络和其他有固定基础设施的无线网络相比，具有以下特点mi：
(1)网络的自组织性
自组织网络与传统的蜂窝移动网络的根本区别就在于它可以在随时随地自由组网。 节点根据自身的网络自组织原则，自动探测网络的拓扑信息，根据当前网络实际状况选 择路由。当网络发生动态变化或出现异常，自组织网络中的节点可以相互协调，改变当 前网络拓扑，保证通行的可靠性。
(2)动态拓扑
自组织网络自动组建网、无基础设施、通过无线信道传输信息。无线信道是相当不 稳定的信道，信息传播条件会受其他信道、地形、用户当前的速度和方向影响，无时无 刻不在发送改变。网络的拓扑结构也会随之动态改变。
(3)信道容量受限
自组织网络釆用无线信道，而无线频谱资源相对于有线通信要紧缺的多，另外考虑 到无线信道的竞争碰撞、多径衰落、噪声干扰等特性，实际的带宽将小于理论上的最大 带宽值。所以根据香农信道容量公式，信道容量与带宽成正比，自组织网络的信道容量 受无线信道带宽影响，传输速率不会很高。
(4)多跳通信
自组织网络的短板-无线通信距离限制，也可以通过多跳通信予以解决。无法直接通 信的节点通过网络中的其他节点转发数据消息，通过多次转发，最终到达目的节点。多 跳通信一方面降低了网络节点的发送数据包所需要的信号发射功率，降低了节点的能耗; 另一方面由于节点发送功率有限，通信距离较短，冲突检测可能会出现错误，导致隐蔽 终端的出现。
(5)分布式运作
自组织网络中具有去中心化的特点，各个节点的地位平等，不需要控制节点。因此 自组织网络采用分布式的控制和运作方式，能够有效分摊网络风险，具有很强的健壮性。
(6)终端功能简单
自组织网络中的终端，如手机、平板电脑等，由于制作成本的限制，处理能力有限， 难以进行复杂运算，给通信协议的设计带来了一定的困难。而且，依靠电池供电的移动 设备如果能量耗尽，将对网络的连通性和拓扑结构将造成影响。
(7)有限的安全性
无线网络由于采用无线信道，网络设备通常暴露在室外条件下，没有中心控制节点， 对于网络攻击的防御能力相对有线网络而言较弱。攻击者可以截获无线信道中的信息， 对数据进行窃听或修改。常见的安全性攻击手段有拒绝服务、数据欺骗、第三者转发等。
ZigBee技术作为自组织网络的一个重要的子研究方向，受到了国内外各类组织和科
2
研机构的关注，在最近几年得到了长足的发展。在最近几年中受到国际各科研单位及民 间组织的重视及追捧，发展极其迅速。ZigBee无线传感器网络是一种低速率短距自组织 网络。传感器节点收集监测各类用户需求数据，并利用内嵌处理器对数据进行一定处理 之后，通过无线信道传输给用户。Zigbee网络由于自身的低功耗、低速率、低成本、易 操作等特点广泛应用于智能家居、工业控制等，在人力难以企及的场合，例如远程医疗、 大气土壤环境监测、高危场所的遥感测控等许多领域都有重要的科研价值和巨大实用价 值[7]o IEEE802.15.4制定了 Zigbee的物理层和介质访问子层的相关内容。Zigbee联盟在 此基础上推出了网络层和应用层标准。目前Zigbee协议已经日趋完善，被公认为传感器 网络领域的最具有影响力和发展潜力的技术之一。
1.2 Zigbee网络研究现状分析
随着物联网概念的兴起和无线网络技术研究的发展，大规模无线网络覆盖已成为人 们日常生活中不可或缺的一部分。Zigbee技术由于自身的低功耗、低速率、低成本、易 操作等特点，适合大面积进行网络的铺设。是大规模无线网络覆盖的关键基础设备之一。 已经被各大厂商广泛应用于智能家居，工业控制，传感器网络等领域。被认为是当前国 际上备受关注的、新兴前沿研究的热门技术。
Zigbee无线传感器网络理论和应用的研究也从各个角度飞快发展。在硬件设计领域， 欧美各国投入了大量人力物力研制新型芯片。在协议层面，由摩托罗拉、飞利浦等厂商 发起的Zigbee联盟和IEEE802.15.4工作组负责制定修改Zigbee协议。2014年Zigbee 联盟拟将推出最新的Zigbee3.0无线连接标准。该版本统一了过去为各式装置提供的不 同Zigbee标准，主打各应用间的高互通性，并强调其低功耗、安全的资料传输特性，为 庞大的物联网装置打通连结管道，让消费者和企业能无缝接轨地提升产品及服务品质同。 国内外的科研院所和高校也不断改进相关的路由技术、节能技术、覆盖控制技术和网络 安全。包括平面型路由的代表——定向扩散(Directed Diffusion, DD)路由协议和信息 协商路由协议(Sensor Protocol for Information via Negotiation, SPIN)卩可；分级层次型 路由的典型代表按需距离矢量路出协议(Ad Hoc On-demand Distance Vector Routing, AODV)和簇树协议，以及它们的各类改进协议。在加密算法也有诸多成果，例如混沌 加密算法、代理加密算法等新算法为网络的安全性提供了更多的保障。这些不断涌现的 研究成果为Zigbee无线网络的进一步发展奠定了更坚实的基础。
1.3	论文内容安排
1.3.1论文工作内容
Zigbee传感网络通过无线方式传送数据，终端传感器多用于人不方便或不可达的地 方，如自然灾害检测、危险区域远程测控等。因此网络的健壮性是衡量Zigbee网络的一 个重要指标。本课题通过对Zigbee网络健壮性影响因素的分析，从节点管理的角度入手， 针对这些影响因素进行算法和协议机制的改进，从而增强整个网络的健壮性。
本文的研究受某国防科研项目支撑，该项目主要目标是研究和实现具有高安全性和 强健壮性的无线自组织传感器网络，该网络能够在隐蔽的环境下安全、稳定、可靠地工 作。为了实现网络强健壮性的设计目标，一方面要求网络的能耗水平较低，能够在没有 人工干预的条件下长时间的工作。一方面要求网络的安全性要有一定的保障，同时网络 还应具备对各种故障的自我修复能力。
项目依托Zigbee技术完成网络协议的设计，之所以在众多自组织网络协议中选择了 Zigbee技术，是因为在Zigbee联盟厂商的大力推动下，Zigbee技术经过几个协议版本 的演变已几近成熟，许多低成本的Zigbee软硬件资源可供使用。
本文的主要工作内容围绕通过节点管理提高Zigbee网络的健壮性进行研究和实现 展开，主要包括以下几个方面：
1）	通过对Zigbee簇型网络的路由选择算法LEACH进行改进，在针对节点分簇的 簇头选择过程中引入簇平均能耗、节点位置、通信距离等影响因素，选择最优 节点作为簇头，降低整个网络的能耗，延长整个网络的生命周期。
2）	在采用LEACH路由的簇型网络基础上，进一步考虑对离网节点的密钥进行管 理。针对Zigbee协议中离开密钥管理机制的漏洞进行完善，创新性地提出分级 网络密钥更新机制和链路密钥反激活机制，有效防止密钥泄漏，增强网络的安 全性。
3）	由于Zigbee协议栈简单，对于异常节点的自我修复机制相对薄弱。而异常节点 的自我修复也是网络健壮性的重要方面。协调器是整个Zigbee网络的核心节点， 一旦协调器出现异常，整个网络的通信将受到极大影响，甚至瘫痪。本文通过 提出一种具有备份协调器的协调器异常检测及切换机制，降低了协调器异常对 整个网络的影响。
通过以上的一些节点管理机制，整个网络的能耗降低，生命周期延长，同时密钥安
4
全性得到进一步保障，异常的自我修复机制更加完善，从而提高整个网络的健壮性。
1.3.2论文组织结构
本文共分为六个章节，各章节的内容安排如下。
第一章“绪论”。首先从Zigbee无线网络的基本概念、特点、应用场景、关键技术 等方面概要性地阐述本文的研究背景。其次介绍本文的主要工作内容，在介绍论文工作 的同时阐述课题背景、研究目的、研究方法等。最后介绍论文组织结构和各章内容安排。
第二章“Zigbee网络健壮性影响因素分析”。首先深入分析Zigbee协议，阐述了 Zigbee无线传感器网络的相关概念。其次从多个角度分析Zigbee网络健壮性的影响因 素，并对可能的改进方向进行简单介绍。
第三章“基于节点能耗均衡的优化路由算法研究”。这一部分单独用一章的篇幅研 究基于节点能耗均衡的LEACH优化算法。分析在实际场景下广泛应用的LEACH算法 的原理和优缺点。针对网络健壮性对低能耗的要求，对LEACH算法进行改进。在簇头 节点的选择算法中，将原来的纯随机选择改为引入多个因素综合考虑，選一步均衡网络 节点的能耗，延长网络的生命周期。然后利用M/TLAB进行算法仿真，验证改进算法 的性能。
第四章“离网节点密钥管理改进机制”。根据上一章的研究结果，利用簇型网络本 身需要将信息发送到簇头节点进行统一处理的特点，将网络密钥划分为两级：内部网络 密钥和公共网络密钥。针对Zigbee协议中离开密钥管理机制的漏洞进行完善，创新性地 提岀分级网络密钥更新机制和链路密钥反激活机制，有效防止密钥泄漏，增强网络的安 全性。并将新的网络密钥更新机制与传统更新机制相对比，证明同等条件下分级网络密 钥更新机制带来更少的网络开销。
第五章“协调器冗余备份机制”。为了实现网络强健壮性的设计目标，网络还应具 备对各种故障的自我修复能力。其中协调器作为网络的核心节点，一旦失效将会引发整 个网络的瘫痪。本章介绍了一种新的协调器异常检测和备用切换机制。利用在线重编程 技术，设立备份冗余协调器。并在Microchip公司的ZigbeePro协议栈上的基础上进行 实现。同时利现有的协调器冗余备份机制做对比，说明了该方案的优点。
第六章“总结与展望”。对论文的研究、实现与仿真工作进行总结，梳理完成论文 过程中用到的方法、体现出的创新点以及暴露岀的不足。针对还需要改进的地方和可能 的新研究课题，展望论文完成后的下一步工作。
5
(C) 1994-2022 China Academic Journal Electronic Publishing House. All rights reserved.
第二章 Zigbee网络健壮性影响因素分析
2.1概述
网络健壮性现在已经成为衡量网络性能的一个重要指标。狭义的网络健壮性反映网 络在故障发生时和发生后保持通信服务质量的能力［24】。广义的网络健壮性反映整个网络 的稳定性，包括网络的生命周期、网络的异常处理机制、自我修复能力以及整个系统的 抗攻击能力等多个方面。本文主要探讨广义的网络健壮性。本章首先对Zigbee系统的网 络拓扑结构和协议体系进行介绍。其次深入分析影响Zigbee网络健壮性的因素，讨论并 提出了一些改进网络健壮性的基本思路。
2.2Zigbee无线网络协议
随着科学发展和社会进步，人们的交流不断扩展加深，对于近距离通信的需求FI益 增大。这样就出现了低速率无线个人区域网络(LR-WPAN, Low Rate - Wireless Personal Area Network)的概念□ Zigbee是它的一个简称oZigbee的名称正如其中所包含的“bee”, 与蜜蜂息息相关。蜜蜂发现食物，可以通过ZigZag的独特飞行模式向其他蜜蜂传递相 关信息，包括地理位置、方向和大致距离等四。这种通信方式和自组织网络十分类似。
Zigbee技术作为一种个人区域无线通信技术，具有许多自己的特点。首先，Zigbee 传输速率较低，主要应用于对网络吞吐能力要求不高的无线连接场合。一般来说Zigbee 设备的空中接口传输速率主要有250kb/s、40kb/s、20kb/s三种Hi】。
在通信机制方面，为了确保数据的可靠传输，Zigbee引入了 CSMA-CA接入模式、 保证时隙和完仝应答三种机制。如图2-1, Zigbee网络用信标帧(Frame Beacons)同步 设备，每个信标帧主要包含竞争接入期(CAP, Contention Access Period)和非竞争期(CFP, Contention Free Period)组成，设备在CAP必须使用载波检测多路接入CSMA-CA机制 竞争通信，而CFP划分成多个保证时隙(GTS, Guarantee Time Slot),供设备独享信道。 在网络中传递数据和命令帧，接收方如成功接收必须返回一个应答帧予以确认"I。


图2T Zigbee信标帧结构

在组网方面，Zigbee设备支持16bit的临时网络地址和64bit的IEEE扩展地址，网 络可容纳的最大设备数量分别为216和2“个，可以构建大规模网络。
在设备能力方面，Zigbee技术支持设备的低功耗、能量检测和链路质量标识能力。 此外，为了进一步提高网络中传输的数据安全性，Zigbee技术采用了长达128位的加密 算法，对传输的数据进行加密。
2.2.1网络拓扑结构
根据不同的应用场景需求，Zigbee设备可以构造星形、对等和簇型网络这三种拓扑
结构（图2-2）

图2-2 Zigbee网络拓扑结构

在星型拓扑结构中，网络的核心设备为中央协调器。网络中两个节点不能直接通信， 需要依靠协调器进行数据的转发。由于所有通信都要经过协调器，一旦节点增多，协调 器负荷将急剧上涨，故星型网络仅适合小型网络使用。
8
点对点对等拓扑中节点通信能力一样，地位平等。所有节点都可以直接相互通信、 同时所有节点都可以进行路由发现和消息转发。节点通过路由发现，可以通过多跳路由 的方式与网络中任何节点通信。
簇型网络是点对点对等拓扑的一个特例，也被称为混合型网络。点对点对等拓扑适 合大型网络。但是当网络结构变大之后，设备需要存储大量的路由表，对设备能力要求 较高，实际使用中通常采用簇型网络的拓扑结构囲。在簇型网络中，簇头设备是全功能 设备（FFD设备），其他半功能设备（RFD设备）作为非簇头节点连接到某个簇中，利 用簇头节点进行通信。每个簇都有自己的簇标识（Cluster Identifier, CID）。邻近设备发 送广播帧，邻近设备受到该广播后最简单的簇型网络是一个单簇网络，即一个星型网络， 如果多个邻近簇相连就可以构成更大的簇型网络。
2.2.2 Zigbee协议体系
Zigbee协议规范体系结构（图2-3）基于标准开放网络互连（OSI）七层协议模型， IEEE802.15.4 I作组负责物理层（PHY）和媒体接入控制层（MAC）的标准化工作卩可， Zigbee联盟负责制定网络层（NWK）和应用层（APL）协议闽。其中Zigbee设备对象 （ZDO）可以和多层进行交互，负责对整个设备层面的操作进行管理。各层之间通过服 务节点传递数据服务和管理服务进行交互。



(1)物理层
IEEE802.15.4定义了两个不同频段的物理层：低频段物理层包括868MHz欧洲采用 868MHz的低频段物理层，美国、加拿大等国家在915MHz的低频段物理层进行採作。； 高频段物理层工作于2.4GHz,为全世界所通用。物理层还监控无线信道的状况，控制 无线发射机状态、对信道进行评估和选择、发送和接受数据等。
(2)MAC层
Zigbee协议栈的MAC层使用的无线信道接入模式为CSMA-CA冲突检测模式，它 的职责包括传输信标帧、保持整个网络的时钟同步和保证通行的可靠性【23】。
MAC层位于物理层之上，网络层之下，处理信道接入相关内容。保证网络同步、 接入信道和网络、维护GTS机制，保证端到端的可靠通信。
(3)网络层
Zigbee网络层处理与网络相关的功能内容。主要负责节点网络接入和离开过程、利 用网络层密钥对数据进行加密，最重要的是负责消息的转发。网络层通过一系列原语完 成路由建立和路由发现过程，维护设备邻居表和路由表。同时也监控整个网络的通信情 况。Zigbee协调器还负责新建网络并在网络新建完成后，向新节点分配网络地址。
10
(4)应用层
Zigbee应用层包括APS, ZDO和AF三个部分。APS子层为应用支持子层，负责 维护设备绑定表。绑定表能够绑定具有逻辑关系的设备，使上层应用能够不关注具体设 备信息而实现消息的发送。ZDO负责与设备整体相关事务，包括设备的设备描述、设 备和服务发现、安全信息的管理等。AF是应用对象和Zigbee设备连接的环境，定义了 最多240个应用对象，端口标识从1到240,另外定义了两个特殊标识：0为ZDO数据 接口，255用于应用对象的广播数据接口，241-254保留作其他用途【22〕。
2.3	Zigbee网络健壮性分析
随着Zigbee网络的应用场合不断扩大。网络健壮性现在已经成为衡量Zigbee网络 性能的一个重要指标。健壮性又称鲁棒性，狭义的网络健壮性反映网络在故障发生时和 发生后保持通信服务质量的能力。广义的网络健壮性反映整个网络的稳定性，包括网络 的生命周期、网络的异常处理机制、自我修复能力以及整个系统的抗攻击能力等多个方 面。本文所讨论的健壮性主要是广义的网络健壮性。接下来将具体分析Zigbee网络健壮 性的一些影响因素。
2.3.1网络生命周期
作为新兴技术之一，Zigbee无线传感器网络已经广泛应用在不同的场合中，对人们 的社会生活产生了不断的影响。然而，低成本作为Zigbee网络的传统优势之一，直接导 致了终端传感器节点制作成本低，一般都具有体积小、能量有限的特点。而在很多应用 场景下，例如军事应用、矿产检测等，电池更换并不容易。因此，如何均衡网络能耗， 降低节点能量消耗，最大限度地延长网络生命周期成为增强网络健壮性的一大热门研究 方向。
常见的几种节能方式是通过对路由算法的改进，降低节点路由成本，选择优质路由； 根据网络结构，设立各种休眠机制，让节点保持长时间休眠，按需唤醒。例如基于节点 移动性的路由选择策略、基于跨层泛听和能耗均衡的混合路由算法、基于网格划分的休 眠算法以及很多Zigbee的芯片制作厂商都内置了节点休眠机制。
11
2.3.2攻击抵抗能力
Zigbee协议的安全服务由四个方面构成，包括密钥的建立和传输、设备管理和帧的 保护。这些安全服务作为安全体系的基本结构单元，对整个Zigbee网络提供安全保护。 其中对称密钥的保管决定了 Zigbee网络的安全等级。对安全架构的信任最终简化为对设 置安全初值，安装密钥材料的信任和密钥材料的安全处理和存储的信任。整个设备是开 放信任模式：通信协议栈的不同层和运行在单个设备上的所有应用相互信任。
这种开放信任模式允许在同一设备的不同层次结构之间重复使用同样的密钥材料， 默认为通信设备任意两层之间为信任关系，只考虑在不同设备之间实现端到端的安全。
这种简单的安全体系，一方面简化了 Zigbee协议栈的复杂度，另一方面也让攻击者 有了可乘之机。这种安全体系带来的危害主要在于利用认证接入过程的漏洞，强行加入 网络；破译网络加密过程，对帧内容进行窃取和修改；利用密钥管理漏洞，窃取安全密 钥。已有不少的研究者们对Zigbee协议栈进行深入的研究，分析可能的安全漏洞，对 Zigbee安全算法和认证过程提出自己的见解。同时Zigbee的低成本特点使得对节点设 备进行硬破解难度较小，密钥管理巳渐渐成为一个研究的热点。
2.3.3异常处理能力
从健壮性的狭义解释中就可以看岀，网络在故障发生吋和发生后保持通信服务质量 的能力是网络健壮性的重要构成部分。在实际的网络环境中，由于通信环境和设备运行 状态的复杂多变，及时检测网络中的异常状态，并进行自我修复十分必要。
Microchip提供的Zigbee Pro协议栈中就提供了信道异常切换机制。当网络中的节点 检测到当前信道环境不适合进行通信，通知协调器当前信道不良。协调器选择其他两个 节点再次检测自己的信道环境，如果结果一致，将发起信道异常处理机制，通知全网节 点进行信道迁移。
网络动态拓扑也是异常保障的一种方式。若网络部分被破坏或者信道发生变化，部 分通信链路失效，网络系统将自动调整网络拓扑结构，保障通信的连续。
2.3.4其他影响因素
除了以上几点，Zigbee网络的健壮性还包括很多其他的影响因素。例如从网络的单 个节点来看，系统网络的健壮性受限于节点的硬件处理能力和硬件资源。其中担任路由 转发功能的路由器节点作为网络的关键节点，一■旦路由器的内存无法支持域间路由系统 (Border Gateway Protocol, BGP),出现过载；计算能力不足，导致CPU过载；缓存
12
空间和计算能力不够，导致队列溢出等，将会导致会话中断和路由器发生故障，从而引 起通信的时延或者网络部分链路的堵塞，影响网络健壮性。
Zigbee网络还釆用了 CSMA-CA机制、帧应答机制和数据校验来提高数据传输的健 壮性。Zigbee信道有两种接入模式：信标模式和非信标模式。在非信标模式下，节点采 用非时隙CSMA-CA信道接入机制。若设备节点有数据需要发送，检查信道状况，等待 一段随机时间。随机等待时间后，将再次检测信道状况，如果信道空闲，进行数据发送。 若信道忙，则继续等待一个随机时间后再次尝试重新接入。在信标模式下，节点采用时 隙CSMA-CA信道接入机制。协调器周期性向网络广播信标帧，两个信标帧间隔有16个 同样的时槽，这些时槽被划分为休眠区和网络活动区两个部分。节点智能等待网络活动 去的时槽发送消息数据。节点若在竞争接入时期（CAP）传输数据，则需要申请随机退 避时隙号才能发送数据。信标模式周期性广播信标帧，网络中各节点利用信标帧进行同 步，保持休眠和工作的一致性，从而最大限度节省网络能耗。在非信标模式下，由于没 有信标帧进行全网同步，消息的发送时间是随机的，网络中的全功能设备路由器和协调 器只能一直保持工作状态。而中断节点不涉及路由的转发，可以定期进行休眠，以轮询 的方式向父节点请求数据。同时Zigbee还提供应答帧机制，对端设备在成功接收到发端 发送的信息帧后，根据信息帧的要求，决定是否发送应答消息。开启应答机制后，若发 送方在一定时间后仍未收到接收到的应答帧，将认为该次发送失败，重新发送数据或将 失败情况通知上层。数据校验机制则通过16bit ITU-T循环冗余校验码CRC来检验比特 错误31。
影响网络健壮性的因素还有很多，由于时间和精力原因，本文暂时不对这些因素进 行详细的展开。
13
第三章基于节点能耗均衡的优化路由算法研究
3.1概述
根据221, Zigbee的网络拓扑通常有三类：星型拓扑、对等网络拓扑和簇型网络拓 扑。在实际应用场景中，星型拓扑只适用于小型网络。对等网络之间任何两个对等节点 都可以通信，当网络规模变大，设备需要存储大量的路由表，对设备处理存储能力要求 较高。同时任意节点都具有路由功能，制作成本高，容易导致个别节点能耗过快而失效。 簇型网络拓扑平衡了两者的缺点，被广泛使用。故选择层次网络拓扑作为Zigbee健壮性 研究的切入点。Zigbee网络健壮性的影响因素中，网络生命周期是关键影响因素之一, 节能问题一直是学界的研究热点。故本章对Zigbee路由算法进行改进，从能耗均衡的角 度降低路由算法能耗，延长网络生命周期。
Zigbee无线通信路由协议共有两类：一类是平面路由协议，所有节点地位平等；一 类是层次路由协议，节点分为汇聚节点和普通节点。平面型路由协议所有节点都可以相 互通信，因此网络节点需要存储大量的路由信息来完成消息的发送和传递，不适合大型 网络使用。与之对应，层次路由协议被广泛使用于簇型网络中。其中低功耗自适应分簇 算法(Low Energy Adaptive Clustering Hierarchy, LEACH)是层次性路由的代表算法'切。
本章研究基于节点能耗均衡的LEACH优化算法。深入分析在实际场景下广泛应用 的LEACH算法的原理和优缺点。针X寸网络健壮性对低能耗的要求，对LEACH算法进 行改进。在簇头节点的选择算法中，将原来的纯随机选择改为引入多个因素综合考虑, 进一步均衡网络节点的能耗，延长网络的生命周期。然后利用MATLAB进行算法仿真， 验证改进算法的性能。
3.2LEACH算法原理
LEACH全称是“低功耗自适应集簇分层型协议”。该算法基本思想是：节点通过产 生随机数与自身阈值比较，小于阈值即当选簇头。不断循环选举簇头节点，保证每个节 点在一个循环中均担任过簇头，从而将网络负载分摊给每个节点，延长网络寿命仁七仿 真表明，与一般的平面多跳路由协议和静态分层算法相比，LEACH可以将网络生命周 期延长15%[29]o
14

LEACH算法中以循环方式进行簇的重构。簇内所有节点都担任过簇头节点为一次 循环。每次簇的重构过程称为一轮。每轮都会进行簇头的选举和稳定消息传输。考虑到 簇头选举过程带来一定程度上的网络交互，在每轮中稳定过程的持续时间相对较长。簇 的建立过程分为四个步骤：首先确定网络中的簇头节点，其次簇头节点向全网广播自己 的相关信息，然后普通节点选择簇头节点加入，最后簇头节点分配传输时间片四］。
每个循环中，未被选为过簇头节点的节点将会参与新的簇头节点的选举过程。每个 传感器节点生成一个大于0小于1的随机值。根据公式计算出当前阈值，将随机生成值 与阈值相比较，小于该值，则节点当选为簇头节点"I。

0,其他
其中，p为预期的簇头百分比（例如，p =0.5）, r为当前轮数，G是最近1/p轮 里没有成为簇头的节点的集合。
簇头节点一旦确定，将立即向全簇发送广播消息，告知网络当前的簇ID和自身地 址。网络中的其他非簇头节点收到广播消息后，比较信号强度，选择信号强度最大的节 点加入，簇头节点和普通节点的通信采用时分复用多址方式。
在稳定阶段中，非簇头节点将采集到的信息发送给簇头节点，由簇头节点对信息进 行汇聚和处理，并转发给整个网络的汇聚节点。一段时间之后，将有稳定阶段重新进入 簇的重构阶段。重复之前的步骤，直到选举岀新的簇头节点，完成簇的建立。在网络中， 同时存在着不同规模的簇，这些簇之间采用CDMA的不同码字来避免其他簇的通信干 扰。
众所周知，通信网络中能耗最大的过程在与数据的收发过程，远大于处理数据能耗。 LEACH协议中，非簇头节点将数据发送至簇头节点，由簇头节点汇聚处理后，统一发 送给汇聚节点，为其余节点节约了大量的能量。同时簇头节点被选举出之后，将进行全 网广播。其他节点根据收到初始化信息的信号强度，可以估测与簇头节点的距离，从而 调整自身的发送功率，以最小功率送达信号。最后，簇头节点和普通节点的通信采用时 分复用多址方式，每个节点有自己特定的传输时间点住］。当节点无数据需要发送时即可 进入休眠模式，也可以节约大量能量。
但是LEACH算法的簇头选择是随机的，而在一个簇内，如果节点剩余能源本来就
15 较少，再被选为簇头节点会进一步增大能耗，很容易导致能量耗尽从而失去功能。而簇 头节点的死亡将会导致整个簇的瘫痪。其次，LEACH算法假设所有节点都能和汇聚节 点通信，但网络其他节点距离汇聚节点的距离不同。离汇聚节点较远的节点如果被选择 作为簇头节点，则为了保证与汇聚节点的通信，节点必须加大发射功率，从而导致节点 的能量消耗急剧增加。
目前,许多研究者在LEACH算法的基础上进行了改进。例如Chandrakasan等人提岀 了一种基于设备节点自身能量的LEACH-F路由算法和一种集中式簇构造算法 LEACH-Co龙际珍等人对LEACH算法的簇头选举过程进行改进，综合考虑了节点在网 络中的位置分布，自身能量和整个簇的规模，动态选取助理簇头。除此之外还有基于非 均匀分簇的思想改进的分簇协议等。
3.3	基于节点能耗均衡的LEACH改进算法
通过上文分析，LEACH纯随机的簇头选择方式虽然算法简单，但没有对节点能耗 进行综合考虑。本节在原有算法基础上，提出一种改进算法。通过对整个簇内节点剩余 能量和簇内节点分布的综合考虑，选择合适的节点作为簇头，同时根据簇头节点距离汇 聚节点的位置，动态决定是否采用多跳传输，延长整个簇的生命周期。
3.3.1多因子簇头选择算法
每个循环中，未被选为过簇头节点的节点将会参与新的簇头节点的选举过程。具体 过程为：每个传感器节点生成一个大于0小于1的随机值。根据公式计算出当前阈值， 将随机生成值与阈值相比较，小于该值，则节点当选为簇头节点129］。阈值计算公式见式 3-10阈值一定，节点产生随机产生选择值，因此每个节点成为簇头节点的概率相等。 而实际上，由于节点在簇内距离不同，节点通信量不同，将会导致节点剩余能源出现差 距。而在一个簇内，如果节点剩余能源本来就较少，再被选为簇头节点会进一步增大能 耗，很容易导致节点能量耗尽从而失去功能。一旦簇头节点失效，整个簇通信将会瘫痪。 因此应该避免剩余能量少的节点被选为簇头备选节点。同时由于非簇头节点发向汇聚节 点的数据都由簇头节点转发。因此簇头节点应该尽量位于簇的拓扑中央位置，即与其他 节点的通信距离最短，可以节约整个簇的通信能耗。改进后的阈值计算公式如下：
16
E (r)
n v 7 x p
E
—	/GG
l-px[rmod(^/)]?
0,其他
其中Emax为当前簇内节点剩余最高能量。En（r）为在第r轮中还没被选作簇头节点的 节点当前剩余能量。在新的阈值计算公式下，节点阈值会随当前节点的剩余能量而改变。 剩余能量高的节点阈值大，被选为簇头节点的概率更高。
在节点进行完阈值匹配后，出现一批备选节点。计算当前网络平均能量E（r）o
硏，）=2鸵（「）	（3-3）
其中N为当前簇内节点数量。如果备选节点剩余能量小于而，抛弃该节点。
计算备选节点与其余簇内节点的通信距离。设节点位置坐标为（X,,匕），备选节点 平均通信距离以（〃）计算公式如下：
八（〃）=x,）2 +（kt）2,〃el	（3-4）
(3-5)
其中丄为备选节点集合，£>_.（〃）为备选节点到簇内任意节点，的距离。
比较各备选节点距离，按距离远近排序，距离越近的节点优先当选为簇头节点。
3.3.2动态簇间路由
Zigbee网络的节点发送数据能耗计算公式受节点距离影响，有自由空间模式和多径 衰减模式两种。当短距离发送时，采用自由空间信道模型；长距离发送时，采用多路径 衰减模型災）。网络通信的能量消耗公式为：

E^(d) = k • Eelec	(3-7)
该类层次网络通信的能量消耗为：其中发送数据能量消耗ETx(d)为发送*个比特 所消耗的能量。该能量跟距离Q有关，刁0为阈值距离。当d m"°时，发送模型为自由 空间发送模型，放大电路能耗系数为牛能量消耗与距离的平方成正比。当d^dQ时， 发送模型为多径衰落模型，放大电路能耗系数为能量消耗与距离的四次方成正比。 Eelec为发送和接受电路处理每个比特所需能量。
从上式中可以看出，能量消耗是和节点距离的指数次方成正比的。长距离传输的能 量消耗远大于短距离传输。而LEACH协议假设所有的簇头节点都需要直接向汇聚节点 转发收集到的数据，故远离汇聚节点的簇头节点的能量消耗将远大于靠近汇聚节点的簇 头节点，更容易耗尽能量。因此可以利用靠近汇聚节点的簇头节点剩余能量相对较多， 将簇头节点直接与汇聚节点通信改为多跳通信，利用近距离节点进行二次转发。在一定 程度上减少了边缘节点和中心节点之间的能量差距，对整个网络的节点进行能耗均衡， 延长了网络生命周期。
假设*聚节点的坐标为(X,,匕)。根据公式3-4,簇头节点到汇聚节点的距离为 ds(«) = yl(Xtl-Xs)2+(Yn-Ys)2 ,将/(〃)与阈值距离刀o比较，根据公式3-6计 算每个簇头节点发送数据到汇聚节点能量消耗：
点0)]-*姦我+虹寫0,,一星)4 + (匕_匸)4 + 2(¥一七)2化—匕)2](-)
计算整个网络的平均汇聚能量消耗：
2%叵(〃)]
琮 0S) =  	 (3-9)
n
当簇头节点发送数据到汇聚节点的能量消耗大于整个网络的平均能量消耗时，节 点采用多跳的方式传输数据。节点将本簇的数据发送给离自己最近的单跳簌头节点，山 单跳簇头节点转发数据至汇聚节点。
3.4 LEACH优化算法仿真结果
LEACH算法通过周期性地重新分簇，让节点轮流担任簇头，使得网络中节点均衡
18
消耗能量。但簇头节点将信息以单跳的形式传递给基站消耗能量大，并且没考虑到基站 附近节点的“热区”问题，即其附近簇头节点担负更多的数据转发任务耗费能量大，更 容易失效，造成网络能量消耗的不均衡。高效能非均匀分簇算法（Energy Efficient Uneven Clustering, EEUC）是一种非均匀分簇算法。EEUC算法通过计算每个节点的竞争半径来 划分簇结构在簇头选择阶段随机性的产生一些临时簇头，之后根据临时簇头的能量从中 选择最终的簇头。在簇建立阶段，EEUC算法让基站附近簇头节点形成更小的簇，离基 站远的簇头形成更大的簇通过这种非均匀分簇的方式降低了靠近基站的簇头节点能量 消耗解决了 “热区”问题，并且最终簇头将以多跳的形式将信息发给基站，延长了网络 的生存周期。
不过EEUC也有一些缺陷：
1）	算法的扩展性问题：
EEUC算法开始前需要计算网络中所有节点到基站的距离，并从中找到离基站最近和 最远距离来计算各节点的竞争半径，这影响了网络的扩展性.一旦加入的节点到基站的距 离最远或最近，或者删除的节点到基站的距离最远或最近，则所有节点都要重新计算各自 的竞争半径，并通过发送信息通知其它节点。网络通信代价大。
2）	“空洞”节点问题：
按照EEUC算法形成的网络存在一些节点没有任何簇可以加入。
3）	临时簇头选择问题：
在簇头选择算法上每个节点都以预先设定的概率参与竞选，没有考虑节点的剩余能 量。从而在选择的临时簇头中有一些节点能量不足，无法用它们传递数据。在最终簇头 的选取中无法获胜，导致产生的簇头不够均衡。
选取原始LEACH和EUUC算法作为对照，仿真参数设计如下：随机生成100个节 点部署在100m* 100m的正方形区域中。汇聚节点位于网络中心位置，坐标为（50,50）。 假设普通节点的初始能量为1J。发送和接受电路处理每个比特所需能量互血为 50nJ/bo自由空间模型下的放大电路能耗系数sfs^lQpJ/bit/m2,多径衰落模型 下放大电路能耗系数Smp^j5GpJ/bit/m4 0簇头比例为0.2。实验采用MATLAB进 行仿真。将原始LEACH协议、改进后的LEACH协议（以LEACH-X表示）和EEUC （Energy-Efficient Uneven Clustering, EEUC）协议进行对比。图3-1为以上三种算法的网 络生存周期比较：
19


图3-1节点网络存活时间比较
从图中我们可以看出，改进后的LEACH-X能够明显提高Zigbee网络的生存周期。 LEACH-X通过簇头选择过程的能量选择和距离选择，优先选择在簇内综合状况较好的 节点作为簇头；在稳定阶段，通过对整个网络簇头节点的传输能耗分析，采用单跳和多 跳相结合的方式，均衡了靠近和远离汇聚节点的簇头节点的能量差异，使整个网络的生 命周期延长。



图3-2节点剩余能量均值比较
20
为了更为直观的看出LEACH-X在能量均衡上的优化，比较以上三种协议的节点剩 余能量均值。从图3-2中我们可以看出改进后的LEACH-X节点剩余能量值一直高于 LEACH和EEUC协议，表明了 LEACH-X确实能够更为有效的节约节点能量。
0.014
0	100	200	300	400	500	600	700	800	900 1000
仿真轮数
图3-3节点剩余能量方差比较
图3-3比较了网络节点剩余能量的方差。方差越小，表明整个网络节点剩余能量差 距越小。从图中可以看出，LEACH的方差明显大于其余两者。而且LEACH和EEUC 的方差变动明显，反而LEACH-X 一直维持在一个相对平缓的范围内。之所以LEACH 和EEUC方差前期比较大，后期降低，是因为工作时间较短，节点存活数量多，剩余能 量多，因此方差随着轮数的增大而增大。到达波峰之后，网络节点开始渐渐耗尽能量， 部分节点已经失效，故方差又随着轮数增大而减小。波峰的发生轮数也和图3-1相吻合。 都是在网络存活节点开始下降时到达波峰。通过以上分析可以说明LEACH-X的能量均 衡性能最优。
21
第四章	离网节点密钥管理改进机制
4.1概述
Zigbee协议作为一种低成本低功耗的短距离无线协议，被广泛的使用在各类应用场 合。攻击抵抗能力成为影响网络健壮性的一个重要因素。由于协议栈较为简单，对称密 钥的保管决定了 Zigbee网络的安全等级。整个设备是开放信任模式：通信协议栈的不同 层和运行在单个设备上的所有应用相互信任。这种开放信任模式允许在同一设备的不同 层次结构之间重复使用同样的密钥材料，默认为通信设备任意两层之间为信任关系，只 考虑在不同设备之间实现端到端的安全。
Zigbee联盟和许多研究者已经在安全方面做了很多改进，但是对于网络的前向安全 仍然没有足够的重视。而Zigbee网络节点通常是低成本制造，抵抗物理破解抵抗力差。 一旦节点被攻击方获得，很容易破解存储在节点芯片内部的密钥资料。而目前的Zigbee 协议并未为节点的密钥管理作出的完善的规定。离网节点在离开网络期间，仍保有当前 网络的相关密钥资料，而Zigbee网络并不能监控离网节点的状态。一旦攻击者通过物理 破解或者其他方式获得离网节点内部存储的密钥资料，即可利用这些资料窃听消息甚至 伪装成离网节点重新加入网络。因此本文从节点管理的角度出发，考虑节点在离开网络 时的密钥管理机制。
在本章我们在前文利用LEACH算法构建的簇型网络的基础上，进一步提出了一种 基于Zigbee层次网络的密钥管理机制。这套机制包括网络密钥的更新和应用链路密钥的 删除两个部分。通过这两个步骤能有效的提高离开网络节点的密钥泄漏造成的危害。同 时验证该套密钥管理机制的性能，结果表明该套密钥管理机制的确能够在低网络开销的 情况下提升网络的安全性。
4.2Zigbee密钥系统介绍
Zigbee协议的安全服务由四个方面构成，包括密钥的建立和传输、设备管理和帧的 保护。这些安全服务作为安全体系的基本结构单元，对整个Zigbee网络提供安全保护。 整个设备是开放信任模式：通信协议栈的不同层和运行在单个设备上的所有应用相互信 任。这种开放信任模式允许在同一设备的不同层次结构之间重复使用同样的密钥材料，
22 默认为通信设备任意两层之间为信任关系，只考虑在不同设备之间实现端到端的安全。
Zigbee的整个密钥体系包括主密钥、密钥传输密钥、密钥加载密钥、链路密钥和网 络密钥。其中主密钥是执行对称钥密钥建立协议过程中使用的一个共享密钥。主密钥是 两个设备之间长期安全的基础，并可用于生成链接密钥；密钥传输密钥由链接密钥派生, 用于保护承载一个非主密钥的密钥传输信息；密钥加载密钥由链接密钥派生，用于保护 承载主密钥的密钥传输信息；网络密钥用于加密流出NWK的帧，也可以用于处理流入 NWK的帧；链路密钥是用于且仅用于两个设备对等应用层实体之间共享的密钥3］。
其中最重要的就是链路密钥和网络密钥。网络密钥共128个比特，全网设备都使用 同一个活动网络密钥。网络密钥主要负责对网络层信息和广播信息进行加密。而链路密 钥主要用于对等实体之间的信息加密。两个对等设备通过密钥协商机制，向信任中心请 求链路密钥，每一对对等节点共享同一个链路密钥。节点设备通过密钥运输、密钥建立 或预先安装来获得链路密钥；通过密钥运输和预配置来获得网络密钥〔35］。
Zigbee可以高层应用进行配置，选择加密方式。协议提供了一套在MAC帧上执行 的一系列安全操作，包括对称加密算法、模式和完整性比特长度。这些安全套件由一个 字节指定。节点根据字节标示符的值，采用不同的加密引擎和密钥资料对帧进行加密操 作。其中标识符0x00表示没有使用安全模式。
表 4-1 NLME-LEAVE. indication 原语参数
标识符	安全组件名称	安全服务
接入控制	数据加密	帧完整性	序列更新
0x00	None
0x01	AES-CTR	X	X		X
0x02	AES-CCM-128	X	X	X	X
0x03	AES-CCM-64	X	X	X	X
0x04	AES-CCM-32	X	X	X	X
0x05	AES-CBC-MAC-128	X		X
0x06	AES-CBC-MAC-64	X		X
0x07	AES-CBC-MAC-32	X		X

以下为采用密钥加密的Zigbee帧格式示意图:
23


图4-2应用层加密帧格式示意图
由于Zigbee网络的低成本特性，节点的制作简单，抵抗物理攻击能力薄弱。如果攻 击者获得了该节点的网络密钥和链接密钥，就能够监听整个网络的基础信息。同时由于 对端节点不知道该节点已经离开网络，仍保留有对应的链接密钥。攻击者可以伪装该节 点与其余节点进行通信，对网络安全造成较大损害。
4.3 多级网络密钥更新机制
本节提出一种新的多级网络密钥更新机制。该机制利用分层网络的特性，将网络 密钥划分为内部和公共网络密钥。在节点离开网络时X寸网络密钥进行相应的处理，来降 低密钥泄漏造成的危害。
4.3.1网络密钥更新缺陷分析
一般来说，当节点离开网络后不应该再对网络中传输的数据具有任何的处理权限。 整个网络的广播信息和NWK层信息都是通过网络密钥进行加密。然而现有Zigbee协议 并未在节点离开后更新整个网络的网络密钥。而所有的广播帧都是利用网络密钥进行加 密，一旦攻击者从离网节点处获得了网络的当前活动网络密钥，将能够窃听或者堵塞网 络。因此在节点离开当前网络后就立即更新整个网络的网络密钥能够有效的提高整个网
24
络的前向安全。然而网络密钥的更新是通过对全网广播网络密钥更新帧和密钥切换帧来 完成的。一旦网络规模较大，这些密钥更新广播帧在网络中的洪泛就将消耗大量的网络 资源，同时还可能会导致网络的拥塞。因此本文提出了一种基于层次网络特点的一种新 的网络密钥更新机制。该机制能够在消耗较少的网络资源来完成整个网络的网络密钥更 新，从而提高网络的安全。
4.3.2多级网络密钥方案设计
正如本文2.2.1所示，簇型网络目前的使用场景最为广泛，适合絶大多数大型网络。 簇型网络是以簇为基本单位，每个簇内的非簇头节点的数据都要先发送到簇头节点。簇 头节点对这些信息进行处理和汇聚后再转发。根据这种簇型网络的结构特点，本文创新 性地提出了一种多级网络密钥更新机制。
多级网络密钥将网络密钥分为两类：公共网络密钥和内部网络密钥。每个簇内都维 护自己的网络密钥；同时所有的簇头节点除了存储各自内部网络密钥之外还保留一个共 享的公共网络密钥。传感器节点直接使用内部网络迷药加密数据，而簇头节点负责整个 簇内的数据加解密。详细的处理过程如图4-3所示：
Cluster-head M如」receives Z)«ra.{Dst,Scr,Key;.}
If ( Dst W Cluster Rad ,{•} ), where Clusterhead ,.{•} means the set of
nodes in the cluster of N, J
head
If( Scr^Clusterhcad )
Transmit Datai directly to Dst
else
decrypt Data, with NKpublic , then set Keyi=NK.ilernal
encrypt Datai With Key.
Transmit Datai to another Nhead j,i h j
else
If( Scr ^Clusterheiid .{i})
decrypt Data, with NKinternaI , then set Key^NK^.
encrypt Datai With Keyj
Transmit Datai to another Nhead w j
else
Transmit Data, directly to Dst
图4-3分级网络密钥加解密过程伪代码
25
当一个非簇头节点离开网络时，公共网络密钥保持不变，只需要在簇内更新内部密 钥；当簇头节点离开网络时，在所有簇头节点间更新公共网络密钥，每个簇的内部网络 密钥保持不变。用INK代表内部网络密钥，PNK代表公共网络密钥。由是整个网络簇 头节点的个数。112是每个簇的节点数。多级网络的密钥更新过程如下图：
Trust center TC receives a leaving notification of node
IRN,. ^Nheads{i} ),where Nheads{9} means a set of cluster-head nodes in network
Generate a new PNKt
Broadcast PNK update frame {Public, PNK,. }in whole network
For i =1 to n；
Nheads{^} set PNK = PNKj
else
Broadcast INK update frame {Internal, clusterlD} in whole network
For i =1 to
If( i = clusterlD)
Generate a new INK,
Broadcast NK update frame in cluster
For i =1 to n2
setNK=WK,
else
Abandon frame
图4-4分级网络密钥加解密过程伪代码
这种分级网络更新机制利用簇型网络的通信信息需发往簇头节点的特点，将网络密 钥划分为两个层次：内部网络密钥和公共网络密钥。通过将内部网络密钥更新过程限制 在一个簇的范围内来减少网络密钥更新所需的帧数，从而减少网络资源的消耗。
4.4	链路密钥反激活机制
4.4.1节点离开网络缺陷分析
根据Zigbee协议，当一个节点离开网络时，将会由其他节点(如它的父节点)通知 信任中心该节点已离开网络。节点通过原语NLME-LEAVE.request来请求一个设备离开
26

网络。
表 4-2 NLME-LEAVE. request 原语参数
名称	类型	有效值	说明
DeviceAddress	IEEE地址	任何有效的
64bitIEEE 地址	从网络上移除的实体的64bitIEEE地 址。如果设备从网络上移除自身时，此 值为NULL
RemoveChildren	布尔类型	TRUE 或者
FALSE	如果被要求离开网络的设备同时被要
求移除它的子设备时，此参数为TRUE,
否则它的值为FALSE
MACSecurityEnable	布尔类型	TRUE 或者
FALSE	此参数允许高层控制MAC层的 SecurityEnable参数。如果已执行的网 络层能够正常地请求安全策略应用于 开销分离通知命令帧，此参数的值为 TRUE,即允许执行请求的安全进程， 值为FALSE即禁止它执行。如果已执 行的网络层不能正常地请求开销分离 通知命令帧的安全进程，此参数的值被 忽略
网络设备节点接受此原语后，且DeviceAddress不等于NULL,网络管理层实体判 断指定设备是否存在于它的邻居表里。如果请求的设备不存在，网络管理实体发出状态 为UNKNOWN_DEVICE的NLME-LEAVE.confirm原语。如果请求的设备存在，网络管 理层实体将试着将该节点从网络上移除。如果RemoveChildren参数为TRUE,设备将请 求也移除它的子设备。在移除之后，网络管理层实体发出一个NLME-LEAVE.confirm原 语，其DeviceAddress等于被移除设备的64bitIEEE地址。如果移除成功，Status参数为 SUCCESS,否则Status参数为LEAVE_UNCONF1RMED。最后，与移除设备相应的邻居 表关系域将被设置为0x03,显示无关系。信任中心将会删除该节点对应的路由表入口和 应用支持子层的映射表入口。
遗憾的是，Zigbee协议没有提及如何处理存储于对等节点的应用链接密钥。即是说, 离网节点的对等节点并未意识到该节点的离开。它们仍然保留着离网节点对应的应用链 路密钥。如果攻击者获得了离网节点内存储的应用链路密钥，他将能够窃听利用该密钥 加密的信息，甚至伪装离网节点同对等节点通信。
27
4.4.2链路密钥反激活方案设计
本节提出一种应用链路密钥反激活机制来避免该类威胁。当信任中心收到节点离开 请求后，它将删除自身存储的对应该节点的信任中心链路密钥。然后向全网广播该节点 的离开消息。收到该广播消息的节点将检查自身的应用链路密钥表。如果有对应表项存 在，将删除该链路密钥。链路密钥反激活流程如下图所示：

图4-5链路密钥反激活策略

在该模型中，链路密钥反激活机制一定程度上弥补了 Zigbee协议密钥管理的不足。 靠在节点离开后即时删除对应链路密钥，增强了网络密钥的安全性。
4.5	性能分析和验证
本节我们分析多级网络密钥更新机制的相关性能。在现有的网络密钥更新过程中， 信任中心将周期性广播携带新的网络密钥的密钥传输帧。半功能节点将直接切换成新的 网络密钥。全功能节点将存储该网络密钥，待收到信任中心广播的密钥切换帧之后再将 该网络密钥置为活动网络密钥。然后我们的分级网络密钥更新机制的帧数量只和簇大小 和簇头节点数量相关。
为了简化评估过程，将离网节点占整个网络节点的比例设为0.1。假设每个网纟各密
28
钥更新相关帧的开销一定。帧数量将能从一定成程度上反映网络资源的消耗。
图4-6中，我们比较了两种网络密钥更新机制。一种是现有的全网更新机制，另一 种是本文提出的分级网络密钥更新机制。假设每个簇大小一定，簇比例为0.05,即每个 簇的节点数为20o通过图像可以看出，分级网络密钥更新所需帧数量少于传统网络密钥 更新机制。随着网络数量的不断增大，差距将越来越明显。
. hierarchical update
—■B— tradition update
下图比较了离网节点中，簇头节点和非簇头节点占比不同的情况下，该算法的性能。 从图中我们可以看出，虽然在一开始资源消耗是和非簇头节点占离网节点比例成正比, 但是随着网络规模的不断增大，两者关系变为反比。这是因为，每个簇的规模一定，每 个非簇头节点的离开都会触发内部网络密钥的更新。在小规模网络里，内部网络密钥更 新的影响要大于公共网络密钥更新。而随着网络规模的增大，簇头节点增多，公共网络 密钥的更新将带来更多网络资源的消耗，相应簇头节点的离开会带来更大的影响。
29


从以上的分析结果可以看出，相比于Zigbee协议现有的网络密钥更新机制，分级 网络密钥更新机制大幅减少了密钥更新所需的网络开销。同时簇规模大小、网络规模大 小、簇头节点变动情况都是影响分级网络密钥更新的因素。在实际使用中，应根据不同 的应用场合和实际网络环境，调整簇和簇头比例，使网络开销尽量减少。
30
第五章协调器冗余备份机制
5.1概述
网络在故障发生时和发生后保持通信服务质量的能力是网络健壮性的重要构成部 分。在实际的网络环境中，由于通信环境和设备运行状态的复杂多变，及时检测网络中 的异常状态，并进行自我修复十分必要。为了提高Zigbee网络的健壮性，本章设计了一 种协调器冗余备份机制，描述了协调器失效情况下的网络自修复流程。设立冗余备份协 调器。冗余备份协调器是一种特殊的全功能设备，内部存储有两套协议栈。在网络正常 工作状态时，作为普通路由器进行工作。当网络协调器出现异常时，通过在线重编程技 术，将自身切换为协调器节点，支持协调器的所有功能。这样可以避免网络所有设备都 需要支持协调器功能，降低节点制作成本。同时考虑到实际应用场景中网络资源和能量 资源的有限，引入优先级机制，简化网络切换的协商和冲突过程，并将节点的掉网检测 与协调器异常检测相结合，减少网络异常检测和自我修复的成本
5.2协调器冗余备份必要性分析
Zigbee网络节点分为三类：终端节点、路由器节点和协调器节点。协调器节点负责 整个Zigbee网络的建立和管理，每个网络有且只有一个协调器。路由器节点作为一种关 联节点，主要负责数据的转发。终端节点执行具体数据的收集，通常作为子节点挂靠在 路由器和协调器之下，定时休眠，周期性向父节点轮询数据。
协调器作为网络的中心节点，除了负责数据转发，还负责整个网络的安全管理、设 备绑定管理。在信标网络中，还负责信标帧的周期性广播，其余节点根据信标帧决定数 据发送时刻。一旦协调器崩溃，整个网络将陷入瘫痪。而且在Zigbee的某些应用场景下， 如矿产检测、军事通信等，一旦协调器因为能量耗尽或是意外情况发生崩溃，进行人工 修复有一定难度。因此，在网纟各屮设置备份协调器，并能在协调器发生异常吋进行网络 的自我修复十分必要。
31
5.3 协调器冗余备份机制设计
Zigbee网络作为一种低成本低功耗的无线自组织网络，协议结构简单，节点处理能 力较弱。在设计网络冗余备份机制时，优先考虑机制的复杂度和开销。因此将协调器的 异常检测心跳帧和网络自身的休眠机制相结合。利用全网休眠帧需要定时周期由协调器 广播的特点，将异常检测字段包括在休眠帧中，减少额外的开销。同时由于节点需要定 时接受异常检测消息，将节点本身的掉网检测和协调器异常检测相结合，能够进一步增 强网络的健壮性。
5.3.1网络拓扑模型
本文的协调器冗余备份方案在协调器周围设立两个备用协调器。这两个备用协调器 在网络正常状态下作为普通路由器工作。当协调器失效后，将自动切换为协调器重建网 络。在备用协调器重建网络后，其余节点将全部迁移到新的重建网络中。同时在协调器 异常检测的同时，其余节点会定时检测自身是否掉网，若掉网将会重新加入网络，保证 通信的可靠性。
Zigbee是一种短距离无线通信协议，有效通信距离在lOm-lOOm之间。在协调器失 效后，其下属的备用协调器在失去协调器这个中继节点后，可能会由于无线通信距离的 限制，导致无法相互通信，从而拆分为两个独立子网络，形成网络独岛效应。为了避免 这种情况，需要保证两个备用节点处于最大通信距离之内，以保证在协调器失效的情况 下备用协调器仍能相互通信，经协商后重建一个完整的网络。具体网络拓扑设计如下：

图5-1协调器冗余备份网络拓扑图

在该拓扑条件下，协调器、备用协调器都要处于最大通信范围内。
5.3.2异常检测及切换方案
Zigbee网络作为一种低成本低功耗的无线自组织网络，协议结构简单，节点处理能 力较弱。在设计网络冗余备份机制时，优先考虑机制的复杂度和开销。
协调器定时向全网广播心跳帧。所有其他节点启用定时器Timerl,在一定时间内没 有收到心跳帧（暂设为连续三个周期均未收到心跳帧）即判断当前网络情况可能出现异 常。此时节点以单播的方式主动向协调器请求心跳帧，若收到应答，定时器归零，继续 正常工作；若未收到应答，则判断网络状态出现异常。
网络状态出现异常后，节点需要判断是否是自身掉网导致无法接收心跳帧。此时节 点向自身父节点请求心跳帧，若无父节点，则选择邻居表链路状态最优的邻居节点。若 收到邻居节点应答，则可判断协调器出现异常。未收到邻居节点应答消息，则判断为节 点自身掉网，按节点预先配置，启动重接入流程。该步骤创新性地将节点的掉网检测和 协调器异常检测相结合，利用一次心跳检测，对网络当前节点状况进行了双重检测，流 程设计简单，节约网络开销。
当备用协调器确认当前协调器发生异常之后，启动网络切换流程。将网络重建标志 位Flag_rebuild置为1。进入切换协商过程。以两个冗余备份协调器为例。在网络配置 阶段预设置备份优先級Coor Backup Level,此例中为0x00和0x01。设立一组原语用 于处理网络切换协商过程。首先备用协调器向对端备份协调器发送网络重建协商请求原 语 NWK_REBUILD_NEGOTIATION.request。
表 5-1 NWK_REBUILD_NEGOTLATION.request 原语参数
名称	类型	有效值	说明
DeviceAddress	IEEE地址	任何有效的
64bitIEEE 地址	原语发送设备自身的IEEE地址
CoorBackupLevel	BYTE	0x00~0xFF	请求协商的备份协调器的优先级

发送网络重建协商原语后，备用协调器启动定时器Timer2,等待应答。如果相应
的NWK_REBUILD_NEGOTIATION.confirm原语状态值为SUCCESS,将存储的网络备
份协调器信息的协商状态标记为TRUEo若所有优先级小于自己的备份协调器协商状态
33
均为TRUE （本例中为优先级为0x00的备份协调器），则向全网广播网络重建帧。否则 放弃重建。
表 5-2 NWK_REBUILD_NEGOTIATION.confirm 原语参数
名称	类型	有效值	说明
DeviceAddress	IEEE 地
址	任何有效的64bitIEEE地
址	经协商后，同意网络切换的备份协
调器IEEE地址
Coor Backup Level	BYTE	0x00~0xFF	同意切换的备份协调器的优先级
Status	状态	SUCCESS
INVALID_REQUEST
UNKNOW_DEVICE
NEGOTIATION„FAILED	相应的请求状态
设备在发送网络重建协商原语后，备用协调器启动定时器Timer2,等待应答。若规 定时间收到对端备份协调器的应答，则将Status置为SUCCESS；若协商请求发送失败， 则将Status置为INVALID_REQUEST；若DeviceAddress不匹配设备存储的网络冗余备 份协调器地址，将Status置为UNKNOW_DEVICE；若超时未收到应答，则将Status置 为NEGOTIATION_FAILED。当且仅当状态为SUCCESS时，备份协调器才会向全网广 播网络重建帧。为了保证网络中所有设备都能收到网络重建帧，设置重启时间T_Restart, 然后备份协调器重启并新建网络。其中T_Restart是备份协调器重启需要的时间。
在网络重建过程中，所有设备同时加入新网络，会带来协调器的处理压力，影响网 络的玉.常重建。收到网络重建帧的其他网络节点设备会随机等待一段时间T_Random再 启动网络接入流程。其中T_Random = T_Restart+X/10, X为0-100的随机数。
网络异常检测及切换方案流程如图5-2。
34


是.
count++, count>3
放弃重建流程，更
新T_Sleep
其他设备收到忡络
更建慎
等待 T_Restart, 再&诚避一段时 fuJGiK新加入网结
.否—►
继续正常工作
'■-疋-►
给PAN协调器单播
心跳帧
仝网广播网络重建 帧,设置重启时间
T_Restart
垂启，成为新的
PAN协调器
图5-2网络异常检测及切换方案流程示意图
35







































网络对端备份协调器在收到备用协调器发来的协商请求后，向上层递交网络重建协
商指示原语 NWK_REBUILD_NEGOTIATION.indication。
表 5-1 NWK_REBUILD_NEGOTIATION. indication 原语参数
名称	类型	有效值	说明
DeviceAddress	IEEE地址	任何有效的
64bitIEEE 地址	发起协商请求的设备的IEEE地址
Coor Backup Level	BYTE	0x00〜OxFF	请求协商的备份协调器的优先级
在收到该原语后节点进行判断。首先判断自身是否也在进行网络重建协商，即 Flag_rebuild是否为1。若不为1,则自身没有进行网络重建，发送协商请求应答帧；若 为1,则进行优先级判断。和自身优先级比较，若小于自身优先级字段值，放弃重建流 程，将Flag_rebuild置为0,并发送协商请求应答帧；若大于自身优先级字段值，则不 发送应答，继续自身的重建流程。网络备份协商机制流程如图5-3。

图5-3网络重建协商机制流程示意图

36
5.4	方案测试及评价
5.4.1实验环境搭建
上文中提出的协调器冗余备份机制仅仅是在Zigbee协议栈中增加了一组原语，来实 现网络异常检测和切换的过程，并不涉及到对协议栈整体框架的改动，而且消息的发送 也需要其他一些基本协议功能的支持，因此在已有的Zigbee协议软件的基础上进行开发。 本文选用的协议软件是Microchip Zigbee Pro。
Microchip Zigbee Pro是美国微芯科技股份有限公司(Microchip Technology Inc)根 据最新的Zigbee协议规范Zigbee2007推出的协议软件包。Zigbee2007定义了两种不同 功能级别的特性集，其中标准集是Zigbee,增强的特性集叫做Zigbee Pro。与Zigbee相 比，Zigbee Pro提供了许多增强的网络能力，并在某些条件下支持对Zigbee的兼容性。 在Zigbee Pro中加入的新特性包括：
•随机地址生成和地址冲突解决机制；
・大块数据的分段发送和接收聚合机制；
・支持跳频通信和动态信道选择；
・源路由和多对一路由机制；
・PANID冲突检测和解决机制；
・支持链路状态命令；
・启动属性集和非易失性存储特性；
・适用于高安全应用的主密钥交换机制。
・中心化的数据集中机制；
支持对MPLAB C编译器、PIC24系列MCU和MRF24J40 2.4GHz无线收发模块的 兼容性。
硬件设计采用 Microchip Explorerl6 开发板搭配 Microchip PIC24FJ128GA310 单片 机作为微控制器芯片。微控制器(MCU, Micro Control Unit)是整个系统的核心，除了 负责对系统进行控制外，其主要功能是承载Zigbee协议软件，实现完整的Zigbee协议 栈功能，包括全部应用层和网络层功能，大部分MAC层功能，和对物理层的配置。 Microchip PIC24FJ128GA310 单片机是一款 16 位的超低功耗 MCU,引入 nanoWatt XLP 技术支持器件深度休眠;采用改进哈佛型架构，拥有8KB数据存储和128KB程序存储； 内置支持整数运算的硬件乘除法器，最大工作性能可达16MIPSo以上特性提供了对运
37 行Zigbee协议软件的有力支持。
无线模块是Zigbee模块的无线信号收发装置，本系统采用了支持IEE802.15.4规范 的Microchip MRF24J40MC 2.4GHz无线收发器模块㈣，该模块集成了 IEE802.15.4基带 和射频电路，提供250kbps (Zigbee标准)和625kbps (加速模式)两种空口速率，用 硬件实现了 Zigbee协议MAC层组装解析协议帧、AES-128安全算法加密、CSMA-CA 机制、自动应答，和物理层差错编码、调制、扩频、能量检测等功能。此外还提供了对 功率控制功能的支持。
外部存储器采用Microchip 25LC1024电可擦除可编程只读存储器(EEPROM, Electrically Erasable Programmable Read-Only Memory)芯片冋，作用是存储 Zigbee 节点 启动属性集(SAS)和网络层邻居表等在设备重新启动后仍然保留的信息。该芯片拥有 1Mbit存储能力，与系统微控制器通过串行外设接口(SPL Serial Peripheral Interface) 相连，釆用3线模式，单片机可提供最大4MHz的采样时钟速率。无线模块与微控制器 也采用SPI连接。
5.4.2实验结果分析
方案测试包括以下四个步骤。
(1)协议软件植入节点硬件
首先在MPLAB X IDE vl.8开发环境中创建一•个新工程，将安装5.3节所示的方案 设计修改过的Microchip Zigbee Pro协议软件的文件导入到工程中，其中检测周期设置 为5s<>然后用Microchip C30编译器编译生成可下载到目标单片机中执行的.hex文件。
最后，用PICKit3下载调试工具将运行MPLAB X IDE vl.8的PC机与节点硬件系 统相连，点击“下载”按钮将协议软件下载到硬件中。
(2)Zigbee无线网络搭建
由于条件有限，本次测试只用5个节点组网。一个协调器，两个备份协调器，两个 路由器节点。按照正常网络建立模式进行组网。
(3)节点掉网检测验证
保持正常网络状态5min,再让其中一个路由器节点移出网络通信范围。保持该状态 20s (大于三次检测周期)，观察路由器是否能发现自身掉网。再将路由器移入网络正常 通信范围内，看能否进行网络重新接入。
(4)网络重建机制验证
38

重启网络，保持正常网络状态5min。再关闭协调器。观察备用协调器能否进行网 络重建，其余路由节点能否正常加入新网络。图5-4为掉网检测实验结果。

图5-4路由器掉网检测工作日志

从路由器工作日志中可以看出，路由器在初始加入网络后，能够正常收发数据。之 后检测到路由器掉网后，能够自动启动网络重接入流程，重新加入网络。在重新加入网 络后，能够正常收发数据。	-
图5-5为备份协调器进行网络异常检测和网络切换的实验结果图。从下图中可以看 出，备份协调器在网络正常工作状态下，能够以路由器的身份进行网络通信。一旦检测 到协调器发生异常，将启动网络协商切换机制。利用系统重载，将自身切换为协调器, 重新建立网络。
39

图5-5备用协调器网络切换工作日志

实验结果表明，利用该套协调器冗余备份机制能够及时检测节点掉网并能在协调器 失效时，自动完成网络的重建和节点的迁移过程。该机制能够让网络在故障发生后及时 自我修复，仍然保持通信服务质量，提高了网络的健壮性。
现有的一些协调器冗余备份机制需要主协调器持续给备用协调器发送心跳帧，一旦 备用协调器不能收到心跳帧，则判断主协调器失效，启动备份机制，切换网络。但是这 种方案没有考虑到当备用协调器自身出现异常，如处于掉网状态，此时若错误启动备份 机制将导致形成新的网络，影响原有网络的正常工作。本文中提出的方案有双重判断机 制，在初步判断主协调器处于异常状态后，会进行二次判断，尝试和邻居节点通信，检 査自身状态是否正常。当自身状态正常时才会判断主协调器异常，重建网络。相比之下 更为可靠。
同时现有的协调器冗余备份机制通常只设立了一个备用协调器，容错性不强。本文 引入了优先级机制，当存在多个备用协调器时能够进行自主协调，避免冲突。
同时该机制还具有以下优点：
(1)将掉网检测帧和休眠帧进行复用。利用网络原有的定时发送的休眠帧来检测 网络是否正常，减小网络开销。
(2)在关键判定条件下叠加了计数机制，增大检测次数，保证检测的可靠性。
(3)将节点本身的掉网检测和协调器异常相结合，分别进行不同的处理，减少误 判可能，保证网络通信稳定，进一步增强网络的健壮性。
40
(4)在网络重建流程中增加冲突检测和协商机制，设立优先级，以小成本进行网 络重建协商。同时其余收到网络协商请求的备用协调器，如果自身处于未检测到协调器 异常的状态，将发送应答，同时保持自身的Flag_rebuild为0 一段时间。这是为了防止 在发送应答帧后，立刻检测到网络异常，启动网络重建流程，造成冲突。
(5)所有节点在收到广播的网络重建帧后等待时间T_Restart加上一段随机时间后， 再重启并接入新的网络。重建等待时间T_Restart可以保证节点在备用协调器完成新网 络的重建工作后再接入新网络，降低接入失败的可能性。考虑到节点新加入网络时会有 大量的交互过程，在等待T_Restart后再多等待一段随机时间，使其余网络节点错峰加 入重建的网络。避免同时处理大量交互信息，减小网络处理负荷和可能的错误。
41
第六章总结与展望
6.1	论文工作总结
本文的主要工作内容紧密结合项目需求，针对Zigbee健壮性，从节点管理的角度提 出了一些新的技术和实现方案，主要包括以下几个方面：
通过对Zigbee簇型网络的路由选择算法LEACH进行改进，在针对节点分簇的簇头 选择过程中引入簇平均能耗、节点位置、通信距离等影响因素，选择最优节点作为簇头， 降低整个网络的能耗，延长整个网络的生命周期。
(1)在采用LEACH路由的簇型网络基础上，进一步考虑对离网节点的密钥进行 管理。针对Zigbee协议中离开密钥管理机制的漏洞进行完善，创新性地提岀分級网络密 钥更新机制和链路密钥反激活机制，有效防止密钥泄漏，增强网络的安全性。
(2)由于Zigbee协议栈简单，对于异常节点的自我修复机制相对薄弱。而异常节 点的自我修复也是网络健壮性的重要方面。协调器是整个Zigbee网络的核心节点，一旦 协调器出现异常，整个网络的通信将受到极大影响，甚至瘫痪。本文通过提出一种具有 备份协调器的协调器异常检测及切换机制，降低了协调器异常对整个网络的影响。
(3)设计了 Zigbee自组织网络的Matlab仿真平台，验证了分级网纟各密钥更新机制 在网络开销方面的提升。同时分析了不同簇规模，不同离网节点比例对分级网络密钥更 新机制的影响，为在实际场合下寻求最佳网络拓扑结构提供了一定参考。
(4)在Microchip Zigbee Pro协议软件中编程实现了 Zigbee协调器冗余备份机制。 在Zigbee协议栈的应用层、网络层、媒体接入控制层中加入了备份机制服务原语、掉网 检测判断和协商机制，使应用了该协议软件的网络具备更强的健壮性。
(5)用Microchip的微控制器芯片和2.4GHz无线收发器模块等产品组网，完成了 Zigbee网络协调器冗余备份机制的软硬件联合测试工作，验证了该机制的功能。
42
6.2	问题分析和工作展望
本文在提出了对Zigbee无线网络健壮性的一些改进方案之外，既对Zigbee协议体 系和路由机制有了比较深刻的认识和了解，也意识到自己的研究还存在着一些问题和不 足，需要接下来做进一步的深入研究和解决，下面就对未来的研究方向加以展望，以期 能给读者提供参考。
（1）	解决密钥管理机制匹配局限性的问题。本文重点研究簇型网络的密钥节点管 理。因为簇型网络本身的网络拓扑就具有层次化的特性，通过簇头节点对网络消息进行 汇聚和转发，分级网络密钥能够和网络本身的拓扑结构相匹配。所有的外部数据都需要 在簇头节点进行二次加解密不会引入额外的消耗。而实际上，一旦网络拓扑发生变化， 不再是层次性结构，分级网络密钥将导致数据不能按照最优路由进行传输，而必须先传 输至某一节点进行转发。这样将减弱网络的路由优势，带来更大的开销。因此这种算法 具有一定的局限性。
（2）	设计更加动态的协调器冗余备份机制。本文设计的冗余备份机制中，考虑到 实现的复杂度，备用协调器之间采用优先级方式进行协商。优先级是通过节点预配置的 方式进行设置，不可以随网络状况改变。进一步可以考虑让网络在重建前尝试对当前网 络状况进行评估，包括网络拓扑的变化、节点的剩余能量等，根据这些综合因素判断最 优备用协调器。
43
参考文献
[1]Magnus F, Per J. Wireless Ad hoc networking-the art of networking without a network. Ericsson Review, vol・4, 2000, pp:248_262.
[2]Bakhache B, Ghazal J M, Assad S E. Improvement of the security of zigbee by a new chaotic algorithm [J]. 2013.
[3]Bakhache B, Ghazal J, El Assad S. Enhancement of zigbee and wi-fi security by a robust and fast chaotic algorithm[C]//Network and System Security (NSS), 2011 5th International Conference on. IEEE, 2011: 300-304.
[4]Seo H, Kim H. Zigbee security for visitors in home automation using attribute based proxy re-encryption[C]//Consumer Electronics (ISCE), 2011 IEEE 15th International Symposium on. IEEE, 2011: 304-307.
[5]A^dgren N? Haataja K, Patino-Andres J L, et al. Security Threats in ZigBee-Enabled Systems: Vulnerability Evaluation, Practical Experiments, Countermeasures, and Lessons Leamed[C]//System Sciences (HICSS), 2013 46th Hawaii International Conference on. IEEE, 2013: 5132-5138.
[6]Dini G, Tiloca M. Considerations on security in zigbee networks[C]//Sensor Networks, Ubiquitous, and Trustworthy Computing (SUTC), 2010 IEEE International Conference on. IEEE, 2010: 58-65.
[7]Nyamasvisva T E? Hasbullah H. Multi-level security algorithm for random ZigBee wireless sensor networks[C]//Information Technology (ITSim), 2010 International Symposium in. IEEE, 2010, 2: 612-617,
[8]J. Capon, “High-resolution frequency-wavenumber spectrum analysis/' Proceedings of the IEEE, vol. 57, no. & pp. 1408 -1418, Aug. 1969.
[9]Panahi N, Rohi H O, Payandeh A, et aL Adaptation of LEACH routing protocol to cognitive radio sensor networks[C]//Telecommunications (1ST), 2012 Sixth International Symposium on. IEEE, 2012: 541-547.
[10]Ramanathan R, Redi J. A brief overview of ad hoc networks: challenges and directions. IEEE Communications Magazine, 40(5), May 2002, pp:20-22.
[11]任秀丽，李政.基于无线传感器网络SPIN协议的一种改进方案卩].化工自动化及 仪表,2006,33(2): 35-38.
[12]陈兆海.应急通信系统.北京：电子工业出版社.2012.
44
[13]Jurdak R, Lopes C.V, Baldi P. A survay, classification and comparative analysis of medium access control protocols for Ad hoc networks. IEEE Communications Surveys & Tutorials, 6(1), 2004, pp: 2-16.
[14]IETF RFC 3561. Perkins C, Belding R, Das S. Ad hoc on-demand distance vector (AODV) routing. IETF, 2003.
[15]IETF RFC 4728. Johnson D, Hu Y, Maltz D. The dynamic source routing protocol (DSR) for mobile Ad hoc networks for IPV4. 2007.
[16]Lee S.J, Gerla M, Chiang C.C. On demand multicast routing protocol. In proceedings of IEEE WCNC'99. NEW Orleans, LA, 1999, pp: 1298-1302.
[17]Liu M, Talpade R, McAuley A. AMRoute: Ad hoc multicast routing protocol. Mobile Networks and Applications, 7(6), Dec 2002, pp: 429-439.
[18]Mascolo S, Casetti C, Gerla M. TCP westwood: Bandwidth estimation for enhanced transport over wireless links. In proceedings of the 7th annual international conference on Mobile computing and networking. Rome, Italy. 2001, pp: 287-297.
[19]SONG C Y, ZHANG H, ZHANG X. Clustering hierarchy tree routing algorithm based on LEACH [J]. Journal of Computer Applications, 2008, 10: 040.
[20]周玉，景博，杨洲. 一种基于遗传算法的无线传感器网络LEACH路由协议的改进 算法[J][J],计算机研究与发展,2010, 47(10): 175-179.
[21]Hu Y.C, Johnson D.B, Perrig A. SEAD: secure efficient distance vector routing for mobile wireless Ad hoc networks. In proceedings of 4th IEEE workshop on Mobile Computing Systems and Applications. 2002, pp: 3-13.
[22]高伟，胡艳军.WSN中一种基于LEACH的协同通信算法的研究[J]・通信技术， 2010, 43(10): 81-83.
[23]Lin C.R, Liu J.S. QoS routing in Ad hoc wireless networks. IEEE JSAC, 17(8), Aug 1999, pp: 1426-1438.
[24]Singh S, Woo M, Raghavandra C.S. Power-aware routing in mobile Ad hoc networks. Inproceedings of 4th annual ACM/IEEE International Conference on Mobile Computing and Networking. 1998, pp: 181-190.
[25]Chang J.H, Tassiulas L. Energy conserving routing in wireless Ad hoc networks. Inproceedings of INFOCOM 2000. Tel, Aviv, Isreal. 2000, vol.l, pp: 22-31.
[26]Kawadia V, Kumar RR. Principles and protocols for power control in wireless Ad hoc networks. IEEE Journal on Selected Areas in Communications, 23(1), 2005, pp: 76-88.
[27]Ramanathan R, Rosales H.R. Topology control of multihop wireless networks using transmit power adjustment. In proceedings of INFOCOM Tel, Aviv, Isreal. IEEE, Mar
45
2000.
[28]Elbatt T.A, Krishnamurthy S.V, Connors D. Power management for throughput enhancement in wireless Ad hoc networks. In proceedings of INFOCOM. Anchorage, Ak: IEEE, Apr, 2001.
[29]张伟华，李腊元，张留敏等.无线传感器网络LEACH协议能耗均衡改进[J]・传感 技术学报,2009, 21(11): 1918-1922.
[30]Lin S, Zhang J.B, Zhou G. ATPC: Adaptive transmission power control for wireless sensor networks. ACM Press, 2006, pp: 223・236.
[31]Martin K, Holer K, Adam W. Distributed algorithms for transmission power control in wireless sensor networks. IEEE ECON, 2004.
[32]Mohamed R, Fahmy S, Pandurangan G. Latency-Sensitive power control for wireless Ad hoc networks. In proceedings of the MSWiM 2005. Montreal, ACM Press, 2005, pp: 31-38.
[33]Park S.J, Sivakumar R. Load-Sensitive Transmission Power Control in Wireless Ad-hoc Networks. Global Telecommunications Conference, 2002, vol.l, Nov 2002, pp: 42-46.
[34][美]Theodore S.无线通信原理与应用[M],电子工业出版社,1999, pp: 69-133.
[35]金纯，罗祖秋，罗凤等.Zigbee技术基础及案例分析.北京：国防工业出版社，2008, 第一章.
[36]Zigbee alliance. Zigbee™ alliance Network specification version 1.0, 2004.
[37]Microchip Technology Inc. Microchip Zigbee Pro Feature Set Protocol Stack (AN 1125). 2009.
46
缩写说明
3GPP
IEEE
AF
APS
AODV
CFP
CAP
DD
GTS
LEACH
LR-WPAN
SPIN
RFD
ZDO	　　　　　第三代合作伙伴计划
电气与电子工程师协会
应用框架
应用支持子层
按需距离矢量路由协议 非竞争周期
竞争接入周期
定向扩散
保证时隙
低功耗自适应分簇算法 低速率无线个人区域网络 通过协商的传感器协议 半功能设备
Zigbee设备对象

47
(C) 1994-2022 China Academic Journal Electronic Publishing House. All rights reserved, http://www.cnki.net
岁月如梭，光阴似箭，转眼间硕士阶段的学习生活已接近尾声，现在即将划 上一个圆满的句号。这两年多的时间里，我学习到了很多的知识，也日渐感觉不 懂的知识越来越多。特别是我的研究内容广、杂、难，使我有种力不从心的感觉。 即使如此，这两年多的时间也让我成长了许多，不仅在实验室培养了一些基本素 质，也对自己认识更清楚，这两年，是自己从学生走向社会的非常重要的两年； 这两年也是和周围人共同成长的两年。对于每个一起度过这两年的人，都有无尽 的谢意。值此论文工作完成之际，向多年来关心帮助过我的老师、同学和亲人们 致以由衷的感谢！
首先，感谢孙卓老师在我攻读学位期间对我的悉心指导和严格要求。在孙老 师的言传身教下，我不仅锻炼和提升了自己的科研能力，更受到了严谨的治学态 度、务实干练的工作作风的影响，这些将使我受益终生。
感谢WSPN实验室为我完成学位论文提供了良好的科研环境和浓厚的学术 氛围，感谢实验室里每一位曾经帮助过我、为我提出过建议的老师，你们高深的 学术水平和治学风范是我学习的榜样。
感谢在Zigbee项目组一起工作过的温涛、孙建书、马笑笑等同学，感谢方 雨亨和王光迪两位师弟对我工作的大力协助，在大家共同努力和密切配合下，较 好的完成了项目的科研任务，对我的论文丁作是极大的帮助。
感谢我研究生期间的五位室友，有了你们单调乏味的读研生活变得丰富多彩, 充满了欢乐，我将珍惜这份宝贵的友谊。
最后，更要感谢我的家人，是你们在我成长的路上给予了我温暖的关爱和遇 到挫折时的鼓励和支持，你们永远是我坚实的后盾！
再次感谢我的所有师长、同窗和亲朋，谢谢你们！
49
(C)1994-2022 China Academic Journal Electronic Publishing House. All rights reserved, http://www.cnki.net
攻读硕士期间发表的学术论文
论文：
[1] An Wu, Zhuo Sun. ^Management Mechanism of Key Leakage Avoidance in Hybrid Zig
Bee Network", 2014 International Conference on Communications, Signal Processing, and Systems, July. 2014. (El 检索)
51
