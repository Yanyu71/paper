第一章绪论
1 • 1研究背景和意义
二十世纪六十年代，英特尔创始人之一的戈登•摩尔在对集成电路未来展望 中提出了著名的摩尔定律，他指出集成电路上可以容纳的晶体管数目在大约每18 个月便会翻一番，单位芯片价值降低一倍，芯片性能提升一倍。多年以来，集成 电路(IC)行业的发展一直与该条定律不谋而合⑴。在芯片尺寸不增大的前提下， 开发出具有更高运行速率的芯片结构成为可能。目前，芯片的运行时钟频率已可 达到3.5GHz,芯片制造工艺开始转向7nm制程，芯片功率可以突破100W,而 高端芯片的核心供电电压却己经下探到2V以下。
在当前阶段，芯片等高性能器件仍然主要集成在印刷电路板(PCB)上。在 PCB中，为了实现电路的功能，可将其分为信号分配网络系统(SDN)和电源分 配网络系统(PDN)两个部分。SDN和PDN分别实现为电路传输信号和提供电 源电压的功能，并通过多叠层的方式实现两个系统走线的相互分离。
在SDN中，对于低频信号，PCB导线及导线上的性能问题并不突出，然而 在时钟信号的频率越来越高的情况下，信号完整性问题成为不可忽视的问题。信 号完整性(SI) [2】是衡量信号在传输过程中能否保持自身稳定不受干扰的能力， 它对信号在时域、频域两方面中都有要求。在数字芯片中，信号通常有两个逻辑 门状态，对于存在振铃现象的信号，振铃可能会导致逻辑高电平和逻辑低电平之 间的误判，为了保证数字信号能够正确判决，信号需要在上升/下降时间结束后保 持稳定状态。若信号发生失真现象，不正确的数字信号可能会导致器件工作错误， 甚至影响到整个系统的性能。在高频时钟信号的驱动下，PCB的走线、过孔和材 质等因素对信号传输产生的影响不可忽略。信号完整性问题可以分为反射效应、 串扰相应、轨道塌陷和电磁干扰四个部分，其中前两个是研究较多的部分。
在PDN中，由于芯片整体趋向于更低的供电电压，电源分配网络中同样幅 度的电源噪声会对供电平面产生更大的影响，此时PCB的电源完整性问题显得 尤为严峻。电源完整性(PI)指的是PCB为其上各器件提供稳定工作电压的能 力。在PCB设计过程中，为了保证供电电流都是从电压流向地线而不辐射到空 间中，一般将供电线和地回路设计成平面的形式，由于电压的和功率各自分别呈 下降和上升趋势，在过去十几年的发展中电源和地平面的目标阻抗越来越低，目 前已经低至200毫欧姆以下。在如此低阻抗的回路中，电源系统中的开关噪声、
1
共模噪声和电源噪声对供电系统的影响会更强，低质量的信号会导致器件的供电 电压不稳定，从而增大器件烧坏的风险⑶。在更高的时钟信号频率下，如何保证 芯片在印刷电路板中正常供电，成为了 PCB设计、仿真和加工中十分重要的要 素。
1.2国内外研究现状
对于印刷电路板和电磁兼容的研究，西方国家起步较早，并已经取得了一些 富有价值的成果。在计算电磁学中，早期的工程师们一般借用天线理论和闭环方 程的解法⑷，在计算机辅助设计出现之前，这种方法是一种十分繁琐的方法，在 增加干扰因素的情况下，其计算效率显得较为低下。随着学科研究的不断深入， 西方学者为求解场强的精确解提出和验证了多种算法，按照其分析角度的不同可 将这些算法分为频域法和时域法。在频域，计算方法包括有限元法（FEM0、差 分法（FDM）【6］、矩量法（MOM）⑺、传输线法（TLM）冈和边界元法（BEM） ［9】。在时域，计算方法包括时域积分法（FIT）和时域有限积分法（FDTD）。与此 同时，随着计算机主频率和数据处理能力的不断提高，多家公司为实现电路板和 电磁兼容的实验室仿真付出了巨大努力，并开发出了一系列的仿真软件。例如 ANSYS公司开发的SIwave、HFSS软件，能基于FEM实现对印刷电路板中导线 的反射和串扰问题的精准仿真。恺登电子公司开发的Oread和Cadence Sigrity软 件，能实现原理图绘制，版图布局布线和电磁兼容仿真功能。Mentor公司开发的 Board Sim和Line Sim软件，能分别实现印刷电路板的设计与仿真功能。
国内对于印刷电路板电磁兼容性的认识经历了从不被重视到受重视的转变， 经过一段时期从无到有的发展，也取得了喜人的成果。北京邮电大学高攸刚教授 翻译了国外教授Mark I. Montrose编著的《电磁兼容与印刷电路板》［101＞给后来 学者的学习和研究提供了很大的帮助。在学术界中，国家标准化管理委员会不断 发布和更新电磁兼容国家标准，部分高校单位联合成立了本领域的电磁兼容国家 重点实验室。在企业界，华为、大疆、小米等民营企业也纷纷成立电磁兼容研发 团队，已将国内高速电路设计电磁兼容技术提升到一个新的台阶。
反射问题作为一种常见的自然现象，在进入高频时代后一直是国内外电磁兼 容和微波领域学者的重点分析对象。在文献［⑴中，作者通过传输线模型和相关计 算公式计算出不同基板材料下的传输线内源端与终端的多次反射系数，经过仿真 验证，证明了其计算的有效性。在文献Ml中，作者剖析了多种仿真措施的优缺点， 并推导了高频信号在传输线中传输过程中的相关寄生参数，绘制了研究反射问题 的等效电路，通过仿真对其结果进行了验证。在文献【13］中，作者研究了微带线在
2 不同类型终端端接时信号反射问题。在文献【“］中，作者研究了高速低电压的 DDR4印刷电路板中，芯片管脚封装对于PCB信号完整性产生的影响。在文献 ［15］中，作者将过孔(via)作为噪声源，通过控制和改变过孔的物理参数变量，研 究了过孔对反射问题的影响。
国内外学者对于串扰问题的研究历史也已经十分长久。对串扰问题的研究可 以分为串扰问题的分析方法和降低传输线串扰两个方面。在文献"］［⑺中，根据传 输线的连接路径，构建了准确的模型，仿真结果验证了串扰的主要贡献力量。文 献［国运用时域有限差分法分析了 PCB板传输线的远端串扰，并与实测结果对比， 验证了这种方法的可靠性。文章［⑼在分析PCB异面的传输线串扰时，采用了场 方程积分公式，用边界原法求解传输线的耦合噪声。文章［绚针对全波分析方法耗 时的缺点，依据通孔间互相相关的特点，总结出了通孔关联协矩阵，提出了一种 分析印刷电路板通孔的物理模型。文献0］着重研究了过孔和PCB焊盘对于互相 垂直走线串扰的影响，并总结了垂直走线与水平走线在抑制串扰方法方面的差异。 文献QI介绍了一种新型的PCB板材和沟槽设计工艺，这种工艺能够利用介电常 数比差产生极性相反的串扰噪声，同时简单介绍一种配合此工艺使用的能够降低 串扰的微带线和带状线的设计和走线方法。
在高频电路时代，电源完整性问题日益突出，因此成为了 PCB研究的热点 问题之一。对于电源完整性的研究可以分为三个部分，分别是电源地平面的建模 方法、电源系统的噪声分析以及电源系统去耦的设计方法研究。除了上文中所列 举的方法，也存在局部元件等效电路法(PEE)、传输矩阵法、模型降阶法和宏模 型法等用于分析电源分配系统。局部元件等效法是最早用于电源分析系统分析的 方法之一，在文献【23】中，从局部的电路互联结构出发，根据其电学属性建立了电 路模型，根据不同的电路情况可以建立不同的等效电路模型。谐振腔法被广泛应 用于形状规则的电源地平面的建模和分析中，在文献［24］中，总结了在高频电路板 中经典的谐振腔计算方法中存在的不精确问题，同时根据地平面结构等效的阻抗 矩阵将二级无穷级数降低为一级无穷级数，是用于快速求解电源地平面谐振腔的 一种新思路。在文献［25］中，提出了将电源地平面分割为网格状的建模方法，同时 提出了一种对于不规则形状的电源地平面的修正，并通过全波电磁仿真测试了方 法的性能。文献〔26］中介绍了电源分配系统的开关噪声、共模噪声和电源噪声三种 噪声。文献〔27〕对开关噪声(SSN)的产生机理和分析方法做了十分详尽的介绍， 是电源完整性分析领域经典之作。
1.3研究内容
本文以PCB为总体对象，探究其除全波仿真之外的分析方法。研究的主要 内容包含以下几个方面：研究高频下用于分析反射问题的等效电路模型建模方法; 研究用于实现PCB走线串扰批量仿真的方法；研究电源/地平面网络的阻抗建模 分析方法。
1.3.1分析反射问题的等效电路模型建模方法
反射问题一直是PCB走线中不可避免的问题，在实际的PCB批量仿真中， 端口示波器上的波形是一个多种问题复合的结果，很难只考虑反射而不考虑其他 走线的耦合问题。而用于传输线拓扑结构的仿真方法往往不能将过孔与管脚对信 号的影响考虑到位。本文通过对PCB走线的高频特性研究，分析了各种可能导 致传输线阻抗不匹配的因素，在分析反射问题时加入了过孔对反射问题的影响， 构建了反射问题的等效电路模型。
1.3.2实现走线串扰批量仿真的方法
串扰的本质是研究其他旁路对本条走线的耦合情况，因此只针对一条传输线 没有意义。与反射分析不同的是，走线在印刷电路板中的相对位置情况对串扰有 十分重大的影响，因此完整获取传输线在PCB板上的位置信息是整个建模方法 的先决条件。在传统的PCB全波仿真中，分析某些局部紧密的走线的串扰问题 往往需要大量的计算时间和计算资源，本文以串扰的主要影响因素为可控条件， 抽取了上述数据作为一条模型，通过机器学习的方式实现了串扰问题的快速批量 化仿真。
1.3.3电源地平面的阻抗建模分析方法
对于电源分配系统来说，阻抗是其最重要的指标之一。电源分配系统研究的 是整个电源和地平面，在芯片较多的印刷电路板中，不同的芯片管脚可能需要多 个不同的电压幅度来带动芯片工作，因此需要对电源平面分割，谐振腔等效分析 方法对电源/地平面边缘形状和边界条件有较高要求，因此本文开发了一种基于 路分析方法的电源地平面建模方法，该方法可以用以分析电源分配网络的阻抗。
1.4章节安排
本文共分为五个章节，其各个部分的主要内容如下：
第一章陈述了高速印刷电路板信号完整性和电源完整性的研究背景，介绍
4
了国内外相关领域的研究现状，并讨论了本文的主要内容。
第二章介绍了高速印刷电路板中信号反射问题的产生原因，简单介绍了用 于分析反射问题的传输线理论，重点介绍了 PCB传输线等效电路模型中相关器 件值的计算方法。通过分析趋肤深度研究了高频信号在传输线内时其等效寄生参 数发生的变化，提出了使用矩量法计算高频下的寄生参数的方法。根据传输线各 部分的等效电路搭建了等效电路模型，分别使用常规计算方法和矩量法计算所得 的参数进行仿真，模型仿真结果与Cadence Sigrity软件全波仿真结果进行了比对。
第三章介绍了高速印刷电路板中串扰问题的类型和产生的原因，通过仿真 验证了能对串扰造成影响的参数。编写了读取PCB文档的代码获得传输线中完 整的拓扑结构信息，建立了相应的元素序列。并通过分析传输线和板材中对串扰 问题造成影响的因素，从文件中抽取出相关的序列，以监督学习的方式实现了串 扰的批量化判决，并与HyperLynx仿真软件结果作对比验证了该序列的性能。
第四章简单介绍了 PDN的各个组成部分，概括性比对了几种用于实现电源 分配网络建模的方法，提出了一种用于高速印刷电路板中不规则电源和地平面的 建模方法，并通过与Cadence PI仿真软件进行对比验证了建模方法的性能。
第五章总结了本文的主要成果和不足，并对未来可以改进和深入研究的方 向做了展望。
第二章反射的等效电路设计
反射是传输线在高频信号驱动的情况下常出现的问题之一。反射可以理解为 高频信号在传播过程中因瞬态阻抗突变而被折回源端，从而使信号产生失真和振 荡。反射的研究对象为一条完整的信号回路，在分析时也应将源端信号源和终端 负载考虑在内，因此只讨论某一段传输线的反射信号是没有意义的。在高速印刷 电路板中，反射所形成的电压幅度振荡是造成信号过冲、延时等问题的原因，电 压振荡可能会导致芯片电平判决失误，影响电子设备使用性能。一般来讲，PCB 的设计和检验是开发工作的两个不同阶段，PCB工程师在设计阶段不可能根据 检验阶段的仿真结果来进行布局布线，因此PCB设计往往依靠设计师的经验和 一些既定规则来完成。SPICE模型给工程师提供了一种依靠电路参数即可计算反 射参数的方法，传统的SPICE参数计算方法在高频时的精度不能让人满意。在 本章中提出了一种依靠矩量法计算高频时参数的计算方法，仿真结果与传统的低 频参数计算结果和PCB全波仿真结果作了对比，在保证精度的前提下，为工程 师在设计阶段提供一种验证方法。
2. 1传输线理论与反射分析方法
2.1.1传输线理论
在低频电路中，电路板中的走线长度远小于所传输信号的波长，走线长度对 于信号时延的影响可以忽略，将这种所有参数都可以等效为与器件位置无关的电 路定义为集总电路。集总电路可以用直流电路的分析方法来分析，在集中电路中 存在三种理想的电路元件：电阻用于消耗电能产生热能，电容用于储存电能，其 两端电压与电路在该处断路电势相等，电感L用于存储磁能，其中的电流与它所 接入电路的电流相等。
然而在分析高频信号时，由于信号的波长较短，电路中组件的尺寸与其差异 较小，则组件尺寸对其值的影响不可忽略，电路板上的走线长度会影响信号的时 延，此时走线不能被认为是理想导体，其参数的性质存在于导体内的每一小段， 具有典型的分布性，此时与集总电路存在着较大的差别。分布式电路中，在同一 瞬间相邻两点之间存在着电流差和电动势差，分布参数会随着信号频率发生变化, 当高频信号通过传输线时，PCB在工作过程中其自身温度会升高，这表明其本身 具有分布电阻。在流过的电流周围可以观测到磁场强度，因此传输线本身存在分 布电感。由于同一叠层和不同叠层导线之间形成了带电的两片金属导体，因此传
6 输线本身也构成了电容，称为分布电容。一般来讲，分布式参数回路所分析的要 素都与电磁场的传播与反射有关，因此反射系数和衰减系数分析此类电路时重要 的技术指标，有鉴于用于分析电磁场的场分析法过于复杂，在分析分布式电路时， 一般采用将微波元件等效为电阻和容性与感性元件，将实际的导波传输系统等效 为传输线，将场分析的问题转换为电路分析的问题，这是一种等效电路的方法。 在印刷电路板中，根据走线所在层叠的不同，传输线主要有两种形式，分别为微 带线和带状线。二者具有不同的等效方法和计算公式，传输线和微带线的参数计 算方法将在后文详细介绍。
传输线最大的作用便是传导电场能量和磁场能量，这是传输线的广义定义。 分析传输线可以从“场”分析的角度分析，即以Maxwell方程组为基本点，通过 解传输线所在的边界条件下的Helmholtz方程，得到传输线电场和磁场量在时间 维度和空间维度的变换规律。而在印刷电路板中，一般都从“路”角度来分析传 输线问题。这种方法通过构建传输线的等效电路，通过仿真，其仿真结果为解线 上电压和电流随时间和空间的变化规律。在高频印刷电路板中，时钟信号频率已 经可以达到几百兆赫兹甚至吉赫兹，这种信号的波长在分米到米量级，PCB板上 的导线长度一定远小于信号波长，因此高频电路中的PCB上的信号线属于传输 线。
在分析传输线电路属性时，一般借助二端口网络对传输线等效电路进行分析。 二端口网络是对复杂电路分析的一种等效方法，在印刷电路板中，信号总是从电 源平面经过走线流入到地线回路，因此可以将电源平面和地平面分别看成是电路 的两个端口，在电路中只需要关心源端和负载端的电气属性，而不需要关心电路 内部的具体构造。
2.1.2形成反射的原理
反射现象广泛存在于现实生活中，与光学中的反射相似，反射本质上是信号 到达某分界处后部分分量沿原路返回的现象。在高频电路中，反射是发生阻抗突 变引起的［須。对于理想的均匀传输线，任何一处的瞬态阻抗都是相同的，然而在 实际电路中，高频信号在传输线中每一段距离内所感受到的阻抗各不相同，如果 这个阻抗未按照一定规律改变，而是发生突然的变化，则信号将在阻抗发生突然 变化的地方产生反射现象，此时部分信号将接着沿传输线传播，而另一部分信号 则将沿相反方向返回源端。在实际情况中，源端电压源是非理想电压源，其内阻 不为0,如经过反射的返回信号到达发射端时也不能保证阻抗匹配，则反射信号 会发生二次反射，信号强度由此渐进衰减，从而造成信号幅度的振荡。
印刷电路板上阻抗突变可以用图2-1来表示【29］。图中线段A和线段B是两
7

段宽度不同的传输线，信号从内阻为/?s的非理想源端流出，先后经由线段A和 线段B。线段A和B之间存在一个分界面，分界面两端的电流分别是心和％，电 压分别是/和内，线段A部分的特征阻抗为乙，线段B部分的特征阻抗为ZR。 在理想状态下，Z,=ZB，依据欧姆定律，此时下列公式2-1、2-2都成立。
tZ=H
1

+ UA -
于S -
-Ur +

图2T传输线的阻抗突变




(2-1)



(2-2)
在现实电路中，如果A和B材质相同，则IA—定不等于IB。又因为线段A和 线段B两端的电流和电压都需连续，因此不存在2-1和2-2同时成立的可能性, 则此时一定存在一个电压血和电流厶才能满足基尔霍夫定律，他们符合以下公式 的关系：
UA = UB-Ur	(2-3) (2-4)
将上面的公式进行代入和整理，即可得到反射系数r的计算公式为:

2.1.3 PCB中影响反射的因素
在印刷电路板的设计与仿真中，反射主要受到变化的走线宽度、终端负载匹 配，布线层间过孔等因素影响。在实际电路中，由于存在自电阻以及寄生电容和 电感的影响，设计一个不存在反射问题的PCB电路是不可能的。根据设计人员 经验以及一般设计规则，一般认为反射噪声低于信号最大振幅的10%时，该宿号 线的设计符合要求。
在PCB版图设计的过程中，导线布置的方法往往能对电路板的电磁兼容性 产生很大的影响［河。与串扰不同的是，反射中传输线只需关心自身布线情况，而
8
不必研究旁路和周围走线对其产生的影响。在设置布线时，需要控制导线的长度 以减少传输线效应的影响。有经验的工程师一般在同一层的相连导线中保持同一 宽度，避免导线的横截面发生突变从而导致信号发射严重的反射。同时，当导线 发生弯折时，一般避免走线出现直角弯折，转而用弧线型弯折代替，这种方法减 少了因横截面积突变而导致的反射现象。
在造成阻抗不连续的原因中，过孔(via) 一直是难以被忽视的一个因素PH。 在PCB中，过孔通常用于连接两信号走线，实现跨层走线和安装通孔元件。一 个典型的过孔主要由三部分组成：用于连接走线的焊盘区，中间部分中空的圆柱 体以及平面层的隔离区。图2-2为过孔结构的示意图。



图2-2过孔的结构示意图
在高频电路中，过孔的属性与其尺寸和连接的焊盘具有直接的影响。过孔的 金属焊盘会与上下信号层之中的导体产生电容效应，同时带电体与自身和周围导
体发生自感和互感，因此过孔同样存在分布电容和分布电感。过孔的寄生电容C”
与过孔的尺寸有关，寄生电感厶”与其高度和直径有关，近似值计算公式分别如下。
(2-6)
Lv = 5.08 [iny + 1]
其中：务一一填充物的相对介电常数；
D2-一参考平面的电气间隙直径(in);
Dj—一过孔的焊盘直径(in);
T——印刷电路板的厚度(in);
d	过孔的直径(in);
h	过孔的长度(in) o
终端负载是对传输线反射影响最大的因素。当终端阻抗与传输线完全匹配时, 理论上能实现反射系数为0,即不存在反射现象，源端流出的电流完全流入终端。 目前实现终端匹配有多种方式，一般来说，串联和并联匹配方式是两种最常见的 方式，两种方法的原理分别如图2-3和图2-4所示。
源驱动器
R3

Zo



~~1
r-

>
¥ 负载


J
J


图2-3串联终端匹配


源驱动器
Zo
j	负载


可




Zf	7
ZL

图2-4并联终端匹配
串联匹配的原理，本质就是在源端和负载端之间增加一个电阻&，源端的内 阻抗的值心和电阻他必须与传输线的特征阻抗Zo匹配。电阻凡和电源内阻会起到 分压的作用，因此当完全匹配时，信号线上的电压只有源端处电压的二分之一。 这种方案功耗较小，也不会在传输线和接地面之间产生额外的阻抗。
并联匹配的原理是电阻心把传输线末端接到GND或VCC层，其中禺的电 阻值与传输线的特征阻抗Z。和驱动端内阻/?o的和相匹配，最终将形成的反射信号 引向电阻心。这种方式原理简单且实现起来并不复杂，只需要根据该网络的传输 线信息和PCB的层叠信息，计算得到传输线的特征阻抗，根据数据手册查找相 关有源器件管脚的输出阻抗，即可计算得出电阻Rp的值。
2.2 PCB两种常用传输线及其特征参数求解
印刷电路板上的导线是先用化学和光学方法在基板上蚀刻出走线沟槽，再经 过电解等化学工艺将铜等金属导线材料覆在沟槽中得到的。在理想情况下，传输 线不存在因导线横截面突变和过孔导致的阻抗不连续问题，传输线电阻为0。然 而在实际情况中,传输线的电阻并非为0,并且可能会存在导线的横截面积突变、 跨层等情况，为了确保反射分析的准确性，需要在设计时将这些情况考虑进去。 在高频电路中，导线表现为容性和感性，导线与周围的每一部分的导体之间会形 成电容和电感，这两种参数都是分布式的，存在于导线的每一个部分。
印刷电路板中导线的种类主要有带状线、微带线两种形式。微带线也可再细 分为嵌入型和普通型，带状线可分为对称型和不对称型。在单层和双层的PCB 中，只存在微带线，在多层板中，两种导线同时存在。
10

2.2.1微带线
微带线是存在于顶层(TOP)和底层(BOTTOM)的(BOTTOM)信号线，它 一半与基板之间使用介质隔离,另一半暴露在空气中。图2-5所示的为其结构图。 其中，Z。是特征阻抗；是微带线的等效介电常数；务是介质的相对介电常数； W是导线的宽度；T是走线的厚度；H为导线和参考平面之间的距离卩2〕。

参考平面

由于微带线上部和下部的介质不同，为了同时满足上下两个面的边界条件,
微带线的相对介电常数务可以用等效介电常数&〃来表示，其计算公式如下:

2. 2. 2带状线
带状线是存在于多层板的中间层的传输线，其两端均由介质材料包围，常见 的对称带状线结构如下图2-7所示。
11


图2-6带状线的结构图 计算带状线特征阻抗Z。、分布电容C（）、分布电感厶o的公式如下： 亦嗟）叽需	°心
「 _	1.41Er
Lo =、_{ 3.8IH、	（2-14）
叫乔吋丿
LQ = Co- Zl	（2-15）
其中，Z°—一是微带线的特征阻抗；
Er——是介质的相对介电常数；
W一一走线的宽度；
T——走线的厚度；
H一一信号走线和参考平面之间的距离。
2. 3高速信号对等效电路参数的影响
2. 3.1趋肤效应
一般来说，上一小节中所描述的SPICE模型的参数计算方法只适用于低频 电路中，在高频阶段其精度无法保证。其主要原因是当传输线传输高频信号时， 电流在其中的分布情况不能再被认为是理想情况，一般使用趋肤效应来解释这种 现象。当导体内流过交流电时，导体内部的电荷分布并不是平均分布的，在接近 导体表面的部分电流密度较大，集中电流的“表面”的厚度被称为趋肤深度，当 趋肤深度大于导体长宽尺寸时，电流才是在导体内都有分布的。趋肤深度与导体 的电导率（电阻率）和信号频率有关，一种计算趋肤深度的方法如公式2-16所 示，其中，f是所传导的信号的频率，卩是导体材料的相对磁导率，。是导体的
电导率，P是导体的电导率。
(2-16)
由公式2-16可见，当频率升高时，电流越集中在导线的表面。对于一条宽 度为4mil,厚度为0.6mil的带状线来说，当频率低于76MHz时，传输线的趋肤
12
深度大于传输线的厚度，电流在传输线内均匀分布。当信号频率为100MHz时, 传输线的趋肤深度为6.67X10-6m,其与传输线厚度的比值约为0.44,当信号频 率达到500MHz时，传输线的趋肤深度为3X10-6m,其与传输线厚度的比值约为 0.2,即传输线在0.6mil厚度中，仅有0.24mil厚的线中有电流流过。
对于理想电阻而言，其电阻值与所传输的信号频率无关，却与导体的横截面 积成反比。由于高频传输线的趋肤效应影响，当信号频率增大时，导体内有电流 流过的有效横截面积会减少，进而导致导体的电阻值增大。
传输线的分布电感是衡量其在内部和外部空间磁通量大小的量，其包含了自 感和互感两部分。在图2-7所示的传输线截面电流分布图中，电流分布在传输线 表面内，以A和B两点电流作为分析对象，根据螺旋定则，A、B两点在导体内 部产生的磁通会互相抵消。对于截面形状规则的传输线，都会存在一点与所关注 点在内部产生的磁通相互抵消。同时，由于电流强度整体不发生变化，导体外部 的磁通与低频下电流均匀分布时的差别不大。

图2-7传输线截面电流分布
2. 3. 2高频传输线电阻和电感的计算方法
高频传输线中的电阻和电感会随信号频率的升高而发生改变，因此常见的低 频时的参数计算方法不再适用。为了保证等效电路在高频时的准确性，本节以麦 克斯韦方程组为基础，考虑趋肤效应对传输线参数的影响，提出了一种使用矩量 法计算电阻和电感的计算方法。
麦克斯韦方程组的积分形式如公式2-17-2-20所示。在不考虑太赫兹频率的 情况下，电流密度7远大于jo）压,因此血应可以忽略。
V xH = ja)eE + J
(2-17)
V xE =
(2-18)
7・O目)=0
(2-19)
13

V - (sE) = p	(2-20)
磁场强度目是无散场，可以用一个矢量的旋度来表示，如公式2-21所示，A 为矢量磁位。
l/H = Vx A	(2-21)
将公式2-21代入公式2-18中，可以得出：
7 X (F -ja)A) = 0	(2-22)
因此则必有一个标量式①，满足公式2-23：
E-ja)A = -V^	(2-23)
将公式2-21、2-22代入到2-17中，其结果如公式2-24所示：
VxVxA = {iJ	(2-24)
利用拉普拉斯算子的恒等式和洛伦兹条件，将公式2-24化简为公式2-25所 zj\ O
V2A = -fij	(2-25)
求解上式的非齐次微分方程，假设传输线的长度为单位长度，则其解为公式 2-26所示。
人(「)=佥J加詁可(2-26) 将公式2-26代入到公式2-23中，可以得到如公式2-27所示，用于求解电流 密度的方程。
字 + 嚳 J 加占"「'Mr' = - W(r)	(2-27)
为了求解上式的积分方程，可以考虑使用矩量法将电流密度r分解。矩量法 能将连续方程离散为若干个数相加的结果，在使用矩量法时，可在构建基函数和 检验函数时加入趋肤效应对参数值计算结果的影响。将横截面为矩形的传输线在 宽度和厚度两个维度分别将其分为a份和b份，划分方式为平均分配。依据频率 的高低，考虑a和b的取值会对计算时间产生的影响，可以调整a和b的数值， 但划分的细丝应尽可能准确表征是否存在电流的两个部分。可以使用公式2-28 所示的方法来离散电流密度。其中g为基函数，心为基函数的权值。
了(门 呻皿冗	(2-28)
基函数的选取是灵活的，在分析三维不规则形状时，常常采用RWG和SWG 基函数，在分析二维形状时，常采用分段常数基函数和分段线性基函数。本文选
14

取了分段常数的基函数，这种基函数在运算时较为简单，其原理是在趋肤深度内,
每一根导线内的电流密度只与其横截面积有关，假设满足趋肤深度的细丝的集合
为5[r],基函数g（r）的表达式可以用公式2-29来表示。
扌(r e 5[r]>
.0 (T 年 丿
将公式2-28代入到公式2-27中，即可得到公式2-30o在选取检验函数时, 采用伽略金法，即检验函数和基函数相同，都为分段常数函数。依据矩量法的内 积表达的公式，其中单位长度的电阻矩阵和电感矩阵可以用公式2-31和公式2- 32来表示。
总i + 骂』3蔬 J/严右d Wdr = - V<P（r} （2-30）



kj =冷 If - (r)d)y (r) In-^^dr'dr	(2-32)
2.3.3电阻和电感的求解方法
不同细丝之间的电阻相互独立，不存在互电阻，因此电阻矩阵为一个部分对 角元素为0的对角矩阵，值不为0的元素值指的是对应细丝的电阻，值为0的元 素值则代表对应的阻抗为0,电阻矩阵可以由其基函数和检验函数关于细丝横截 面积的积分而直接求得，其表达式可以由公式2-33来表示。

电感矩阵包含了自感和互感两方面信息，由于互感的相互作用性，因此电感 矩阵是对称矩阵，将公式2-32中对数函数取-2次幕，并在系数中补齐，则其矩 阵元素的计算公式可以由公式2-34来表示。
冷=一皑5%加2 -「'尸]処旳	（2-34）
为了求解上式中的积分，使用高斯积分函数。在二维高斯积分中，使用勒让 德取点方法，常见的高斯积分采样点可以分为4点和9点。9点的二维高斯点及 其权重如表2-1所示。使用高斯积分求解积分，则公式2-34可以变换为公式2- 35所示。其中M〜皿是高斯点的采样点数，3为采样点的权重。
Nr N2 N3 N4
,		“o \" \ 1 X 1 X 1 3尬3713卅
ij _ _而瓦乙乙乙乙	16
J m n m, n1
15
ln[(xim - xjm)2 + (yZm - yjm)2]	(2-35)
表2-1高斯积分点和权重
序号
高斯点
权重
序号
高斯点
权重

(VoZ, VoZ)
25
81
当iHj时，计算值表示为两个不同位置细线的互感，其坐标差值可以用细丝 之间的距离值来表示，即公式2-36,其中△ Num为两细丝横纵坐标的数量差，也 是电感矩阵的坐标差，width是传输线的宽度，thickness为传输线的厚度，a和b 分别为横纵坐标所分的细丝数。
（xim -	= ANumx * 竺农
v 77	a	（2-36）
r	、 A .T	thickness
（畑-Vim） = ANumy * —-—
当i=j时，公式2-35的计算值为细丝的自感。则公式2-35中的四层求和可 以逐步化简为公式2-37所示的两层求和公式，其中k为二维高斯点的权重，A 为化简至高斯定义域所产生的系数，耳和％为高斯点的坐标。
切=一彘列M錚豐产如（航一尤）2 +（% -刃勺	（2-37）
2. 3. 4电阻和电感的计算结果
当信号处于低频时，由于趋肤深度的影响较小，信号频率对传输线的电阻和 电感影响较小，其数值与低频时计算结果的比值为1。当导线上的信号频率逐渐 升高时，传输线的电阻和电感的值也随之发生变化。图2-8和图2-9分别为宽度 为4mil,厚度为0.6mil的传输线的电阻和电感随频率的变化曲线。可以发现在高 频段，电阻随频率的增大而增大，电感随频率的增大而微弱减小。
16

1.00-



0	200	400	600
信号频率(MHz)
图2-9单位长度传输线奇生电感随頻率变化曲线
2. 4反射的仿真分析
2.4.1选取的仿真简介
为了分析反射问题，本文选取了 ALTERA公司生产的Stratix IV GX FPGA 开发板作为验证等效电路仿真结果的电路板，其结构图如图2-10所示。该板具 有DDR3、HDMI、Flash、LCD等多个模块，属于高速多层印刷电路板。在高速 电路中，信号的反射、串扰等问题更加突出。该板的层数为16层，其层叠结构 如图2-11所示，其介质材料为FR4,相对介电常数的范围在4.2〜4.5,电导率为 5.9e+7 S/m・同时ALTERA公司也向开发者提供了 Stratix IV GX的开发套件和 部分芯片的IBIS模型，这为开发和研究提供了极大便利。该开发板上部分芯片
17

及其特点如下：
1、	FPGA选配的型号是EP4SGX23(HCF40,其工作电压为900mV,共有9120 个逻辑数组块，744个"0管脚，内存为17133bit.
2、	DD3选配的型号是MT41J64M16JT,其工怡电压为1500mV,共有64位 差分信号位，单片内存为512MB。
3、	CPLD选配的型号是EPM2210GF256,其工作电压为1500〜3300mV多电 平控制，共有272个管脚。




图 2-10 Stratix IV GX FPGA 开发板
TOP
DE.002
SG_LAYER2 —
DE_004
GND_LAYER3 -
DE_G06
PWR_LAYER4 -
DE_008
SIG_LAYER5 —
DE_010
SIG_LAYER6 —
DE_012
GND.LAYER7 -
DE_014
PWR_LAYER8 -
DE_016
PWR LAYER9-
DE_018
Ghffl_LAYERl0
DE_020
SIG_LAYER11 -
DE.022
SG_LAYER12 -
DE_024
PWR_LAYER13
DE_028
GNO_LAYER14
DE_028
SIG_LAYER15 -
DE_Q30
BOTTOM
图2T1 Stratix IV GX FPGA开发板的展叠结构
2. 4. 2履射的暮效电踣仿真
非理想传输线的等效电路并不是普适的，需要针对具体的导线网络，根据上 文所介绍的过孔与寄生电容电感的*效电路分析方法，将走线过程中所遇到的情 况一一串联，即可得到该传输线用于分析反射的等效电路模型.
在设计成熟的PCB线路中，对于直接与电源层（VCC）和地层（GND）相 连的传输线来说，终端端接可以通过上文所述的各种方式来实现终端负载的阻抗 匹配。然而在信号层上的走线中，则很少存在这类方式•当分析这类从管脚（Pin） 到管脚（Pin）的数据时，需考虑器因管脚封装所带来的寄生电容和电感信息。在 PCB仿真中，有源器件管脚正常工作时的数据都被集成在该器件的IBIS模型中, 通过查询该器件的IBIS模型文件即可获得该管脚的封装电阻R_Pin、封装电容 C_pin和封装电感L_Pin。同时根据模型类别可获取焊盘与驱动器之间的电容 C_Compo
为了更好地突出反射问题在传输线中的影响，传输线的选取应当尽可能长。 本文在开发板中选取一条跨越多层的长传输线，该传输线Line共分布在三层中， 在不同层叠之间通过过孔实现了其的连通。其位置信息如图2-12所示。该线共 有三个引脚，其对应的三个芯片分别为FPGA、ISL54050和CPLD。其中ISL54050 为双重低压单刀双掷模拟开关，共有10个管脚。在上文的读取PCB文件所得的 拓扑结构中，已经包含这些有源器件管脚的信息，该条传输线的主要用途是实现 对FPGA芯片的选通数据信号通信。


图2-12所选传输线在PCB板上的位置
通过编写的读取PCB文件的代码，一方面可以得出该传输线的端接情况， 另一方面可以准确获得每一段在各层上的走线长度。根据文件读取结果，可以得 出该网络的三个部分分别在Bottom> Sig_Layerl2和Sig_Layer6层，在上述各层 中的走线长度分别为0.83in、5.56in和2.54in°同时读取结果显示，该条传输线 三个管脚并无其他分支走线，避免了互连线分支造成的阻抗突变。在PCB文件
19
的头部，通过查询PCB的层叠信息，可以获得上述各层的电导率、厚度、相对 介电常数和损耗角正切等参数。根据该网络的结构特点，在考虑过孔对电路的影 响的情况下，按照上文所述的计算传输线和过孔电容电感的栩关公式，绘制传输 线的等效电路模型如下图2-13所示，图中詁个盧线框部分分别代表传输线和过 孔的电气模型。



圈2-13传输线的等效电路
为了分析该等效电路的性能，选用Advanced Designed System（UZ下简称为 ADS）软件来对电路进行仿真验证。将ADS仿真频率设置为0〜400MHz,步长为 50MHz,同时在电路的源端和负载端设置S参数端口 Termo
对于使用数值计算方法的电路参数，其SU参数的仿真结果如下图2-13所
示。

freq, MHz
图2T3常规数值计算方法的结果
对于使用矩量法和高斯积分法计算的电路参数，其参数是随频率不断变 化的非线性曲线。因此存在两种方法来表征出其S11参数曲线。其一是将参数随 频率的变化关系拟合为一段函数，这种方法速度快，但由于拟合函数与原曲线存 在误差，因此存在较大的误差。另一种方法是根据计算结果，按照一定的步长采 样，将不同频率下的仿真结果描点，即可得到使用矩量法计算参数的S11曲线,
20
抽取的点数越多，该方法的精度越好•使用第二种方法绘制的S11参数曲线如图
2-14所示。

频率(MHz)
图2-14矩量法计算的仿真结果

2. 4. 3 Cadence Sigr ity 中的反射仿真
为了验证该等效电路的准确性，本文采用对照实验的方式对仿真结果进行比 对和验证。在目前市场流行的板级仿真工具中，Cadence公司出品的Sigrity可以 为印刷电路板提供快速的全波电磁场分析，并且可以相对自由设置端口，该软件 能够提供多任务分布式计算能力，将大型复杂的任务分配给多个线程同步完成, 因此比其他全波仿真工具在速度上占据优势。
在分析反射问题时，在Cadence Sigrity中，首先选择该条传输线，根据该传 输线所涉及的器件为管脚设置IBIS模型，默认使用该PCB板上已经设置好的层 叠结构，同时设置左右两个边缘引脚设置端口，将仿真频率设置为0〜500MHz, 其自反射系数Si】的结果可以如下图2-15所示。
21



图2-15 Cadence SI中该传输线參数仿真结果
2. 5仿真结果分析


S 2-16三种仿真方法的S"秦数对比
在低频时，铜质材料在相应的频率下的趋肤深度大于该传输线厚度的一半,
22
即电流在传输线内均匀分布。此时使用常规数值计算方法的结果和使用矩量法计 算的方法的结果不存在变化，图2-16中的对比结果很好地印证了这点。观察图 2-16,发现当频率升高时，使用常规数值计算方法的仿真结果与全波仿真之间的 结果差距越来越大，这说明当频率升高时数值计算方法不能准确表征此时的器件 值。以50MHz为步长，在0〜400MHz范围内，对三条曲线进行抽样，其结果和 与全波仿真之间的误差如表2-2所示。
表2-2仿真的结果和误差表
频率
全波仿真法
(Cadence)
低频等效方法仿真结果及
、E3 ¥
咲差
矩量法仿真结果及误差

由表2-2所示，在50~400MHz的频段内，与常规计算方法相比，使用矩量 法计算参数的方法有着较小的误差。在PCB的设计阶段，设计人员可以使用该 方法对传输线的等效电路参数有更加精准的预测。

2. 6本章小结
本章对传输线反射的问题进行了详细的阐述和分析。首先对传输线理论和用 于分析反射的S参数进行了介绍，引出了反射问题的研究方法，接着研究印刷电 路板中常见结构的等效电路模型及其参数计算方法。经过研究发现，已有的常规 参数的计算方法在低频阶段有较为准确的结果，但当频率升高时其数值准确度无 法保证，因此提出了一种考虑趋肤效应的依靠矩量法的参数计算方法，在不同频 率下计算出不同的参数，并将其放入到等效电路中进行仿真。仿真结果一方面与 Cadence软件中的全波仿真结果作对比验证其准确性，一方面与常规数值方法作 对比，验证其在高频下的准确性。对三种仿真结果进行采样分析，观察结果发现 使用矩量法计算参数的方法在低频阶段与常规数值计算方法的结果极为相似，在 高频阶段，其与全波仿真之间的误差比常规方法的结果要小。使用等效电路分析 PCB上走线问题能为设计人员提供一种快速的预测方法，当频率升高时，相比传
23


统的参数计算方法，使用矩量法计算电路参数有更精确的结果。
24
第三章串扰问题的分析与研究
串扰问题是除了反射问题之外另一比较常见的信号完整性问题。与反射问题 不同的是，反射问题更多关注于单根传输线上的信号波动和分散程度，而串扰的 研究对象为这一区域内相邻的所有线路对该传输线所产生的影响，只研究单根导 线的串扰是没有意义的。串扰主要有两个方面的内容：一方面，传输线本身受到 来自于周围传输线的影响不能超过一定限度，另一方面，如果传输线本身信号的 电流较大，则其对四周的影响需控制下合理的范围内。在本章中，首先介绍了串 扰的两种类型，再而分析了电路中与串扰有关的因素，最后根据这些因素设计了 一种利于实现传输线大批量仿真的方法，并与HyperLynx仿真软件中的结果进行 了对比。
3. 1串扰的两种形式
在印刷电路板中，板上的走线多用于传输交流信号，依据法拉第电磁感应定 律，变化的电流周围一定存在其产生的磁场。在PCB中，这种磁场不仅存在于 该条传输线和其对应的返回路径，也会向外辐射，在该线路周围的传输线感受到 磁场会在其上产生感应电场。同时传输线与周围的带电线路之间能够形成一个电 容，当电容器之间的电势差发生变化时，对于两条传输线也会存在电流的流入和 流出，上述两个过程叫做耦合，这就是传输线间的串扰现象。串扰包括两种耦合 方式，分别为感性耦合和容性耦合，串扰往往是两种耦合方式叠加的结果［珂。
3.1.1容性耦合
对于两条平行的传输线，由于传输线有一定的厚度，两条传输线可以理解成
一个平板电容器，平板电容器电容值的计算方法如公式3-1所示，其中£为中间
材料的介电常数，S为两导体平行的面积，d为两电容极板之间的距离。在传输
线中，这种电容是分布式的，其存在于平行双导线的每一段，在使用等效方法分
析时，可以将双传输线等效为无数个长度为△的线段首尾相连，长度为△的微带
线的等效电路如图3-1所示，其中Cg”d为传输线与地平面之间电容，Cc°up为两传
输线的分布电容。当电容两端有稳定的电压时，电容相当于断路，其上的电荷不
发生变化，电荷值为电容值与电压值的乘积。对于理想的方波信号，其电压发生
改变只存在于电平跳变时，然而由于信号在传输线中发生电平转换时，电平变化
需在电平的上升/下降时间内达到电平幅度，因此在上升/下降时间内，电压始终
25
是变化的。当电容两片导体上的电压发生变化时，由于电容值C不变，则其上会
经过Comp发生电荷的转移，对外发射电流的导线称为攻击线，接受电流的导线被
称为受迫线。在电容＜：8^中所形成的电流值可以用公式3-2来表示，其中AU为
受迫线上由噪声引发的电压跳变量，可以用式3-1求得，Aui在上升/下降时间
内传输线上电压的变化值，t为信号的上升下降时间。
(3-1)







BHB



1
图3-1微带线的电容分布图
1=^.
t

在干扰电流到达受迫线后，将对受迫线有三个方向的改变。首先电流到达受 迫线后，其与地面之间的电容仓冋两端电压不再保持平衡状态，同样会进行 充放电操作。其次电流到达受迫线将分别向其左右两端传播，与攻击线传输方向 一致的称为远端串扰，与攻击线传输方向相反的称为近端串扰。由于传输线左右 两端的阻抗与该分布电容所处的位置有关，因此理论上两电流应不相等。
3.1.2感性耦合
根据奥斯特和法拉第电磁感应的理论，当电路板上的走线中有电流通过时, 走线周围一定存在磁场，其产生规律符合右手定则，磁感应强度如公式3-3所示 的毕奥-沙伐尔定律，其中住)为攻击线上的电流，r为感应点离导体的距离，sin0 为感应点与导线首末端的倾角，当sin0 = 0时，感应点在导线的延长线上。走线 上的交流信号不斷发生电平跳变，变化的电流会产生变化的磁场，当这条走线周 围还有其他传输线时，磁场会在其上形成一个感应电动势，进而产生感应电流。 感应电流的大小一般用两根线之间的互感来表征，因此称为感性耦合。
3 =严*型空业	3)
r2
与容性耦合类似，感性耦合中的电感同样是分布式参数，两平行传输线之间
26

的互感可以由團3-2来表示。在受迫线中的感应电动势公式可以用式3-4求得, 其中％为攻击线上单位长度传输线的电压，畑为受迫线的感应电动势，d为传输 线平行部分的长度，0为单位长度传输线之间的互感值。



3. 2对串扰的影响因素研究
对于两条距离相近且存在平行段的导线来说，分析攻击线对受迫线上的干扰 可以将串扰的影响因素可以分为四个方面来探讨，分别是导线本身属性参数、电 路板属性参数、信号属性参数以及端接情况。其中导线本身参数可以理解成设计 师的布线方法，这包含传输线的双线之间的耦合长度和两线之间的相对位置，电 路板属性参数主要包含层叠信息，信号属性参数主要包含信号的频率、幅度和上 升/下降时间。
在HyperLynx BoardSim仿真软件中输出第二章用于分析反射的开发板中两 条多段耦合的传输线，其网络名分别为BOT_DQ5和BOT_DQ7,两条线均为带 状线，两线之间距离的默认值为6mil,这两条传输线在HyperLynx LineSim中的 拓扑结构如图3-3所示，图3-3显示这两个传输线将通过四个过孔并分布在四个 信号层上。假设BOT_DQ5为攻击线，BOT_DQ7为受迫线，通过改变上一段中 所涉及的参数观察BOT_DQ5上信号幅度的变化。

图3-3攻击线和受迫线的拓扑结构
27
3. 2.1导域發数対■扰问■林响
1、耦合长度对串扰的影响
|在分析串扰问题时，一般认为距离小于三倍线宽的干行双导线之间存在耦合 问题•当耦合长度变长时，两导体平行的部分变大，即公式3-1中的面积S变大， 则此时依照公式3-2中计算传导电流的方法，会有更大的耦合电流自攻击线流向 受迫线。
在图3-3中的两线拓扑结构中，TL9和TL12是一对耦合传输线，输入频率 为133MHz,占空比为50%的方波信号。当其长度均为O.Olinch时，BOT_DQ7 的H7端口处的电压曲线如图3-4中紫色曲线所示，当其长度均为1.5inch时， H7端口的电压曲线如图中的白色曲线所示。


图3-4不同耦合长度的电压曲线
由于信号所需要传输的距离增长，因此白色信号线与紫色信号线相比存在约 为0.4纳秒的时延。通过观察两线的波动情况可以发现，在紫色线中信号上升阶 段的电压曲线较为平缓，在达到高电位的电压值时其波动较小。与之相比，白色 信号线在上升时间内存在着较为明显的波动，当其处于高电位时电压曲线也存在 着明显起伏。仿真的结果表明耦合长度的改变会对串扰的强度产生影响。
2、传输线相对位置对串扰的影响
传输线的相对位置是一个广泛的概念，其不止有两线之间的平行距离关系, 也包含了两线的方位关系。当两条导线垂直分布时，因两线并无多少直接平行的 平面，其上的容性耦合趋近于0,又由于印刷电路板中导线的线宽一般较窄，因 此感性电容也在一个较小的值。当两条传输线平行分布时，当两线之间的距离变 小，则公式3-1中距离d变小，等效电容C的容值变大，两线之间的容性耦合增 大，同时受迫线所能感应到的攻击线的磁感应强度也变强，单位时间内磁通量变 化增大，因此感性耦合也会增大。
在图3-3中,TL3和TL7是一对存在耦合的平行双线,其长度均为O.OOlinch,
28
调整两线之间的距离，并对其输入频率为133MHz,占空比为50%的方波信号. 当两线之间的距离为6mil时，H7端口处的电压曲线如图3-5中红色曲线所示, 当两线之间的距离为O.lniil时，H7端口处的电压曲线如團中亮蓝色曲线所示。

图3-5不同线距的电压曲线
与图34中两条电压曲线相比，图3-5中的两条线不存在时延.通过观察图 中电压幅度曲线可以看出，在信号的上升阶段，亮蓝色曲线的信号极大值要高于 红色曲线，在信号处于高电位，两者之间的波动形状几乎重合。仿真结果说明了 在信号的上升/下降时间范围内，缩短两线之间的间距能够显著的增强来自攻击 线的噪声耦合，这与预期分析的结果相符。为了避免这种情况，一般遵循三倍线 宽原则。
线宽是印刷电路板导线的另外一个重要参数，在线间距不发生改变的情况下, 线宽的改变并不能显著改变等效电容的数值。在分析电感耦合时，由于分析方法 是将传输线等效为集总参数线，因此其宽度的改变无法通过数值法来分析.
在TL3和TL7的耦合长度和线间距都不发生改变的情况下，将攻击线 BOT_DQ5的线宽调整为当前数值的两倍，输入信号仍然为频率是133MHz,占 空比为50%的方波信号。调整线宽前的H7端口处的电压曲线如图3-6中白色曲 线所示，调整线宽后的H7端口处的电压曲线如图中绿色曲线所示.
29



图3-6不同线寬的电压曲线
由图3（所示的两电压曲线，发现两电压曲线高度重合，得出结论当调整攻 击线线宽时，其对受迫线的干扰能力并无明显变化。
3. 2. 2层叠參数对串扰的影响
层叠的参数主要有介电常数、厚度。其中介电常数主要由其材料决定，在本 电路板中使用的FR4材料是一种环氧树脂材料，其相对介电常数为4.5。介电常 数将直接影响等效电容存储电荷的能力，从而对串扰产生影响。层叠结构是印刷 电路板中最复杂的系统之一，不可能因在某信号层的某信号对而轻易改变层叠设 置，这在下一章中将会具体分析。分析层叠参数对串扰的影响，主要是分析不同 层厚下攻击线对受迫线的干扰能力。
图3-7显示的是在其他参数相同的情况下，不同层厚导线之间的电压变化曲 线，其中红色线为当层厚为2.8mil时的电压曲线，绿色线为当层厚为lOmil时的 电压曲线。通过观察两线之间的差异，不难发现层叠的厚度是影响干扰能力的因 素之一。
tMM
MM

图3-7不同展厚的电压曲圾
30
3.2.3W号•数対・扰的％响
传输线中所传输信号的参数主要有三个，分别是频率、幅度和上升/下降时 间。信号幅度主要由其驱动端的端|口属性决定，在HyperLynx仿真中主要由其供 电端口所设置的田IS模型有关，在实际情况中，信号的幅度并不会发生过大的 改变，因此分析幅度对串扰的影响并无意义。信号的上升/下降时间同样包含在其 端口的IBIS模型中，因此在仿真分析时无法对其进行分析。
在分析信号对串扰能力的影响时，主要研究频率变化对其产生的影响。分别 在攻击线输入端口设置频率为130MHz和230MHz的方波，其电压波形如图3-8

图3-8不同信号频率的电压曲线

3.2.4端接对串扰的影响
从电磁场理论的角度来看，传输线的端接情况并不能改变攻击线对受迫线产 生的电磁干扰，其对串扰的影响主要是从降低攻击线的电压幅值出发的。在文献 [35][36]中，分别提出了不同的端接方案，并将其近端、远端串扰与无端接情况下的 相比较。在没有端接的攻击线拓扑结构中，由于信号到达远端后发生了反射，使 得攻击线近端处的电压增大.而拥有合理的终端匹配的拓扑结构，信号到达远端 的反射参数为0,抑制了近端处的电压升高，因此攻击线对于受迫线的串扰问题 会得到有效的改善.然而并非所有端接都能对串扰产生抑制作用，当攻击线的反 射电压与传输线的电压方向相反，即反射系数为负数时，其会增大近端处的电压， 导致攻击线对受迫线的串扰更加严重。因此选择合理的端接方式在降低串扰的领 域也十分有必要•在图2-4和2-5中，分别绘制了串联匹配和并联匹配两种方式.
31

除此之外，还有戴维南并行匹配、并行AC匹配和主动并行匹配等方法。
3. 3读取PCB板上信息
目前工业化PCB生产和设计的标准流穩，主要可以分为原理图设计、版图 设计、布线前仿真、布线后仿真、样板制作，测试调试等几个部分。一般来讲， 在印刷电路板的设计流程中，原理图设计是保证电路板功能的重要一环。然而在 原理设计阶段，不能实现对PCB上的传输特性进行有效分析，同时原理图也不 能表现出过孔和寄生参数等高频属性。在版图设计阶段，也主要依靠设计师以往 的经验来避免元器件布局和导线布线对PCB性能产生影响。
3. 3. 1 PCB信息的分类
实现PCB文件信息的读取是建立传输线拓扑结构的前提。目前印刷电路板 基本为多层结构，有些复杂电路甚至达到了 20层，与其他方式相比，使用文件 读取的方式能够精准的获取PCB板上信息。有鉴于PCB的开发和仿真己经完全 能够由计算机辅助完成，因此研究重点应放在诸如hyp、PCBDoc、BRD等主流 文件格式的印刷电路板EDA文件。在一定的条件下，上述产品可以实现互相转 换。由于各个公司的文件标准和加密算法不同，本文选取了 Mentor公司的 HyperLynx中用于分析批量化仿真的.hyp文件进行分析，该文件包含了印刷电路 板的全部信息。其中关键词｛StackUp｝中存储了印刷电路板的层叠信息，包含各 层的层叠名称、厚度、电导率等信息。关键词｛Devices｝中存储了电路中的器件信 息，包含了各个器件在电路中的名称（REF）、器件型号（NAME）和所在层（Bottom 或Top）。关键词｛PadStack｝中存储了焊盘的技术信息。在关键词｛Net｝中，管 脚（Pin）中包含了该管脚的坐标（X,Y）、该管脚的名称（R）以及该管脚的焊盘类 型（P）,线段（Seg）中包含了该条线段的起始的两个坐标点位置（XiZ）和％,岭）、 该线段所在的层叠（L）和该线段的宽度（W）,过孔（Via）中包含了过孔的位置 信息（X,Y）和焊盘类型（P）。
3. 3. 2建立PCB信息的集合
在印刷电路板中，传输线都是从有源器件管脚（包括电源）流向另一个有源 器件管脚（包括地），有源器件指消耗电能并进行信号输入和输出的器件，因此 读取PCB信息的第一个阶段是获取有源器件名称清单，该信息可以通过Altium Designer中装配输出。在编写代码时，一般近似认为当管脚（Pin）值大于3时， 该器件为有源器件。

在获取有源器件名称后，可以实现构建有源器件管脚的集合，将该集合记作 activej)ins,其中每个管脚记作active_pino首先按照器件名称在PCB文件中检 索出所有的有源器件管脚，将该管脚中的位置信息以(X,Y)的形式保存。然后在 有源器件的IBIS模型文件中根据关键字检索到器件管脚的封装电容和上升/下降 时间等信息，因此activejpin的数据格式如表3-1,也可以用公式3-5来表示。
表3-1有源器件管脚格式
横坐标
纵坐标
寄生电容(pF)
上升/下降时间(ps)

active jpin = [X, Y, value, dv/dt]	(3-5)
在印刷电路板中，为了电路的导通与去耦，除了有源器件以外，还有大量的 如电容、电感、电阻和开关等无源器件，无源器件管脚的集合记作passivejpins, 其中每一个管脚记作passivejpin»在读取PCB文件时，一般近似认为当管脚(Pin) 值等于2时，该器件为无源器件。无源器件管脚的存储也可以分为两步，第一步 根据无源器件清单在PCB文件中｛REF｝部分查询到相应的器件名称，第二步根 据器件名称在(Net｝部分根据器件名查找到管脚对应的相关信息，每条 passive_pin序列里包含"器件名称Reference "、“管脚名称Name坐标信息(X,Y) ” 和“器件值Value”三个部分，每一个器件都有两条序列。passivejpin的数据格 式如表3-2,也可以用公式3-6来表示。
表3-2无源器件管脚格式
器件名称
管脚名称
坐标信息
器件值
passive jpins = [Name, Number, X, Y, value]	(3-6)
除了器件以外，在印刷电路板中，走线是最主要的部分。印刷电路板的走线 可以分为两种，一种是直拐型，形成一个尖锐的倒角，另外一种是弯曲的平滑曲 线，弯折处呈现为一个弧线形。经过研究发现，前者可以由存储在文件中的许多 段线段经过“首尾”拼接得到，后者的圆弧占用的存储空间较大，因此改为用连 接弧线两端点的直连线来代替。走线的集合记作Segs,其中每一条走线记为seg, 需要注意的是，这里的一条线段序列并不是一条完整的走线，而只是其中的一部 分。每条seg序列里包含了 “起始点坐标(绻血)”、“终止点坐标(X2,Y2)\ “线段 所在层Layer”(用阿拉伯数字代替层的名称)和“线宽Width”。seg的数据格式 如表3-3,也可以用公式3-7来表示。
表3-3线段的数据格式
33
左横坐标
左纵坐标
右横坐标
右纵坐标
所在层
线宽
seg = [leftco, rightco, layer, width]	(3-7)
在PCB拓扑结构中，过孔常常是会被忽略的一部分。过孔的集合名记为 Vias,其中每一个过孔记为via。根据上文描述的过孔类型，在存储过孔信息时， 需要根据其封装P将过孔的开始层和结束层读取出来。每条过孔序列里包含了 “坐标信息(X,Y)”、“开始层”和“结束层”三个部分，via的数据格式如表34, 也可以用公式3-8来表示。
表3-4过孔的数据格式
横坐标
纵坐标
开始层
结束层


3. 3. 3建立PCB的拓扑结构
经过 PCB 文件的读取，获取了actiue_pi7is、passivejpinsSegs、Vias四 个序列集合，这四个集合中的序列可以根据坐标和器件名称连接起来。研究串扰 问题主要研究处于同一层的信号线之间的耦合，因此在构建拓扑时，一般都以有 源器件管脚作为开始点，对于不存在跨层的传输线，以有源器件管脚为结束点， 而对于存在跨层的传输线，以过孔作为该拓扑结构的结束点。
上述四个集合中，每个集合中的元素具有无序且不重复的特点，因此使用集 合(set)存储上述的四个集合。每查找到该元素的下一条元素信息，则从集合中 将已经查找到的元素删去(过孔除外)，其时间复杂度为0(1)。首先在队列(Queue) 中存入一条有源器件activejpin的信息，依据该有源器件的坐标，可以査询到与 该点相连的线段的一个端点的坐标，根据该线段的另一端点的坐标，可以查找与 该点相连的下一条线段的坐标。根据坐标点可以在无源器件管脚集合中査找到该 器件的名称，同时在管脚集合中查找到该器件的另外一个管脚(无源器件管脚基 本为2个)。过孔的坐标信息往往与线段的坐标相重合，在构建拓扑结构时，需 要注意在过孔处信号线常常出现分支的情况，即在Seps集合中可能存在多个seg 包含过孔的位置信息，因此过孔集合Vias在第一次遍历时需保持完整，不进行删 减操作。依次类推将上述信息使用深度优先搜索(DFS)算法在以上四个集合中
34 遍历，当遇到过孔或第二个有源器件时，停止查找。将査找到的信息依次存入队 列中，队列遵循先进先出(FIFO)原则，此时输出的即为一条互联线的拓扑结构序 列。
将最终建立的模型命名为modeGosstaik，其结构如公式3-9所示，其中。针对 Stratix IV GX FPGA开发板，共有120068条线段，7781个管脚和783个过孔， 读取和建立传输线拓扑结构的总用时长为10.624s。
modelcrosstalk = [activejpin^ segr ... passivejpirii ...segn ... activejpin^\ (3-9)
3. 4批量化分析的建模方法
在分析单个传输线的串扰时，可以依靠HyperLynx LineSim和Cadence等工 具实现图3-3所示的拓扑结构仿真，单次仿真时间在2秒以内。然而串扰是广泛 存在于印刷电路板中所有导线的问题，当仿真对象为多条传输线时，其仿真时间 也会随之增长。在3.3节中，通过编写读取PCB文件的代码实现了 PCB信息的 完全读取，在该电路板所组成的线段集合内共有120068条数据，若对电路板实 行整板分析，对其所有线段都进行仿真，则仿真时间为~个巨大的数字。为了实 现对该PCB板上传输线的批量化仿真，本小节将主要介绍一种传输线拓扑结构 的数字化建模方法。
3.4.1建立PCB平行线段集合
根据3.2中对干扰因素的分析，可以得出与传输线耦合长度，传输线的间距， 层叠厚度和端接情况有关，因此需要构建一个能够包含上述所有信息的序列。
在进行串扰仿真时，确定两条线之间的耦合段是十分重要的步骤，可以近似 认为线间距不符合3W原则的平行双线互为耦合段。在3.1节中，介绍了串扰的 两种耦合方式中，当两条传输线相互正交时，其耦合的长度最小，当两条传输线 相互平行时，其耦合部分的长度越大。因此在进行数据抽取时，首先应筛选出不 同序列中相互平行的线段。在PCB布线的过程中，为了避免阻抗突变，减小信 号的反射，一般不采用直角弯直接转弯的布线方式，多采用E面弯曲、E面双拐、 H面双拐等方式，拐角的常见角度一般为120°和240° o
在3.3节中，读取PCB所得到的Segs集合中，每条seg包含了其起始坐标 (Xi")和终止坐标区2，冬)，利用公式3-10求解该条线与水平方向夹角的正切值 tand,每条seg都可以计算出该值。根据的数值，将tan &数值相同的seg 线段组成一个新的集合，这个集合记作Paralleln,可用公式3-11来表示，其中 n表示tan0数值。对于一个Parade!集合，包含了这块电路板中所有互相平行的 35

线段，其中部分线段可能互为耦合。如Parallel,包含了 segs集合中所有的 tan0=0的线段，即与水平方向平行的线段。
(3-10)
对于一个完整的拓扑结构，依照第3.3节中的分析，其中拓扑结构是由有源 器件管脚、无源器件管脚、线段和过孔四个集合中的内容以器件名和坐标位置为 检索项，逐条拼接而成，在不考虑序列的先后顺序的情况下，假设每个拓扑结构 对应一条网络，则一个网络中所包含的序列信息可以用公式3-12来表示，其中 网络的集合记作nets,单条网络记作net。在nets中，可以认为passivej)in中包 含端接的器件信息，Segs内包含导线的相对位置信息。
net = {passivejptn, activejpin, Segs, Vias}
3. 4. 2构建耦合对序列
对于每一个Para〃创集合，其存储的是可能存在耦合的平行线段，逐一査询 其所存储的seg信息属于哪条网络，将这部分网络保存为新的临时网络集合，记 作nettempo需要注意的是，可能存在一个Paralle陳合中包含了同一网络中的多 条线段的情况，其解决方案是如果此时nettemp已经存储了一遍这条网络，再遍历 到与该线同网络的线段则直接跳过，并在Seps集合中将该条seg删除，即临时网 络集合内不存在重复的网络，存储临时网络集合的作用一方面是对平行线集合进 行筛选，另一方面将线段平行的关系映射为网络之间的耦合关系。
由于Parallel^合中存储的是整片PCB电路板中所有的平行线段，因此必然 存在许多物理距离较远或在不同层叠的线段，这些线段虽然平行，但也不能形成 耦合对，因此需将可能构成耦合对的线段筛选出来。当已知一条线段的首尾两点 的坐标时，其所在直线方程的两点式方程可以写为公式3-13,其中(兀人)和化卫) 分别为起始坐标和终止坐标。两根平行线之间的距离可以由公式3-14计算，其 中 A=(h —论)，B=(XI-X2), C=(«X2-$XI)。在 PCB 电路板的布线阶段，3W 原则是设计人员所遵循的基本原则，因此如果假设当线间距小于3W时两线发生 耦合，则可能会造成许多耦合对的遗漏，因此可以将筛选条件设置为4倍的线宽。 当线的中心间距小于线宽的4倍时，则认为两条线之间可能互为耦合对。该方法 需要对Parallel^合中的每两条seg都进行一次计算，其时间复杂度为O(n2)o
(3-13) (3-14)
依据计算出来的线距，Parallel集合中的元素的关系可以用有向图来表示. 集合中的每一条线段对应有向图中的每一个顶点，有向图的边和权重表示为集合 中两点之间的距离关系。由于串扰是两条传输线之间的相互影响，每一条线段既 有可能是诫击线，也有可能是受迫线，因此每个顶点的出度命入度都为n~l,其 中n为顶点的个数，即该有向图为全连接图，并且每两个节点之间都存在两条边, 即双向连接，一个简单的双向全连接有向图如图3-9所示.双向连接之间的边上 的权重均为两条线段之间的距离，但由于不同线段的线宽存在着不同，因此在进 行倍线宽判定时存在着判定结果的差异。


圈3-9线段集合的双向全连接有向图
在双向图中，每一个顶点内包含着该条线段的线宽信息，由顶点A指向其 他顶点的边上的权重为其与其他顶点之间的距离。当该距离小于4倍的线宽时, 则认为这两个顶点所对应的线段为一对串扰对，其中A为攻击线，指向的顶点 为受迫线，串扰对序列可以用公式3-15来表示，其中sepl为攻击线，seg2为受 迫线。
Crosstalkco =	(3-15)
对于双向全连接图中两线之间的中心距离大于4倍线宽时，则认为攻击线对 受迫线的影响较小，则此两条线不构成串扰对，公式3-15可以写为公式3・16的 形式。
Crosstalkco = {"f	(3-16)
3. 5数据的预处理
3.5. 1拓扑借患的数据填充
在公式3-12中，网络的拓扑结构以［驱动端管腳、无源器件管脚、连接线段， 过孔］的格式来表示。在3.2节中，通过仿真验证了对PCB串扰问题造成影响的 因素，因此可将3-12精简，要求网络信息必须以［驱动端，接收端，端接信息,
37 连接线段］的格式和顺序来表示。同时要求在一整块PCB板信息中，始终以PCB 板的层叠数据信息为头部，其中层叠数据信息包括：该PCB板的尺寸(长度*宽 度)，PCB板的层数和每层的厚度。
由于不同PC』上网络的个数各不相同，因此需要将所有net集令I整合为同 一长度的序列，这个步骤称为训练数据的填充。数据的填充包含两个部分：一方 面，要将每条网络序列调整至相同维度；另一方面，要将不同PCB的数据拓展 至相同维度。
在3.4节中，一条网络只存在一个驱动端和接收端，因此“驱动端”、“接收 端”和“端接信息”的维度是固定的，其数值可以由3.3节中集合的信息中读取。 经过对平行线段的筛选，所有的线段都存储在若干个Parallel集合中，在Parallel 集合内，存在着多组串扰对序列，为了剔除对于不存在耦合的线段，网络拓扑结 构中的“连接线段”中只保留出现在串扰对Crosstalkco中受迫线处的线段，即通 过对所有Crosstalkco的遍历，查找到所有可能存在串扰的线段，不存在的串扰 的线段如公式3-16所示，其值默认为0,所有相同的元素只保存一次。在存储 “连接线段”信息时，默认从下标较小的Parallel集合开始保存，设置每条网络 中线段信息个数的最大值为50,当线段信息不满50时，以0填充至50。
每个PCB板所提取出的网络数量几乎不会相同，因此在做训练之前，需要 将训练集中所有PCB板矩阵拓展到相同维度，拓展方式为在PCB板矩阵后添加 全零向量。假设训练集中共有两块PCB板，分别为：
(PCBl = (B,X1,X2...Xa,E)
{PCB2 =	...X'b,E}
此时，PCB1拥有a个网络，PCB2拥有b个网络，如果dim(PCBl) < dim(PCB2),则对PCB1进行维度拓展，使其与PCB2的维度一致，拓展后的PCB1 可用公式3-18来表示。因为抽取的网络模型本身以全零向量作为结束标志，因 此这种维度拓展方式对于结果的预测不会产生影响。
PCB1 = {B,X1,X2 ...^padding)	(3-18)
3. 5. 2数据的归一化处理
数据归一化是数据预处理中很重要的一步。数据经过归一化后，一方面，与 归一化之前相比，在相同路径下梯度下降更加明显，增加了求最优解的速度；另 一方面，归一化也有可能提高训练的精度。
针对数据的特点，目前存在很多种数据归一化的方法。当数据相对集中时， 可以使用简单缩放的方法，即根据数据的最大值和最小值，将数据变换至［-1,1］的 区间内。当数据分类主要依靠向量的距离的相似性时，可以使用标准差标准化的
38

方法，即通过所有数据的均值将数据的分布变换为标准正态分布。
在进行PCB数据预处理时，其数据主要分为两类。第一类如“端接信息” 等，其主要为端接的上升\下降时间等参数，不同PCB的该类数据之间相差不大， 因此可以使用简单缩放的方法实现这类参数的归一化,其方法如公式3-19所示， 其中max为样本数据的最大值，min为样本数据的最小值。

第二类数据如“连接线段”信息，其受到PCB尺寸的影响，不同PCB板的 之间的变化区间较大，这种取值范围较大的数据，在进行数据训练时其梯度下降 不明显。在处理不同的PCB电路板时，首先要确保其单位值一致，不能存在(mil) 和(mm)的差异。同时，依据PCB的尺寸(长度*宽度)，对坐标信息进行归一化， 具体实现方法是横坐标除PCB的长度，纵坐标除PCB的宽度，经过这一步处理， 所有坐标信息的取值都在［0,1］区间内。
3.5.3对训练数据进行标注
数据标注的本质是通过人工贴标的方式，为机器系统可供学习的样本。数据 标注是把需要机器识别和分辨的数据贴上标签，然后让计算机不断地学习这些数 据的特征，最终实现计算机能够自主识别。
在PCB全波仿真软件中，传输线的结构与公式3-9中所描述的格式相同， 都是从一个有源器件管脚经由线段和过孔到达另外一个有源器件管脚结束。因此 在进行数据标注时，首先应通过仿真验证该条网络是否存在串扰问题。使用 HyperLynx BoardSim 和 Cadence Sigrity 等全波仿真工具对Crosstalkco集合中线 段所对应的网络进行全波仿真。在HyperLynx将串扰阈值设置为150毫伏，在 CadenceSigrity—般认为串扰阈值为10%,其意义是在两款软件中，当串扰信号 分别超过方波信号150毫伏或超过方波信号的10%,则认为该条网络的串扰超 过正常工作范围。在网络序列中额外增加一个标志位flag,对于最大值超过阈值 的网络，flag的值为1,否则为0。
3.6机器学习算法预测
为了模型训练的准确性，本课题使用HyperLynx等仿真软件做了大量的批量 仿真，主要对连接在同一有源器件的不同网络进行分析，并对最大串扰超过串扰 阈值的网络进行人工标注，从而生成了可用的潜在串扰网络集^netcrosstalk.该 数据集包含超过30块PCB板，其中大多数为层叠结构相对复杂的多层板。
机器学习模型采用seq2seq模型，编码和解码分别选用双向LSTM模型和单
39
向LSTM模型皿，由于netcTosstaik中串扰对的结构只存在一对一的干扰与被干 扰的关系，因此seq2seq编码和解码部分的深度较浅。将数据集内的70%用于训 练，其余15%用于测试，15%用于对模型的验证。当使用这种分割比例时，不考 虑前期PCB文件读取和构建串扰对序列的时间，经过5.367秒的时间消耗，输入 测试数据后其正确率为73.2%。
3. 7实验结果分析
为了验证该等效电路的准确性，本章节依旧采用对照实验的方式对仿真结果 进行比对和验证。将同一电路板内的不同网络的拓扑结构输入所训练的模型中， 由于StratixIVGXFPGA内拥有许多独立走线的供电导线，为了防止这类信号对 仿真结果的影响，因此在选择输入数据时，应选择与周围线路耦合较多的拓扑结 构，其走线方案可以在PCB制版文件中直观体现岀来。本课题选取了 25条长传 输线，并在HyperLynx内进行了批处理仿真，仿真总时间为390秒，其仿真报告 如表3-5所不。
表3-5 HyperLynx的仿真结果
编号
网络名
CrossTalk
(mV)
编号
网络名
CrossTalk
(mV)

从时间角度考虑，建模方法能够将串扰的批量化仿真时间数分钟降低至几秒 内，因此有较好的工业应用前景。从准确率角度考虑，建模方法能够在短时间以 超过70%准确率检查出存在串扰的网络。
在表3-5中，当串扰阈值设为150毫伏时，25条传输线中共有8条检查出串 扰超标。机器学习模型从整板的所有拓扑结构中提取同一有源器件不同引脚的网 络，其最终检查出11条标记为“存在串扰问题”的网络，其中有6条网络与 HyperLynx仿真结果相同。
40
造成误差的原因主要来自于两个方面：第一，在制作数据集时，使用了不同 的全波仿真软件，这些软件在仿真算法、阈值的设置标准上存在着差异；第二， 在读取可能存在串扰的网络时，将耦合问题简化为寻找同一板上不同的平行双线, 这种方法不能包含非平行传输线之间的攻击线与受迫线，同样也不能包含不同器 件的攻击线对。
3. 8本章小结
本章主要提出了一种用于快速分析串扰的数据格式。首先介绍了传输线串扰 产生的两种机理分别为感性耦合和容性耦合。之后通过使用HyperLynx对拓扑结 构进行仿真，分析得出了导线、电路叠层和信号参数中会对串扰产生影响的要素。 之后以包含所有干扰因素为建模的基本方向，设计了一种用于训练机器学习模型 的数据结构，机器学习模型选用编码器为双向LSTM模型、解码器为单向LSTM 模型的seq2seq模型，在保持了 73.2%准确率的情况下将批量仿真时间缩短了数 十倍。
41
第四章电源完整性的研究和分析
随着印刷电路板的信号频率日益增高，同时芯片供电电压持续降低，这就大 大提高了对于印刷电路板电源完整性的要求。一般来讲，电源完整性包含三个级 别的目标：芯片级、系统级和板级。其中芯片层面通过芯片内部的去耦电容和去 耦模块将从芯片管脚中流入的直流电流优化，为芯片提供了一个起伏较小的电流。 系统层面要求避免电源供电系统以微带线天线的方式对外辐射电磁场，这种电磁 场往往由不理想接地导致的共模电流和差模电流产生，主要对与印刷电路板相连 接的导电电缆辐射。板级层面要求印刷电路板需要为自电压源流入芯片管脚的电 流提供低阻抗、低噪声的参考回路。本章将主要针对板级层面对电源完整性进行 分析。
4. 1电源分配网络介绍
在印刷电路板中，为了实现完整的回路，所有的有源器件和无源器件都通过 管脚和贴片的方式直接或间接连接在电源分配网络中。电源分配网络很难单独分 析，必须以一个整体来考虑问题，因此电源分配网络被认为是印刷电路板中最复 杂的部分a】。电源分配系统经过一段时间的发展，已经从原来的低速电源线和接 地线演变成今天在工业界广泛运用的多层平行平面的总线结构。当前电源分配网 络主要包含：电压调节模块(VRM)＞去耦电容和电源/地平面(Power/GoundPlanes)o 在PDN中，信号完整性设计的主要目标是通过添加去耦电容，保证在印刷电路 板最高工作频率范围内，电源/地平面的阻抗一直低于目标阻抗。下面将分别介绍 以上所提到的内容。
4.1.1电源分配系统中的电压调节模块
当前印刷电路板上器件密集，并且不同的芯片管脚的工作电压存在着差异， 比较常见的芯片供电电压幅度如3.3V、1.8V、1.5V。PCB并非任由不同芯片在 电路板上各自接入自己的工作电压源，这样则意味着电路板需要接入多个电源为 其供电。对于一般的电路板来说，设计师只为电路板设计了一个电源接口，这个 电源一般为12V。为了应对不同器件的不同等级电压，电路板中的电压调节模块 (VRM)因此也应运而生，其功能就是将电路板的供电电压调整为芯片的工作电 压。电压调节模块的核心部件是MOS型场效应晶体管和扼流圈，场效应管为主 要的电压控制元件。将扼流圈与场效应管栅极串联，而后与负载相连，场效应管
42
的漏级与负载相连。当供电电源开启时，扼流圈开始存储电能，并将电流传输给 负载端。当扼流圈中存储的电流大于负载的所需的额定电流时，另一端导通，扼 流圈上所存储的电能不断减小并持续流向负载，扼流圈的本质是一个电感。对于 超高频的器件，如CPU和GPU,多釆用多阶段的电压调节模块，同单相VRM 不同的是，它们由上一段分配供电功率，这种方法能有效减少负载上产生的无用 热量。
VRM的一个重要指标是它的输岀阻抗。在直流和低频段内，平面中的电压 的纹波很小，容易实现较低的输出阻抗。然而在高频段内，回路的增益会下降， 这意味着检测到的VRM的阻抗增加。为了保障VRM在高频段内的有较小的起 伏，常用的方法是在其输出端添加大容量的电容，电容对非本频段内的电信号有 明显的吸收和存储作用㈤］。
依据VRM的电气属性和功能，可以将其等效为一个RCL电路。其模型如 图4-1所示。在图4-1中，Co表示VRM用于去耦的电容，Co的大小决定了 VRM 的输出阻抗，其值为多个电容并联的结果。厶。址表示VRM的输出电感，该电感 来源于VRM的管脚。&是VRM的感应点与实际负载之间的阻值，其大小一般 在0〜10毫欧姆。厶°为选用的扼流圈的电感值，一般需要满足能够使电流增加所 需时间与VRM中实际的电压电流增加所需的时间相同。

图4-1 VRM的等效电路

4.1.2去耦电容
与电压调节模块类似，在电路板的电源/地平面之间也采用接电容的形式来 滤除不期待的纹波，这里的电容指的是在电路板中安放的电容器件，这类电容被 称作去耦电容。设置去耦电容的初衷并不是降低阻抗，而是为了滤除信号中不期 望出现的纹波。去耦电容直接加在负载管脚的两端，当电源能够为负载提供稳定 的电流时，电容中存储着电能，呈现为稳定状态，不对外产生电流。当负载所对 应的管脚发生电平跳变时，负载的阻抗会发生突变，流入负载电流会发生变化， 此时依靠电源不能及时对这种突变做出响应，为了保证负载两端的电压不变，此 43
时依靠去耦电容放电来弥补电流发生的变化。
当电源供电系统为管脚提供的是高频交流电时，去耦电容本身具有感性和容 性两种属性，在非理想条件下，往往还存在去耦电容与管脚之间连接造成的阻抗, 电容在高频线路中所表现的性质与其所流过的电流的工作频率有关。电容的实际 阻抗Zc的计算方法如公式4-1所示，其中R为电容与管脚之间的阻抗，一般为几 十毫欧姆，L是电容串联电感，C为电容的额定值。
Zc = R+j(2nfL-^)	(4-1)
在高频的情况下，可知(2好厶-盏)>0,此时电容变现为感性。当(,2nfL - 盏)=0,即"办=£急时'4-3所奈的电路达到谐振，沧为耦合电容的谐振频 率，实际阻抗乙的虚部为0,实际阻抗达到最小值，此时电容表现为纯阻性。由 此可见为了保证耦合电容的低阻抗性，应尽量保证谐振频率的大小与信号频率的 大小相似。
根据九的计算公式可以看岀，耦合电容的谐振频率与其电容值C成反比，即 当工作电流较低时，反而需釆用较大的电容来实现滤除其上的噪声。由于同一电 路板上不同器件供电电源的多样性，因此大多数时候采用将许多个谐振频率相近 电容值不同的电容并联来实现对纹波的过滤。在过去很长一段时间，去耦电容被 认为是利于全局的无源器件，其位置对其效果影响不大，但经过过去十年的研究 发现RO"】］,去耦电容与器件管脚的间距越小，其去耦效果越佳。
4.1.3电源/地平面
电源/地平面是VRM中体量最大的部分。一般来说，对于功能复杂的多层电 路板，可能会存在好几个地层，但基本上只会有一个电源层，为了给不同的器件 提供电压，电源层会根据器件位置再进行分区处理，因此在PCB中存在着多对 电源/地平面。由于地层、电源层之间存在着电势差，因此在低频时，一般将电源 /地平面看作为一个中间距离为隔离材料厚度的电容。此时该等效电容的计算方 法如公式4-2所示。其中为自由空间内的介电常数，S是中间隔离材料的相对 介电常数，S表示电源/地平面重合部分的面积，d为两平面的垂直间隔。常用 的 材料FR4的务在4-4.5的范围内，电源和地之间的距离小于0.1mm,因此一平方 厘米的电容值通常在几十皮法，不能在高频时对纹波起到很好的过滤作用。
C = £°* 磅	(4-2)
与在低频时采用的“路”的分析法不同，在高频分析时，往往釆用“场”的 分析方法。在高频信号的驱动下，电源/地平面自身电感不能被忽略，因此其表现 为一个谐振腔，对于一个形状规则的矩阵PCB电源平面，根据其尺寸可以计算
44 出电源/地平面的谐振频率，计算方法如公式4-3所示。其中a和b分别是平面对 的长和宽，m和n分别为长度和宽度方向上的谐振模式，卩为自由空间磁导率, 爲兀为谐振腔的谐振频率。如果将电源/地平面等效为谐振腔，求解整体的阻抗可 以依靠求解在指定边界条件下的Helmholtz方程来得到。然而在实际情况中，一 方面平面对的边界条件难以得到准确解，另一方面，根据上文的介绍，电源地平 面之间会存在很多个并联的去耦电容，去耦电容通过各种方式连接在平面对上, 会改变谐振腔的总电容，从而使谐振频率偏离原频率，如在谐振腔内加入上述因 素，则其分析速度极其缓慢。
"右」（Zb	（切
4.2目标阻抗
在保证印刷电路板电源的完整性时，以目标阻抗为设计目标是目前很流行的 方法。在进行电源/地平面设计时，在选用合适的去耦电容的情况下，依据欧姆定 律，要求PDN的阻抗不能大于目标阻抗，这种设计方法的关键是利用去耦电容 在谐振频率附近的阻抗达到最小值来有效降低电源/地平面的阻抗，由于去耦电 容的阻抗是一个关于频率f的函数，因此在分析电源/地面时也可以根据频率来 观测其阻抗的变化情况。目标阻抗的计算方法可以用公式4-4来表示。在公式中， I为管脚中所流过的平均电流，为能保证器件正常工作的前提下所允许的最大 噪声幅度，U为电路板的供电电压，P为电路板的功率。在多数情况，电路板的 总功率和输入信号的电压值是可知的，因此目标阻抗较为容易即可求得。随着印 刷电路板的敏感度越来越高，器件的目标阻抗正在不断降低，因此依照目标阻抗 设计的关键是如何在电流不断提高的前提下降低目标阻抗。
Z『=營誉	（4-4）
4. 3电源/地平面常见的分析方法
实现对电源/地平面的分析，目前己有多种研究方法，如有限差分法，有限元 法和谐振腔法。这些研究方法往往是将其进行分割，将一个大的平面对转换为无 数个小尺寸平面对。在本小节中将主要介绍谐振腔法和有限元法。
4.3.1谐振腔法
在研究微波传输时，谐振腔是一种重要的波导形式，它具有选频和储能两个
方面的特性。谐振腔相当于低频集中参数中的LC振荡回路，在4.1节中关于电
45
源/地平面的分析中，常采用谐振腔法实现对电源/地平面的分析。

度为h的矩形谐振腔。谐振腔法能够建立电源/地平面的阻抗矩阵，阻抗矩阵由 二维亥姆霍兹方程推出，在一定的边界条件下(一般认为是理想磁壁)，通过使 用格林函数求解亥姆霍兹方程，即可得到电源/地平面的阻抗。其表达式如公式4-
5所示。


其中，smc2(x) = sinx/x； % = mx/a； kyn = nn/b； xb yh Xj,力分别为 第i个端口和第j个端口中心在x和y方向上坐标，w是每一个端口的尺寸，一 般来讲，w远小于公式4-3所对应的截止频率的波长。h是电源/地平面之间的厚 度，3是信号频率，环和R为计算系数，当m,n=O时，Cm,Cn=O,当m,nH0时， Cm,Cn=2.在文献M2〕中提出了复横向波数K的计算方法，如公式4-6所示。
K2 = a)2ii£ — %%)/&	(4-6)
在公式4-6中，A和£分别为平面中间介质的磁导率和介电常数，Z$为电源 地平面非理想导体的表面阻抗，文献阴】介绍了它的计算方法，如公式4-7所示, 其中出为导电层的表面电阻率，亠为趋肤深度，其计算公式参见公式2-16。
Zs = (1+/)J?s，Rs =	(4-7)
为了求解公式4-5,需要在频域范围内求解无数种模的分量，这将消耗大量 的时间和计算资源。为了解决计算效率低下的问题，文献屮］提出了一种将二维亥
46 姆霍兹方程降为一维的方法，并证明了降维过程中两种误差补偿方法的有效性。 文献陈］提出了一种用等效电路代替高阶的求和项，但其在高频阶段的误差较大。
谐振腔法作为一种计算电磁学中的经典方法，其本质上仍是求解波动方程的 场分析法。然而其妇实际应用中存在着诸多弊病，它只能针对形状规贝！I的电源/地 平面进行建模。同时由于大量的去耦电容的存在，使得谐振腔法无法准确预测电 源/地平面的阻抗。
4. 3. 2有限元法
有限元法(FEM)是一种基于网格划分的方法，其本质是通过对所求区域进行 分解，求解偏微分方程边值问题近似解的数值技术。有限元法的解为稀疏矩阵， 同时，有限元法也是诸多全波仿真软件中电磁计算器中所采取的算法之一，这些 软件包括Cadence SI和Ansys。与矩量法不同的是，矩量法能够通过多个采样点 以求得直接解，其只存在精确问题而不存在收敛问题；有限元法通过迭代求解， 存在收敛问题。
有限元法主要可以分为三个步骤，分别为剖分、单元分析以及求解方程。剖 分指的是将待分析的区域剖分成更小的区域，有限元的收敛性和准确性取决于区 域的剖分方法，对于二维电源/地平面，常采用等边三角形、四边形等形状。单元 分析指的是根据剖分得到的区域的形状和边界条件，列出该区域的二维波动方程。 在求解方程过程中，根据加权残量方程可以建立参数数量有限的方程组，对该方 程组求解即可得到有限元法的数值解。

如图4-3所示的图中，将电源/地平面以自适应网络的三角形进行划分【妁, 由线性三角形函数，其所得到的偏微分方程如公式4-8所示,其中①为测试函数, 其取值可以参考2.3节中矩量法测试函数的取值方法。
丫角厲［▽①j ▽甥 + 3妝珂％ + j3#dJz如 dx dy	(4-8)
有限元法在计算的过程中，其计算精度与区域划分的精度有关，当区域划分 较小时，在其计算过程中会产生大量的未知数，因此需要消耗大量时间和计算资
47
源来获得精确解.当区域划分较大时，其精确度无法保证.
4. 4对电源/地平面的建模


电源/地平面并非是由两个封闭的平板导体组成的，其上分布着多个过孔。依 据在第二章中对于过孔的介绍，可知过孔对于电路的影晌主要在于过孔在跨越多 层时，过孔上的电流会在信号层上的导线上产生不期望存在的电容和电感。以跨 越Top层到Bottom的通孔为例，在图44中，过孔与信号层线段在切面上存在 寄生电容Roup，其上的电流产生的磁场会辐射到信号层从而产生感应电动势［切。


圈4-4过孔的舒生参数产生原理
由于过孔存在于两平面之间，并且连通这两层的所有过孔公用一个地层，因 此在分析过孔对于电源/地平面的影响时，其不能被认为是理想通路，需要采用一 种估算方法来分析电源/地平面阻抗。在高频信号时，两平面被认为是分布式回 路，但由于过孔位置摆放的无序性，若采用分布式参数计算则模型过于复杂且不 具备普适性，因此采用集总参数来对电源/地平面阻抗进行估计。因此地平面的估 计阻抗Zest与公式4-1计算Zc的方法相同。
电源/地平面多数为铜质，其本身具有电阻，计算方法可以将其看成是一个长 度为1横截面为S的导线，铜的电阻率为1.75*10-8Q/m,计算得出阻值基本为 几十皮欧姆.由于电源和地平面本身可看作一个巨大的平板电容器，则其电容的 计算方法可以用公式4-2来计算。文献刚中介绍了一种电源/地平面电感的提取 方法，其方法是在电路板边界条件为理想开路的情况下，使用格林函数求解阻抗 矩阵，将容抗从虛部中去除，即可得到得电源/地平面的电感值。
已知实验测试电路板的尺寸为8cm*4cm,信号输入的端口和输出端口分别 设置在左右两边缘的中点处，即坐标(0,2)和(8,2),电源/地平面中间的填充材料为 FR4,厚度为1.2mm,其相对介电常数为4.5,介质的损耗角正切为0.012。根据 上述计算方法，其电阻R为54nQ,电容C为10.2pF,电感L为29nH。
过孔的相关参数可以依据公式2-6和公式2-7求得，由于电源/地平面采用集
48

总分析方法，因此过孔的位置对于最终的实验结果没有影响。在分析电流流经过 孔时可以根据其参数将其建模为X -型电路，电路结构如图4-5所示。



图4-5电流流经过孔的等效示意图
使用ADS分析上述电路，并将仿真结果与电源/地平面集总模型的结果放在 一起进行比较，如图4~6所示，其中红色为电源/地平面集总模型，蓝色虚线为添 加过孔的阻抗曲线。通过观察图中两个曲线，发现对于常见的高频信号来说，单 个过孔对于电源/地平面的谐振频率和阻抗值的影响较小.

freq, GHz
® 4-6过孔和电源/地平面的仿真结果
4. 4. 2单条区域的传输矩阵
在针对电源/地平面进行建模时，共有两种思路可以参考。一种是“场”分析 法［洌，利用特定的边界条件，采用有限元法和差分法求解麦克斯韦方程组得到精 确解，场分析法对仿真硬件有极高的要求，需要比较长的仿真时间.另外一种是 “路”分析法【刈，将电源平面等效为等效电路，利用传输线理论和基尔霍夫定律
49

求解传输线的特征参数，这种方法具有很高的效率，在本章中主要采用电躍分析 的方法实现电源/地平面的建模。
对于一块长为a,宽为b的正方形电路板，在长和宽上分别将其平均划分为
4-7来表示，其中相灵等效参 血》»6为损耗
Z1 R


图4-7场分析法的等效电路

由于上文已经验证过过孔对电源/地平面的影响较小，因此在分析时只考虑 去耦电容对电源/地平面的影响。对于整个平面对来说，其可以看成是以图4-7为 模型的m列二端口网络之间的级联。
在第二章中已经提到二端口网络中S参数可以用来描述端口中电压的分散 程度。二端口网络在分析两个端口之间电氐电流之间的直接关系时，引入了传 输矩阵T,二端口网络的T矩阵有A、B、C、D四个参数,T的表达式为公式4- 13o二端口网络中，公式4-14表示以上这四个参数的关系。。其四个参数的意义 分别是：
A：其数值等于当12=0 （输出端开路）时，U占U2的比值；
B：其数值等于当-=0 （输出端短路）时，输入端对输出端的转移阻抗，其 单位为Q；
C：其数值等于当12 = 0 （输出端开路）时，输入端对输出端的转移导纳，其 单位为S；
50

D：其数值等于当/ = 0 (输出端短路)时，输入电流h与输出电流-之间的 比值。

当图4-7中输出端开路时，【2=0,则此时U1和U2的解如公式4-16所示。


则A和C的表达式可以写成公式4-17和公式4-18-
彳=£1 = 竺塑丝蟲


4. 4. 3去耦电容的传输矩阵
在实际电路中，去耦电容会对电源/地平面产生影响，在使用第二章中的方法 读取PCB文件信息时，发现无源器件集合中存在着大量的去耦电容器件，通过 查询PCB的无源器件集合可以获取这些电容在电路板上的位置信息。应尽可能 使一个去耦电容处于一个方格内，可以通过调整m和n的大小来控制横向/纵向
51
上的分格数来实现，在去耦电容数目较少的情况下，也可以在长度方向上实行不 均匀分割，再将传输矩阵按级相乘。
对于去耦电容Ccoup,在4-8所示的电路中，当输出端断路，【2=0,则此时U1 和匕的解如公式4-23所示。
图4-8去耦电容的二端口网络

当输出端短路时，U2=0,则此时U1和一【2的解如公式4-24所示。
f ^ = 0
= 一【1
则A、B、C、D的值分别为1、0、jo)C、1=电容的传输矩阵人可以用公式
4-25来表示。
(4-25)
4. 4. 4阻抗计算方法
假设去耦电容位于第x格，则此时公式4-15应写为公式4-26o

当已知从开始点到结束点的级联传输矩阵时，电源/地平面的输入阻抗可以
由公式4-27计算。

4. 5实验绪果分析
本文选用CadencePI仿真软件作为对照实验•仿真实例为一块长为420mil, 宽为310mil的长方形印刷电路板，其申，m和n的值均为8.选取的去耦电容组 合如表4・1所示.图4-9显示了去耦电容对于阻抗的影响，其中蓝色线为不加去 耦电容的阻抗曲线，黑色线为加入去耦电容的单节点仿真的阻抗曲线.可以发现 在高频段，去耦电容对阻抗起了降低作用，该电源/地平面不加去耦电容时其谐振 频率为260MHz»
<4-1去耦电容的配备表
序号
电容值
谐振频率


图4-9去耦电容对电源/地平面阻抗的彩响
在进行多节点仿真时，在电路板的(xm=5, %=2)和(xra=6, *=2)处添加两 个最大幅度为1A的干扰源，同时设置去耦电容在不同的位置，如图4-10所示.
53



图4T0两种不同的去耦电容摆放位置
图4-10中两种不同的去耦电容摆放位置的全仿真结果如图4-11所示。其中 黄色线段为4-10里上图的仿真结果，红色线段为下图的仿真结果。

Frequency [Hr]
X2741140Y787401_S2_Sl	X2741140Y7S7401_S2,Sl

B4-11去耦电容的分布対电源阻杭遗戒的彫响
在图4-11中不难发现，频率越高，电源/地平面的阻抗对去耦电容的位置越 敏感。结合图4-10中去耦电容距离噪声源的位置差别，可以发现当去耦电容离
噪声源较近时，同一点观测到的阻抗随频率下降的曲线越尖锐，去耦电容对于噪 声响应的速度越敏感。
当使用“路”分析法对两种情况进行计算时，其主要差别在于传输矩阵级 联相乘的顺序不同。将两个端口的坐标点分别设在(%TO=1,丸=5)和(xm=7, yn=5),依据方程组4-27求得级联网络的阻抗矩阵，求得在信号频率/为 300MHz时，二者的阻抗分别为250.64mG和146.576mG,计算时间分别为 0.0012s和0.007s。与全波仿真之间的误差分别为20.11mf)和20.897mG,误差 偏移程度分别为8%和14%。在“路”分析法的等效中，默认两电平面的中间 介质为理想的FR4材料，然而在实际电路中，中间部分包含信号的走线层，信 号与地平面之间同样会形成电容，但由于其走线的不确定性，无法根据网格进 行量化分析，这是造成这种误差的主要原因。
4. 6本章小结
本章针对印刷电路板的电源分配系统做了详细的介绍与分析。首先介绍了 电源分配系统的内部组成部分，简单介绍了电压调节模块VRM的等效分析方 法和噪声产生原因，之后介绍了去耦电容的去耦原理，可以采用“场”、“路” 两种方法对电源/地平面进行了等效。再而介绍了引起不期待信号噪声的两种原 因，分别为电源开关噪声和不理想接地。在对平面对进行建模分析之前，研究 了过孔对于电源/地平面阻抗的影响，发现单个过孔对于电源/地平面阻抗的影响 十分有限。最后提出了一种分析电源/地平面的办法，根据去耦电容的位置选择 将电源/地平面分割的方案，求解得到级联二端口网络的传输矩阵，并根据传输 矩阵计算出两端口之间的阻抗矩阵。其计算结果与Cadence PI多节点仿真结果 进行了比对，误差在15%以内。
第五章总结和展望
5.1总结
本课题基于高频信号驱动下的印刷电路板，通过建模分析的方式，主要研 究了其信号完整性和电源完整性特征。其中信号完整性主要实现了反射的等效 电路建模和串扰的批量化仿真建模，大大缩短了反射和串扰的仿真时间，电源 完整性主要实现了电源/地平面阻抗的等效“路”分析建模，为电源/地平面建模 提供了新思路。本文工作主要包括以下四个方面：
第一、本文提出了一种实现印刷电路板数字化建模的方法，并根据类型构 建了集合。为了获取用于建立传输线拓扑结构的完整数据，可以根据计算机辅 助设计产生的PCB文件，获取板上的完整信息。印刷电路板主要可以分为有源 器件、无源器件、导线线段和过孔的四个集合。利用深度优先搜索算法可以实 现上述四个集合的首尾相连，以拓扑结构的有源管脚作为网络的起点即可获得 该网络的完整拓扑结构。
第二、本文提出了一种电路等效分析法分析印刷电路板上的反射问题，等 效电路中的各个参数都可以由解析公式计算。反射的研究对象为一条有负载阻 抗的非理想传输线，引发发射的原因在于传输线的阻抗突变，而过孔、布线跨 层等情况是导致阻抗突变的原因。与传统的全波仿真相比，本文提出的等效电 路法极大地降低了运算时间，同时对仿真的硬件条件也更低。此外，本文中涉 及到的电路及器件的高频分析方法也有十分可观的可移植性。
第三、本文提出了一种用于实现快速批量化串扰预测的数据序列。首先将 连接同一有源器件不同管脚的网络构成一个集合，再通过全波仿真软件对这些 网络中超过串扰阈值的网络进行标记，有标记的网络则可能成为某一条攻击网 络的受迫线。
第四、本文提出了一种用于分析电源/地平面阻抗的等效方法。首先对电源/ 地平面切分为小格，再由二端口网络的级联求得指定两个坐标下的转移阻抗。 其分割的每一小段的RLCG参数均可由解析式求得。在电源/地平面中，去耦电 容会对其最终阻抗有显著影响，因此在进行级联分析时，需要根据去耦电容的 位置来调整传输矩阵的顺序。与传统的利用电磁场分析的多节点仿真方法相 比，本文提出的等效模型具有明显的时间优势。
5.2未来展望
本文针对印刷电路板信号完整性和电源完整性进行了一些研究。但是由于 作者自身科研水平和时间等限制因素，本文中所提出的方法仍有可以完善之 处。结合现阶段针对建模结果的误差分析得出的结论，以下几点可以作为下一 阶段研究和攻克的重心。
第一、在分析反射问题时，对电路参数的计算方法做了简化操作。已知高 频信号会对传输线的参数造成较大的影响，本文只分析了信号频率对于电阻和 电感的影响，而信号频率的改变同样也会导致介电常数发生变化，由此导致电 容发生变化，本文针对电容并没有过多的研究，这是导致结果与全波仿真结果 之间存在误差的原因之一。在接下来的研究中，可以将高频下电容的计算方法 作为突破口。
第二、在构建串扰的数据序列时，只根据两平行线之间的距离关系来确定 两线之间的串扰关系。此外，在构建攻击线和受迫线对时，只选择了多对一式 的半连接关系，尚未有能准确表征攻击线和受迫线之间关系的方法。
第三、在分析电源/地平面反射时，由于无法准确表述频率与分布式参数的 关系，将低频信号下的电源/地平面腔体的电容计算方法移植到了高频计算中。 除此之外，本文所提出的方法仅适用于外边框形状规则的矩形电源/地平面，对 于形状不规则的电源/地平面的建模方法研究，可以作为日后科研努力的方向。
参考文献
[1] P. IG Bondyopadhyay, nMoore,s law governs the silicon revolution," in Proceedings of the IEEE, Jan. 199& vol. 86, no. 1, pp. 78-81.
[2] S. S. George, S. Sivanantham and R. Vikram, nSignal Integrity and Power Integrity Challenges in Embedded Computing Boards/1 2018 15th International Conference on ElectroMagnetic Interference & Compatibility (INCEMIC)，Bengaluru, India, 2018, pp. 1-4.
[3] C. -K. Chan et al., "Power Distribution Network Modeling and Design of ReDistribution Layer in DDR Application/ 2020 IEEE 24th Workshop on Signal and Power Integrity (SPI), Cologne, Germany, 2020, pp. 1-4.
[4] ]Bruce Archambeault,Sam Connor,Colin Brench.Review of Printed-Circuit-Board Level EMI/EMC Issues and Tools[J].IEEE Transactions on Electromagnetic Compatibility,2010,52(2):455-461.
[5] J.Jin.The Finite Element Methd in Eletromagnetics. New York:Wiley,2009
[6] D. D. Jatkar and B. Beker, "Analysis of multilayer-multiconductor structures on anisotropic substrates using the finite difference method/ in IEEE Transactions on Components, Packaging, and Manufacturing Technology. Aug. 1995?Part B, vol. 1& no. 3, pp. 532-536.
[7] Harrington R F . Field computation by moment methods[M]. Macmillan, 1968・
[8] J. S. Pak, H. Kim and J. Lee, "Modeling and Measurement of Radiated Field Emission From a Power/Ground Plane Cavity Edge Excited by a Through-Hole Signal Via Based on a Balanced TLM and Via Coupling Model/ in IEEE Transactions on Advanced Packaging, Feb. 2007,voL 30, no. 1, pp. 73-85・
[9] R. E. Milsom, K. J. Scott and A. T. Yule, nBEM employing Taylor expansion for modelling complex PCB layout," 1994 Second International Conference on Computation in Electromagnetics, London, UK, 1994, pp. 339-342.
[10] 蒙特罗斯.电磁兼容和印刷电路板：理论、设计和布线[M].人民邮电出版 社,2002.
[11] Go!umbeanu V, Ionescu C , Codreanu N D , et al. Analysis of reflections for different electronic modules[C]// International Spring Seminar on Electronics Technology: Meeting the Challenges of Electronics Technology Progress. IEEE,
58
2005.
[12] Meni Anin A B , Damnjanovi M S9Ljiljana D. RF equivalent circuit modeling of surface mounted components for PCB applications [J]. Microelectronics International, 2010, 27(2):67-74.
[13] Gao Yougang, He Wei and Li Shufang, n Analysis of transmission line equations at high frequency/* 1999 IEEE International Symposium on Electromagnetic Compatability. Symposium Record (Cat. No.99CH36261), Seattle, WA, USA, 1999,pp. 185-188 voLl.
[14] Gupta S , Powers S ・ LPDDR4X Optimal PCB and PKG Trace Lengths in Automotive System[C]// IEEE International Symposium on Electromagnetic Compatibility;IEEE International Symposium on Signal & Power Integrity. 0.
[15] Du M , Li S , Qiu X ・ Via design in multi-layer PCB[C]// Environmental Electromagnetics, 2003. CEEM 2003 ・ Proceedings. Asia-Pacific Conference on. IEEE, 2003.
[16] Paul C R . Transmission lines in digital and analog electronic systems : signal integrity and crosstalk[M]// Transmission Lines in Digital and Analog Electronic Systems:Signal Integrity and Crosstalk. Wiley-IEEE Press, 2010.
[17] Paul C . Transmission lines in digital systems for EMC practitioners[M]・ Wiley, 2011.
[18] Hollaus K 9 Biro O ? Caldera P ? et al. Simulation of Crosstalk on Printed Circuit Boards by FDTD, FEM, and a Circuit Model [J], IEEE Transactions on Magnetics, 2008,44(6):p.l486-1489.
[19JMILSOM, R.F., SCOTT, K.J., and CLARK, G.:'Electrical simulation of multilayer PCB with non-parallel tracks and printed components'. 8th International Zurich Symposium and Technical Exhibition on EMC, 7-9 March, 1989,pp・ 63-68・
[20] Wu S ・ Analytical Prediction of Crosstalk Among Vias in Multilayer Printed Circuit Boards [J]. Electromagnetic Compatibility, IEEE Transactions on, 2012， 54(2):p.413\t-420.
[21] Shim Y, Dan O . Improved PCB via pattern to reduce crosstalk at package BGA region for high speed serial interface[C]// 2014 IEEE 64th Electronic Components and Technology Conference (ECTC). IEEE, 2014.
[22] Cheng M H , Tung Y J , Lai YT ? et aL Microstrip lines far-end crosstalk cancellation using striplines in hybrid PCB structure[C]// Asia-pacific International Symposium on Electromagnetic Compatibility. IEEE, 2016.
59
[23] Ruehli, E A. Equivalent Circuit Models for Three-Dimerisional Multiconductor Systems [J]. Microwave Theory & Techniques IEEE Transactions on, 1974, 22(3):216-221.
[24] Wang Z L, Wada O , Toyota Y, et aL Convergence acceleration and accuracy improvement in power bus impedance calculation with a fast algorithm using cavity modes[J]. IEEE Transactions on Electromagnetic Compatibility, 2005, 47(l):2-9・
[25] 丁伟英.网格状电源分配网络的电磁建模研究[D].浙江大学,2018： 15〜18
[26] 周润景，袁伟亭，张鹏飞.Cadence高速电路板设计与仿真-第3版[M].电子 工业出版社,2009.
[27] Eric Bogatin,李玉山，刘洋.信号完整性与电源完整性分析[M].电子工业出 版社,2015.
[28] J. B. Nitsch, R. Rambousky and S. Tkachenko, "Introduction of Reflection and Transmission Coefficients forNonunifbrm Radiating Transmission Lines," in IEEE Transactions on Electromagnetic Compatibility, Dec. 2015,vol. 57, no. 6, pp. 17051713.
[2刃范寿康.微波技术与微波电路[M].机械工业出版社,2003:15-4&
[30] Yan T, Ma Q , Wong M . Advances in PCB routing[J], Ipsj Transactions on System Lsi Design Methodology, 2012, 5:14-22.
[31] G. Dong, Y Biao, D. Xidong and L. Yuan, "Research on the influence of vias on signal transmission in multi-layer PCB," 2017 13th IEEE International Conference on Electronic Measurement & Instruments (ICEMI), Yangzhou, China, 2017, pp. 406-409.
[32] 江思敏.PCB和电磁兼容设计[M].机械工业出版社,2006:20〜50.
[3 3] Ying W, Han N T. The development of analog SPICE behavioral model based on IBIS model[C]// VLSI, 1999. Proceedings. Ninth Great Lakes Symposium on. IEEE, 2002.
[34] 李千.高速PCB设计中串扰与反射的研究[D].哈尔滨工程大学,2016： 1~20
[35] 张志伟.端接方法抑制反射的仿真及分析[J].智能计算机与应用， 2014(03):83-85.
[36] T立涛，初秀琴，范欣.端接方式对改善高速电路串扰的分析研究[J].电子 科技,2011.
[37] 陈星宇，石丹，王云鹏•基于机器学习的PCB串扰预测[J].太赫兹科学与电子信 息学报：1-7
[38] 周润景，王洪艳.Cadence高速电路版设计与仿真:信号与电源完整性分析•第
60
5版[M]・电子工业出版社,2015:100〜150.
[39] S. M. Sandler, "Measurement based VRM modeling/* 2017 IEEE 21st Workshop on Signal and Power Integrity (SPI), Lake Maggiore, Italy, 2017, pp. 1-4.
[40] Knighten, James L J・ Fan, et al, "PDN Design Strategies: II. Ceramic SMT Decoupling Capacitors 一 Does Location Matter^ IEEE EMC Society Newsletter, Issue No. 20& 2006, pp・ 56-67.
[41] T. Hubing, T. Van Doren, F. Sha, et al, "An Experimental Investigation of 4-Layer Printed Circuit Board Decoupling," IEEE International Symposium on Electromagnetic Compatibility, August 1995, pp. 308-312.
[42] Wang Z L, Wada O , Toyota Y, et al. Reduction of Q-factor of resonance in power/ground planes of multilayer PCBs by using resistive metal films卩]. Transactions of the Institute of Electrical Engineers of Japan A, 2001, 121(10):928- 932.
[43] S. Ramo, J. R・ Whinnery, and T. van Duzer, Fields and Waves in Communication Electronics. New York: Wiley, 1994, ch. 5 and 7.
[44] Wang Z L, Wada O , Toyota Y 5 et al. Convergence acceleration and accuracy improvement in power bus impedance calculation Avith a fast algorithm using cavity modes [J]. IEEE Transactions on Electromagnetic Compatibility, 2005,47(l):2-9.
[45] Chen W， Mao J , Selli G 5 et al. An efficient approach for power delivery network design with closed-form expressions for parasitic interconnect inductances [J]. IEEE Transactions on Advanced Packaging, 2006, 29(2):320-334.
[46] M. Swaminathan, D. Chung, S・ Grivet-Talocia, et al. Designingand modeling for power integrity [J]. IEEE Transactions on Electromagnetic Compatibility, 2010, 52(2): 288-310.
[47] 韩海涛.高速数字PCB板互连噪声建模与仿真研究[D].电子科技大
学.2006:33-35
[48] 章剑波.PCB板级共模噪声抑制方法研究[D].浙江大学,2016:11-12
[49] 张木水.高速电路电源分配网络设计与电源完整性分析.西安电子科技大 学,2009:18-25
[50] 王君.分布式电源分配网络建模及去耦设计研究[D].西安电子科技大学， 2019:10-20
61
