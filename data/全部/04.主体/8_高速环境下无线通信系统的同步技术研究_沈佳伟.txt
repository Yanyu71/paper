第一章绪论
移动互联网的快速发展带动了车联网技术的飞速发展，人们对于车辆通信的 需求也越来越强烈。在车辆通信技术的研究中，不管是LTE和802.11p,均釆用 了 OFDM技术。而OFDM技术对于频率偏差十分敏感。因此，对高速环境下车 辆通信中的同步技术研究具有重要的意义。
1.1课题背景及研究意义
当今时代，移动互联网风起云涌。移动互联网就是将互联网的技术、平台、 商业模式和应用与移动通信技术相结合，为人们随时随地提供各种各样的服务。 随着智能终端和4G、WIFI等通信技术的普及，移动社交、移动广告、手机游戏、 手机电视、移动电子阅读、移动定位、手机搜索、移动电子商务等应用都呈现井 喷式的发展。但是想要为这些应用提供高质量的服务，保证移动通信过程的稳定、 正确和快速是其中的基础与关键。因此移动互联网的快速发展也对我们的无线通 信技术提出了新的要求。车联网作为移动互联网的一部分，也面临着同样的机遇 与挑战。
近年来，随着我国社会经济、技术的快速发展，我国高速铁路的建设规模也 越来越大，全国已经建成多条高速铁路，包括“四纵四横”客运专线和城际客运系 统等。目前正在运行的高速铁路，包括京沪高铁、沪杭高铁等，其运行速度均达 到了 300km/h。因此，对于高速移动环境下的可靠通信越来越受到大家的关注。 乘客在高铁上的语音和多媒体通信需求越来越强烈，为高速铁路场景提供一个可 靠的个人移动通信解决方案成为亟待解决的问题。同时，随着高速公路的快速建 设以及私家车和公共交通的全面普及，人们对于车辆通信的需求也越来越强烈， 为了满足道路导航、实时定位和车载娱乐等汽车时代的基本需求，车辆互联网应 运而生。车辆通信技术可以大大的提高行车的安全性和便捷性，可以非常有效地 改善恶劣的交通环境。它是实现未来的智能交通的基础和关键，并为智能驾驶和 自动驾驶的进一步研究打下坚实的基础。
车辆通信作为高速环境下无线通信系统的典型应用，发展迅速。随着汽车销 量的持续快速增长以及国家4G网络、物联网、智能交通等的建设，我国的车载 信息服务产业将迎来蓬勃发展。车辆通信将车载和服务连接起来，不同的无线通 信技术为车载通信带来更多的变化。在车辆通信技术中除了传统的卫星定位技术 以外，最重要的是蜂窝通信技术和车路/车车协同信息交互技术。蜂窝通信技术 为车辆通信中的信息传送提供可靠安全且覆盖广泛的基础网络，随着LTE技术 的全面普及，当前主要是利用LTE技术实现车辆与现有主干网络之间的通信。 工信部电信研究院基于TD-LTE车辆安全短程通信研究目前已经完成，近期将形 成行业标准立项。车车/车路协同信息交互技术使得车辆本身成为智能交通的节 点，通过车与车之间交换运行状态信息，车与路边单元之间进行信息的交互。车 路协同主要采用专用短程通信技术，目前主流的标准是IEEE 802.11p。
因此，目前对于车辆无线通信网络及其中的无线通信技术的研究主要集中在 LTE和802.1 lp两个方面。对于LTE,作为准4G无线通信技术标准，其引入了 OFDM和MIMO等关键技术，显著增加了数据传输速率和频谱利用率，并支持 多种带宽分配，频谱配置灵活，支持高移动性和低时延，系统网络架构扁平化， 减少了网络节点和系统复杂度。对于IEEE 802.11p,其工作频率为 5.850〜5.925GHz,共 75MHz,被划分为 7 个 10MHz 的信道。802.1 lp 使用了 64 点OFDM技术，其信道带宽也降为10MHz ,是802.Ha的一半，提高了车载环 境下抵抗多径传播和多普勒效应的能力，信息传输速率为3~27Mbit/so
由此我们可以看到，在车辆通信中，不管是LTE还是IEEE 802.1 lp,其物理 层均采用了 OFDM技术。OFDM作为一种频率复用技术，具有较强的抗频率选 择性衰落的能力和较高的频谱利用率。OFDM技术将高速的数据流分成多个并 行的低速数据流，分别在不同的子信道上（子载波上）进行传输。宙于子载波间 相互正交，因此各个子载波间的频谱可以相互重叠，提高了频谱利用率。所以说， OFDM对于频率偏差十分敏感，由于OFDM的子载波相互正交，子信道的频谱 相互覆盖，通信系统收发两端的频率偏移，尤其是高速移动导致的多普勒频移， 都会使得OFDM子载波之间的正交性遭到破坏，每一个子载波上的数据都将受 到其余多个子载波上数据的干扰，形成子载波间干扰ICI,使解调性能迅速恶化。
对于车辆通信的无线通信环境，其通信信道一方面受高速运动带来的多普勒 频移导致的时变快衰落，另一方面受信号多径传播导致的信号频率选择性衰落和 ISL因此对于车辆环境下OFDM系统来说，其同步技术至关重要。对于LTE和 802.1 Ip在车辆通信下的应用并保证其通信质量，研究其同步算法具有重大的意 义。
1.2国内外研究现状
对于车辆通信而言，不管是采用LTE还是802.1 lp,其物理层都是采用了 OFDM技术。因此对高速环境下车辆通信的同步技术研究，主要就是对OFDM 系统的同步技术研究。对于采用OFDM技术的无线通信系统，其同步算法主要 可分为基于数据辅助的同步算法和非数据辅助的同步算法。
2
数据辅助的同步算法[>][2][3][4][5][6][7][8]具有复杂度低的特点，尽管占用了一定 数据符号，在一定程度上降低了数据传输效率，但由于能获得较好的同步估计结 果，因此广泛被应用于同步算法中。S&C算法是数据辅助算法中比较经典的算 法，其频偏估计范围为一个子载波间隔，同时还利用前后两个符号间特有的关系 进行整数频偏估计。在这两个特殊符号中，每个符号均分为相同的两部分，以达 到定时同步和小数频偏估计的目的。利用S&C算法进行定时估计时，其定时测 度为一平台，这会引起一个大的方差，H.Minn对S&C算法作了改进，使其定时 测度为尖峰，但在子载波数目比较小的系统中，其定时测度会出现多个峰值，因 此Park对H.Minn算法作了改进，设计了具有共轴对称性的训练符号，使其产生 一个像脉冲一样的定时测度，使其精度大大提高。Bo-Seok也是在S&C算法的 基础上做了适当的改进，它将S&C用作导频的两个特殊OFDM的子载波上采用 差分相位调制。S&C算法通过导频符号的绝对相位获得信道信息，而Bo-Seok 算法则是利用导频符号的相对相位差得到整数倍的频偏估计。Bo-Seok频偏估计 算法能获得较S&C算法更精确的结果，但由于估计范围被限制在半个子载波内， 使得Bo-Seok算法的使用受限。当相邻子载波信道频率响应相对静止时，可利用 定时同步偏差产生的相位旋转差异实现定时细同步。根据这一特性，Luise提出 了一种BLUE (Best Linear Unbiased Estimation)频率同步算法—最优线性无偏 估计算法。该算法用更复杂的计算达到了比Schmid】提出算法更高的估计精度。 后来，Morelli等人对BLUE频率同步算法做了适当改进，使其复杂度稍有降低。
在数据辅助的同步算法中，由于CAZAC序列具有恒包络和零相关性的特 点，因此基于该训练序列符号的设计和同步算法也得到了广泛的研究。Lambrette 在连续间隔数据符号中插入重复CAZAC序列，得出一种精度较高的同步算法【幻。 Czylwik提出了一种采用Chirp序列的时频估计算法卩°】。该算法的训练符号使用 了两个相同的Chirp序列，利用这两个符号的相关性完成频率估计，但是估计范 围被局限于正负1内。Guangliang REN等人重新构造了 Czylwik提出的导频符号， 引入了加权因子〔山。TufVesson提出的算法中，导频序列采用重复的PN序列卩2〕， 该算法可以调节频率估计的精度和范围。
非数据辅助同步算法不需要占用额外数据，因此能保证信号原有数据传输效 率。盲估计和循环前缀估计算法均属于非数据辅助算法的范畴。但这类算法的计 算复杂度普遍偏高，并且性能也较差。循环前缀是数据符号中的一部分，因此与 原数据符号具有良好的相关性，接收端可以利用这种特性完成定时和频偏估计 [|3][14][15][16](17][18][19]0 Van de Beek 提出了 AWGN 信道下基于 CP 的同步算法。但 是由于CP本身是用于OFDM抵抗多径干扰的，当信道多径衰落严重时，CP与 原数据符号的相关性遭到破坏，大大影响了同步性能。为了抵抗多径衰落对CP 同步算法的干扰，Landstorm在Van de Beek的基础上，将CP同步算法和离散导 频同步算法结合起来，在多径干扰严重的情况下仍获得了较好的同步性能。此外 Takahashi根据CP与原符号的直接相似性以及Ramasubramanian采用CP集相关 特性的同步算法都支持多径干扰严重的情况。
除了利用循环前缀完成同步之外，仍有不少算法根据信号的高阶统计特性实 现同步估计[20][21]（22][23][24]o Qh JS等人将时域接收信号过采样后分为奇数序列和 偶数序列，两列序列由于受频偏的影响，产生不同相位偏差，根据该相位偏差关 系实现频率同步。该算法处理速度快，充分利用接收信号，无需进行时频转换， 可用于跟踪于较大范围的载波偏移。Tureli则利用虚载波实现同步算法，但计算 复杂度非常高。Luise通过分析得到，OFDM系统受频偏影响后的结果与QAM 系统受抽样误差影响的结果类似。根据这一分析，Luise提出了一种复杂度较低 的盲同步算法，并有一定的抵抗频率选择性衰落的能力。
随着无线通信技术及其应用场景的不断发展，针对高速环境时变信道下的有 关 OFDM 系统的频率同步研究也在不断发展[25][26][27][28][29][30][31][32]cNathanRicklin 等人提出了时变信道下基于数据辅助的信道和载波频偏联合估计算法，该算法分 别在信道统计特性已知和未知时做出不同的处理，分别采用最大后验概率估计算 法MAP和最大似然估计算法ML。Qi Jiang等人利用导频和修正的时变信道的复 指数基扩展CE-BEM模型，提出了信号的频偏估计算法，但是该算法的约束条 件较强，一旦提高复指数基扩展模型的阶数，该算法将无法推导oHungNguyen-Le 等人提出了一种时变信道下对于单用户的OFDM系统的频偏估计算法，该算法 在利用导频的基础上采取递归最小二乘RLS、最大似然ML、最大后验概率MAP 等方法完成的。Eric Pierre Simon等人通过建立状态方程和观测方程以及不断迭 代扩展的Kalman滤波，提出了一种对信道和频率偏差的联合估计算法。该算法 是针对多用户的MIMO-OFDM系统提出的，通过建立基扩展模型实现信道状态 和载波频率偏差的估计，但是由于算法中采用了自回归的迭代方法，使得算法的 计算复杂度大，迭代速度也比较慢。另外除了上面介绍的算法外，Yu-Ting Sun 等人提出了一种基于MUSIC算法的对载波聚合OFDM系统的多频偏估计算法。
另外，对于高速环境下的无线通信系统来说，多普勒频移是影响系统性能的 一大问题，因此对多普勒频移的估计也是十分重要的。对于多普勒频偏估计的研 究，比较经典的算法主要有：SampathA提出了在计算得到信道冲激响应的基础 上进行自相关（ACF）的估计算法El,该算法需要精确的信道估计方法为前提。 SchoberH等人改进了 ACF算法，直接利用接收信号的频域值完成相关估计，但 是该算法的估计精度较低[34】。Jack M等人基于接收信号包络的平方偏差，提出 了一种多普勒频移的估计算法，该算法的复杂度比LCR算法要高mi。LCR算法,
即电平交叉率估计算法，是一种计算较为简单的算法,但是其估计精度无法保证。 Goohyun Park通过分析对比接收的频域导频信号和衰落信号的频谱特性，提出了 一种基于信道功率谱(CPS)的多普勒频移的估计算法，该算法可以通过调节FFT 变换的点数来获得较高的估计精度HI。
1.3本文的主要内容及章节安排
本文主要研究了高速环境下无线通信系统的同步技术,文章以车辆通信为切 入点和主要应用场景，分析了车辆通信下分别釆用802.lip和LTE技术标准情形 下，如何进行同步以及对同步算法的仿真和硬件实现。文章主要研究和探讨了以 下几方面的内容：
(1)分别讨论了基于LTE协议和IEEE 802.lip协议的车辆通信系统，主要 是它们的物理层帧结构。LTE的帧结构为时频二维结构，在时域上以帧、子帧、 时隙进行划分，一帧包含10个子帧，1个子帧包含2个时隙，1个时隙包含7个 OFDM符号；在频域上以资源块RB进行划分，不同的带宽包含不同的RB数，
1个RB包含12个子载波。而802.1 Ip的帧结构则是由不同的OFDM符号组成 的，包括短训练序列、长训练序列、数据符号以及他们之间作为保护间隔的循环 前缀。
(2)研究了无线通信环境下OFDM系统的同步算法，并给出了 LTE下的一 种联合频偏估计算法。OFDM系统的同步算法主要分为数据辅助的同步算法和 非数据辅助的同步算法。数据辅助的同步算法主要有基于训练序列的、有基于导 频的、有基于CAZAC序列的；非数据辅助的同步算法主要有基于CP的同步算 法和盲同步算法。文章重点介绍了基于数据辅助的同步算法，包括Schmidl、 P.H.Moose等算法。另外在这些算法的基础上针对LTE的帧结构和参考信号的插 入方式，提出了 LTE下利用主同步序列和参考信号进行频偏联合估计的算法。
(3)重点针对IEEE 802.1 Ip T的频率同步算法进行了研究和硬件实现。针 对802.1 Ip的帧结构特点我们提出了易于硬件实现的频率同步算法，包括载波同 步和相位补偿两个模块。本文利用Verilog语言和Altera的FPGA开发板对频率 同步算法进行了实现，并将所实现的两个模块分别加入己有的车载通信的物理原 型机上，通过视频传输调试，顺利实现了收发板之间的射频传输。
根据论文研究的主要内容，文章的主要章节安排如下：
第一章为绪论，首先介绍了课题的背景及研究意义，包括车辆通信的发展及 关键技术和存在的问题等，接着介绍了当前OFDM系统的同步技术研究的现状， 最后阐述了本论文的主要内容及其章节安排。
第二章阐述了高速环境下的车辆无线通信系统，重点分析了车辆通信主要所 釆用的两种标准技术：ETE和802.1 lp»在介绍两种技术共同釆用的OFDM基本 原理的基础上分别介绍了他们的物理层结构。同时，对高速环境下的无线信道的 特性进行了初步的研究。
第三章研究了无线通信环境下的同步算法，主要包括同步算法的分类和经典 算法的介绍，并且在研究之前算法的基础上给出了在LTE下的联合频偏同步算 法，对算法结果进行了仿真和比较，并对算法进行了分析。
第四章重点研究并介绍了基于802.1 Ip的频率同步算法，包括载波同步和相 位跟踪，在对相应算法进行描述的基础上，对算法进行了硬件实现，并且通过仿 真联调和实际射频调试对算法的硬件实现进行了验证，并且对硬件实现中遇到的 一些问题进行了总结。
第五章是总结与展望，对全文进行总结，对论文研究过程中存在的不足和问 题进行了分析，并对今后的研究方向及工作目标进行了展望，提出了一些建议。
第二章高速环境下车辆无线通信系统
车辆通信作为高速环境下无线通信的常见应用场景，发展迅速，车联网技术 正快速兴起。而针对于车联网中车辆通信方式的选择，目前有两种主要的研究方 向，一个是基于专门的车联网协议，如802.11P, 一个是利用现有的蜂窝网络， 如LTE,作为车与车、车与基站之间的通信方式。其中,IEEE 802.1 Ip协议是IEEE 802.11a协议在高速移动车辆环境下的拓展，与802.11a-样，802.lip协议物理 层传输技术釆用正交频分复用OFDM技术。而支持高速率数据传输的LTE技术, 其下行链路釆用OFDM技术，具有较强的抗码间干扰的能力和频谱利用率高的 特点。可以看到两种通信系统在物理层的技术均釆用了 OFDM技术。下面就 OFDM技术、802.lip和LTE分别作一个简单的介绍。
2.1 OFDM技术的基本原理
OFDM技术是一种频分复用技术，在一个符号内，N个子载波分别承载原高 速数据流的一部分数据。由于子载波上的数据传输速率是原始数据的1/N,降低 了经历频率选择性衰落的可能。并且，不同于依靠频谱划分的一般频分复用技术， OFDM各子载波信道的频谱相互重叠，接收端根据各子载波间的正交性完成解 调，大大提高了频谱资源的利用效率Ml。
OFDM符号中每个子载波都受到独立的PSK或者QAM调制。一个从々开 始的OFDM符号可以表示为：
s（，）=Re 像却冲；+*）（1』｝	ts<t<ts+T （2」）
0	t<ts or t>ts+T
其中，T是一个OFDM的持续时间，N是子载波数量，子载波编号从。到 N-l, d,•是第i个子载波上的调制符号，九是第0个子载波的频率，即中心频率。
由于OFDM的调制解调主要在基带完成，所以通常使用复等效基带信号来 表示OFDM符号，用式（2・2）表示：
”n-i	r	-	'
,八」叫丿2件（s《）？ ts<t<ts+T
j=o	L	丁	J	（2-2）
0	r<or t>ts+T
复等效基带信号的实部与虚部分别对应OFDM符号中的同相分量和正交分 量，将实部与cos分量相乘的结果和虚部与sin分量相乘的结果相加，就构成了
实际通信系统中传输的OFDM符号。接收端利用三角函数正交性，区分不同子 信道，获得同相和正交分量，还原发送数据。图2-1给出了 OFDM系统基本模 型的框图，在接收端，接收到的同相分量和正交分量通过和接收端相反的操作映
射回数据信息，完成子载波解调。

图2-1 OFDM系统基本模型框图
复等效基带信号正交的两个子载波正交，子信道数据解调时将接收信号乘以 调试函数后的结果在T时间长度内积分。由于子载波间的正交性，相乘的调制函 数如果与发送端相同，则积分后结果不为0;如果乘以其他信道的调试函数，则 积分后的结果为0。如式(2-3)所示：
1 c	i	k
了 J《exp j27r-(t-ts) • d*exp	dt
=—Jd,.exp jln—t • dk exp jln—t Ut
T o I T ) I T
_ 0 i.k
d； i = k
子载波之间的正交性使得我们可以通过积分解调出每个子载波上的信息，并 且各子载波之间没有信道间干扰(ICI)o
在对OFDM的调制中，釆用了离散傅里叶变换DFT进行实现。对复等效基 带信号s(t)进行抽样，抽样速率为T/N,并设起始吋刻\=0,可以得到第k个样 值的表达式如式(2-4)所示：
NT	(	ik、
s*=£4exp 丿2才篇	Q<k<N-\
，=0	V	N)	(2-4)
可以看出，&等效于4的离散傅里叶逆变换(IDFT)o因此，在接收端，为 了恢复4可以对公进行离散傅里叶变换(DFT),如式(2-5)所示：
NT	(	永、
4 = »Kxp -/2^r —	0<A<7V-l
*=o	V	N)	(2-5)
复数符号4.其实是基带OFDM符号的频域样值，&则是时域的样值。由上 式可以看出，IDFT/DFT数学变换与OFDM符号的调制解调等价。因此，在实际 系统应用中，可采用IDFT/DFT实现该调制解调过程，然后进行数模转换得到连 续的OFDM基带符号；在接收端，先对连续的基带信号进行抽样，然后对样值 进行DFT运算，就可以恢复出频域数据。由于DFT具有快速算法FFT,所以在 实际应用中采用FFT/IFFT进行调制解调。对于基2的FFT来说，完成N点的运 算仅需要进行ylog2 N次复数乘法，而依照定义式进行N点DFT运算则需要N2 次复数乘法，有效降低了运算的时间复杂度，随着点数N的增加，运算量的增 长仅稍快于线性增长。对于高点数的DFT运算，可以采用基4的FFT算法，性 能将得到进一步提高。
尽管子载波上低速的数据流使得OFDM符号具有良好的抵抗频率选择性衰 落的能力，但是在时延扩展时间内，OFDM符号仍受符号间干扰(ISI)的影响。 为了解决这一问题，可在OFDM符号间插入一段保护间隔，降低ISI的影响。但 如果插入空白间隔，由于到达接收机的多路信号具有不同的时延，那么FFT运 算长度中一些子载波不具有完整的一个周期，这会破坏子载波间的正交性，产生 ICIe为了解决这个问题，人们想到用循环前缀来填充保护间隔。添加循环前缀 的方式之一是把IFFT运算后得到的离散时域样值的末尾一段加到整段符号的前 面。这样无论FFT运算区间如何选取，区间中的子载波都具有完整的周期，这 就保证了子载波间的正交性。虽然通过添加循环前缀抑制了 ISI和ICI,但是循 环前缀属于系统开销，数据速率将会下降，这也意味着信噪比的损耗。
OFDM基带收发系统如图2-2所示。其处理流程大致如下：首先对输入比特 进行信道编码，比如卷积编码、Turbo码等，编码完后进行样值的交织，接着进 行基带调制，如BPSK、QPSK、MQAM调制。将调制后的符号通过串并转化划 分为K个低速符号流。发送端将K个符号送入DFT变换器完成N点的调制，并 且满足KWN。由于FFT计算速度更快，实际系统中一般使用FFT代替DFT。 信号在频谱的两端预留一定虚载波的宽度作为保护带宽，以满足滤波器的性能要 求。同时，为了接收端能跟踪不断变化的无线信道，可在这些空白子载波中插入 已知导频，使接收端可以利用接收符号中的导频信息完成信道质量检测和估计， 提高接收性能。FFT变换后得到长度为N的样值序列，取其后L个数据插入序 列前部形成CP,就构成了一个完整的基带OFDM符号。根据实际系统的需求， 可对基带OFDM符号进行成形滤波。发送端通过D/A转换和射频电路将基带 OFDM符号送入无线空中信道。接收端对接收到的空中信号通过A/D转换为数 字信号，通过时钟同步、符号同步以及载波同步等一系列同步处理得到接收信号 的有效起始点。根据发送端插入CP的长度去除CP,并按发送端IFFT点数串并
9 变换为N个数据点，送入FFT完成多载波解调。接收信号在无线信道中受到不 同程度的衰落，特别是在信道质量较差情况下直接利用FFT后的数据可能引入 较大误差，因此需要根据发送端插入的导频符号或接收信号自身信息完成信道校 正，提高接收信号质量。从校正后的信号中提取出K个有用信号，根据发送端 的处理协议完成信号的解星座映射、解交织和译码，还原发送端发送的原始比特 流。


图2-2 OFDM系统收发机框图
相比于传统通信技术，OFDM具有以下几方面的优点：
（1）	抵抗ISI能力较强。N点的串并变换使得OFDM各子信道上的传输速 率只有原始的1/N,每个子载波上的符号长度相对被延长。在信道时延扩展一定 的情况下，符号长度越长，抵抗ISI的能力越强；
（2）	OFDM依靠子载波之间的正交性完成子信道划分，允许子信道频谱重 叠，因此具有更高的频谱利用率。
（3）	FFT比DFT拥有更快的处理速度。随着大规模集成电路的发展和DSP、 FPGA等数字处理器的广泛应用，使OFDM系统的实现可利用FFT/IFFT模块完 成，为OFDM系统的广泛应用奠定了硬件基础。
当前，OFDM系统同样也存在缺点，这些缺点是OFDM系统性能提升的瓶 颈，具体表现在：
（1）	易受频率偏移的影响。由于OFDM系统子载波信道重叠，因此严格要 求子载波间保持正交。一旦在传输过程中受到多普勒效应的影响，或是收发机的 本地振荡存在偏差，都将破坏子载波的正交性，使得FFT变换后引入载波干扰
（ICI）o ICI严重时将严重影响解调后数据的可靠性。
（2）	峰均比较高。当各子信道数据符号相位一致时，OFDM瞬时功率将远 远大于平均功率，此时造成发送信道的高峰值平均功率比（PAPR）,使发送端的
10 线性功放器面临巨大挑战。如果线性功放器的性能达不到要求，将导致信号畸变, 功率谱发生变化，系统性能将急剧降低。
2.2 LTE下行物理层协议概述
LTE （LongTerm Evolution）是由3GPP组织制定的准4G技术标准，其核心 调制技术采用OFDM技术。与现有通信技术相比，LTE主要具有如下技术特点:
（1）系统传输能力高。根据3GPP规定，LTE上下行峰值速率最高可分别达到 100Mb/s和50Mb/so平均用户吞吐量是传统3G网络的2到3倍；（2）高移动性 支持和低时延，LTE能最高支持500km/h下的移动网络接入，数据的处理时延在 5ms以内；（3）LTE支持多种带宽设置，支持成对和非成对带宽配置和频带整合。
2.2.1 LTE帧结构
LTE支持两种类型的无线帧结构，分别对应两种不同的双工模式：FDD模式 和TDD模式。本文研究主要针对TDD模式，故对FDD模式不做展开介绍。
TDD模式下，无线帧长7} = 307200• 7；= 10ms,由10个子帧构成，每个子 帧的长度是1ms。通常情况下每个子帧又包括两个时隙，1个时隙的长度是7个 OFDM符号的长度。TDD-LTE数据帧中包含三个特殊子帧，分别是DwPTS, GP和UpPTS。DwPTS和UwPTS用于传输相关参考信号或控制信息。GP是上 下行之间的保护间隔。TDD-LTE可以支持上下行不对称时隙传输，协议中规定 了 7种可用时隙配比。3GPP协议规定通常情况下TDD-LTE有两种长度的循环 前缀，第一个符号的循环前缀是160个符号样值，其他符号的循环前缀长度是 144个符号样值。此外，为了增加系统的灵活性和业务支持能力，3GPP根据子 载波间隔不同引入了不同长度的扩展循环前缀，分别为512个符号样值长度和 1024个符号样值长度。其帧结构如图2-3所示。

图2-3 TD-LTE帧结构

11

2.2.2时隙结构与物理资源
LTE下行链路传输中时隙结构为时频二维结构，最小的时频单位为资源单元 RE,其构成了 LTE的资源块RBo	个子载波和忠b个OFDM符号构成
了一个时隙的传输信号。资源格结构如图2-4所示。其中，處的大小，即下行 链路在频域上包含的RB数，取决于小区中的下行传输带宽的配置，根据不同的 带宽配置，其值可以取6、15、25、50、75、100。而CP长度和子载波间隔决定 了时隙中的OFDM符号个数。
One downlink slot T^i





k=0
图2-4 LTE下行链路资源柵格
物理信道到资源单元的映射用资源块RB表示。从图中我们可以看出，一个 子载波和一个符号共同确定的资源单元称为资源粒（RE）, 乂？个连续的子载波 和M斜b个连续的OFDM符号构成了资源块（RB）。一般情况下，一个RB包含 12个子载波，子载波间隔为15kHz,占用180kHz带宽，在时域上占7个OFDM 符号，0.5ms的时间，即一个时隙。LTE系统中调度的基本单位是子帧，包含两 个RBo
12
2.2.3参考信号和同步序列
LTE系统在其时频二维结构中插入参考信号RS (Reference Signal)作为导 频信号，对信号进行相干解调。LTE下行信道包括了小区专用参考信号、UE专 用参考信号和MBSFN参考信号3类参考信号。为了保证发射信号具有较低的峰 均比，所有参考信号都釆用QPSK进行调制。本文在实现算法仿真时只用到了小 区参考信号，故对其他两种参考信号不做详细介绍。
下行信道可以利用小区专用参考信号进行频率估计和信道估计。在单天线情 况下，小区专用参考信号的结构如图2-5所示。时域上参考信号位于每个时隙第 1个OFDM符号和第5个OFDM符号，频域上，每6个子载波插入一个参考信 号。以1个资源块为例，子载波间隔为15kHz时，该资源块共包含12个子载波, 标号为1至12,则该时隙内第1个符号从第1号子载波开始的每间隔6个子载 波插入1个参考信号。而在第5个OFDM符号频域范围内，从第3个子载波开 始每间隔6个子载波插入一个参考信号。一个RB中含有4个参考信号。


图2-5单天线下小区参考信号配置
如式(2-6)所示，参考信号序列為(时定义为：
% (秫)=丄(1一2一(2时)+ 丿丄(1一2七(2«1 + 1)),四=0,1,...,2熠皿_1 (2.6) v2	v2	-
其中，其是一个无线帧中的时隙号，/是一个时隙中的OFDM符号序号，c(z) 是由长度为31的Gold序列产生的伪随机序列。
另外，LTE下行链路物理帧结构中还包含有同步序列，包括主同步序列PSS 和辅同步序列SSS。UE检测主同步信号和辅同步信号进行时间和频率同步，同 时获取小区的物理标识(即小区ID)和循环前缀的长度。PSS和SSS由长度为 62的Zadoff-Chu序列组成，小区ID和CP类型决定了 ZC序列的根指数。频域
13
上，PSS和SSS在中心的6个RB内传输。ZC序列中的62个符号映射到带宽中 心的62个子载波上，两侧的10个子载波作为预留资源不传输PSS/SSS,如图2-6 所示。时域上，PSS映射在每个无线帧的第1个和第6个子帧的第2个时隙的第 3个符号，SSS映射在每个无线帧的第1个和第6个子帧的第1个时隙的第6个 符号。
「5个零 十63个子载波(出去中间直流)十 5个零 「



图2-6 PSS序列在频域上的映射
以PSS信号为例，其为Zadoff-Chu序列，可由式(2-7)产生:

其中，u为ZC序列的根序列号，根据小区ID号的不同可取25、29、34。
2.3 802.1 Ip的物理层介绍
IEEE 802.1 Ip是由IEEE 802.11标准扩充而来的通信协议，主要用于车载电 子无线通信，适用于车辆通信的高速环境。它工作在5.9GHz频段(5.875 - 5.925GHz),提供了 3〜27Mb/s的数据速率。与802.1 la 一样，802.1 Ip协议物理 层传输技术同样采用OFDM技术，且采用相同的帧结构，只是根据车辆无线环 境的高速移动性的特点，将信道带宽和传输速率缩减了一半，以减小其相干带宽， 从而增强了其对抗多径时延的能力。
2.3.1系统参数
如表2-1所示为IEEE 802.1 Ip物理层标准的主要系统参数。相比于LTE物理 层协议，802.11p物理层规定了更大的保护间隔长度，使其容忍多径时延的能力 增强，以至于能够支撑更高的移动速度。802.11p规定一个OFDM符号总共有80 个样值点，其中CP长度为16,数据长度为64。因此数据符号长度为6.4"s, 子载波间隔为1/6.4冋=156.25kHz。标准中规定，64个FFT数据中，48为有效 子载波承载数据，4个为导频子载波。接收端可利用发送端插入的导频完成频率 校正、信道估计、频偏估计，增加接收信号的可靠性。同时，协议规定了 BPSK、
14

QPSK及16QAM等多种调制方式和1/2、2/3等种编码效率配合使用，使系统满 足3Mb/s至27Mb/s等不同传输速率的需求。
表2-1 IEEE 802.1 Ip物理层标准的主要•系统参数
参数	数 值
数据速率(Mb/s)	3、 4.5、 6、 9、 12、 18、 24、 27
调制方式	BPSK、QPSK、16QAM、64QAM
编码效率	1/2、2/3、3/4
总子载波数量N	64
数据子载波数量Nd	48
空载波数量Ne	12
导频子载波数量Np	4
OFDM有效符号长度T(ns)	8
保护间隔长度Tg(gs)	1.6
子载波间隔AF (kHz)	156.25
信道总带宽/信道间隔(MHz)	10

2.3.2子载波分配
在上一节中己经介绍，802.1 Ip中有用子载波数总共为52个，其中48个承 我数据信号，4个承载导频信号。由于IFFT采用64个点，因此将有部分子载波 为填0子载波。为了节约频谱资源，降低系统占用带宽，802.11p将有用子载波 集中插入FFT中，其具体子载波标号为：k=-32,…，-27, 27,…，31。髙端编 号和低端编号的子载波保留为空白符号，减少信道间干扰。将子载波映射到IFFT 的64点输入时，将两边的空子载波都集中到中间的子载波上，即将前一半的子 载波整体搬移到后半部分，如图2-7所示。导频将插入编号为7、21、43、57的 子载波当中。
15

频率
图2-7 802.lip物理层子载波映射方式

2.3.3帧结构
IEEE 802.1 Ip标准所规定的物理层协议数据单元(PPDU)帧结构，作为基 带发射处理器所要产生的数据结构，如图2-8所示。


图2-8 802.1 Ip的PPDU帧结构
从图中可以看出，PPDU帧结构中包含了短训练序列(ShortTraining Symbol, STS)、长训练序列(Long Training Symbol, LTS)、SIGNAL 域以及数据符号。 其中接收机利用10个周期重复的短训练序列和两个周期重复的长训练序列来完 成定时同步、载波估计和信道估计等功能。一个短训练序列包含16个样值，一 个长训练序列包含64个样值。长训练序列之后是一个OFDM符号长度的 “SIGNAL”域，它包含了接收机需要的数据长度、数据调制类型、编码速率等重 要信息。STS、LTS和SIGNAL域共同构成了 802.1 Ip发送的物理帧的帧头，接 收机需要在利用它们完成训练任务之后才对数据符号译码。帧头后面跟的是数据 符号域DATA,它包含了物理层服务数据单元、服务域、尾比特域以及填充比特 等。
根据802.1 Ip协议标准，短训练序列由10个周期重复的符号组成，每个长 1600ns,包含16个样值，其主要用于符号定时、粗频偏估计、信号检测和自动 增益控制。利用短训练序列做频率偏移估计，可以得到的最大频率偏差为1/2T, 即312.75kHz。同时，短训练序列由于其持续时间短、周期重复多的特点，更加 容易测量并调整训练数据。
长训练序列紧跟在短训练序列之后，一个长训练序列与一个OFDM符号一
16
样，长为6.4徊，包含64个样值。802.1 Ip中包含两个长训练序列以及一个长的 保护间隔。
2.4无线信道的传输特性
无线传输信道是无线通信系统的基础，它处于无线通信系统的最底层却是整 个无线通信系统的关键，制约着无线通信系统的传输速率和传输质量。对无线信 道特性的研究以及信道建模，为通信系统的设计提供参数化的依据，是通信系统 设计、建立以及优化的重要基础。通信系统任一方面的性能提升必须以信道允许 条件为前提。
无线信道与其他通信信道相比，是其中变化最为复杂的一种信道。电波在无 线信道中主要有直射波、折射波、散射波三种传播方式。信号在空中经过传播之 后会受到不同的衰落影响，再加上接收端的运动，会使得信号经过无线信道之后 更加多变。根据信号幅度随着时间和频率的不同变化，可以把信号衰落分成大尺 度衰落和小尺度衰落两种。其分类情况如图2-9所示。


图2-9无线衰落信道的分类
其中大尺度衰落主要包括路径损耗和阴影衰落。路径损耗是由于发射功率的 扩散以及电波传播在较大距离的路径上引起的接收信号的功率衰减和能量损失， 反映出接收信号电平均值在宏观大范围（千米量级）的距离上的变化趋势。阴影 衰落是指电磁波在传播时受到建筑物的遮挡或者地形的影响而产生阴影效应，反 映了接收信号电平均值在中等范围（数百波长量级）的空间距离上的变化趋势。
而小尺度衰落是指由于多径传播造成信号的电平和相位发生快速变化以及 由于多普勒扩展造成的信道时间差异对信号产生不同的衰落。由信号参数（如带 宽，符号间隔等）与信道参数（如时延扩展和多普勒扩展）的不同关系形成了四
17
种不同的衰落类型，分别是平坦性衰落和频率选择性衰落、快衰落和慢衰落。 当信号周期远远大于信道的时延扩展，或者信号带宽远远小于相干带宽，则 接收信号经历平坦性衰落信道，即：Ts»aT或B,«8/信号在平坦性衰落信 道下只经历了一个可分辨的衰落，各频率分量受到相同的衰落，接收到的信号的 频谱特性保持不变，符号间干扰可以忽略。当信号周期小于信道的时延扩展，或 基带信号带宽大于相干带宽，则接收信号经历频率选择性衰落信道，即：Ts<aT 或BS>BC.信号在频率选择性衰落信道下经历了多个可分辨的衰落，不同频率 的信号受到的衰落程度不同，信号波形发生畸变，幅度和相位随机变化。子载波 之间相互干扰，信号波形发生严重失真，误码率增大。
当信道的相干时间小于所传信号的符号间隔，或者信道的多普勒扩展大于信 号的符号速率，即TS>TC或氏叫，则信号受到了快衰落。在快衰落信道中，信 道冲激响应在符号周期内快速变化，信号由于多普勒频移产生多普勒扩展而造成 失真。当数字基带信号的符号间隔远小于信道的相干时间，或信号的符号速率远 大于信道的多普勒扩展，即TS«TC或Rs»Bd，则信号受到慢衰落。在慢衰落 信道中，信道冲激响应在符号周期内基本不变，信号在一个符号周期内基本保持 稳定。
在车辆通信的高速移动环境下，多径传播和多普勒频移是影响信道质量的两 个主要因素。与传统无线通信系统相比较，车辆无线信道具有速度快、时变快衰 落、多普勒效应严重的特点。而且由于路边建筑、道路情况、车辆之间相对速度 等多种因素的影响，使得无线信道质量十分不稳定。当车辆行驶在市区等人群、 楼宇密集的区域时，影响系统通信质量的主要因素是多径衰落；当车辆行驶在郊 外、高速公路等开阔区域时，影响系统通信质量的主要因素是多普勒频移EL
在模拟车辆通信的信道时，我们可以釆用COST207模型。COST207定义了 三种信道传播模型，分别是乡村(Rurual Area, RA)模型、典型城市(Typical Urban, TU)模型和山区(HillyTerrian, HT)模型，最高可支持250knVh的运行速度。每 种传播模型定义了个各自的多径数目，且每一径均给出了相对于主径的多径时 延、相对功率和频谱类型。该模型中的可用频谱类型分别为经典谱、莱斯谱、高 斯1型谱和高斯2型谱。用S踞(/)表示功率谱，则经典谱在多径时延小于500ns 时的定义为：
用于描述直射径的莱斯谱的定义为:

在RA、TU、HT这三种模型当中，RA是以主径为莱斯衰落，其余径为瑞利 衰落的信道传播模型，因此该模型更符合车辆通信下的信道特征。典型的RAx6 模型中定义6径信道，其具体参数如表2-3所示。
表2-2 COST207RAx6信道模型参数即］
径数	相对时延
（.S ）	平均相对 增益（dB）	多普勒谱
1	0	0	莱斯
2	0.1	-4	经典
3	0.2	-8	经典
4	0.3	-12	经典
5	0.4	-16	经典
6	0.5	-20	经典

RA模型适用于远郊平原或乡村等高速公路区域（非山区），在该环境下，传 播信号受到轻度的散射作用，接收端存在少量的散射分量。同时该模型考虑了该 环境下的直射分量，莱斯分量可考虑在6-18dB范围内。
在本文的算法仿真实现时，釆用的是具有直射信号的莱斯衰落信道加上多普 勒频移来模拟车辆高速行驶在较空旷环境下的实际信道。
2.5本章小结
本章主要对高速环境下车辆通信采用的两种主要方法LTE和IEEE 802.1 Ip 进行了相关的介绍。首先，对于这两种方法在物理层均采用的OFDM技术的基 本原理进行了阐述，包括实现方式、处理过程以及相应的优缺点等。接着分别介 绍了 LTE和802.1 Ip各自的物理层标准，主要是他们的帧结构形式，包括LTE 的时频二维时隙结构、参考信号和同步序列插入方式和802.1 lp的子载波分配、 训练序列、导频插入等。最后对无线信道的传输特性进行了相应的分析，主要是 影响传输质量的小尺度衰落，包括平坦性衰落、频率选择性衰落、快衰落、慢衰 落，并且针对车辆通信的高速环境提出了算法实现并仿真时所采用的信道模型。
19





























































20


第三章LTE通信系统的同步算法研究
同步是系统进行可靠通信的基础，没有精确的同步就不能对传送的数据进行 可靠的恢复。在无线通信环境下，系统对同步的要求更高。对于OFDM通信系 统而言，其对同步误差十分敏感，同步性能的好坏将对OFDM系统的性能产生 直接的影响。不好的同步性能会降低OFDM系统的整体性能，产生较大的误码 率，造成系统传输失败。LTE作为车辆通信的主要技术之一，需要根据其具体的 帧结构方式采取有效的同步方式。因此，本章在讨论OFDM系统同步算法的基 础上，给出了一种LTE下的联合频偏估计算法。
3.1 OFDM系统的同步算法及其分类
OFDM系统的同步包括定时同步和频率同步，其中定时同步又可以分为帧 同步和符号同步，分别对应定时粗同步和定时细同步，频率同步又可分为载波频 率同步和釆样频率同步。
定时同步是为了找到OFDM符号的开始位置，也就是找到每个OFDM符号 做FFT的窗口位置以便进行快速傅立叶变换(FFT)操作，对数据进行正确的解调。 如果符号定时出错，将会使OFDM系统对时延扩展的要求更敏感，因此需要尽 量减少符号定时同步误差。另外，由于在OFDM符号中插入了循环前缀作为符 号之间的保护间隔，因此OFDM系统对定时同步的要求会相对宽松。
载波频率同步主要是为了解决收发信机之间振荡器不稳定造成的接收载波 对本地载波有偏差以及收发两端相对运动产生的多普勒频移的问题。载波频率偏 移将破坏OFDM系统的子载波之间的正交性，从而产生严重的子载波间干扰 (ICI)o在这种情况下，各子载波之间的信号相互影响，使系统性能急剧恶化， 误码率增高。载波频率偏差有整数倍频率偏差和小数倍频率偏差两种。小数倍频 率偏差会引起子载波间的能量“泄露”，破坏了子载波之间的正交性，产生ICL 使系统性能恶化；而整数倍频率偏移尽管可以保持子载波间的正交性，但是由于 频率采样值的频移，同样会造成OFDM频谱内数据符号的误码率。
釆样频率同步主要是为了解决收发信机之间AD/DA的晶振的釆样时钟和相 位不完全相同而导致的釆样间隔偏差的问题。采样频率偏差主要会引起两方面的 问题，一方面是采样时钟的偏差引起FFT周期的偏差，使得釆样之后的子载波 之间不再保持正交性，从而产生ICI；另一方面是釆样频偏会引起时变定时偏差， 经过FFT之后会导致时变的相位变化，在一个OFDM符号内子载波的序号越大， 相位偏差也越大，造成解调错误，增大误码率。
针对以上不同的同步分类，OFDM系统的同步算法主要有基于数据辅助的 同步算法和非数据辅助的同步算法两种。数据辅助的同步算法大致有基于训练序 列和基于导频两种，而非数据辅助的同步算法又可以分为基于循环前缀CP的同 步算法和盲同步算法。数据辅助的同步算法与非数据辅助的同步算法的主要区别 是数据辅助的同步算法需要插入额外的数据符号，而非数据辅助的同步算法主要 利用已有的数据符号或者数据的统计特性等完成同步，它比数据辅助同步算法的 数据传输效率要高，但是数据辅助算法优于非数据辅助算法的地方是其计算的复 杂度低，同步性能好。
3.2数据辅助的频偏估计方法
本文主要研究频率同步算法，尤其是数据辅助的频偏估计方法，下面就简单 介绍一下经典的数据辅助的频偏估计算法。
3.2.1 Schmidl同步算法
Schmidl算法利用两个训练序列来完成时频同步，其中前一个训练序列分为 两个相同的部分，利用这两部分的相关性来求得其相关值的最大值以及相应的相 位信息，计算得到符号的定时估计和频偏估计的小数部分；然后利用前后两个训 练序列进行差分运算得到整数频偏估计。
第一个训练序列符号的结构如图3-1所示，它的前半部分和后半部分的数据 相同，重复间隔为N/2个采样。
N/2
CP A	A
图3-1 Schmidl算法的第一个训练符号结构图
如图3-1,训练序列前后两部分数据相同，利用该特点Schmidl提出了一种 基于相关处理的同步算法，用于符号定时和频率偏移的估计，定义频移估计函数
SSI
22
N/2-\	JV/2-1
其中，P(d)= £ r(d + N/2+k)r*(d + k),夫(d)= £ |r(d+7V/2 + A)|
k=Q	k=Q
r(4)为接收到的信号，M(d)是归一化的互相关函数，R(d)是归一化的功 率因子。引入归一化功率因子的原因是由于其能够减少信号功率受到的传播距离 的影响，提高同步检测概率。在接收时取使得归一化的互相关函数取得最大值的 采样位置作为定时同步位置，即为所求的定时偏移估计
仓= argmax(M(d))	(3-2)
在实现符号定时同步的基础上，相应的载波频率偏移估计算法为将上述计算 的符号定时偏移估计的值带入接收信号的互相关函数，然后求其角度值得到频率 频移的估计值，相对于子载波间隔的归一化频偏估计可以表示为
v = Larg(F(e))	(3-3)
3.2.2 P.H.Moose 算法
P.H.Moose算法是在假定符号定时己经完成的基础上完成对载波频率偏差的 估计，该算法是在频域上进行的一种载波频率偏差的最大似然估计算法，它的性 能由接收信号的信噪比决定。该算法设计的训练符号的格式如图3-2所示，发射 机发射两个连续相同的训练符号，中间没有循环前缀。
N		N	-
A	A	CP	OFDM符号
图3-2 P.H.Moose算法的训练符号姑构图

该算法是在假设已经做完OFDM系统的定时同步的前提下提出的，并且假 设信道中没有多径和噪声，利用最大似然准则对两个相同的连续发送的OFDM 符号做频率偏差估计，则利用该算法得到的频率偏差估计为：
|1>[&(小*(左)]
£ =——taL 亨	}	(3-4)
2"	支Re国。)虻住)]
从式中可以看出，该算法通过前后两个符号在频域上相除抵消了信道中不同 频率响应对结果的影响，所以相比于平坦性衰落信道，该频域估计算法在频率选 择性信道中能够取得更好的性能。
23
3.2.3基于导频的同步算法
在文献［40］中Ferdinand Classen和Heinrich Meyr提出了一种利用导频进行频 偏估计的方法，其利用两个OFDM符号中接收到的导频和本地导频做相关累加, 得到频率估计值，如式（3-5）所示：
£=扁睥｛*（知"［幻）修［口厲［"） ］（3-5）
其中，D为两个含有导频的相邻OFDM符号间的间隔，N为OFDM符号中 总的子载波数，M为OFDM符号中两个导频之间相隔的子载波数，M为OFDM 符号中导频的个数，如为第p个导频所在的子载波序号，弋［如］为第i个OFDM 符号的第p个导频符号。
3.3频率同步算法在LTE下的实现
根据上文对各种频率同步算法的介绍和LTE的帧结构特点，我们分别选取 LTE的主同步序列PSS进行粗同步和小区参考信号RS进行细同步的联合估计实 现其频率同步算法及其仿真。由于在车辆通信的高速环境下，影响LTE同步性 能的主要因素是多普勒频移，因此给出的算法在利用PSS进行粗同步的基础上, 又采用在帧结构中离散分布的参考信号进行了频谱细估计，以适应并跟踪由多普 勒频移引起的时变信道。
对于LTE的主同步序列，由于其由Zadofif-Chu序列组成，具有良好的自相 关性以及循环移位特性，如图3-3所示，良好的互相关性，恒包络，低峰均比， 傅里叶变换后仍未ZC序列等特性，适合在时域利用PSS的相关性对其频率偏移 进行粗估计。

图3-3主同步序列的相关性

24
根据主同步序列的性质，借用P.H.Moose的算法，我们将一帧内的两个PSS 序列做归一化的互相关，根据式（3-3）我们得到LTE一帧内的频率粗估计，我 们将得到的频率粗估计值作为一帧内所有OFDM符号的频率偏移，得到统一的 频偏补偿因子并作初步的补偿；在此基础上，根据LTE无线帧中小区参考信号 的插入方式，如图2-5,以及式（3-5）,在LTE的一个子帧内，做一次频率的细 估计，根据式（3-5）,我们可以得到以下参数：两个含有导频的相邻OFDM符 号间的间隔D为7, OFDM符号中总的子载波数7V为300 （仿真时我们采用的是 5MHz带宽的LTE系统，故在频域上有25个RB）, OFDM符号中两个导频之间 相隔的子载波数M为6, OFDM符号中导频的个数、为50。由于LTE的一个 子帧中有两组这样的参考信号，即第一个时隙和第二个时隙的第一个OFDM符 号以及它们的第五个OFDM符号，因此在计算细估计时我们采取了两种方法， 一种是将一个子帧内的两组估计结果求平均作为整个子帧的频率细估计，另一种 方法是将第一组的结果作为子帧的第一个时隙的频率估计，将第二组的结果作为 子帧的第二个时隙的频率估计。对于我们提出的基于主同步序列和小区参考信号 的频率联合估计算法，我们的仿真结果如图3-4所示：


图3-4 PSS和RS联合频偏估计算法仿真结果
从图中我们不难看出这样的结论：如果我们只利用LTE的主同步序列做粗估 计，其性能仅比不做频率估计的结果好一点点；在频率粗估计的基础上利用小区 参考信号再做一次细估计，索统的性能将显著提高，误码率大大降低；在粗估计 的基础上做频率细估计，采用第二种方法的性能比第一种要好，即将一个子帧内
25
的两组频偏估计结果分别作为一个时隙的频偏结果比将两组的结果做平均得到 的系统性能要好。
以上仿真结果我们是在MATLAB环境中按照3GPP TS36.211 （Release 9版本） 协议规定搭建的LTE下行链路基带系统仿真平台，如图3-5所示。其中数据帧格



图3-5 LTE仿真平台框图
如图3-5,发送端模块主要包括：星座映射模块、层映射和预编码模块、资 源映射模块（含导频插入）、IFFT模块、添加循环前缀模块。接收端包括去循环 前缀模块、FFT模块、信道估计和信道均衡模块、解星座映射模块。整个MATLAB 数据链路详细仿真参数如表3-1所示。
表3-1 LTE下行链路仿真参数
参数名称	　　　　参数取值
系统带宽	　　　　5MHz
子载波间隔	　　　　15kHz
调制方式	　　　　QPSK
子帧长	　　　　　1ms
CP	　　　Normal CP
每个时隙OFDM符号	7
IFFT/FFT	　　　　　512
有效子载波数	　　　　　300
天线模型	　　　　　SISO
仿真数据	1000 帧
仿真时釆用的信道是两径莱斯信道加上多普勒频移，利用matlab自带的 rayleighchan函数，其中一条径为延时为0的直射径，多普勒频移利用九=
C 仿真车速得到。设车速为60km/h。
如图3-6所示是该联合估计算法，即利用主同步序列在一帧内做粗估计的基
26

础上利用参考信号在一个时隙内做细估计，在不同的移动速度下的仿真结果，分 别选取了 60km/h> 120km/h和180km/h三种不同的速度进行仿真，从中我们可 以看出：不同的运动速度会影响算法的性能好坏，随着运动速度的提高，算法的 性能会有所下降。


图3-6不同速度下联合估计算法的性能仿真图
从上面的仿真结果及分析可知，所提出的频偏联合估计算法能够有效提高系 统的性能，并且在车辆通信的高速环境下具有较好的性能。但是由于算法所限， 其所能估计的频偏范围有限，精度不够高，在后续的研究中还需要进一步的完善。
3.4本章小结
本章首先介绍了无线通信环境下OFDM技术的同步算法极其各自对系统性 能产生的影响，主要有定时同步、载波频率同步和采样频率同步。对于这些不同 的同步，现阶段主要有数据辅助和非数据辅助两种同步算法。本章针对频率同步 的同步算法，着重介绍了数据辅助算法中的Schmidl算法、P.H.Moose算法以及 基于导频的频率同步算法。然后在这些算法的基础上，针对LTE的帧结构特点, 提出了基于主同步序列的粗同步和基于小区参考信号的细同步联合频偏估计算 法，并且利用matlab搭建了 LTE的下行仿真链路，对算法的性能进行仿真和验 证。
27





























































28


第四章 基于802.1 Ip的频率同步算法研究与实现
对于釆用802.1 Ip的系统来说，由于其发送和接收机的本振频率偏差和多普 勒频移容易造成载波频率偏差以及信道环境多变引起的信号衰落，因此基于 802.lip车辆通信协议的同步技术主要包括定时同步、载波频率同步和采样时钟 同步。本文主要对802.11p的频率同步算法进行了研究，并利用Verilog语言和 FPGA开发板进行了硬件实现。
4.1开发环境及整体系统搭建
本文在利用FPGA进行频率同步算法的硬件实现之外，还在已经搭建好的车 辆通信原型机系统上对实现的算法进行了验证。
4.1.1FPGA开发环境
FPGA (Field Programmable Gate Array )是现场可编程门阵列，它是在 CPLD 的基础上发展起来的高性能可编程逻辑器件，一般采用SRAM工艺，集成度很 高，可以完成极其复杂的时序与组合逻辑电路功能，非常适用于高速、高密度的 高端数字逻辑电路设计领域。因此，作为原型机的设计与实现，我们采用了能够 进行灵活编程实现的FPGA技术，便于原型机的研发与编程以及反复的修改，节 省了开发成本。
本文硬件实现用的FPGA开发板是ALTERA公司的Cyclone III系列的FPGA 开发板 DK-DEV-3C120N，其中 FPGA 芯片的型号是 EP3C120F780C7N。该 FPGA 芯片核心供电电压是1.2V,拥有119088个逻辑单元(LE),可使用I/O引脚为532 个，片上存储单元3981312bits,内嵌乘法器数量为576个，还有4个锁相环(PLL) 和20个全局时钟。如此丰富的硬件资源为原型机的实现奠定了基础。采用的硬 件编程语言是Verilog HDL,主要的开发环境是ALTERA公司的FPGA开发环境 Quartus II 9.L 配合的硬件仿真环境是 Matlab 和 ModelSim-Altera 6.5b(Quartus II 9.1) Starter Edition o
4.1.2802.1 lp车辆通信原型机系统
在完成本论文的工作之前，我们已经搭建了一个基于802.lip协议的车辆通 信的原型机系统，这是一个视频传输的软硬件平台。在未添加本文实现的频率同
29 步模块之前，该原型机系统不能实现正常的视频的射频传输。该车辆通信系统原 型机，主要完成WAVE车载网络的物理层传输功能，主要由四大硬件模块组成: 控制及数据接口模块、IEEE 802.1 Ip物理层数字基带模块、数模/模数转换模块、 射频发射与接收模块。各个模块之间都采用流水线的工作方式，增加了系统的平 行处理能力和吞吐量，消除了各个模块间的处理等待时延。同时，在原型机上搭 建了一套实时视频传输系统来模拟车辆通信的业务层，主要包括视频釆集与回显 模块、业务层视频数据收发模块、中间层视频数据收发模块、中间层控制和接口 模块。
该原型机主要包括物理层的硬件实现和业务层视频传输系统的实现，系统的 整体连接图如图4-1所示：


图4-1 802.1 Ip车辆通信原型机系统连接图
从图中我们不难看出，整个车辆通信的原型机设计包括了摄像头、计算机、
FPGA开发板、AD/DA板、射频板等。系统的整个收发流程是摄像头采集视频 信息，经过视频压缩编码后，将压缩视频数据传输给FPGA开发板，在此开发板 上实现了基于IEEE 802.11p物理层的发送机部分，经过数模转换和射频调制之后 发送出去，在接收端通过射频接收之后经过模数转换传回给接收端的FPGA开发 板，在此开发板上完成了基于正EE 802.1 lp物理层的接收机部分，然后再传回给 计算机，完成完成视频解压缩，视频回显等操作。
对于上面提到的基于IEEE 802.1 lp物理层的发送机和接收机框图如图4-2和 图4-3所示，这是我们整个原型机硬件实现的关键部分：
30


图4-2 802.lip物理层发送机框图
由图4-9可知，发送机首先通过NIOSII软核和AVALON总线从计算机上读 取己缓存的上层数据；然后将读取的数据按照802.1 Ip协议规定的物理层处理流 程经过信道编码、交织、星座映射、插入导频、IFFT、添加循环前缀、添加帧头、 成形滤波，最后发送数据帧到数模转换模块。


图4-3 802.lip物理层接收机框图
31
由图4-10可知，物理层接收机的处理流程是将模数转换模块输出的数字基带 数据通过帧同步检测数据帧的到来，通过载波同步进行载波偏差的估计和纠正， 通过符号同步定位和分离OFDM符号，获得FFT的转换窗口位置，接着去除CP 和时域训练序列，使用FFT完成子载波的解调，通过信道估计来估计和补偿信 道衰减，通过釆样同步进行采样定时偏差和采样频率偏差的估计和纠正，通过相 位跟踪来对相位变化进行跟踪补偿，然后去除导频、星座逆映射、解交织、信道 解码、解扰，将已解调数据输出到数据缓存接口中，供上层读取。
我们所开发的频率同步模块是在整个系统的物理层接收机中，除了利用短训 练序列完成频率的粗同步之外，由于车辆通信中高速导致的多普勒频移引起信号 的快衰落，我们还需要利用导频完成相位的跟踪。其中载波同步位于帧同步和符 号同步之间，相位跟踪模块位于信道估计模块和BPSK解调模块之间。我们通过 在发送端摄像头采集图像，在接收端进行图像的接收和还原来验证其中各种算法 的正确性和有效性。
4.2 802.lip频率同步算法描述
在实现802.1 Ip的频率同步算法时，采用了两步进行，分别是载波同步和相 位跟踪。对于载波同步，釆用了基于训练序列的最大似然算法，在时域实现；对 于相位跟踪，利用导频在频域实现。对于车辆通信而言，其无线环境是一个高速 信道，通信系统的收发两端受到多普勒效应的影响。系统的频率偏移除了由于发 射机和接收机中振荡器不稳定造成的频率偏差外，更多的是由于多普勒频移造成 的。从第二章中对无线信道的特性分析可知，多普勒频移造成了时变快衰落，信 号在短时间内幅度和相位都会快速变化。显然仅仅釆用基于短训练序列的时域载 波同步算法不能实时跟踪信号的频偏变化，无法満足在车辆通信高速环境下的同 步需求。因此，本文在对802.1 lp进行时域载波同步的基础上，进一步利用导频 实现了频域相位跟踪算法，以应对在高速环境下的时变快衰落。
4.2.1时域载波同步算法
对于802.11p来说，其帧结构中有10个连续重复的短训练序列，可以利用其 进行载波同步。设发送信号为％,忽略噪声，则接收信号可以表示为
r = x	損"T‘
~Xne	(4-1)
=x/5
32
其中 H 为发送端信号和接收端信号的载波频率偏差。
设两个连续重复符号之间的延时为D个采样点，OFDM符号长度为L,则周 期重复信号的延时相关和为

支 arctanp5，［«-1)'把 + 小*［«-l)x£»必+〃-£＞引、
A = -U—	J	〉(4-6)
对于该算法，R的幅角形式为-j2叽DTs，严格定义在［-4,+硏的范围内，
则其可估计的最大频率误差可由式(4-7)计算得到：
f. =	— = -^—	(4-7)
f 2nDTs 2DTS
不难看出，该时域频率同步算法可以估计的最大频率偏差取决于釆样时间和 周期重复符号的长度，频率误差最多为载波间隔的一半。对于802.11p系统来说， 我们釆用的短训练符号的取样时间为100ns,延时D=16,则可以估计的最大频 率误差为
f. =	=			 = 312.5(kHz)	( 4-8 )
Amax 2DTS 2x16x100x10-9	v
另外频率偏差估算也可经过DFT处理后在频域完成，但是相比于时域算法， 频域算法需要计算两个重复符号的DFT,从而需要更多的计算量，因此对于 802.1 Ip的接收机来说时域方法具有一定的优势，因为它在前导时间内完成所有 必须的同步功能，通常只需要很短的时间。因此，本次硬件实现采用时域估计方 法。	、
4.2.2频域相位跟踪算法
经过上面的时域载波频率偏差校正之后的数据仍会留有一定的残余偏差，这 些频率偏差将会造成数据的相位偏移，另外由于车辆通信下高速运动引起的多普 勒频移会造成相位偏移在短时间内迅速变化。如果不对此进行补偿，相位旋转在 一个OFDM符号内的快速变化会导致解调数据的随机错误增多，使性能恶化。 因此需要接收机在接收数据符号时对载波相位进行跟踪，相位跟踪补偿能够有效 对抗多普勒频移引起的相位偏差的不断变化。
对于802.lip系统来说，其利用每个OFDM符号包含的4个导频信号，釆用 数据辅助的相位跟踪算法进行相位偏差补偿。设为接收到的第m个OFDM 符号的第n个导频，月为本地已知的发送导频。接收信号在接收端经过DFT处 理后，导频子载波等于信道频域响应和本地导频符号片.“的乘积与剩余频 率偏差旋转作用后的结果：
匕“小&衫…颂	(4-9)
其中，4/■为经过载波频偏校正后由多普勒频移引起的快速变化的剩余频率
34

偏差。假设信道频域响应估计值H“可以通过信道估计算法得到，则可以忽略其 影响，即
(4-10)
由此，可得到相位估计为
(4-11)
对于802.11p来说，本地导频为+1或-1,导频数为4,则式(4-11)可以
简化为
瓦=/[〃＞ •戒(1)]
"=1 J
= z[4x/2e・v]	(4-12)
=Znm • Af
相应的可以得到补偿因子为
°-丿6 = /Kgf
1	4
e-gVx£(%x4“)	(4-13)
"	w-1
L
1	4
=丁 z(4/知)
4 L H=1	_
根据上式得到的补偿因子就可以对剩余相位偏差进行相应的补偿。
4.3频率同步算法的FPGA硬件实现
针对以上算法，本文以方便硬件实现、节省硬件资源为指导，兼顾算法效率, 利用硬件描述语言Verilog对上一节介绍的算法进行了硬件实现。
4.3.1载波同步的FPGA实现
在硬件实现上，本文选取N=4,即利用802.1 Ip规定的短训练序列中的其中 5个完成相应的计算。首先对5个短训练符号两两做相关得到4组相关结果，并 对每个相关结果中的16个点的值做累加，得到4个累加结果。然后对这4个累 加结果进行角度估计，得到的结果即为角度频率偏差，将4个角度偏差结果做平 均得到的即为估计的频偏值。个之所以选取5个短训练符号做相关平均，是因为 这样在求平均时可以直接右移两位，实现除以4的运算，方便硬件实现。
35
载波频率同步的硬件实现框图如图4-4所示，整个硬件实现模块分为数据分 流、数据缓存、载波频偏估计、频偏补偿、数据联合输出5个部分。数据在整个 模块中的处理步骤是：首先输入的数据根据计数器计数区分出短训练序列和长训 练序列符号、数据符号，分别做不同的处理，这是数据分流模块；载波频偏估计 模块利用提取的5个短训练序列符号做延时相关累加并求平均得到频率偏移估 计值；然后利用得到的频偏估计值计算补偿因子，同时按照补偿因子对之前输出 的长训练序列符号和数据符号做相应的频偏补偿；最后将补偿之后的长训练序列 和数据符号加上之前没有经过补偿的短训练序列重新组合成完整的数据帧进行 输出。

图4*4载波频率同步模块实现框图

（1）	数据分流模块
数据分流模块主要完成对输入数据的分流工作，区分出短训练序列、长训练 序列和数据符号。在硬件实现上，对输入数据用计数器进行计数，当计数值大于 等于1且小于等于160时为短训练符号，将其送入数据缓存子模块；当计数值大 于等于1且小于等于80时为前5个短训练符号，将其送入载波估计子模块用于 频率偏差估计；当计数值大于160时为待补偿的长训练序列符号和数据符号，将 其送入频偏补偿子模块。
（2）	载波频偏估计子模块
整个实现模块中最关键的模块是载波频偏估计模块，其利用数据分流模块提 取的5个短训练序列符号，根据式（4-6）对频率偏差进行估计。如图4-5所示, 在硬件实现上，载波频偏估计模块可分为延迟相关、相关累加和补偿估计三个部 分。

图4-5载波頻偏估计子模块框图

36
1）延迟相关子模块
利用数据分流模块提取的5个短训练符号，采用移位寄存器做缓存，计算相 邻两个短训练符号的相关值，如图4-6所示，将当前短训练符号的样值和前一个 短训练符号相同位置的样值同步输出，然后调用复数乘法器完成两个训练序列符 号的相关运算，得到式（5-6）中的各个相关值。

图4-6短训练符号延迟相关子模块框图
2）相关累加计算子模块
在得到5个短训练符号的4组相关值后，需要进行每组16个数据的求和运 算。如图4-7所示，在硬件实现上采用滑动窗口的思想实现。滑动窗口累加的计 算公式为
Sum = Sum+ BufferData- ShiftData	（4-14）
其中，Sum为累加和，BufferData为当前输入数据，ShiftData为经移位寄存 器移位后的数据，实际上也就是前一组短训练符号同一位置的取样值。对于第一 组相关值累加来说，ShiftData的值为0,因此在求Sum时直接将当前的输入数 据即BufferData进行累加即可；对于之后的几组相关累加计算，由于累加和Sum 中已经包含了前一组的相关值累加结果，且ShiftData的值也变为经移位寄存器 之后的前一组的16个数据，因此在计算相关累加和时，累加和Sum在加上当前 输入数据BufferData后还需要减去移位寄存的前一组的数据ShiftData,因此在第 32个点处的Sum值正好是第二组的相关累加结果。以此类推，在第48和第64 点处的Sum值分别为第三组和第四组的短训练序列相关值的累加和。由于在相 关累加之前进行了延迟相关计算，实际上第一组相关值也向后延迟了 16个点， 因此，5个短训练符号的4组相关值累加和分别位于第32、48、64、80点处。

图4-7短训练符号相关累加子模块框图
3）偏差估计子模块
偏差估计子模块利用相关累加和提取相位信息，并根据式（4.6）计算出频率
37
偏差，其硬件实现结构如图4-8所示。


图4-8频率偏差估计子模块框图
从图中我们可以看出，其过程是得到上一级的相关累加值后输入CORDIC核 完成arctan运算，得到相位值，然后使用CORDIC核计算得到4个角度值，利 用累加器将4次结果累加，然后通过移位求平均。另外，角度平均后还需要除以 短训练符号的长度DSTS,对于802.11p来说，。"=16,因此在硬件实现上右移 4位即可。
(3)载波频偏补偿子模块
载波频偏补偿子模块主要根据前面得到的频率偏差计算频偏补偿因子『商'， 通过式(4-13)对待补偿数据进行频偏补偿：
rn=rnx e~Jn^ =rn~x. e~J6" =r*x [sin (—8“)4- j cos (-0 )]	(4-15)
在硬件实现上，载波频偏补偿模块主要分为补偿因子计算和数据补偿两部分。由 于补偿因子早于待补偿数据即长训练序列符号和数据符号出现，故需将补偿因子 做相应的延迟，其流程图如图4-9所示，包括补偿因子计算、数据缓存和数据补 偿三个子模块。


图4-9载波频偏补偿子模块框图
对于补偿因子的计算，当获得频率偏差的估计值介后，利用补码器对九取 反，利用累加器实现相角的计算-％=-畝，而求取补偿因子实际上就是求 sin(-%*)和cos(-q*)。当待补偿数据(长训练序列符号和数据符号)到达时， 将缓存中的补偿因子e-丿戒输出并利用用复数乘法器进行载波频偏补偿。
(4)数据联合输出子模块
数据联合输出子模块是整个载波同步模块的最后子模块，主要是将没有经过 频率偏差补偿的短训练序列符号和经过频率偏差补偿的长训练序列符号和数据 符号重新组合成数据帧之后进行输出。由于短训练符号是在数据分流模块之后就 直接送到数据联合输出模块而长训练符号和数据符号需经过频率偏差补偿模块 补偿模块补偿后才送至数据联合输出模块的，为了确保短训练符号和补偿后的长
38
训练符号及数据符号连续输出，硬件实现上需通过移位寄存器将短训练符号做相 应的延时。
4.3.2相位跟踪的FPGA实现
相位跟踪补偿处理利用导频，以一个OFDM符号为单位进行，其硬件实现 结构如图4-10所示。


图4-10相位跟踪模块框图
相位跟踪模块可以分为导频提取、数据缓存、相位跟踪补偿因子计算和剩余 相位补偿4个部分。在数据以串行方式输入的过程中，以一个OFDM符号为长 度单位输入数据缓存模块，利用双口 RAM作为缓存空间实现，同时导频提取单 元根据写入RAM的地址信号将导频提取出来。提取的导频信号送入相位跟踪补 偿因子计算模块，根据式（4-11）,将接收到的导频信号和本地标准导频信号做 相关运算处理，得到相位跟踪补偿因子。在计算完补偿因子之后，将待补偿的数 据从缓存中输出，然后调用复数乘法器完成相位跟踪补偿。
整个模块中最重要的是相位跟踪补偿因子计算模块。对于802.11p系统，4 个导频信号分别为1,1,1，-1,导频极性由初始状态全为1的扰码器生成的127 个循环序列控制，当导频极性为0时，4个导频的值保持不变；当导频极性为1 时，4个导频值取反，即为-1, -1, -1,1。但是无论怎么变化，导频值要么为1或 -1。因此在计算式（4-11）时只需对接收的导频信号进行实部或虚部分量的取反 操作即可。即令歸=%“ +此.“，
则当导频知=1时，（歸x%）.=%”-丿垢，当％=-1时， （Rm/XPm J =-a心+jb心 该操作可根据导频极性信号决定是将实部分量还是 虚部分量送入补码器实现，然后将利用累加器得到的累加和结果右移两位得到其 平均值，即我们所需要的相位跟踪补偿因子。
39
4.4硬件实现结果及遇到的问题
本文在基于已经搭建的IEEE 802.11p物理层车辆通信系统原型机，实现了其 频率同步算法，并借助频率同步顺利实现了原型机的收发板之间的射频通信。通 过在原型机上搭建一套实时视频传输系统来模拟业务层，验证了课题所研发的车 辆通信系统原型机的正确性和实用性。
4.4.1实验结果验证
本文通过借助ModelSim仿真频率同步算法的时序波形、matlab和ModelSim 联调分析算法误码率曲线以及原型机加上频率同步算法后能够实现视频的射频 传输来验证了频率同步算法硬件实现的准确性。
如图4-11和图4-12是利用ModelSim得到的载波频率同步模块和相位跟踪模 块的时序仿真图。通过时序分析，验证算法实现时流水线结构的正确性，在保证

图4-11载波频率同步模块时序仿真图
从图中可以看出，当待同步的数据到达时，首先利用短训练序列符号的前5 个估算得到频偏值，然后利用频偏值计算得到频偏补偿因子，再根据补偿因子对 待补偿数据进行跟踪补偿。由于补偿因子早于待补偿的长训练符号和数据符号， 因此需要对补偿因子做相应的延时。
40


图4-12相位艰踪模块时序仿真图
从图中可以看出，当待补偿数据到达时，从中读取相应位置的导频信息，送 入相位误差补偿因子计算模块计算得到相位补偿因子，然后从缓存中读取数据信 号进行剩余相位补偿。由于补偿因子在接收到第四个导频信号后4个周期即可得 到，进而可对数据进行相位跟踪补偿，故数据缓存单元中RAM的深度设置为 OFDM符号的长度64即可，同时要求其为双口 RAM,同时进行前一个OFDM 数据符号的读取和后一个OFDM数据符号的写入。
如图4-13是通过matlab和ModelSim联调，并采集相应数据得到的频率同步 算法的性能结果图。


图4-13 802.1 lp频率同步算法的性能仿真图
从图中我们不难看出，所釆用的载波同步算法和相位跟踪算法在接收端能够 有效降低系统误码率，完成系统的正确解调。如果在接收端不做频率同步，则系 统误码率显著上升，无法在接收端正确解调，导致数据丢失；如果只做载波同步 或相位跟踪中的一种，虽然能够提高误码率，但是比两者同时做的效果要差一些。 因此，本文在做频率同步时选择同时完成载波同步和相位跟踪，在帧同步之后加 入载波同步模块，在信道估计之后加入相位跟踪模块,使得系统误码率大大降低。
41
在原有的车辆通信原型机上加入频率同步模块后，即上文分析的载波同步模 块和相位跟踪模块，我们实现了收发射频板之间真正的无线传输。如图4-14所 示，在没有添加频率同步模块之前，我们在进行射频传输时，收发射频板用的是 同一个时钟，即用一根同轴线将收发射频板的时钟晶振连起来，这样才能实现整 个系统之间视频的无线传输。在加入频率同步之后，我们就能去掉连接收发射频 板之间的同轴线，收发射频板使用各自的时钟晶振10MHz,顺利实现视频的无 线收发传输。


图4-14加入频率同步算法模块前后系统连接对比图
如图4-15所示为加入频率同步模块后，包括载波同步模块和相位跟踪模块,
整个系统顺利实现视频的射频传输。由此，验证了我们所实现的802.1 Ip的频率 同步算法的有效性和准确性。

图4-15视频射频传输效果图

4.4.2遇到的问题
在整个的硬件实现及调试过程中也遇到了许多问题，主要有以下几个：
（1）利用CORDIC算法完成arctan求角度的运算。由于自己硬件实现 CORDIC算法较为复杂，可以利用现成的IP核实现此功能。Altera的Quartus中 没有现成的可用的CORDIC IP核，我们利用网络上运用VHDL语言编写的开源
42
的CORDIC核，加入自己的算法工程，实现了该算法的功能。在CORDIC实现 时我们需要注意由于在算法内部经过大量的移位和加减操作，最后流水线输出的 结果已经延迟了 17个时钟，在进行流水线的下一级操作上需要对其他的数据做 相关的延时。
（2＞在做频偏补偿时，我们需要求取补偿因子e-威，根据欧拉公式实际上 我们只要求得cos（-以）和，诅（-心）即可。如果我们在硬件实现时，直接计算， 即将CORDIC算法配置成sin和cos模式，则会有相应的处理时延，效率较低。 因此我们釆用LUT （Look-Up-Table）技术，事先将各角度的sin值和cos值计算 出来，分别写入各自的ROM中，每当输入一个角度值就等于输入一个地址进行 查表，找出地址对应的内容，即该角度对应的sin值和cos值，然后输出。这样 处理既节省了资源，又提高了处理效率。
（3）在整个车辆通信的原型机系统中加入我们的频率同步算法模块后，我 们遇到了视频传输失败，无法正确接收的问题。在整个的调试的过程中我们通过 利用SignalTap II抓包工具抓取分别抓取数字基带发射机和接收机的信号流图、 运用频谱仪测量对比收发两端的信号功率谱等手段，将射频传输顺利调通。在这 个过程中，有许多问题会导致接收端的错误接收，例如收发两端的接收和发送功 率过低或过高、射频板和AD/DA板的两路（I路和Q路）信号接反、程序内部 信号连接错误等等。
4.5本章小结
本章详细分析了车辆通信的另一种常用技术标准802.1 Ip中频率同步的方 法，同时将所采用的算法利用FPGA进行了硬件实现，并通过顺利实现视频的射 频传输对该算法极其硬件实现进行了验证。文章在实现频率同步算法时采用了两 个步骤：载波同步和相位跟踪，分别利用802.11p帧结构中的短训练序列和导频 进行实现。在对算法进行FPGA实现之后，将两个频率同步的硬件模块加入到已 有的车辆通信的原型机中，通过原型机收发板之间视频的射频传输，验证了算法 实现的准确性及有效性。	-
43





























































44


第五章总结和展望
5.1论文工作总结
随着物联网的不断发展与普及，车联网作为其中的一部分也发展迅速，车辆 通信，作为高速环境下无线通信系统的典型应用，包括车与车的通信，车与路边 单元和基站的通信，成为其中重要的研究内容。对于车辆通信而言，其目前有两 种主流的通信手段和技术，一种是借助现有的蜂窝网络，特别是4G网络LTE开 始普及以后，其传输速率和其他各方面均能较好的支持车辆通信；另一种是基于 特定的车载通信协议，其中比较成熟的是车载环境无线接入(Wreless Access fbr Vehicular Environment, WAVE)协议802.11p,利用其完成车辆自组织网络VANET 的构建与通信。但是不管是采用LTE还是802.11p,其物理层都釆用了 OFDM技 术。OFDM技术由于其具有频谱效率高、带宽利用率高、能够根据信道条件对 子载波进行灵活调制等优点得到了广泛应用，但同时其也有一个比较大的缺点就 是对频率偏差敏感，频率偏差将会造成载波间干扰(ICI)o因此在车辆通信中实 现同步技术至关重要。针对于此，论文研究了高速环境下车辆通信的同步技术， 主要工作如下：
(1)详细介绍了高速环境下车辆通信的发展及研究现状,对其中釆用的LTE 技术和IEEE 802.1 Ip技术的发展与应用以及其共同釆用的OFDM技术进行了相 应的介绍，阐述了文章的研究背景及其研究意义。
(2)全面介绍了车载通信下的ETE和802.1 Ip的物理层标准，包括LTE的 时频二维帧结构、物理资源的映射、参考信号和同步序列在帧结构中的插入方式， 802.11p的系统参数、子载波分配、导频插入方式以及其帧结构的组成方式，同 时对两者均釆用的OFDM技术的基本原理、DFT生成以及其一般的系统流程做 了分析与介绍。另外对于无线通信的信道特性，包括大尺度衰落和小尺度衰落进 行了相应的研究，着重介绍了高速无线通信环境下对通信质量影响较大的两个因 素多径传播和多普勒频移进行了分析。
(3)针对无线通信环境下的同步算法进行了分析和阐述，在分析不同的同 步分类包括定时同步、载波频率同步、采样频率同步对OFDM系统产生不同影 响的基础上，研究了针对这些不同种类同步的各种同步算法，包括基于数据辅助
(导频和训练序列等)的同步算法、基于CP的同步算法和盲同步算法，介绍了 他们的研究现状和能够实现的不同同步性能，在此基础上重点介绍了基于数据辅 助的频率同步算法，包括Schmidl和P.H.Moose的基于训练序列的同步算法和基
45
于导频的频偏估计算法。
（4）在研究上述各同步算法的基础上，针对车辆通信下的LTE和802.1 Ip, 分别提出了自己的算法，并进行了相应的仿真和实现。对于LTE下的同步，本 文根据LTE的帧结构的特点，给出了利用其主同步序列和小区参考信号进行联 合估计的算法，首先利用一个LTE帧内的两个相同的主同步序列的相关性进行 了频率粗同步，然后在此基础上在LTE的一个时隙内利用导频进行了频率细同 步，并且利用matlab对算法的性能进行了仿真验证和分析。对于802.11p,我们 利用己有的同步算法，针对其自身的帧结构特点，选取其中易于硬件实现的算法 分别对载波同步和相位跟踪两个模块进行了 FPGA实现，并且通过实际的系统联 调和视频的射频发送接收验证了算法的准确性和有效性。
5.2下一步研究展望
同步技术作为无线通信系统通信质量和性能的保证，其在整个通信系统中尤 其重要。对于高速环境下的车辆通信，其采用OFDM技术，同步技术更是其中 的关键技术。对于高速环境下车辆通信的同步技术研究具有十分重要的现实意 义。虽然本文工作已经结束，但是由于自身能力、水平所限，文章还有许多地方 值得进一步探索和研究，在后续的工作中需要进一步完善：
（1）	本文只是对无线信道的传输特性做了具体的介绍，对于高速环境下车 辆通信的信道只是重点考虑了其中的多普勒频移，并没有做深入的研究。在下一 步的研究工作中，需要对高速环境下的车辆通信的无线信道做深入的调研，对其 传播特点做定量的研究，在此基础上进行信道的建模，完善信道参数，模拟实际 的信道传输场景。在准确建模信道的基础上，对各种同步算法的研究将会是事半 功倍，对同步算法的性能的做出更准确的验证，得出更准确的结论。
（2）	本文对于LTE下提出的频率同步算法，只是针对标准规定的帧结构简 单的利用主同步序列和参考信号分别做相关运算得到频率偏差，而没有过多的考 虑实际的通信信道以及信号经过信道之后彼此间的关系，得到的结果不够精确。 在下一步的研究中，应该更多的考虑LTE信号经过高速无线信道之后，帧结构 中的各OFDM符号会经历的衰落和偏移情况，在此基础上，可以针对分析的结 果，釆取调整LTE无线帧中导频的插入方式或者尝试其他例如卡尔曼滤波、回 归迭代等更精确的同步方法，并提出新的有效的同步方法。另外，本次研究是在 单天线单用户的情况下进行的，后续的工作中应该考虑MIM0下的情况，因为 MIM0.是LTE中提高传输效率和质量的一种关键技术，是技术发展的必然趋势。
（3）	文章中对于802.11p下算法的研究和实现，是基于已有的算法进行的， 在实现中考虑了如何做到易于硬件实现，实现过程中调用了 CORDIC核、FFT
46
核实现相应的算法，也采用了 LUT技术提高了流水线的处理效率，降低了处理 延时。这些都是在实现过程中值得提倡的，但是由于能力和精力所限，选取的算 法只是能基本满足802.11p下的射频通信，在收发射频板相对运动的情况下，视 频的传输会出现花屏、抖动、卡死等情况，性能的鲁棒性不好。下一步的研究工 作应该对已经实现的802.1 Ip下的频率同步算法进行改进，使其能够更好的满足 实际应用。
(4)本文的研究是针对高速环境下的同步算法研究，高速环境应该包括车 辆通信、高铁通信等多种应用场景。本文只是集中在对车辆通信的环境下的研究， 研究方向较为单一。后续的工作中可以考虑在高铁环境下的同步技术研究，随着 高铁的普及，对高铁环境下的通信需求将会越来越大，高铁由于速度更快，信道 变化更快，更需要在通信系统中釆用有效的同步技术，具有更大的研究意义。
47





























































48


参考文献
[1]Moose P H. A technique for orthogonal frequency division multiplexing frequency offset correction]J]. Communications, IEEE Transactions on, 1994,42(10): 2908-2914.
[2]Schmidl T M, Cox D C. Robust frequency and timing synchronization for OFDM[J]. Communications, IEEE Transactions on, 1997, 45(12): 1613-1621.
[3]Morelli M, D'Andrea AN, Mengali U. Frequency ambiguity resolution in OFDM systems[J]. Communications Letters, IEEE, 2000, 4(4): 134-136.
[4]Park B, Cheon H, Kang C, et al. A novel timing estimation method for OFDM systems[J]. Communications Letters, IEEE, 2003, 7(5): 239-241.
[5]Minn H, Bhargava V K, Letaief K B. A robust timing and frequency synchronization for OFDM systems[J]. Wireless Communications, IEEE Transactions on, 2003, 2(4): 822-839.
[6]Minn H, Zeng M, Bhargava V K. On timing offset estimation for OFDM systems [J]. Communications Letters, IEEE, 2000, 4(7): 242-244.
[7]Luise M, Reggiannini R. Carrier frequency acquisition and tracking for OFDM systems [J]. Communications, IEEE Transactions on, 1996, 44(11): 1590-1598.
[8]Morelli M, Mengali U. An improved frequency offset estimator for OFDM applications[C]//Communication Theory Mini-Conference, 1999. IEEE, 1999: 106-109.
[9]Lambrette U, Speth M, Meyr H. OFDM burst frequency synchronization by single carrier training data [J]. Communications Letters, IEEE, 1997, 1(2): 46-48.
[10]Czylwik A. Synchronization for systems with antenna diversity[C]Wehicular Technology Conference, 1999. VTC 1999-FaIl. IEEE VTS 50th. IEEE, 1999,2: 728-732.
[11]Ren G, Chang Y, Zhang H, et al. Synchronization method based on a new constant envelop preamble for OFDM systems[J]. Broadcasting, IEEE Transactions on, 2005, 51(1): 139-143.
[12]Tufvesson F, Edfors O, Faulkner M. Time and frequency synchronization for OFDM using PN-sequence preambles[C]//Vehicular Technology Conference, 1999. VTC 1999-Fall. IEEE VTS 50th. IEEE, 1999,4: 2203-2207.
[13]Van de Beek J J, Sandell M, Boijesson P O. ML estimation of time and frequency offset in OFDM systemsfJ]. IEEE Transactions on signal processing, 1997, 45(7): 1800-1805.
[14]Park B, Cheon H, Ko E, et al. A blind OFDM synchronization algorithm based on cyclic correlation [J]. Signal Processing Letters, IEEE, 2004, 11(2): 83-85.
[15]Negi R, Cioffi J M. Blind OFDM symbol synchronization in ISI channels[J], Communications, IEEE Transactions on, 2002, 50(9): 1525-1534.
[16]Ma X, Tepedelenlioglu C, Giannakis G B, et al. Non-data-aided carrier offset estimators for OFDM with null subcarriers: identifiability, algorithms, and perfbnnance[J]. Selected Areas in Communications, IEEE Journal on, 2001, 19(12): 2504-2515.
[17]Liu D Z, Wei C H, Chang C J. An extension of guard-interval based symbol and frequency synchronization technique for wireless OFDM transmission[C]//IEEE Vehicular Technology Conference. IEEE; 1999, 2001,4: 2324-2328.
[18]Liu D Z, Wei C H, Chang C J. An extension of guard-interval based symbol and frequency synchronization technique for wireless OFDM transmission[C]//IEEE Vehicular Technology Conference. IEEE; 1999, 2001,4: 2324-2328.
[19]Landstrom D, Wilson S K, Van de Beek J J, et al. Symbol time offset estimation in coherent OFDM systemsfJ]. Communications, IEEE Transactions on, 2002, 50(4): 545-549.
49
[20]Oh J S, Chung Y M, Lee S U. A carrier synchronization technique for OFDM on the frequency-selective fading environment[C]/A/ehicular Technology Conference, 1996. Mobile Technology for the Human Race., IEEE 46th. IEEE, 1996, 3: 1574-1578.
[21]Tureli U, Liu H, Zoltowski M D. OFDM blind carrier offset estimation: ESPRIT]J]. Communications, IEEE Transactions on, 2000, 48(9): 1459-1461.
[22]Tureli U, Kivanc D, Liu H. Experimental and analytical studies on a high-resolution OFDM carrier frequency offset estimatorfJ]. Vehicular Technology, IEEE Transactions on, 2001, 50(2): 629-643.
[23]Luise M, Marselli M, Reggiannini R. Low-complexity blind carrier frequency recovery for OFDM signals over frequency-selective radio channels[J]. Communications, IEEE Transactions on, 2002,50(7): 1182-1188.
[24]Barbarossa S, Pompili M, Giannakis G B. Channel-independent synchronization of orthogonal frequency division multiple access systems[J]. Selected Areas in Communications, IEEE Journal on, 2002, 20(2): 474-486.
[25]Ricklin N, Zeidler J R. Data-aided joint estimation of carrier frequency offset and frequency-selective time-varying channel[C]//Communications, 2008. ICC08. IEEE International Conference on. IEEE, 2008: 589-593.
[26]Gao F, Nallanathan A. Identifiability of data-aided carrier-frequency offset estimation over frequency selective channels[J]. Signal Processing, IEEE Transactions on, 2006, 54(9): 3653-3657.
[27]Jiang Q, Speidel J, Zhao C. A novel carrier frequency oflset estimation for OFDM systems over time-varying multipath channels[J]. Wireless personal communications, 2009, 49(4): 587-596.
[28]Nguyen-Le H, Le-Ngoc T. Pilot-aided joint cfo and doubly-selective channel estimation for OFDM transmissions[J]. Broadcasting, IEEE Transactions on, 2010, 56(4): 514-522.
[29]Simon E P, Hijazi H, Ros L, et al. Joint estimation of carrier frequency offset and channel complex gains for OFDM systems in fast time-varying vehicular environments[C] //Communications Workshops (ICC), 2010 IEEE International Conference on. IEEE, 2010: 1-5.
[30]Hijazi H, Fawaz L, Akra A, et al. Hybrid Cramer-Rao bound for dynamical time-varying channel and carrier frequency offset estimation in OFDM systems[C]//Telecommunications (ICT), 2012 19th International Conference on. IEEE, 2012: 1-6.
[31]Simon E P? Ros L, Hijazi H, et al. Joint carrier frequency offset and fast time-varying channel estimation for M1MO-OFDM systems[J]. Vehicular Technology, IEEE Transactions on, 2011, 60(3): 955-965.
[32]Yu-Ting Sun; Jia-Chin Lin, ”Multi-carrier frequency-ofiset estimation based on MUSIC for carrier-aggregation orthogonal frequency-division multiplexing communications,'1 Communications and Information Technology (ICCIT), 2012 International Conference on , vol., no., pp.408,412, 26-28 June 2012.
[33]Sampath, Ashwin; Holtzman, J.M., nEstimation of iraximum Doppler frequency for handoff decisions," Vehicular Technology Conference, 1993., 43rd IEEE , vol., no., pp.859,862, 18-20 May 1993.
[34]Schober, H.; Jondral, F., nVelocity estimation for OFDM based communication systems,H Vehicular Technology Conference, 2002. Proceedings. VTC 2002-Fall. 2002 IEEE 56th、
50
vol.2, no., pp.715,718 vol.2,2002.
[35]Holtzman J M, Sampath A. Adaptive averaging methodology for handoffs in cellular systems [J]. Vehicular Technology, IEEE Transactions on, 1995, 44(1): 59-66.
[36]Park Q Hong D, Kang C. Level crossing rate estimation with Doppler adaptive noise suppression technique in frequency domain[C]//Vehicular Technology Conference, 2003. VTC 2003-FalL 2003 IEEE 58th. IEEE, 2003,2: 1192-1195.
[37]佟学俭，罗涛.OFDM移动通信技术原理与应用.北京:人民邮电出版社,2003>46.
[3&]罗涛，王昊车辆无线通信网络及其应用卩].中兴通讯技术,2011,03:1-7.
[39} COST 207, "Digital land mobile radio communications/ Office fbr Official Publications of the European Communities, Final regport, Luxembourg, 1989.
[40] Classen F, Meyr H. Frequency synchronization algorithms fbr OFDM systems suitable for communication over frequency selective fading channels[C]//Vehicular Technology Conference, 1994 IEEE 44th. IEEE, 1994: 1655-1659.
51





























































52


