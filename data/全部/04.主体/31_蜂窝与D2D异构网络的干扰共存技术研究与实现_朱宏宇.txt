
第一章绪论
1.1移动通信发展概况
移动通信是一种具有用户移动性的无线通信。移动通信的特点之一是其信道 是无线信道，即开放式信道，这一方面弥补了有线通信的静态性，使得随时随地 通信成为可能，另一方面也失去了全封闭式信道的优质性①。移动通信的特点之 二是其用户具有移动性，这极大地满足了人们日益发展的通信需求，但也增加了 信道的时变性，为信号的准确传输带来了更大的挑战。由于移动通信具有这两大 特性，移动通信成为了通信领域中最具活力及发展前景的一种通信方式。
从20世纪80年代中国引进第…代移动通信系统以来，移动通信在中国的发 展已经走过了二卜多个年头，经历了从第代到第四代移动通信系统的更迭和演 进。第一代移动通信系统早己不再出现在商用无线通信系统中；第二代移动通信 系统在我国得到了广泛建设，如今仍发挥着它在承载语音及低速数据业务方面的 作用；从第三代移动通信系统开始，数据业务成为了核心业务，我国的第三代移 动通信网络建设已经完成，目前正处在大规模建设及推广第四代移动通信系统的 阶段，关于第五代移动通信系统的研究工作也正在各研究机构如火如荼地展开。
第一代(1G)移动通信系统是模拟的通信系统，具有代表性的商用系统主 要有欧洲的 TACS (Total Access Communication System)和北美的 AMPS(Advanced Mobile Phone System),我国使用的 TACSo 1G 主要利用频分多 址实现动态寻址，以实现移动通信中的用户动态性。另外，通过采用具有良好性 能的模拟调频以及基站二重空间分集来匹配信道的动态性。
第二代(2G)移动通信系统是数字化的，在20世纪90年代开始商用，具 有代表性的商用系统有使用时分多址的GSM (Global System for Mobile Communications)s使用码分多址的IS-95以及日本的PDC系统。2G采用的数字 调制方式有GMSK和QPSK,它们都具有良好的抗干扰性能。自适应均衡和Rake 接收技术也在被2G系统所采用来抵抗频率选择性衰落和多径干扰。
第三代(3G)移动通信系统主要是面向多媒体业务的，代表商用系统有 CDMA2000、WCDMA以及我国提出的TD-SCDMAo 3G引入了用户业务动态 性，即用户的业务类型可能是语言、数据、图像或多媒体业务，为了匹配这个特 性，3G采用了可变扩频比正交码(OVSF),以保持不同速率业务之间的正交性。 为了更好地适应数据业务对误码率要求高但对实时性要求不高的特点，3G普遍 采用Turbo码，这一编码方式也延续到了第四代移动通信系统中。
随着移动互联网在近十年来的飞速发展，3G已不足以承载移动互联网带来 的业务量。作为“准"4G的LTE系统在用户带宽为20MHz时能达到下行100Mbps 和上行50Mbps的峰值速率，在此背景下LTE系统在多个国家成功地实现了大规 模商用。在物理层，LTE以OFDM和MIM。技术为基础以提高传输速率。
IMT-Advanced提案确立了第四代(4G)移动通信系统的标准，它对通信系 统的通信速率提出了更高的要求，同时也强调了在室内低速环境下的用户体验。 LTE的增强版本LTE-Advanced能够满足4G的各项要求，并且能前向兼容LTE, 是一项很有前景的4G技术标准。
1.2终端直通技术简介
随着移动互联网的发展，用户密度将进一步增加，用户对于数据业务的需求 也会增加，这将加重作为中心调度节点的基站的负荷，因此如何在不断增加的业 务压力下减轻基站负荷成为了 4G及之后的通信系统所必须考虑的问题。近距离 通信被认为是这个问题的一种解决方案，这主要是基于以下几点考虑：第一，用 户的通信需求中有一部分本来就属于近距离通信，如通信双方处于同…层楼；第 二，用户密度的不断增加为近距离通信的组网提供了有利条件，即可以将任何用 户当作中间节点；第三，用户设备的处理能力的提高使此技术的实现成为可能。
终端直通(Device-to-Device, D2D)技术作为一种近距离通信技术被引入到 LTE-Advanced标准体系当中，除了减轻基站负荷外，D2D技术的引入还带来了 以下好处：对于有空间隔离的用户由于相互间干扰较小，可以同时以合适的发送 功率复用同一段授权频段，因此D2D技术能够提高整体频谱利用率、整体吞吐； 由于近距离通信所需的发送功率较小，因此相比之前与基站通信的方式，直通通 信能降低能耗；D2D技术能带来新的点对点或基于位置的应用和服务。另外， 在公共安全方面，D2D技术能作为一种灾备技术应用于基站无法正常工作的情 景下，这使得公共安全领域的通信系统也能够演进到4G。
与其他近场通信技术 如蓝牙或WiFi 相比，D2D具有如下优势m首 先，D2D基于已有的LTE通信技术，这使得它更容易被兼容地集成到LTE系统 中；其次，D2D本身具有良好的分布式组网能力，这将为近距离通信所能发挥 的作用提供更大可能；再次，D2D工作在授权频段，干扰是可控的；最后，D2D 没有复杂的密钥配对过程，只需要简单的URL即可。
D2D通信技术作为一种新兴技术，仍然面对很多挑战，主要有以下几个方 面：如何控制D2D用户与基站用户之间、D2D用户之间的干扰，由于D2D以复 用相同频域资源的方式提高总体吞吐，因此干扰控制技术是D2D中的关键技术;
如何利用D2D技术进行自主组网，只有具有了组网功能的D2D系统才能发挥更 大的作用;如何降低D2D终端的计算复杂度以降低终端制造成本,这将成为D2D 是否能被广泛应用的关键因素。
1.3论文研究内容及结构介绍
蜂窝与D2D干扰共存的两大核心内容是干扰的感知和干扰控制，本文将围 绕干扰的感知和干扰控制中的三项关键技术进行研究：干扰感知中的PDCCH盲 解码技术和LTE下行信道估计技术、干扰控制中的D2D资源分配。这三项技术 的共同特点是其性能都极大地影响了最终蜂窝-D2D网络的总体吞吐性能增益。 另外，这三项技术之间还具有如下联系：在进入LTE蜂窝下行链路解码模块之前，卜行信道均衡模块将根据下行信道 估计的结果对接收到的蜂窝下行数据进行处理，为蜂窝下行链路解码模块提 供减小了信道影响的输入数据，即LTE下行信道估计是用于PDCCH及其他 下行链路解码的关键基础模块，信道估计性能的优劣将影响最终的解码性能;
在LTE系统中，蜂窝终端将使用的上行资源位置等信息承载于PDCCH中。
而在D2D数据链路复用蜂窝上行链路的异构网络中，蜂窝用户所占用的上 行资源及其干扰功率是D2D资源分配算法的输入，D2D将根据这些信息来 合理分配D2D应该占用的资源以及发送功率。因此，PDCCH盲解码的正确 率将影响D2D资源分配算法的性能，从而影响最终异构网络的总吞吐。
因此本文以提升异构网络总体吞吐性能为岀发点，选择了这三项与最终性能关联 性最大且存在难点的技术进行深入研究。
与前人的研究相比，本文在千扰感知方面的研究中提出了更优的感知算法， 并给出了详细的对比仿真结果，以及更加具体的干扰感知方案等。本文在D2D 资源分配方面，提出了一种结合实际LTE系统的功率分配特点的场景，并提出 了在这种场景下的多种D2D资源分配算法，给出了详细的推导、算法流程、仿 真结果及分析。
本文具体结构如下：
第二章：阐述了一套基于干扰感知和干扰控制等关键技术的LTE-D2D系统 方案，之后各章节都基于此系统框架，对框架中的多项关键技术进行了进一步的 研究和优化。
第三章：此章研究干扰感知中的关键技术——PDCCH盲解码技术。重点关 注低聚合等级下的PDCCH盲解码并提出了一种适用所有聚合等级的PDCCH盲 解码方案。
第四章：此章研究干扰感知中的另一项关键技术一一下行信道估计技术。基 于VCFR添加技术提出了一种在保证低时间复杂度前提下性能良好的下行信道 估计算法，在多种低速信道下的仿真结果显示此算法优于同类型其他算法。
第五章：此章研究D2D中的资源分配技术。首先对符合实际的LTE-D2D资 源分配场景进行了建模，在此基础上提出了多种资源分配算法，并详细分析了其 仿真结果。
第六章：总结全文，并说明进一步的研究方向。

第二章LTE-D2D系统方案描述
本章将阐述一套基于干扰感知和干扰控制等关键技术的LTE-D2D系统方案。
2.1 LTE-D2D系统概述
在原有的LTE蜂窝系统中引入D2D通信机制的目标是：在对LTE蜂窝通信 干扰可控的前提下，D2D通信通过实时感知蜂窝干扰，灵活复用蜂窝时频资源， 最终实现用户设备间的直通通信，以提高频谱利用率、增大网络整体吞吐図。 LTE-D2D混合通信系统的通信场景如图2-1所示。


图2-1 LTE-D2D混合通信系统的通信场景图
D2D终端需要具备的能力可以概括为以下两点m
与LTE蜂窝通信的干扰共存能力
干扰共存的一方面是要控制D2D通信对蜂窝通信的干扰，这是在LTE中引 入D2D的前提条件；另一方面是由于D2D通信需要在有蜂窝通信干扰的环 境下进行，所以D2D需要一套基于干扰避免和控制的资源分配算法来达到 较高的通信速率。
D2D直通通信传输技术
传输技术主要包括D2D通信流程设计以及各信道的物理层传输技术。其中 D2D通信流程设计需要考虑D2D用户的资源接入信令流程、D2D控制信令 流程等，而物理层传输技术一般使用与所复用的蜂窝上行或下行传输技术相 同叫
2.2干扰环境感知
D2D干扰感知需要解决以下三个问题：
(1)D2D所处的位置是否被LTE蜂窝基站信号覆盖
(2)若有蜂窝基站，D2D需要获得所处小区的上下行配置、带宽、时频同步 值等基本信息
(3)若有蜂窝基站，D2D需要实时获取各蜂窝上行信道占用的资源
LTE蜂窝基站在主同步信道及辅同步信道广播小区ID囲，D2D在获得了帧 同步后可以通过解主同步及辅同步信号获得小区ID。若D2D成功解到了小区ID, 说明此D2D处于LTE蜂窝干扰之中，为了满足干扰控制的需求D2D需要实时 获取每个上行子帧蜂窝用户的资源占用情况。因此，首先要获取小区的上下行配 置，即每个无线帧中哪些是上行子帧哪些是下行，还需要系统带宽、收发天线数 等基本信息作为解其他下行控制信道的基础。这些小区配置信息可以通过解物理 广播信道(Physical Broadcast channel, PBCH)获得。
根据文献［4］,物理上行共享信道(Physical Uplink Shared channel, PUSCH) 用于传输蜂窝用户上行数据，基站通过物理下行控制信道(Physical Downlink Control channel, PDSCH)中承载的信令来指示PUSCH的资源占用信息，另夕卜， 物理 HARQ 指示信道(Physical HARQ Indicate Channel, PHICH)包含了重传的 PUSCH的资源占用信息；物理上行控制信道(Physical Uplink Control Channel, PUSCH)和物理随机接入信道(Physical Random Access Channel, PRACH)的资 源占用由物理下行共享信道(Physical Downlink Shared Channel, PDSCH)中承载 的特定信令指示；若要解PDCCH和PDSCH,必须先解物理控制格式指示信道
(Physical Downlink Control channel,PCFICH),因为它指示了 PDCCH 和 PDSCH 位于一个下行子帧中的哪几个OFDM符号。
总的来说，D2D干扰感知需要的技术包括小区同步搜索技术和各下行信道 解码技术。其中PDCCH盲解码技术由于复杂度高且解码性能直接影响D2D干 扰感知的准确性，成为了干扰感知中的一个难点，将在本文第三章中进行重点研 究。下行信道估计是解码各下行信道的一个公用基础模块，信道估计的性能将影 响各信道的解码正确率，因此也是干扰感知中的一项关键技术，将在本文第四章 对下行信道估计算法进行优化。
2.3 D2D控制及数据传输信道
D2D控制信道要完成D2D资源接入、D2D资源指示以及D2D反馈重传指 示的功能。在文献［3］和［5］中，设计了一套完整的D2D控制及数据传输流程，能
在现有的LTE商用网络中达到点对点的高吞吐D2D数据传输，本文所提出的 D2D干扰控制算法将假定D2D用户之间的数据传输使用此项技术。下面简要描 述文献［3］和［5］中所提出的D2D传输技术。
D2D的资源接入是为了解决某个上行子帧被哪个D2D使用的问题，与蜂窝 系统不同，D2D系统一般不具备能进行统一资源分配的中心节点。因此，为了 避免D2D终端之间的碰撞问题，本方案中D2D的资源接入釆用RTS-CTS机制。 具体来说，D2D中RTS-CTS资源竞争和碰撞避免的流程是：一个需要发送数据 的D2D终端在所规定的RTS子帧发送RTS消息,RTS消息中包含了数据的目的 D2D等信息，接着RTS发送端将监听相应的CTS子帧，若收到CTS说明资源 申请成功，准备在相应的子帧发送D2D数据，若未收到CTS,说明发生了 RTS 碰撞，将采用退避策略⑶；同时每个D2D终端会监听每个RTS子帧，若解到其 他D2D发送的RTS,首先检查RTS中的目的D2D是不是自己，若是自己，则 在CTS子帧发送CTS作为应答，并准备在相应子帧接收D2D数据，若目的D2D 不是自己，则不再申请相同的数据子帧资源則5】。
D2D资源指示信道的功能是指示D2D数据传输信道所占用的RB位置，也 可以提供用于解D2D数据的其他基本信息。D2D反馈重传指示信道是D2D数据 接收端用于指示相应D2D数据是否正确接收，数据发送端将根据此信息决定是 否要重传数据。
由于D2D终端要监听D2D控制信道来决定自己的行为，所以上述D2D控 制信道占用的时频域资源应该是规定好的，D2D终端不需要其他信息就能对 D2D控制信道进行解码。几种不同的D2D控制信道应该在哪个子帧上发送需要 考虑到数据发送接收的处理时间等因素，图2-2展示了一种可行的D2D控制信 道的时序图。控制信道在相应子帧上所占用的频域资源需要与LTE蜂窝系统进行协调。
n+3 th frame
n th frame
n+2 th frame
n+l th frame
图2?2D2D数据传输通信流程
n+4 th frame

2.4 D2D资源分配及功率控制
D2D的资源分配和功率控制决定了 D2D将在所申请到的上行子帧使用哪些 RB以多大的功率发送数据,这将最终决定D2D的传输速率以及对蜂窝用户的干 扰大小，因此是LTE-D2D系统中的关键模块。文献［5］阐述了描述了一种适用于 一对D2D独占一个子帧进行数据传输的资源分配和功控算法，本文将在第五章 讨论的多对D2D共享一个子帧的场景下的干扰控制算法也借鉴了这一算法。本 节将简述文献［5］提出的D2D干扰控制算法。
算法的输入是蜂窝用户已经占用的RB位置、各RB上蜂窝对D2D的干扰 强度、各蜂窝用户所能忍受的吞吐率下降值以及各终端之间的路损，输出是能达 到最大D2D速率的RB位置及相应的D2D发送功率。算法流程是：首先根据是 否被蜂窝用户占用将整个频带分成多个连续的RB段；根据各蜂窝用户所能忍受 的吞吐率下降值和D2D到各蜂窝用户的路损值计算出D2D在各RB段上的最大 发送功率；通过D2D的发送功率、D2D收发端之间的路损以及蜂窝对D2D的干 扰强度可以得到D2D在各RB段上的吞吐速率。比较各RB段上D2D能达到的 吞吐速率，选择具有最大D2D速率的RB段用于D2D数据发送〔七
上述算法是一种分布式的算法，各D2D完全可以自主地收集所需的信息， 自主决定资源占用和发送功率。但上述算法不适用于第五章所描述的需要多D2D 对协调资源占用和功率的场景。
2.5小结
本章描述了一种可行的LTE-D2D系统的架构、D2D控制信道信令流程设计 以及与干扰共存相关的功能模块，在本文的后续章节中将对干扰共存相关的关键 技术进行更深入的研究。
第三章PDCCH盲解码的研究及实现
在D2D复用蜂窝上行链路的混合网络中，D2D实现干扰控制及干扰避免的 前提是能实时地感知蜂窝用户所占用的资源及其干扰功率。在4GLTE系统中， 基站通过物理下行控制信道(Physical Downlink Control channeh PDCCH)中承 载的下行控制信息(Downlink Control Information, DCI)来指示蜂窝终端将使用 的上行资源位置等信息向。本章将讨论D2D用户如何解码PDCCHo
3.1 PDCCH链路介绍
本节简要介绍PDCCH的所承载的内容、链路流程及其占用的资源。
3.1.1 DCI的格式及长度
DCI是PDCCH所承载的实际内容，DCI可用来传输卜行数据的调度信息、 上行数据的调度信息(UL Grant)、功率控制命令(TPC)、上行数据的ACK/NACK。 不同的DCI格式传输不同的信息，共有10种不同的DCI格式”］。
D2D用户需要从各种DCI格式中区分岀传输上行数据调度信息的format 0 DCL这种DCI中的内容如下：
Ibit , Format 0 和 Format 1A 的区分标识，0 指示 Format 0, 1 指示 Format 1A
?Ibit,跳频标识位
log2(C(C +1)/2)-Nbr hop)bits 或者(pog2(C(C+D/2))bits, 前者是PUSCH采用跳频时的资源分配，后者是非跳频的资源分配。
5bits, I"*调制和编码方案及冗余版本
Ibit,新数据指示符
2bits, PUSCH的TPC传输功率控制命令
3bits, DMRS的循环移位
2bits, UL index上行子帧号，针对的是TDD上下行配置0
2bits, DAI下行分配的索引，TDD上下行配置1-6
Ibits, CQI 请求
根据不同的DCI长度可以大致区分出不同DCI格式。若已知系统的带宽、 双工方式及天线配置，可以计算出各种不同格式的DCI长度回，10种格式的DCI 共有6种可能的长度，因为其中用于上行传输调度的format 0.用于下行数据调 度的format lAs用于上行功率控制的format 3/3A具有相同的长度，formatlB、


formatlD的长度也相同。表3-1给出了在20M带宽、双工方式为TDD、两天线 的系统中各种format的DCI长度。
DCI format	DCI 长度(bit)
1C	13
0/1A/3/3A	31
1	33
1B/1D	42
2	51
2A	54
表3-120M带宽双天线TDDETE系统中的format长度

3.1.2 PDCCH链路流程
PDCCH链路的发送和接收流程如图3-1所示孔值得说明的是，在添加CRC 步骤中，根据CRC校验生成多项式计算出CRC比特后，还要使用相应UE的 RNTI进行掩码加扰处理，以便UE接收端在PDCCH解码时区分不同用户的控 制信息。但D2D用户无法获得其他UE的RNTL因此D2D的PDCCH盲解码 中不能使用CRC校验来检验是否解码正确，这就对解码提出了更高的要求。

图3-1 PDCCH链路的发送和接收流程图
3.1.3 PDCCH资源映射原则
PDCCH资源分配的单位是控制信道元素(Control Channel Element, CCE),每 个CCE包含9个资源粒子组(Resource Element Group, REG), 4个资源粒子 (Resource Element, RE)为一个REG,每个QPSK符号可映射到一个RE中。每个 PDCCH占用一个或多个CCE,协议中定义了表3-2中的几种PDCCH格式。 PDCCH所占用的CCE数又称为聚合等级(Aggregation Level对特定的PDCCH所需的CCE数量取决于DCI负荷、信道编码速率的负荷大小以及当时的信道条 件，一般来说，在同等的信道条件下，DCI负荷越大、PDCCH聚合等级越小， 说明信道编码后冗余比特越少，则PDCCH解码难度越大，低聚合等级下的 PDCCH解码是本章的重点关注内容。
PDCCH格式	CCE个数(L)	REG个数	PDCCH比特数
0	1	9	72
1	2	18	144
2	4	36	288
3	8	72	576
表3-2 PDCCH格式信息表
在同一个子帧的控制域中可以通过复用同时发送多个UE的PDCCH,为了 简化译码过程，复用过程中各PDCCH所占用的CCE的位置受到聚合等级、UE 的RNTI、DCI格式的约束。具体如下：
约束1 LTE协议规定，控制域的CCE从。开始编号，由L个CCE构成的 PDCCH只能由一个编号等于L的倍数的CCE作为起始CCEo
约束2； LTE协议定义了搜索空间来规定不同类型DCI可能占用的CCE的
位置，有两种类型的搜索空间：公共搜索空间和UE专用搜索空间，每种类 型捜索空间中的聚合等级、搜索空间大小及候选集人数如表3-3所示⑹。
搜索空间	聚合等级(L)	搜索空间大小	候选集数(“⑥)
UE专用搜索空间	1	6	6
2	　　　　12	6
4	8	2
8	　　　　16	2
公共搜索空间	4	　　　　16	4
8	　　　　16	2
表3-3搜索空间类型信息表
协议同时规定了搜索空间的起始位置：公共搜索空间的起始位置为0, UE 专用搜索空间的起始位置与UE的RNTI有关回。根据搜索空间的起始位置、表 3-3中的搜索空间大小即可确定PDCCH可能出现的所有位置，再根据表3-2中 的聚合等级以及约束」,能够进一步缩小范围，减小解码次数。
根据协议，D2D用户需要解出的format 0DCI可以出现在公共搜索空间或 UE专用搜索空间，其聚合等级可能为1/2/4/8,但由于D2D用户在没有基站辅 助的情况下无法获得小区中UE的RNTL即无法确定UE专用搜索空间的位置，

因此约束2对D2D的PDCCH盲解码没有帮助，D2D用户需要在整个PDCCH 范围内寻找所有满足约束1的位置进行解码。
3.2高聚合等级的PDCCH盲解码
从上一节可以看出，D2D用户在不知道蜂窝UE的RNTI时解码PDCCH会 遇到如下几个困难：
1）	无法确定UE专用搜索空间的位置，需要尝试解码的范围大，这对解码的时 间性能提出了更高的要求
2）	无法通过CRC校验来验证解码是否正确，即要求解码有更高的准确性。 为了解决上述问题，文献［8］中提出了先用功率检测算法判断出有PDCCH传输的 CCE位置，然后只对这些CCE位置进行基于累积度量优势的PDCCH解码。
3.2.1功率检测判断CCE位置
在UE接收端解层映射预编码之后各复用的PDCCH是以CCE为单位排列 的，功率检测的目的是判断出整个PDCCH范围内哪些CCE实际传输了 PDCCH 信号，如此可以缩小PDCCH盲解码的解码范围，减小解码耗时。文献［9］提岀了 一种在全盲频谱条件下的噪声估计与能量检测联合迭代算法，文献［10］中基于这 一算法并结合PDCCH解码的实际情况，提出了 一种迭代的CCE功率检测算法， 并给出了其虚警率及漏检率的证明。本小节将阐述这种CCE功率检测技术。
假设务承载了用户数据的CCE之间没有相互干扰，且整个频带内的噪声类 型为高斯白噪声。设整个频带内共有N个CCE,每个CCE都处于“空闲”或“被 占用”这两种状态中的一种，用&表示CCE空闲，用§表示CCE被占用，则 CCE功率检测问题可以被建模为二元假设检验模型言
岛：印]=W[i] .
其中N为频带内CCE总个数，X［/］为发送端在第7个CCE发送的信号强 度，地］为接收端在第，个CCE接收到的信号强度，砂［/］为信道在第7个CCE 的噪声强度，信道中的噪声分布服从N（0q"
功率检测算法的目的是最终得到一个判决门限弓,，从而将信号强度大于此 门限的CCE状态判决为被占用，小于此门限的判决为空闲，即：
(3-2)

算法需要依据信道噪声强度得到4的初始值七,1,由于缺乏信道的先验信 息，文献［9］提出用经验公式3-3获得门限初始值。
Vthx=C^mean(Y\i}\r)	(3-3)
其中C可以取［1,2］之间的值，如1,1.2,15； 丫卩］|,表示接收到的信号强度最低 的r%个CCE信号强度的集合，mean。)表示取平均值。
功率检测中的漏检概率是指实际是有信号的CCE被判决成纯噪声CCE的概 率，虚警概率是指实际只有噪声的CCE被判决成有信号的CCE的概率，这通常 是两个无法同时达到最优的指标。由于D2D通信中的PDCCH盲解码将对所有 被判决为有信号的CCE进行解码，若功率检测算法的虚警概率较高将导致解出 较多本来不存在的蜂窝用户资源占用信息，影响D2D通信吞吐性能，同时，也 增加了盲解码模块的耗时，对系统实时性造成影响。因此，应用于D2D干扰感 知中的功率检测应该首先保证较低的虚警概率3】。在恒虚警概率门限准则下的 判决门限计算公式为【刈：



其中。己为信道中高斯白噪声的方差，冰(?)为误差函数，今为指定的虚警概率, N为CCE总个数。
从式(3-4)中可以看出，只要确定了 bj,匸方就随之确定了。假设第上一1次 迭代得到的判决门限是*虹】,根据式(3-2)用此门限对所有CCE进行判决， 用判决结果中处于&状态的CCE信号强度求平均值得到第上次迭代中的噪声强 度庁云，再根据式(3-4)可以得到第k次送代的判决门限七曰迭代的终止条 件是:’
(3-5)
其中「是收敛精度。
算法收敛时将输出当前判决门限，PDCCH盲解码依据此判决门限对所有
CCE进行功率判决。具体的功率检测算法流程如图3-2所示：
图3-2 PDGCH解码前的功率检测流程图

3.2.2基于累积度量优势的PDCCH盲解码
功率检测模块可以判断出哪些CCE上有PDCCH信号传输，在缺少蜂窝用户 RNTI的前提下，判断这些CCE中究竟传输的是哪种格式的DCI是本小节将介 绍的PDCCH盲解码模块要完成的功能。
如表3-1所示，PDCCH中共有10种DCI format,这10种format共有6种 不同的比特长度，将这6种不同的长度记为】(Z),其中Z = l,2,...,4若己知 PDCCH的聚合等级L,可以基于累积路径度量优势判断这L个CCE中承载的 DCI比特长度。PDCCH接收端在解调解扰之后，将根据目标DCI长度来解速率匹配以及解卷积编码。在使用维特比译码算法解卷积编码结束时具有最大度量值 的译码路径将成为幸存路径，幸存路径上的译码比特将成为译码输出。幸存路径 上的各个时刻都有累积度量值，将第，种DCI长度在时刻子的累积度量值记为 M"),其中z = l,2,...,6,l<Z<Z^)o累积度量值会随着时刻的增加而增加， 并且在一定信噪比条件下，正确DCI长度译码的累积度量值会明显高于其它错 误DCI长度译码的累积度量值㈣。图3-3给出了用4个CCE承载长度为42比 特DCI的各译码时刻的累积度量值，图中6条线分别代表表3-1中6种DCI长 度的译码度量值，图中译码的长度等于DCI长度加上16比特的CRC长度，可 以看出正确DCI长度——42比特——的累积度量值明显高于其他5种错误DCI 长度译码的累积度量值。基于这一现象，将某指定DCI长度的累积度量优势定 义为：在指定DCI长度译码结束时，指定DCI长度译码的累积度量值相对于其 他DCI长度译码同时刻的累积度量值的差值之和，若其他DCI长度比指定DCI 长度短，则计算在较短的DCI译码结束时刻累积度量值的差值。累积度量优势 衡量的是指定的DCI长度相对于其他所有DCI长度译码度量值的优势之和。聚 合等级为L个CCE的第，种DCI长度相对于其他DCI长度的解码累积度量优势 匕丄可以表示为：
D“ = X WCminLO,?) - My(min(/(z),/(；))))
汙i	(3-6 )
'，丿= 1,2,...,6
其中min(.)是取较小值的函数。

0	10	20	30	40	50	60	70
Viterbi Decode Time Index
图3-3 4CCE承载42比特DCI在每个解妈时刻的累积度量值
对于这段长为L的CCE,取6种DCI长度中具有最大累积度量优势的DCI 长度及其解码结果作为最后的解码输出，即：
fdrmat(L) = arg max {DL J	(3-7)
基于累积路径度量优势判断DC】长度的算法可以简单描述为:对于给定CCE 长度的数据进行6种DCI长度的译码，并分别计算6种DCI长度的累积度量优 势值，具有最大累积度量优势值的DCI长度即判断为正确的DCI长度，输出正 确DCI长度的译码结果卩叫
另一个需要解决的问题是DCI聚合等级的判断，例如功率检测模块判断出有 8个连续的CCE包含信号，那么需要判断出这8个连续的CCE是…个聚合等级 为8的DCL还是3个DC】，聚合等级分别为2、2、4,或者其他可能的聚合等 级DCI的组合。
由于最大的聚合等级为8,且根据3.1.3小节中的约束1,聚合等级为L的 PDCCH起始位置只能是L的整数倍，因此可以把从8的整数倍开始的8个CCE 作为一个解码单元，每个解码单元的解码是独立的，即不存在--个PDCCH会同 时出现在两个解码单元中。对每个解码单元，若存在符合约束1的连续m个CCE (m=2,4,8),则比较这m个CCE开头的1,2,4...,m个CCE解码输出的最大累积 度量优势值，假设这些累积度量优势值中的最大值对应的聚合等级为勾，即这m 个CCE中开头的4个CCE承载了一个DCI,再用相同的思路判断其余的 (0 - 4)个CCE的聚合等级。
在仿真中发现，上述基于最大累积度量优势判断聚合等级的算法在较低信噪 比下容易错判为1CCE,这是由于1CCE解码时冗余比特少，在较低信噪比时其 累积度量优势具有一定的随机性，因此正确的聚合等级是2或4或8,但聚合等 级为1的最大累积度量优势却大于正确聚合等级的最大度量优势，导致聚合等级 的误判。为了能在较大的信噪比范围内保证高聚合等级一一2,4,8个CCE——的 解码正确性，暂时放弃低聚合等级——1个CCE——的解码，在第3.3节中依据 仿真结果再将低聚合等级解码合理地加入到算法中。
综上所述，功率检测之后高聚合等级PDCCH盲解码模块的算法流程如图3-4 所示。

3.2.3 PDCCH盲解码算法的性能
本节对3.2.2节中算法进行了性能仿真。仿真的系统带宽是20M,发送、接 收天线数都为1,信道类型为EVA,多普勒频移为5Hz,仿真次数是1000次。 为了验证算法对于各种高聚合等级PDCCH的解码性能，设计了表3-4中的多种 聚合等级及DCI长度组合的测试caseo
Case类别	Case编号	解码CCE
数目	（实际CCE数， 实际DCI比特数）	盲解码比特数
case 11	Casell.l	(8,4,2)	(8,13)	全部解码可能

表3-4聚合等级为2/4/8的PDCCH盲解码仿真case表
在3.2.2小节中的算法在各case中的性能如图3-5至图3-7所示。

图3-5 Casell解码性能仿真图
Pdcch decode simulation result of Case 12
(％￥)￡」0」」LLIO^OOOQ

SNR/dB
图3-6 Case 12解码性能仿真图
Pdcch decode simulation result of Case 13
Case 13-1
4— Case 13-2
0— Case 13-3
Case 13-4 ■★— Case 13-5 气—Case 13-6
(次)① 」0匕山CDpootDQ
SNR/dB

图3-7 Case 13解码性能仿真图
从上面的仿真结果可以看出，在相同的信噪比下，聚合等级越高，DCI比特 数越少则解码错误率越小。承载了上行调度信息的DCI format 0的长度是31比 特，这种DCI format能到达1%错误率的信噪比在聚合等级为8时是-3dB、聚合 等级为4时是-IdB、聚合等级为2时是3dB左右。
3.3包含1CCE的PDCCH盲解码
如3.2节所述，使用前述PDCCH盲解码算法的UE接收端若在整个信噪比 范围内都将1 CCE作为可能的聚合等级之…，将会缩小高聚合等级正确解码的 信噪比范围。另-方面，eNodeB只会在UE信道条件比较好时使用聚合等级为 1的PDCCH承载DCI,这意味着UE必须要在信道条件较差时仍能正确解出高 聚合等级的PDCCHo因此，本节对3.2节中的算法进行了包含1CCE聚合等级 PDCCH解码的仿真和分析，并提出了 ?种以信噪比为参考的解码方案，以在较 宽的信噪比范围内保证高聚合等级PDCCH的解码正确率，在较高信噪比下保证 聚合等级为1的PDCCH的解码正确率。
本节中的仿真条件与第3.2.3小节中的相同，目标DCI长度为31比特一一承 载上行调度信息的format 0的DCI长度。
3.3.1 1CCE盲解码的难点
聚合等级为1的PDCCH在传输相同format的DCI时与其他聚合等级相比 占用的资源最少，在信噪比较高的场景下，基站会通过发送聚合等级为1的 PDCCH以增加在一个下行子帧同时调度的用户数。因此，下行接收端必须具有 解码1CCE PDCCH的能力。
在PDCCH盲解码中将1CCE作为一个候选的聚合等级主要会遇到以下两个 挑战：
挑战1：在较低信噪比下导致高聚合等级PDCCH的误判。
假设基站发送的是一个聚合等级为2或4或8的PDCCH,若解码算法调整 为在1.2节的算法基础上将1CCE加入候选的聚合等级，由于1CCE的比特 少，当信噪比较低时，在比较1CCE的累积度量优势时还没有体现出卷积译 码的规律，可能出现1CCE的最大累积度量优势高于其他聚合等级的情况， 这会导致聚合等级的误判。本节的仿真结果展示了这种误判的概率。
挑战2：在较低信噪比下1CCE维特比译码的正确率较低
承载相同比特长度的DCI时聚合等级越低数据冗余越小，因此在相同的信噪 比下解码正确率会随着聚合等级的降低而降低。本节的仿真结果展示了这一 现象。
表3-5比较了两个case是否加入1CCE解码的误码率，从中可以看出加入
1CCE解码会增加其他聚合等级的误码率。
Casel2.2	SNR(dB)	-3	-1	1	3	8	13
不加入1CCE解码的错误率(％)	4	0.6	0.2	0.1	1.3	0
加入1CCE解码的错误率(％)	29.1	0.64	0.3	0	0	0
Casel3.4	SNR(dB)	-3	-1	1	3	8	13
不加入1CCE解码的错误率(％)	97.6	82.7	29.7	1.7	0	0
加入1CCE解码的错误率(％)	100	99,4	88.2	31.2	0	0
表3-5 Casel2.2和Casel3.4加入和不加入1CCE的解码错误率对比
由于廠2的存在，基站在选择某用户的PDCCH聚合等级时会参考此用户 的接收信噪比，只对接收信噪比满足要求的用户发送聚合等级为1的PDCCHe 这实际匕也为1CCE盲解码提供了思路，即只在某信噪比门限以上进行1CCE解 码，门限选择合理的话可以在保证不对高聚合等级解码造成影响的前提下，使 1CCE解码正确率满足协议要求。本节的后面几小节将按照这…思路逐步获得这 一信噪比门限。
3.3.2 1CCE解码误块率仿真
PDCCH长度为1CCE时，信道编码由于冗余少导致误比特率髙。…个DCI 只要错了 1个bit就称发生了 “误块”。表3-6是已知聚合等级为1、DCI K度为 31比特的误块率仿真结果。
SNR(dB)	0	3	6	9	12	15
误块率(％)	95.7	37.7	1.4	0	0	0
表3-6聚合等级为1、DCI为31比特的误块率
从仿真结果可以看岀，在6dB时，聚合等级为1、DC1长度为31比特的维特比 译码误块率在1%左右，随着信噪比的下降，误块率增长得很剧烈，所以在6dB 及以上才考虑1CCE的解码，这样既能保证正确率又能节约解码时间。
3.3.3未知聚合等级的1CCE解码仿真
本节仿真中解PDCCH的流程是对从CCE起始位置开始的1、2、4、8个CCE 分别用6种DCI长度解码，选择其中具有最大累积度量优势的CCE聚合和DCI长度。与3.2.2小节中的算法相比，只是将1CCE作为一种可能的聚合等级，具 体的基于累积度量优势的解码算法并没有改动。基于3.3.2小节的仿真结果，本 小节仿真的SNR范围从6dB开始。
为了验证在多种DCI长度及聚合等级的组合下1CCE PDCCH的解码性能， 设计了表3-7中的测试caseo
Case 编号	解码CCE 数目	(实际CCE数， 实际DCI比特数)	盲解码比特数
Case14.1	(8,4,2,1)	(1,31)(1,31)(2,31)(4,42)	全部解码可能
(13,31,33,42,51,54)
Case14.2		(1,31)(1,13)(2,31)(4,42)
Case14.3		(1,31)(1,13)(1,31)(1,13)(4,42)
Case14.4		(1,31)(1,31)(1,13)(1,13)(4,42)
Case14.5		(1,31)(1,13)(2,31)(2,13)(2,42)
Case14.6		(1,31)(1,13)(2,54)(2,13)(2,42)
Case14.7		(1,13)(2,42)(1,13)(1,31)(2,13)

表3-7 case 14参数表 仿真结果如表3-8所示。
Casel4.1	SNR(dB)	6	7	8	9	10	11	12	13
聚合等级判断错误率(%)	1.7	1.4	0.5	0.1	0.1	0	0	0.2
总错误率(％)	29.4	16.6	7.4	3.5	1.8	0.9	0.5	1.1
Casel4.2	SNR(dB)	6	7	8	9	10	11	12	13
聚合等级判断错误率(%)	1	0.2	0.8	0.3	0.1	0	0	0
总错误率(％)	29.6	16.5	7.8	4.4	1.6	1.6	0.8	0.7
Casel4.3	SNR(dB)	6	7	8	9	10	11	12	13
聚合等级判断错误率(%)	1.9	0.7	0.4	0.2	0.5	0	0.1	0
总错误率(％)	31.6	15.5	7.2	3.9	2.8	1.1	0.8	0.5
Casel4.4	SNR(dB)	6	7	8	9	10	11	12	13
聚合等级判断错误率(%)	1.3	0.2	0.7	0.1	0	0	0	0.1
总错误率(％)	29.9	16.2	8.1	4.9	1.6	1.2	0.4	0.5
Casel4.5	SNR(dB)	6	7	8	9	10	11	12	13
聚合等级判断错误率(%)	0.2	0.4	0.5	0	0.1	0	0	0.1
总错误率(％)	27.2	14.7	7.2	3.3	2.6	1.1	0.5	0.3
Case 14.6	SNR(dB)	6	7	8	9	10	11	12	13
聚合等级判断错误率(%)	1.3	0.2	0.3	0.1	0	0	0	0

总错误率(％)	29.9	16.0	7.2	2.9	1.6	1.8	0.3	0.7
Casel4.7	SNR(dB)	6	7	8	9	10	11	12	13
聚合等级判断错误率(%)	0.6	0.3	0.3	0.1	0	0	0.1	0
总错误率(％)	29.8	14.9	8.3	3.3	2.1	1.1	0.6	0.9
表3-8 case 14仿真结果
从本节的仿真结果可以看出，在目标format是31bits的情况下,SNR在lldB 及以上时，1CCE聚合等级的PDCCH解码总错误率在维持在1%左右。值得注 意的一点是，在7dB及以上，聚合等级判断错误率维持在1%左右，只是在判断 1CCE中的DCI长度时错误率较高。可以考虑在7dB及以上将1CCE解码加进来, 根据在最近一段时间内解到的format 0 PDCCH存储一个常调度的RNTI列表， 当SNR在7?lldB之间，若CCE数目判断出为1个CCE,则以1CCE中31bit 解出的RNTI是否在这个常调度列表里来决定解码结果是否有效，这样可以减少 常调度用户一一通常也是对D2D影响较大的用户一一上行调度信息的漏检率。 当SNR在lldB及以上，就可以完全信任1CCE解码的结果了，不需要再比对常 调度的RNTL


3.3.4 1CCE解码对于高聚合等级解码的影响
本小节使用加入了聚合等级为1的解码算法对表3-4中部分Case进行了仿真, 以考察聚合等级为1的解码对高聚合等级解码的影响。测试结果如表3-9所示。
Casel 1.2	SNR(dB)	-3	-1	1	3	4	5	6	7	8	13
总错误率(％)	-	-	-	0	0	0	0	0	0	0
Case! 2.2	SNR(dB)	-3	-1	1	3	4	5	6	7	8	13
总错误率(％)	29.1	2.4	0.3	0	-	-			0	0
Casel3.1	SNR(dB)	-3	-1	1	3	4	5	6	7	8	13
总错误率(％)		-	-	-	0	0	0	0	0	0
Casel3.2	SNR(dB)	-3	-1	1	3	4	5	6	7	8	13
总错误率(％)	-	-	-	―	0	0	0	0	0	0
Casel3.3	SNR(dB)	-3	-1	1	3	4	5	6	7	8	13
总错误率(％)	-		-		0	0	0	0	0	0
Case 13.4	SNR(dB)	-3	-1	1	3	4	5	6	7	8	13
总错误率(％)	100	99.4	88.2	31.2	4.9	0.4	0	0	0	0
表3-9在部分高聚合等级case中加入1CCE解码的仿真结果
表3-9中不是对所有的case都仿真了所有列出的信噪比，而是只仿真了每个case
可能会被聚合等级为1的解码影响的信噪比范围，表中错误率为的信噪比 是对应case未仿真的信噪比。关于仿真case的选择也需要说明，在目标聚合等 级为8和4的case中只各仿真了一个case,这是因为在同等信噪比下聚合等级 越高的PDCCH解码正确率越高，错判为聚合等级为1的概率小，所以主要仿真 了聚合等级为2的case,它们受到聚合等级为1的解码的影响最大。
将表3-9与3.2.3小节中对应的仿真结果进行比对，发现聚合等级为8的case 的正确率基本不会受到1CCE解码的影响，聚合等级为4的case的正确率在信 噪比为OdB以上时不会受到1CCE解码的影响。另外，case 13.4的仿真对比表明 5dB及以下由于1CCE解码带来的错误率增加了，而5dB及以上没有影响；case 13.1至13.3在SNR=4~7dB之间错误率都为零，即加入1CCE解码在SNR=4?7dB 之间不会対这些case的正确率有影响。
駐于以上的仿真结果及分析，认为在6dB及以上引入1CCE解码不会对高聚 合等级PDCCH解码正确率造成影响。
3.3.5信号质量自适应的PDCCH盲解码技术
综合上述仿真结果及分析，提出图3-8所示的信号质量自适应的PDCCH解 码技术，它适用于所有聚合等级的PDCCH解码。

图3-8聚合等级为8/4/2/1的PDCCH解码流程图
信号质量自适应PDCCH盲解码技术在目标聚合等级为1/2/4/8时的仿真性能:

目 标 为 高 聚 合 等 级	Case 11.2
(8CCE)	SNR(dB)	-3	-1	1	3	4	5	6	7	8	13
总错误 率(％)	1.3	0.2	0	0	0	0	0	0	0	0
Casel2.2
(4CCE)	SNR(dB)	-3	-1	1	3	4	5	6	7	8	13
总错误
率(％)	4	0.6	0.2	0.1	0	0	0	0	0	0
Casel3.1
(2CCE)	SNR(dB)	-3	-1	1	3	4	5	6	7	8	13
总错误
率(％)	3.5	0.1	0	0	0	0	0	0	0	0
Case 13.2
(2CCE)	SNR(dB)	-3	-1	1	3	4	5	6	7	8	13
总错误 率(％)	68.5	23.6	2.6	0.1	0	0	0	0	0	0


Casel3.3
(2CCE)	SNR(dB)	-3	-1	1	3	4	5	6	7	8	13
总错误 率(％)	73.6	23.7	1.4	0	0	0	0	0	0	0
Case 13.4
(2CCE)	SNR(dB)	~3	-1	1	3	4	5	6	7	8	13
总错误 率(％)	100	99.4	88.2	31.2	4.9	0.4	0	0	0	0
目 标 为 低 聚 合 等 级	Casel4.1
(1CCE)	SNR(dB)	-	-	6	7	8	9	10	11	12	13
总错误 率(％)	■	-	29.4	16.6	7.4	3.5	1.8	0.9	0.5	1.1
Casel4.2
(ICCE)	SNR(dB)	-	-	6	7	8	9	10	11	12	13
总错误 率(％)	-	-	29.6	16.5	7.8	4.4	1.6	1.6	0.8	0.7
Casel4.3
(ICCE)	SNR(dB)		-	6	7	8	9	10	11	12	13
总错误
率(％)	-	-	31.6	15.5	7.2	3.9	2.8	1.1	0.8	0.5
Casel4.4
(ICCE)	SNR(dB)	-	-	6	7	8	9	10	11	12	13
总错误 率(％)	-	-	29.9	16.2	8.1	4.9	1.6	1.2	0.4	0.5
表3-10信号质量自适应PDCCH盲解码技术仿真性能

下面对所提出的解码技术的仿真性能与3GPPLTE协议中的相关性能要求进 行对比。协议［11］中规定了对聚合等级为2/4/8的PDCCH解码性能的最低要求， 如表3-11所示。表3-11中参考信道的具体信道条件如表3-12所示。
Bandwidth	Aggregation level	Reference
Channel	Propagation Condition	Antenna configuration and correlation Matrix	Reference value
Pm-dsg
(%)	SNR
(dB)
10 MHz	8CCE	R.15 TDD	ETU70	1x2 Low	1	-1.6
10 MHz	4CCE	R.16TDD	EVA70	2x2 Low	1	0.1
5 MHz	2CCE	R.17TDD	EPA5	4x2 Medium	1	6.5
表3-11 3GPPLTE协议中对PDCCH解码性能的要求

Parameter	Unit	Value
Reference channel		R. 15 TDD	R.16TDD	R.17TDD
Number of transmitter antennas		1	2	4
Channel bandwidth	MHz	10	10	5
Number of OFDM symbols for PDCCH	symbols	2	2	2
Aggregation level	CCE	8	4	2
DO Format		Format 1	Format 2	Format 2
Cell ID		0	0	0
Payload (without CRC)	Bits	34	46	45
表3-12 3GPP ETE协议中各种参考信道的具体条件
本章的仿真环境与协议中的主要存在以下差异：
本文中带宽是20M,协议中的是10M；
本文中接收天线数是1,协议中的是2；
本文中的发送天线一直是1,协议中为1、2、4.
本文中的信道类型固定为EVA,多普勒频移固定为5Hz。
其中带宽几乎不影响最终解码性能；接收和发送天线数越少，在同等信噪比 条件下解码性能会越差；多普勒频移的减小使得同等信噪比条件下的解码性能略 有提升。因此，总的来说，本章中的仿真条件相比于协议中的是更不利于达到较 高的解码性能的。对比表3-10和3-11,可得出如下结论：
目标聚合等级为8时：所提出算法在-3dB时错误率为1.3%, -IdB时错误率 为0.2%；而协议中要求在-1.6dB时错误率不大于l%o
目标聚合等级为4时：所提出算法在-IdB时错误率为0.6%；而协议中要求 在0 IdB时错误率不大于1%。
目标聚合等级为2时:所提出算法在6dB时错误率为0；而协议中要求在6.5dB 时错误率不大于1%。
因此，所提岀算法的高聚合等级解码性能均达到了协议要求，这…方面说明 基于功率检测和最大累积度量优势的PDCCH盲解码算法的可行性，更重要的是， 这说明加入1CCE的PDCCH盲解码算法并没有影响高聚合等级的解码性能。
关于聚合等级为1的PDCCH解码性能，协议中没有给出具体要求°本章所 提出的算法能达到的性能是在收发单天线且DCI比特长度为31时，在lldB附 件解码错误率小于等于1%。从表3-12中对于高聚合等级的性能预期来推测，本 文所提出的算法在低聚合等级上的解码性能是可以符合实际应用中的需求的。
3.4 PDCCH盲解码的并行实现
由于D2D中的PDCCH盲解码需要尝试多聚合等级与多DCI长度，因此它是D2D系统干扰感知功能中耗时非常高的一个模块，其时间性能将直接影响整 个D2D系统的实时性，因此对PDCCH盲解码进行时间优化是实现中的关键问 题。
观察前述的PDCCH盲解码流程，发现一个子帧的PDCCH信道盲解码是以 8个CCE为解码单元的，即各8个CCE的解码之间没有相互影响，这就构成了 并行程序的基本条件一一没有耦合的子模块。因此可以使用并行程序的思想对 PDCCH盲解码进行时间优化。
釆用任务分发-任务执行-结果收集的模型实现PDCCH盲解码的并行实现， 此模型中的任务分发线程将多个任务分配到多个空闲worker线程中并行执行， 在PDCCH盲解码中一个任务就是对8个CCE进行解码，每个worker做完任务 后将运行结果输出给结果收集线程，并且重新成为空闲worker准备接受任务分 发线程给的下一个任务，直到所有的任务都完成。如图3-9所示：


图3-9 PDCCH并行解码框架
在GPP平台上可以借助Pthread (POSIX threads)以及ZMQ工具实现上述 框架下的PDCCH并行盲解码。POSIX线程(POSIX threads),简称Pthreads, 是线程的POSIX标准。该标准定义了创建和操纵线程的一整套API。POSIX线程具有很好的可移植性，使用pthreads编写的代码可运行于Solaris、FreeBSD. Linux等平台，Windows平台亦有pthreads-Win32可供使用。ZMQ是iMatix公 司开发的一套高并发的网络消息传输连接库。ZMQ消息可以传输于多种协议之 中，例如TCP、线程之间、多种广播协议、进程之间等；另外，可以通过不同类 型的ZMQ套接字构建多种连接模式，例如发布订阅模式、扇出模式、请求应答 模式、任务分发模式等。ZMQ优秀的异步I/O机制让开发者能够利用多核编程 实现异步消息的处理。可以使用多种语言编写ZMQ程序，ZMQ的同时也具有 良好的可移植性。PDCCH盲解码并行实现中使用Pthread库创建、销毁线程， 使用ZMQ在线程间传递消息以完成线程间同步和数据传递。
在PDCCH信道能量检测之后，任务分发线程将判断所有以8的整数倍开头 的8个CCE上是否有信号，若有，则将这8个CCE的数据及哪些CCE上有信 号打包成一个任务信息：worklnfoo所有任务打包完成后，任务分发线程将所有 workinfo包放到任务池中，即一个ZMQ的套接字中。每个Worker线程在空闲 时都会不断尝试从任务池中下拉一个任务，直到任务下拉成功，此时此Worker 开始8个CCE的PDCCH盲解码流程，解码完成将结果发送到结果池中，即另 一个ZMQ的套接字。结果收集线程不断尝试从结果池中下拉结果并存储结果， 直到成功下拉的结果数等于总的所分发的任务数，此时整个子帧的PDCCH并行 盲解码流程完成。
根据上述并行实现框架，将3.3.5小节所提出的算法在GPP平台上进行了实 现，下面将展示实现的效果。

town! hik sync
/：eue(D:4979
CelIID:332
CeueID:1214
CeueID:1104
图3-10 D2D用户感知到的蜂窝小区及蜂窝用户信息
d2d占用
pucch
CELLUE占用 飞D2D占用(5)
蜂窝占用
图3-11 PDCCH盲解码获得的蜂窝用户资源占用信息与实际占用情况

图3-10展示了 D2D对所处的干扰环境：当前的蜂窝小区ID为332,小区中 存在多个被基站调度的蜂窝用户，它们动态地占用部分蜂窝上行资源。D2D用 户能感知到这些蜂窝用户的存在就是进行了 PDCCH盲解码的结果。图3-11抓 取了一个上行子帧功率测量的结果，其中上图标示了 D2D数据传输占用的资源, 下图标示了蜂窝用户的资源占用情况。图中横轴是资源块(Resource Block, RB) 的下标，当前小区的带宽为20M,因此共有100个RB,纵轴是实际测量到的每 个RB上的功率，单位为dBm/RB。可以从图中看出，在PDCCH盲解码中获得 的RNTI为8755和3014的这两个用户的资源占用情况和实际测量到的占用情况 是吻合的，这说明PDCCH盲解码的结果的正确性。另外，基于解到的蜂窝用户 的资源占用十青况，D2D用户选择了一段空闲的资源段进行D2D数据传输，有效 地避免了 D2D和蜂窝用户之间的干扰，取得了吞吐增益。
3.5小结
本章解决的主要问题是如何在D2D系统中在满足实时性的同时保证PDCCH 盲解码的正确率。本章先介绍了 PDCCH的链路构成、编码及资源映射方式，结 合D2D终端与普通蜂窝终端PDCCH解码过程中的异同，利用最大累积度量优 势来判断PDCCH的聚合等级及DCI长度。由于这种算法在PDCCH聚合等级为 1时误判率较高，通过多种配置下的仿真和对比，最终提出一套能保证在较宽信 噪比范围内2CCE及以上聚合等级31比特DCI解码错误率1%以下、6dB以上 1CCE聚合等级31比特DCI解码错误率较低的PDCCH盲解码方案。最后，提 出了适用于PDCCH盲解码的并行实现框架，以保证系统的实时性。

第四章 基于VCFR的LTE下行信道估计
4.1下行信道估计在干扰共存中的作用
在4GLTE蜂窝网络与D2D的异构网络中，蜂窝用户作为主用户，D2D用户 为次用户，D2D用户必须严格控制对蜂窝用户通信的干扰，控制干扰的一个关 键点是干扰感知，即D2D用户能准确地感知到周围的蜂窝干扰环境。表4-1总 结了完成干扰感知功能D2D需要获得的信息以及获得这些信息所需要的关键技 术。
D2D干扰感知需要获得的信息	所在信道	关键技术
正确搜索到小区	主、辅同步信道	小区搜索
时偏频偏同步及跟踪	同步信道或参考信 号	信道估计、 同步跟踪算 法
上下行配置、系统帧号、天线数等	PBCH	信道估计 信道均衡、 信道解码
蜂窝上行共享信道资源调度信息	PDCCH、PHICH
PCFICH
蜂窝上行功控基本信息	PCFICH、PDSCH
上行控制信道及随机接入信道资源占 用
表4-1 D2D干扰感知所需信息及关键技术
D2D用户需要在搜索并同步到小区后解码多个下行信道获得小区相关参数, 包括通过解物理广播信道(Physical Broadcast channel, PBCH)获得小区无线帧 号、系统带宽、发送天线数、上下行配置等参数，通过解物理控制格式指示信道 (Physical Downlink Control channel, PCFICH)获得控制域及数据域所占用的符 号数，通过解物理下行控制信道(Physical Downlink Control channel, PDCCH) 获得蜂窝用户上行调度信息，通过解物理HARQ指示信道(Physical HARQ Indicator channel, PHICH)获得蜂窝上行数据重传信息，通过解包含系统消息块 (System Information Block, SIB)的物理下行共享信道(Physical Downlink Shared channel, PDSCH)获得蜂窝系统上行功控及上行控制信道的资源占用等相关参数 [7]
从表4-1中可以看出，这些干扰信息中的大多数的获得都需要下行信道估计 这一关键技术，并且信道估计算法的性能将对这些信道的最终的解码性能产生很 大影响，因此对LTE下行信道估计算法的研究是蜂窝与D2D干扰共存技术研究中的一个重要组成部分，提高下行信道估计算法对提高D2D用户干扰感知的准 确性具有很大意义。
本章提出了一种适用于LTE下行链路的信道估计算法。此算法通过添加虚子 载波频率响应(Virtual Carrier Frequency Responses, VCFR)来减轻传统 DFT 信 道估计算法中存在的“边效应”，并使用基于能量检测的动态去噪算法来提升 算法在低信噪比下的性能。仿真结果表明，从MSE(Mean Square Error, MSE)和 BER(Bit Error Rate, BER)这两个指标来看，此算法在较宽信噪比范围和几种低速 信道下与已有的DFT信道估计算法相比都有更好的性能。
4.2 LTE下行链路系统模型
3GPP LTE 采用 OFDM (orthogonal Frequency Division Multiplexing, OFDM) 作为下行链路传输技术妁，OFDM将高速数据流并行放置在相互交叠但正交的子 载波上传输。LTE下行接收端通过导频信号(Pilots)来进行信道估计获得信道 状态信息(Channel State Information , CSDo为了在信道估计性能和发送导频信 号的开销之间取得平衡，LTE下行链路的导频信号是梳状的，即在时域上和频域 上都不连续，如下图所示。另外，在LTE通信系统中为了避免其他通信系统的 干扰加入了虚子载波，虚子载波位于实际使用的子载波的两端，虚子载波上既不 传输数据也不传输导频信号。
考虑一个OFDM系统，总共占用N个子载波，其中Me个为实际传输数据 或导频符号的子载波，剩下的Me个为虚子载波，即为了防止邻信道干扰和降低 对滤波器的要求而存在的子载波，它们之间的关系是：
(4-1) 子载波的下标为〃，〃 = O,1,...,N-1,其中"=0代表基带中的直流分量，即频带 中的中心频点，虚子载波位于频带的两端，图4-1是一种等效的表示方法。
假设相邻梳状导频信号之间间隔了 m-1个子载波，卬称之为导频间隔，则 Nac个子载波中共有Np ac = NAC/ m个实际导频符号，Nvc个虚子载波中共有 NP vc =Nvclm个空导频符号。
OFDM发送端通过N点的IDFT将排列好的数据符号、导频符号和空符号映 射到N个子载波上：
x(”) = IDFT{X(k)}," = 0,1,2,…,N—1	(4-2)
另外，发送端将x{n)的最后Ng个点作为循环前缀(Cyclic Prefix, CP)添加到x(k) 的前面以避免符号间干扰。
OFDM符号经过多径衰落信道后，在接收端去掉CP后的接收信号可以表示 为：
/.-I
=	，/)十 ”(〃)，〃 =。丄2,...,TV-1	(4-3 )
1=0
其中％是第/径的信道增益，乌为第/径的信道时延，信道总径数为/八w(〃)是 咼斯白噪声。
从频域上看，式4-3可以写成m
Y(k) = DFT{y(ri)} = H(k)? X(幻 + 印(k)	(4-4 )
其中 H(k)是信道频率响应(Channel Frequency Response, CFR)。
4.3现有的DFT信道估计算法
由于LTE下行链路的导频是梳状的，一般说来，LTE下行链路的一个OFDM 符号上的信道估计可以分为两部分：获得导频位置处的信道估计值；由插值获得 非导频位置处的信道估计值。传统的DFT信道估计算法相对于LS(Least Square, LS)算法具有更好的抗噪声能力，相较于MMSE或LMMSE算法有更低的计算复 杂度，因此在实际的通信系统开发中得到了广泛的应用。
4.3.1 DFT信道估计算法的原理及步骤
传统的DFT算法先用LS算法得到的实际导频位置处的CFR,通过1DFT变 换得到相应的信道冲击响应(Channel Impulse Response, CIR),根据多径信道的 最大时延等信息对CIR进行去噪。依据时域补零相当于频域插值的原理，在去 噪后的CIR的适当位置补零，得到所有实际子载波处的CIR,最后通过DFT变 换得到所有实际子载波处CFR,即最终的信道估计值卩21。
在具体模型中的步骤如下。不失一般性，假设模型中的导频符号位于导频间 隔m的整数倍处。

step 1:利用LS得到实际导频位置处的CFR：
倉P-AC传）=器器= °丄…，Np_acT	（4-5）
其中匕c（湖0和X“（湖I）分别表示接收和发送的实际子载波处的频域信 号。
step2：通过IDFT变换得到实际导频位置处的CIR:
“p	=lDFT{flp _Ac（k）） = 0丄...,Np _ac ~~1	（4-6）
step 3:对实际导频位置处的CIR去噪：
hp（”）= ［砧c（"），* = O，l，..，NcpT
- \p,n = Ncp,Ncp+\,...,Np_AC-\	（4_7）
step 4：对hp /cS）进行补零，并变换到频域得到所有实际子载波的CFR：
Zero padding
Hp_/c（n） n hAC{n）,n = Q,\,...,NAC-\
"ac （*） = DFT 枷ac （"）}," = O,l,...,^AC-l	（ 4_8）
4.3.2传统DFT算法中的边界效应
传统DFT信道估计算法的一个缺陷是由于边界效应导致的MSE地板（MSE Floor）现象。边界效应是指信道估计的结果，即CFR,在频带的边缘与理想的 信道估计值相比有较大偏差。
边界效应的产生与算法中的去噪有关。由于在虚子载波上缺少导频信号，因 此CFR在实际子载波与虚子载波的交界处有不连续点。根据吉布斯效应，若只 用有限项的傅里叶级数表示一个分段连续的可微函数，所表示出来的函数与原函 数相比在不连续点附近会有较大的差距。若将时域与频域调换后来观察DFT算 法会发现相似的情况，即DFT算法第3步的时域抹零去噪以及第4步的补零操 作会去掉一些“项"，使得所表示出来的频域函数与理想的频域函数相比在不连 续点附近有很大的失真，这个失真就是边界效应卩％图4-2中画出了实际子载波 边缘的部分CFR幅度值，可以看到DFT算法的信道估计值与理想信道估计值相 比在信道边缘偏差较大，这将会造成较高的MSEo信噪比越高，边界效应的带 来的MSE增加的影响越大，从而造成了较高信噪比下，DFT信道估计算法的 MSE随着信噪比的升高下降到一定水平后就不再下降了，即出现了 MSE地板现 象。

4.3.3已有的VCFR算法调研
对抗传统DFT信道估计算法中MSE地板现象的方法己被广泛地研究。文献 ［14］-［17］中在接收端添加VCFR以构造在虚子载波上缺失的导频，就是一种有效 的减弱边界效应的方法，但这些文献中所描述的算法仍都有被提升的空间。
文献［14］中的算法具有较低的时间复杂度，但它所添加的VCFR在频域上不 够光滑，这加剧了时域上CIR的能量泄露，导致信道主要径的能量不集中，影 响最终信道估计的性能。文献［15］的主要贡献是讨论了窗函数对VCFR添加算法 性能的影响，文献［17］仿真了多种VCFR构造方法的性能，但文献［14〕［15］［17］ 都缺少对去噪算法的关注，而去噪算法是基于DFT的信道估计算法不可缺少的 一部分，对最终性能有很大影响。文献［16］仿真了一种基于迭代的去噪方法，但 此算法的时间复杂度偏高，在实际系统中应用时无法保障实时性。
与已有的算法相比，本章所提出的算法使用一种基于能量检测的高效动态去 噪算法来提升算法在低信噪比场景下的性能。另外，算法还提供了一种优化的 VCFR添加方法，包括在不同带宽下添加的VCFR数目、VCFR构造公式以及在 添加VCFR之后所使用的窗函数。

4.4基于滑动窗动态去噪的VCFR信道估计
4.4.1算法原理说明
所提出的基于滑动窗动态去噪的改进的VCFR算法与传统的DFT算法相比 主要有两大优势m 1)通过优化地添加VCFR有效地抑制边界效应；2)通过基 于能量检测的动态去噪算法来提升低信噪比下的性能。本小节阐述这两个方面的 相关原理。
首先讨论添加VCFR的方法，包括添加的VCFR的数目以及VCFR构造公式。 由于计算复杂度会随着所添加的VCFR数目的增加而增加，因此在保证性能的 前提下所添加的VCFR数目应尽可能少。文献［15］仿真证明了只要边界效应被有 效地抑制了，增加VCFR数目几乎不会再带来性能提升。因此，尽管准确的虚 导频数目应该是m，算法中实际添加的虚导频数目略您要小于 樵顷。只要确保添加VCFR后在实际子载波边界处的信道连续性，VCFR的形 状对性能的影响并不大，综合考虑算法效率，在所提出的算法中简单地线性添加 VCFRO在添加完VCFR后，为了提升实际子载波与VCFR交界处的平滑性，使 用了一个频域窗，对CFR加窗后也能使CIR的能量更集中、减少能量泄露。窗 函数和去窗函数如下卩叫
W7N(k) = 0.9 + 0.1.cosk,k =0,1,…,Np !ol -m-\	(4-9)
RE_WIN(k)=祈赤小=0,1,...,Np 皿? mT	(4-10)
除了 VCFR添加，时域去噪也是基于DFT的信道估计算法的一个重要组成 部分。图4；展示了有200个实际导频信号的OFDM符号的CIR能量图。从图 中可以看出，一个OFDM符号的CIR可以分为三个区域:有效径区域(Taps Area)、 噪声区域(Noise Area)以及CIR尾部(CIR Tail)。信道有效径主要都位于有效 径区域中，并且具有最长时延的那…径不会超过CP的范围，即CIR的前2^个 点。由于时域采样的栅格效应导致有效径能量泄露到CIR尾部里，这部分的信 道能量同样不可忽略。去噪算法首先需要定义有效径区域和CIR尾部的长度， CIR中不属于这两个区域的点即为噪声点，从这些噪声点可以估计出噪声功率门 限。利用这一噪声功率门限可以区别出有效径区域以及CIR尾部中残留的噪声 点，将所有噪声点抹零即完成了时域去噪。传统的去噪方法通常固定有效径区域 的长度为CP长度，但在LTE下行链路中，由于导频信号的梳状的，一个OFDM 符号中实际的导频数目不会比CP长度多很多，这样带来的问题是用于噪声估计 的噪声点的数目过少，噪声功率门限估计不准确。事实上，在很多实际信道中实际有效径区域长度要小于CP长度。因此，所提出的算法与传统去噪方法不同的 是釆用了动态的有效径区域长度以加强噪声估计的准确性。另外，由于信道多径 时延通常不是采样间隔的整数倍，一径的能量会在时域上泄露到此径周围的若干 个采样点上，图4-3也展示了这一现象，因此，在所提出的算法中通过一个特定 长度的搜索窗来寻找CIR中具有最大时延的径的位置，将此径之前的区域作为 有效径区域。



4.4.2算法具体步骤
所提出算法的具体步骤如下：
stepl:利用LS算法得到实际导频位置处的CFR房后，线性填充个虚 导频处CFR：

此时所有导频符号处的CFR为:

HP = {Hp ac (O),. . .，时"冬中。火(0)，.. ?，
倉p_vc(Np_vc _ 1)，育p/c ~2?4C * 1],招尸_nc ("p_sc 一 1)}	(412)
step2:使用公式4-9中的窗函数对片「加窗：
p(kyWIN(mlc),k = 0,1,...,Np_tot -1	(4-13)
step3:寻找CIR*具有最大时延的径的位置从而决定着效径区域的长度。将 育p项珈变换到时域的 /，通过式4-14进行径搜索以找到最大时延径。式4-14 中的4(s)是当前搜索窗中的平均功率与当前噪声功率的比值，通过故s)与门限值 0进行比较来判断在s处是否有径的存在，乃在下一节的仿真中根据经验法则被 设置为2.55卩8】。搜索窗的长度为M个采样点，在下一节的仿真中M被设置为 10o s的初始值是残-15然后逐步减少到M,即在CP长度内从后往前搜索最大 时延径。记录满足条件k(s)>Th的第一个位置为S。如果s已经减小到M而最 大时延径还未被找到，则使用式4-15进行判断。
￡丄丄謝)/M
I	丿
￡囂严宀防顼小KNpyN'-s)
\ /
￡\1爲_或)is
I	丿
￡囂艾宀|砧的|「(Np w-Ng.D
\ 丿
其中也项是CIR尾部的长度。 此时有效径区域和噪声区域为:
TapArea = {"|0<n<S or Np tot — Ng /4<?<Np tot — 1)
NoiseArea = {w|1S' + l<n<Np tot —Ng /4—1)
step4：用NoiseArea中的最大噪声功率对TapArea进行去噪，同时将NoiseArea 中的点抹零：
40

-	2
PgeMax =成黑賢冲(")
奴心(〃)二
\	八	2
hp 而(〃)，〃 & TapArea and hP yvin (n) —PfioiseMax
-	2
■ G,n&TapArea and hp win{n) <PnoiseMax
0,w e Noise Area	(4-17)
step5：通过对加添零来获得此OFDM符号完整的CIR。添加的零的个数为: NeHM tnt	(4-18)
补零后的CIR是：
h\、、m =\hp	wm 一~2~~
\ /
hp	+1 ' "'hp m("sT)}	(4-19)
step6： 去窗：
H(A) = Hg{k)?RE_WIN(k),k = 0丄."m-1 其中H”,“是九，.的频域形式，RE_W!N(k)如式4-10所示。
step7：从H中对应位置取出实际子载波处的CFR：
N \
HiC={H(0),...,H 寸-1 ,
V	丿
反何尸写］，…，硏M皿刘_1)} \ 丿
4.4.3算法仿真结果
本节对LS算法、DFT算法、基于DFT的VCFR算法进行了仿真，同时对所 提出算法的算法复杂度进行了分析。本节的仿真使用表4-1中的参数。
参数名	参数值
带宽	20MHz
子载波数	2048
CP长度	160采样点(每时隙的第一个OFDM符号)
144采样点(其他OFDM符号)
实际子载波数	1200


导频间隔	6个子载波
添加的虚导频数	100
调制方式	QPSK
是否有符号间差值	否
一个时隙中的OFDM符 号数	7（其中只有第0个和第4个符号上传输导频 信号）
仿真信道类型	EPA5Hz EVA70Hz ETU5Hz[19]
表4-1信道估计算法仿真参数表
仿真中涉及到两种去噪算法：1）4.4.2小节提出的动态去噪算法，记为“denoise 1”； 2）传统的去噪算法，即固定有效径区域长度为CP长度，使用所估计出的 噪声平均功率的两倍作为去噪门限，这种去噪方法记为“denoise2”。仿真中的 传统DFT信道估计算法使用“denoise 2”来去噪，添加VCFR的信道估计算法 仿真分别使用了这两种去噪算法，以对比去噪算法的性能。
图4-4至图4-6给出了不同信道下不同信道估计算法的MSE性能。



图4-5 EVA.70HZ中LS、DFT、VCFR信道估计算法的MSE性能图


图4-6 ETU5Hz中LS、DFT、VCFR信道估计算法的MSE性能图
从图4-4至图4-6可以看出，与LS信道估计相比，DFT信道估计由于加入 了去噪步骤因此在低信噪比时有更好的MSE性能。但这一性能增益随着SNR的 增加而逐渐减小，并且由于DFT算法中的边界效应在高信噪比时出现了 MSE性 能地板现象，而添加了 VCFR的信道估计算法不会出现性能地板现象，说明边 界效应被有效地抑制了。下面分析比较VCFR算法中两种去噪方法的MSE性能。 在所仿真的3种信道中，4.4节提出的动态去噪算法(denoise 1)都表现出了比 固定有效径区域长度为CP长度的去噪算法(denoise 2)更好的MSE性能。具体 来说，若将VCFR信道估计算法的目标MSE为IO%在EPA5Hz信道中denoise 1相对于denoise 2的MSE性能增益为5.5dB,在EVA70Hz信道中为3dB,在
ETU5HZ信道中为2.5dB。
图4-7到图4-9展示了不同信道下不同信道估计算法的raw BER性能。
EPA5Hz QPSK raw BER LS DFTVCFR ideal(log)
—曰 一 LS CE
0 DFT CE
Tr— VCFR denoise 1 CE
-—?一 VCFR denoise 2 CE
-—	Ideal CE

图4-7 EPA5Hz中LS、DFT、VCFR信道估计算法的rawBER性能图
EVA70Hz QPSK raw BER LS DFTVCFR ideal(log)

SNR/dB
图4?8 EVA70Hz中LS、DFT、VCFR信道估计算法的rawBER性能,图

从raw BER的仿真结果可以得出如下结论：在信道EPA5Hz中，所提出的动 态去噪算法(denoise 1)相对于denoise2在信噪比范围3dB到30dB范围内都有 更低的raw BER,并且VCFR添加结合动态去噪算法的性能已经很接近理想信道 估计的raw BER性能；在信道EVAJOHz和ETU5Hz信道中，denoise 1相对于 denoise 2在信噪比范围3dB到23dB范围内有更低的raw BER。由于不进行OFDM 符号间插值，所以在没有导频信号的OFDM符号上的信道估计结果比较不准确， 导致所提出的算法的raw BER性能增益不如MSE性能增益大。
所提出的动态去噪算法的时间复杂度主要来自于使用滑动窗搜索最大时延 径这一步骤，事实上，这一步骤可以通过简单的优化获得更低的时间复杂度。这 一优化主要是利用相邻两个搜索窗的M-1个共同釆样点来减少冗余计算，当前 搜索窗中的能量之和可以通过将这个共同釆样点的能量之和与本搜索窗的 最后一个点的能量相加得到，而这A/-1个共同采样点的能量之和在得到上一个 搜索窗的能量之和时已经计算过了，无需重复计算。优化后，在整个搜索过程中 每个点的能量只计算了一次，总的计算复杂度与求一次所有点的能量之和的复杂 度相同，仍然是线性时间复杂度。因此所提出的算法在提升性能的同时仍然是一 个高效的、实用的算法。
4.5小结
本章所提出的基于DFT的信道估计算法通过添加VCFR来减弱边界效应， 防止出现MSE性能地板现象。所提出的算法使用一种基于能量检测的高效动态 去噪算法来提升信道估计算法在低信噪比下的性能。仿真结果表明：与传统DFT信道估计算法相比，所提出的算法在高信噪比下不会出现MSE性能地板；在目 标MSE为IO』时，所提出的算法能获得2.5至5.5dB的MSE性能增益；所提出 的算法的raw BER性能也比已有的基于DFT的信道估计算法要好。如4.4.3小节 最后所分析的，与使用传统去噪方法的VCFR信道估计算法相比，所提出的算 法只增加了很少的时间复杂度。综上所述，所提出的信道估计算法可以被使用在 实际的LTE下行信道中以提供准确的CSL进一步地能提高相应下行信道的解码 正确性，为D2D用户的干扰感知准确性的提高奠定基础。

第五章 多D2D对资源分配方案
在蜂窝与D2D组成的异构网络中，通常有多个与蜂窝基站（eNB）通信的蜂 窝终端（CUE）和多对相互通信的D2D终端（DUE）,如何在D2D通信对蜂窝 通信（D2C）干扰受限的前提下，在链路质量和干扰环境各异的各对D2D之间 分配资源及协调发送功率以最大化D2D总吞吐是本章所关注的问题。
5.1场景描述及分析
多蜂窝终端与多D2D对的通信场景示意图如图5-1所示：


图5-1多蜂窝终端与多D2D对的通信场景示意图
D2D对之间的资源复用方式对于如何分配干扰余量有根本性的影响，因此首 先分析上图中各D2D对之间的资源复用方式。由于D2D复用蜂窝的上行资源, 4对D2D之间的通信都会对基站接收端造成干扰，其中D2D1至D2D4能通过 D2D同步信道互相发现彼此，称D2D1至D2D4位于同一干扰范围内，同理， D2D5至D2D8位于另一干扰范围内。根据第二章提出的D2D接入方案，在同一 干扰范围内的D2D对之间通过RTS-CTS机制相互竞争时频资源，在一个子帧只 有一对D2D独占此子帧的资源，即同一干扰范围内的D2D对的资源复用方式是 时分复用；在不同干扰范围内的D2D对由于空间上的隔离互相不知道对方的存 在，可以有多个D2D申请到同一个子帧的资源，即位于不同干扰范围的D2D对的资源复用方式是空分复用。
干扰分析:eNB——蜂窝上行通信的接收端一一会受到D2D通信的发送端的 干扰（D2C）。D2D通信的接收端会受到CUE——蜂窝上行通信的发送端——的 干扰。
当D2D对处于同一干扰范围时，DUE在第2无线帧发送对第”无线帧的 资源独占请求RTS,而基站提前4个子帧（即最多提前一个无线帧）才下发 PDCCH以指示蜂窝用户占用的资源，蜂窝用户的资源占用信息是进行D2D资源 分配的重要依据，已经独占资源之后再作干扰余量分配在时分复用模型中是没有 意义的。因此，本章后面的小节只讨论处于不同干扰范围内的D2D的干扰余量 分配方式。D2D资源分配的大致流程如图5-2所示。

图5-2 D2D资源分配的大致流程图
D2D对之间具有良好的空间隔离度时会釆用空分复用的资源复用方式，本章 的主要工作是提出了对空分复用方式下的D2D对进行资源分配的优化算法。与 已有的D2D资源分配文献中的算法相比，本文中所提出的算法考虑到了实际 D2D-LTE系统中资源连续性分配和功率一致性的约束，所构建的模型更接近实 际应用中的场景，在此模型下所提出的算法也更具有实用性。空分复用的场景如 图5-3所示。
如图所示,D2D1与D2D2位于干扰范围A,D2D3和D2D4位于干扰范围B, 假设这两对DUE将在同一个子帧上进行通信，在此子帧上，CUE】及CUE2也 都将进行上行通信。
实际LTE系统的上行传输方式为单载波连续频分复用（Single Carrier Localized Frequency Division Multiple Access , SC-LFDMA） [22h 在这种传输方 式中CUE的资源及功率分配需要满足以下几个要求：
1）	独占性：在同一个小区中，一个子帧中的一个RB只能被一个CUE占用，即 不同CUE是频分复用的；
2）	相邻性：在一个子帧中，每个CUE只占用一段连续的RB；
3）	功率一致性：在一个子帧中，每个CUE在其占用的每个RB上具有相同的发 送功率。
为了使D2D通信对蜂窝通信造成的干扰是同质化的，在第二章提岀的 LTE-D2D异构网络方案中D2D通信使用与蜂窝上行通信相同的物理层技术， 因此DUE的功率及资源分配也需满足上述要求中的相邻性和功率一致性。
这些对资源分配和功率分配的要求将会成为下一节提出的数学模型中的约束条 件，影响最终算法的提出和模型求解。上述约束均结合了实际LTE系统，将这些约束考虑进模型中将使得所提出的算法比已有的D2D资源分配算法更具有可 实现性。
5.2数学模型
记蜂窝上行链路集合为Kc= {1,2, .D2D链路集合为Kd = [Kc+1,Kc + Z ...,Kc+Kd},记各CUE的占用哪些RB及其发送功率是已知的， 作为模型的输入。在确定了 CUE的占用情况后，整个频带被分成N个连续的RB 段,每个连续RB段的频谱宽度为Hz,这些连续RB段有些被CUE 占用，称为复用资源段，有些是空闲的，这些空闲的RB块就是“频谱空洞”， 也称为正交资源段。图5-4展示出从某个DUE处测量到的一个子帧的频域资源 占用情况，此子帧中有3个CUE各占用了一段频域资源，分别用一个实心柱形 表示，柱的高度代表CUE在此DUE处C2D干扰的大小，整个频域资源被分为 了 7段,其中第2段、第4段和第6段都被CUE占用，其余段暂时空闲。用”小弥 用于表示第"块连续RB段被第斤条链路占用的情况，且成】=1,心 表示第〃块 连续RB段被第A:条链路占用，否则巨”]同一个RB只能被一个CUE 占用，但可以同时被多个D2D用户占用。
CUE2

RB段4	RB段6
图5-4 DUE资源分段示意图
根据5.1节中对于DUE的约束，在一个子帧中各DUE在自己占用的RB上 使用同一功率发送，所以记第k条D2D链路单位带宽上的发送功率为pk<P^， 其中kf,暧宓为due单位带宽上的最大发送功率。记所有链路的发送功率 集合为「={日,...按时}。记垢为第《条链路的发送端到第/条链路接收端之间的信 道增益，久为第左条链路发送端到基站接收端的信道增益，其中k」WK。
1）未引入D2D通信时蜂窝用户的吞吐
实际LTE系统中上行发送功率由功率静态工作点、路损补偿项、码率补偿项、 闭环TPC命令字补偿项共同决定，本模型对实际LTE系统上行功控策略作适当 简化，只采用功率静态工作点加完全路损补偿的方法决定每个CUE的发送功率, 如式5-1所示：
3	（5-1）
其中R是蜂窝用户的功率静态工作点，是蜂窝用户的发送功率，keg 由 于各CUE的发送功率静态工作点相同，且进行了完全路损补偿，因此各CUE在 基站接收端的接收功率相同，为化)。
在蜂窝网络中引入D2D的一个前提是D2D通信对于原有的蜂窝通信的干扰 必须在一个可控的范围内，具体体现为加入D2D通信后各蜂窝用户通信速率下 降百分比要小于某个设定的值a。在未加入D2D通信时蜂窝第Er条蜂窝上 行链路在第neN块连续RB段上的SNR为：
「笋=	(5-2)
其中寸】表示噪声功率。
未加入D2D通信时的蜂窝单位带宽上的速率是：
，户= log(l +	e R	( 5-3)
2) D2D复用功率及吞吐
加入D2D通信后，第Ek(.条蜂窝上行链路在第neN块连续RB段上的 SINR 为：
您由	34)
I，
其中表示噪声功率，Z冲"户代表了 D2C干扰。
加入D2D通信后蜂窝'簞位带宽上的最小速率是：
《/，，，［〃］=(1 _ ay^f［"\k^Kc,Q<a<\	(5-5)
根据啪& 以及香农容量公式可以计算出加入D2D通信后各蜂窝用户允许的最 小SINR为叶侦,D2C干扰控制要求：
啤3/)2以枷］,独次］=1	(5-6)
对蜂窝用户最低速率的限制等同于对复用资源段上的D2C累积干扰功率的 限制，在实际的蜂窝通信系统中，由于基站接收端的存在非线性以及截止特性, 因此即使在正交资源段上对D2C累积干扰功率也有限制，在本模型中指定在正 交资源段上的限制是：正交资源上DUE的在基站接收端的干扰功率不能高于同 一子帧中CUE在基站接收端的平均功率。此约束可以描述为：
E財"k
￡ p［^pkhk V		,V% eNORTH (5-7)
5	\Kc\
其中North为正交资源段的下标集合，即= ｛〃 |c j｝。

Ng%为正交资源段的下标集合，即N皿隆=(n|次】=1,盗e片｝以上约束不等 式的左边表示在第〃块资源段上基站接收到的DUE累积功率，不等式的右边表 示第〃块资源段上基站接收到的CUE平均功率。
第腥r条D2D链路在第neN块连续RB段上的SINR为：
f =寸］+ z黯化￡恥术	(5-8)
f	I臨
其中Z	表示C2D干扰值，￡ W?"尸表示其他D2D链路对此D2D
链路辭扰。	渗
可以得到第旌勺条D2D链路在第昨N块连续RB段上的吞吐率为： ^(AP)=41og2(l+lf(Ap))	(5-9)
单位是bit/s o
第上e弓条D2D链路的吞吐速率为：4(W)=Z*&Q)	(5-10)
neN
即一条D2D链路可能同时占用多个连续的RB段，这条D2D链路的速率是其所 占用的所有RB块上的速率之和。
由于DUE只能占用连续的RB,所以若记q=｛〃|*］=l,〃eN｝,作勺为第 传勺条D2D链路所占用的连续RB段的下标集合，则要求O,中的元素是［1,N］范 围内的连续正整数。满足上述条件的资源段称为DUE的可选资源段。例如在图 5-4中DUE1复用了 CUE1的资源，同时还占用了 CUE1资源旁边的两段空闲资 源，即连续占用了第1、2、3段资源，Q =｛1,2,3｝。
3)模型综述
综上所述，模型的目标是最大化所有D2D链路的总速率，艮卩：
max V r (p,/?)	(5-11)
p，p 念d
约束是：
52
C1:「丫 3/) 2「笋叫栃 G	= 1
C2: pk <P^yk&KD
C3: ￡ p^]<\y\<n<N
ke-c
C4: p^} g(0,1},VA： e k
C5:Ok中的元素是连续的正整数，VkeKD
E E衣孚也
C6 .咨谴。七血 <		,V"°cNorth	(5_[2)
约束Cl限制了 D2D对于每个蜂窝用户上行链路的干扰值。C2限制了每条 D2D链路的最大发送功率。C3限制了同 '个RB最多只能被一个蜂窝用户占用。 C4表示域勿是…个取值只能为0或1的指示变量。C5限制了 D2D只能占用连 续的频域资源。C6限制了正交资源段上的累积干,扰功率值。
在给定了 CUE的资源占用及C2D干扰值的前提下，DUE资源分配问题可以 看成两个子问题：每个DUE使用哪些RB段，以及每个DUE单位带宽发送功率 的大小。
观察所提出的模型，可以得到DUE的资源分配有如下特点m若每个资源段 只允许被一个DUE所使用，则确定了每块资源归哪个DUE使用后，根据约束 Cl、C2和C6可以随之确定DUE的发送功率；若允许多个DUE复用同一段资 源段，如何将此资源段E的干扰总量分配给这些DUE是整个算法中最复杂的部 分。采用由简入繁的思路，本章之后的部分先讨论在…个资源段只能被一个DUE 复用的前提下的资源分配算法，再讨论…个资源段可被多个DUE复用的资源分 配算法。
5.3单独复用的资源分配算法描述
本小节在5.2小节给出的模型的基础上增加以下约束：
C7:	^<\y\<n<N	(5-13)
约束C7限制了使用同一资源段的DUE的个数只能为0或1。在约束C7下， DUE资源分配问题的关键是某资源段是否被DUE使用，以及如果使用给哪一个 DUE使用。
5.3.1基于0-1规划的理想算法
由于C7约束的存在，以上D2D资源分配问题可以被看作0-1规划问题。根 据文献[21]提出的一种将连续资源分配问题建模为0-1规划问题的方法，将本文中单独复用的资源分配算法建模为0-1规划问题的形式为:
max crx
Bx = l”
e(0,l} X/j
其中X是解向量，C是目标函数的系数向量，c'x是目标函数，N是资源段数 目，"是DUE数目，矩阵A、巩共同构成了不等式约束，其中侦=[1,…,1「， 矩阵B、共同构成了等式约束，其中If o
下面说明在D2D资源分配问题中上述各矩阵的内容和含义。当确定了整个 频域有N块资源段后，由于约束C5要求DUE所占资源段必须是连续的，可以 通过枚举的方法确定所有可能的DUE资源占用方案，若频域上有N段资源段，
N	1	1
则DUE的资源占用方案共有C = ￡(7V-(/-1)) + 1 =-#2+-^+1种，且这些方
(=1	2	2
案对所有 DUE 都适用。.解向量x = [xj,x2,...,xM]r ,其中 xm - \xmA,xm2,...,xmCY
KxmJ={0,l),l<j<C,解向量x表示每个DUE分别使用哪种资 源占用方案。记DUEm的所有可能方案存储在矩阵Am中，且|Ara| = ^xC, Am 的每一列用相应资源段的占用情况为0或1表示一种可能的资源占用方案。例如 若共有N = 4段资源段，则C = ll, Am是：
0 1
0 1
0 0
1 0
DUE的Am都相同。由于约束C7要求每段资源上最多只能有一个DUE占用, 则约束矩阵A = [A13A2,...,Am]o另一个约束是每个DUE必须选择一种资源占用 方式，因此约束矩阵B为：
(5-16)
目标函数的系数向量c = ［cu,c12,...,clc.,c21,...,cA,/c］,|c|=A<?xl ,其中的每个元 素dj代表DUE zw选择资源占用方案丿时能达到的速率。本文中的0-1模型与 参考文献［21］中的0-1模型有两点不同：
1)文献［21］使用了约束M
Ax =	(5-17)
即对于每个资源段要求有且只有一个用户占用，而本文中使用的是：
Ax < 1^	(5-18)
即对于每个资源段要求至多有…个DUE占用，也可以不被任何DUE占 用。这是考虑到有的资源段上可能「扰余量很少，若复用这种资源段则DUE 的复用功率会被压得很低，所以在这种情况下DUE可以放弃使用这段资源。
2)本文的模型中的目标函数系数矩阵计算c与文献［21〕中的不同。由于在本文 的模型中DUE在其所占用的各资源段上只能以同一功率发送，因此由于同
-个DUE在不同资源占用方案中的复用功率不同，同一段资源段在不同的 资源占用方案中给同…个DUE带来的速率增益也可能不同，需要对每个 DUE单独计算每种资源占用方案下的速率。而文献［21］中只需计算每个用户 在每段资源段上的速率，在各种资源占用方案中将每段的速率简单相加即可。
至此，0-1规划问题中的各个矩阵都已经赋予了具体含义，关于此问题的求 解已经有很多种成熟的解法，就不在本文中讨论了。在之后的仿真中使用了 Matlab里的bintprog函数求解这个问题。此求解方法求出的是理论上的最大速率， 但求解复杂度太高，bintprog函数采用的分支限界法具有指数的时间复杂度，这 在实时系统的调度中是难以实现的。
5.3.2时间复杂度低的贪心算法
为了提高资源调度的实时性，下面提出一种贪心算法：先根据在复用资源段 以及正交资源段上的干扰功率约束及DUE到基站的路损计算出各DUE在各资 源段上的发送功率，根据式5-9计算出各对D2D在各资源段上的D2D速率，每 次循环将相应资源分配给当前具有最大速率的DUE,这个DUE以及其占用的资 源段不再参与之后的循环。循环终止条件是所有DUE都被分配了资源，或者所 有资源段都已经被DUE占用。
算法的伪代码如下所示：
Greedy-exclusive(D2DChunkRate,M,N)
1"0
2b — N
3totalRate 0
4C<-0
5D<-0
6white M and b.Q
7A update rate matrix for un-configed D2Ds accoiding to exclusive constriants
8do ^p^eAvailRACottf(C, D, D2IXIhunkRate)
9C<-0
10A find D2D with max chunk rate among all un-configed D2Ds
11[C, d, maxRat^ . ^nd!A/ax]?afe(D2DChunkRate)
12A update totalRate and configed D2D set D
13totalRaie. <— toted Rate + maxRate
14D<-D|Jd
15E> update configed D2D number s and unoccupied chunk number b
16s <- s 4-1
17b <— 6 — length [C]
算法的输入是存储了各DUE在每种可能的资源占用方案下的吞吐值的数组 D2DChunkRate、总的DUE数目M以及资源段数目N。代码1?5行进行了变量 定义及初始化：s表示当前已经完成资源分配的DUE数目，初始时没有DUE被 分配了资源，初始化为0; b表示当前未被DUE占用的资源段数目，初始时所有 资源段都未被占用，初始化为N； totalRate表示总D2D速率，初始化为0；集合 C表示在每次循环中分配给DUE的资源段编号，初始化为空；集合D表示已经 分配了资源的DUE集合，初始化为空。代码6?17行是循环主体，调用了两个函 数：updateAvailRACortf和JindMaxRate。实以o化/IvazTZMCW的功能是根据上一次 循环中更新的集合C以及集合D来将D2DChunkRate数组中还未被分配资源的 DUE的相应分配方案的速率置为零，表示后续循环中这些资源段不再参与资源 分配，以满足单独复用约束C7； findMaxRate的功能是找到所有未被分配资源的 DUE的所有可用资源方案中具有的最大速率，输出这个DUE、其占用的资源段 以及最大速率。每次循环首先调用絕出宓协切me。时?进行可用资源段的更新， 再调用顶*“及渔找到当前最优的选择，最后更新相应的集合和变量以保证循 环不变量的正确性。算法的输出是totalRate。
假设有N段资源段，有M个DUE需要进行资源分配，计算D2DChunkRate 数组的复杂度为O0GV2)；由于每次迭代至少能确定一个DUE的资源分配，因此 迭代总次数小于等于M,每次迭代中updateAvailRAConf和findMaxRate的复杂 度都为。"2)。因此算法的最差时间复杂度为0(MN2),相比于前述0-1规划理 想算法在时间性能上有较大提升。
此算法在每次迭代时选择局部最优解，但无法保证最终得到全局最优解。另 外，当某DUE占用了多段连续的资源段时，每个资源段上可能有不同的干扰余 量，由于一个子帧中一个DUE只能以同一功率发送，所以无法保证此DUE用 尽了其占用的所有资源段上的干扰余量。由于约束C7,未被用尽干扰余量也无 法再被其他DUE使用，这样就造成了干扰余量的“浪费”。
5.4联合复用的资源分配算法描述
如5.3小节所分析的，在约束C7下提出的算法虽然有较好的时间性能，但 是会有CUE的干扰余量没有被用尽的现象。为了更好地利用CUE的干扰余量来 获得更高的D2D速率，本小节尝试让多个DUE复用同?块资源，但仍需满足 5.2小节模型中的各种约朿。
当多个DUE复用同-资源段时分配干扰功率的难点夜于DUE复用功率的变 化会导致部分资源占用方案能达到的D2D速率变化，并且…种资源占用方案可 能占用连续的多段资源，每段资源上的不同的干扰功率分配会对方案速率带来多 重影响，在这种情况下提出最优算法是一个很困难的问题。因此，本小节提出的 算法以5.3小节所述的单独复用的资源分配算法为基础，尝试在每次单独复用的 资源分配完成后再对各资源段上剩余的干扰余量进行进一步分配以提高D2D总 吞吐。算法中每次循环一开始先根据己完成资源分配的DUE的资源占用及发送 功率更新各资源段上的干扰功率余量值，并据此更新未完成资源分配的DUE在 各种资源占用方案下的速率，基于更新了的D2D速率，用单独复用资源分配算 法对未完成资源分配的DUE进行资源分配，更新已完成资源分配的DUE集合， 进行下- -次循环。循环终止条件是所有DUE都已完成资源分配或所有资源段上 的干扰余量都为零。这样在每次循环中是在单独复用的约束下进行的资源分配， 而只在各次循环之间存在联合复用的情况，联合复用时干扰功率分配的规则是 “先到先得”，即较先被确定资源分配情况的DUE有更大的优先权使用干扰余量, 这样做的理由是较先被确定的DUE能达到较大的速率，把干扰余量分配给它能 得到更大的增益。
算法的伪代码如下：
Greedy-unoin(D2DChunkRate,M,N)
1s <-0
2tot al Rate 0
3C<-0
4D 0
5d —0
6while s M
7> recalculate remain interference power for eveiy CUE
8￡> according to D2D resource allocation in last iteration
9do RF ? updateReinamJnterf(d. C)
1()	> recalculate rate for every un-conliged D2D of
11> every configuration under new RF
12updateD2DRate(RF. D, D2DChunkRale)
13CD
14d 4- 0
15d> do D2D resource	allocation	under EXCLUSIVE constraint
16lC,d, max Rate] -i—	exclusiveD2DRA (D2 DC h u n k Ra I e.	M	—	s. N)
17> update total Rate and conligcd D2D set I)
18total Rate ― total	Rate +	marRate
19D	—D|Jd
2()	[>	update conliged	D2D number	s	and unoccupied chunk number b
21	s	s + length[<\]
算法的输入与5.3小节所述的单独复用贪心算法的输入相同。代码1?5行进 行了变量定义及初始化：s表示当前已经完成资源分配的DUE数目，初始时没 有DUE被分配了资源，初始化为0； totalRate表示总D2D速率，初始化为0； 集合C表示在每次循环中分配给DUE的资源段编号，初始化为空；集合D表示 已经分配了资源的DUE集合，初始化为空；集合d表示每次循环中被分配了资 源的DUE集合。代码6~21行是循环主体，调用了三个函数:updateRemainlnterfs updateD2DRate 以及 exclusiveD2DRAo updateRemainlnterf 函数根据上次循环中 所确定的DUE的资源占用情况更新各资源段的干扰功率余量值；updateD2DRate 根据已更新的干扰余量值更新尚未进行资源分配的DUE的速率； exclusiveD2DRA即5.3小节所述的单独复用算法，它在单独复用的约束下尝试 让未分配资源的DUE在剩余干扰余量上获得最大吞吐。每次循环先调用 updateRemainlnterf更新资源段上的干扰余量，接着调用updateD2DRate更新DUE 能达到的速率，再调用exclusiveD2DRA来完成剩余干扰余量上的DUE资源分 配。第18?21行更新各集合及变量的值。
假设有N段资源段，有M个DUE需要进行资源分配，计算D2DChunkRate 数组的复杂度为。（枷2）；由于每次迭代至少能确定一个DUE的资源分配，因此迭代总次数小于等于M,每次迭代中exclusiveD2DRA的复杂度最高，最差情况 下为。"2）。因此算法的最差时间复杂度为O{M2N2）,相比于5.3小节中单独 复用的资源分配算法复杂度有所提高，但相比于遍历的算法有较低的复杂度。
本算法能协调各DUE的发送功率，且能获得局部最优的D2D吞吐值；在一 个DUE复用了多段资源时，若出现本DUE未完全使用某些资源段上的干扰余 量的情况，这些剩余的干扰值能够在后面的循环中被其他DUE所使用，从而提 高了整体D2D吞吐。
5.5公平性考虑
5.2小节的模型中以每个子帧的D2D总吞吐值作为目标函数，如果在一段时 间内DUE和CUE的位置变动比较小，就可能出现某些DUE ?直受到强C2D干 扰或到基站路损较小，从而导致这些DUE分配到的资源-直很少，速率维持在 -个很低的水平，DUE之间出现了比较严重的速率不公平问题。
为了解决这个问题，可以使用基于比例公平计算DUE吞吐的方法，即将模 型的目标函数改为最大化式5-19中的这个值伝％
￡,”5〃	（5-19）
其中》是第秫个DUE在当前子帧能达到的速率，是第秫个DUE在前T -1个 子帧实际达到的平均速率，在每个子帧的资源分配结束后按式5-20更新值为 pNew。
*,=加_］）3听	（5-20）
其中T为当前的TTI数目。
将最大化式5-19中的比值作为目标函数之后，资源分配算法用一个相对的 比值取代了一个绝对的值作为判决指标，即不再以DUE在此子帧中能达到的吞 吐值作为判断指标，而是倾向于将更多资源分配给在当前子帧能达到的吞吐比其 历史平均吞吐高的DUE。因此，即使某个DUE无法在单个子帧上获得较高的速 率，但如果其较低，与心的比值较高，算法还是可能将一部分资源分配 给这个DUE；反之，若某个DUE信道条件及干扰环境都比较好，则它的&?比 较高，虽然其&也比较高，但4与夫“,的比值并不高，算法可能会减少分配给此 DUE的资源。所以，本节提出的算法可以增强DUE之间资源分配的公平性。


5.6算法仿真
5.6.1仿真条件及参数
本节的主要仿真参数如表5-1所示：
参数名	数值
基站数及坐标	1 个，(0, 0)
小区半径	400m
CUE数	4
D2D干扰范围数目	6
每个干扰范围中的D2D对数目	1
上行数据信道总RB数	50
CUE发送功率静态工作点	-lOOdBm/RB
CUE允许的最大速率下降百分比(a )	0.3
DUE在每RB上的最大发送功率	-10dBm/RB
蜂窝及D2D链路接收端底噪	-115.45dBm/RB
表5-1仿真参数表
信道使用简单的衰减模型，CUE到蜂窝基站链路的路径损耗模型为：
15.3+37.6*lg(D) dB	(5-21)

D2D链路或DUE与CUE之间的链路的路径损耗模型为：
37+30*lg(D) dB	(5-22)
其中D为收发两端的距离，单位是米(m)。
5.6.2仿真结果及分析
1)固定6个干扰范围位置和半径的仿真
首先，固定6个干扰范围的圆心位置为(100, 0) (-100, 0) (-300, 0) (300,
0) (0, 200) (0, -200),每个干扰范围的半径都为50m,每个子帧在这6个干 扰范围中各随机出一对D2D的位置，每个子帧在整个小区范围内随机出4个CUE 的位置，并在满足资源块独占性和连续性的前提下随机出各C英所占用的RBO 仿真次数为1000个子帧。
图5-5是各干扰范围及某子帧中各用户的位置示意图：



图5.5各干扰范围及某子帧中各用户的位置示意图
分别使用5.3节及5.4节中的算法进行D2D资源分配，以下是仿真结果。
图5-6和表5-2展示了 5.3小节提出的基于单独复用的理想算法和贪心算法的性 能。


图5-6单独复用的理想算法和贪心算法性能比较图
平均D2D总吞吐(bps)	平均D2D吞吐差值(bps)
单独复用理想算法	7.4415e+07	5.6661e+06
单独复用贪心算法	6.8749e+07

表5-2单独复用的理想算法和贪心算法性能比较表
图中画出了前100次仿真中达到的D2D速率，可以看出各次仿真中理想算 法总是比贪心算法得到的D2D速率高，这也从一方面证明了理想算法的正确性。 从具体数值来看，理想算法比贪心算法得到的D2D速率高8%左右，但根据5.3 小节中的复杂度分析，贪心算法的时间性能要明显优于理想算法。
图5-7和表5-3展示了 5.3小节的单独复用和5.4小节的联合复用中贪心算法 的D2D吞吐性能差异。


图5-7单独复用贪心算法与联合复用贪心算法性能比较图
平均D2D总吞吐(bps)	平均D2D吞吐差值(bps)
单独复用贪心算法	7.3719e+07	7.9796e+07
联合复用贪心算法	1.5351e+08

表5-3单独复用贪心算法与联合复用贪心算法性能比较表
图中画出了前100次仿真中达到的D2D速率，可以看岀联合复用的贪心算 法比单独复用约束下的贪心算法的吞吐性能有明显提升，具体来说，D2D总吞 吐速率提高了 108%左右，因此虽然联合复用的时间性能较单独复用的有所增加, 但速率增益更加明显。
为了更清晰地看出所提出算法的干扰避免和控制的效果，抓取了一个子帧的 资源分配结果，如图5-8和表5-4、5-5所示，其中各CUE和D2D对的编号与前 述用户位置示意图中的各编号一一对应。从仿真结果可以看出，最长的连续空闲 RB段的起始位置是1,长度是16,因此联合复用算法中DUE1、DUE2、DUE5、 DUE6选择了这段空闲RB,而综合考虑D2C干扰和C2D干扰，DUE3选择了复 用CUE4的资源从而获得更长的RB段，DUE4选择占用整个频域资源。单独复 用算法将所有频域资源分配给能达到最大D2D吞吐速率的DUE5o
文献［21］中的单独复用理想算法与本文5.3.1小节的不同之处在于前者不满 足同一子帧中一个用户在其所占用的频域资源上使用相同功率发送这一约束，这 一约束的存在导致一个DUE复用多段连续资源段时某些资源段上的干扰余量可 能不会被用完，5.4节的联合复用算法在满足上述约束的前提下尝试将剩下的干 扰余量继续分配给尚未完成资源分配的DUEo下面的仿真在不同的D2D对数目 下比较文献［21］中的单独复用理想算法与5.4节的联合复用算法的吞吐性能，以 考察联合复用算法在多D2D对之间进行干扰余量分配的性能。如下图所示，D2D 干扰范围的数量从6个增加到15个，它们的圆心都分布在一个以基站为圆心、 半径为300米的圆上，且相邻干扰范围的圆心之间的距离固定为120米。在每种 干扰范围数量下，各仿真1000个子帧，每个子帧随机D2D对在其干扰范围内的 位置、CUE的位置及其资源占用情况。

图5-9 D2 D干扰范围数目为6时示意图	图5-10 D2 D干扰范围数目为15时示意图
图5-11是在每种干扰范围数量下文献［21］中的单独复用理想算法与5.4节的 联合复用算法的平均吞吐性能曲线。

从仿真结果来看，由于本文中的联合复用算法满足的相同功率约束，本文中 联合复用算法的吞吐性能普遍低于文献［21］中的单独复用理想算法；另外，本文 中联合复用算法得到的D2D吞吐速率随着D2D对数目的增加而近似线性地增加, 而文献［21］中的单独复用理想算法得到的吞吐性能几乎不变，因此本文中联合复 用算法与文献［21］中的单独复用理想算法之间的吞吐性能差异会随着D2D对数 目的增加而缩小；并且，满足相同功率约束的资源分配算法才是符合协议标准、 更贴近实际LTE系统的算法。
3）改变D2D链路收发两端距离的仿真

为了考察D2D链路收发两端之间的距离对算法性能的影响，仿真了 25米至 200米之间的多种D2D距离，对于每种D2D距离各算法分别仿真1000个子帧， 在这1000个子帧中使用距离一定的、固定位置的D2D,在每个子帧中随机CUE 的位置及其资源占用情况。图5-12是D2D收发两端距离为100米时的D2D位 置示意图。


图5-12 D2D收发两端距离为100米时的D2D位置示意图
图5-13展示了在不同D2D收发端距离下各算法的性能曲线。


66
图5-13三种资源分配算法与D2D收发端距离曲线
从仿真图可以看出，各算法获得的总D2D吞吐值随着D2D收发端距离的增 加而减小，这是由于D2D链路的路损随着D2D收发端距离的增加而增加，在相 同的D2D发送功率下，D2D接收端接收到的功率随着距离的增加而减小，在噪 声和C2D、D2D干扰值不变的前提下，D2D链路接收端的SINR随着距离的增 加而减小，最终导致D2D吞吐速率随着距离的增加而减小。从图中也可以看出， 在所仿真的各种D2D收发端距离下，单独复用的理想算法和贪心算法性能较为 接近，联合复用贪心算法吞吐性能明显由于单独复用算法。
4）改变相邻干扰范围距离的仿真
改变各相邻D2D干扰范围之间的距离以考察D2D链路之间的干扰大小对算 法性能的影响。这部分的仿真中6个干扰范围的圆心都距离基站300m,每个干 扰范围的半径都是50m,使得D2D链路发送端对基站接收端的干扰强度保持不 变。相邻D2D范围圆心之间的距离从120米到300米之间变化，如图5-14和图 5-15所示，在每种D2D范围距离下仿真1000个子帧，每个子帧随机D2D对在 其干扰范围内的位置、CUE的位置及其资源占用情况。


图5-16展示了在不同相邻D2D干扰范围距离下的各算法的性能:

S 5-16三种资源分配算法与相邻干扰范围距离曲线
仿真结果显示：不同的相邻D2D干扰范围距离对联合复用算法的性能产生 了明显的影响，对单独复用算法的性能几乎没有影响，这是因为不同的D2D干 扰范围距离会带来不同的D2D链路之间的干扰，在联合复用模型中，若多个DUE 复用同一段资源段，这些DUE之间的干扰就会影响最终的D2D速率，但在单独 复用的约束下，同一段资源段上最多只有一个DUE占用，因此D2D链路之间的 干扰不会影响D2D速率。另外，D2D链路之间的干扰强度随着D2D干扰范围之 间的距离的增加而减小，因此联合复用算法中D2D速率随着D2D干扰范围之间 的距离的增加而增加。
5）改变干扰范围到基站距离的仿真
为了考察D2D到基站的远近对算法性能的影响，使6个D2D干扰范围的圆 心均匀分布在以基站为圆心的某个圆上，这个圆的半径在150米到350米之间变 化，图5-17和5-18展示了半径为150米及350米时的干扰范围位置示意图。对 每个半径值仿真1000个子帧，每个干扰范围的半径值固定为50米，在每个子帧 中随机D2D对在其干扰范围内的位置、CUE的位置及其资源占用情况。



图5-19三种资源分配算法与干扰范围-基站距离，性能曲线
由于D2D链路发送端到基站接收端的路损会随着它们之间距离的增加而减 小，在相同的D2D发送功率下，D2C干扰强度也随着此距离的增加而减小，对 于同一段CUE资源，D2D的复用功率会随着此距离的增加而增加，因此所仿真 的三种算法的吞吐性能都随着D2D链路发送端到基站接收端距离的增加而增加。 从图中可以发现联合复用算法的吞吐性能随着此距离的增加而提升的幅度比单 独复用算法的大，这是因为同一段资源段可以被多个DUE复用，每个DUE的 吞吐速率都随着它到基站接收端距离的增加而增加，最终总的D2D吞吐速率的 增加是所有这些DUE速率增加之和，所以联合复用吞吐性能提升比单独复用的 更明显。
6）基于比例公平的算法仿真
北京邮电大学工学硕士学位论文
在仿真中加入5.5小节的公平性考虑，即将目标函数改为比例公平的D2D，总 速率。比较了单独复用的约束下在理想算法中加入公平性考虑对速率的影响，为 了让结果对比更明显，增加了仿真时长，共仿真10000个子帧，每次仿真中固定 了 DUE和CUE的位置，只随机CUE的资源占用，所以各D2D链路的信道质量 和对基站的干扰强度是一定的。仿真结果如图5-20至图5-22所示。

（基于比例公平）
表5-6加入公平性考虑前后的吞吐性能比较
图5-20给出了前100次仿真中加入与不加入公平性的吞吐值,可以看出在有 些子帧加入公平性的算法得到的速率明显低于不加入的算法，从表5-6中的具体 吞吐值也反映了这一速率差异，说明算法牺牲了部分D2D速率以获得公平性增 益。图5-21和图5-22对比了是否加入公平性对各D2D对的平均速率的影响， D2D对6是具有最好的信道环境与干扰情况的D2D对，因此达到的速率明显高 于其他D2D对，但考虑公平性时各D2D对之间速率的不均衡情况要好于不考虑 公平性时，从表5-6中各DUE速率方差也可以得出这个结论。从以上仿真结果 可以看岀，相同的资源分配算法，加入了比例公平的D2D总速率较不加的时候 有所降低，但各D2D获得的速率的方差减小了，说明不同D2D获得资源的公平 性有所提高。
5.7小结
本章解决的是当多个DUE复用蜂窝同…个上行子帧资源时D2D的资源分配 问题。本章先描述了 D2D与LTE蜂窝共存网络中，D2D数据传输复用LTE上 行信道时的干扰环境。结合实际LTE系统，分析了 DUE和CUE在资源分配过 程中应满足的基本约束后，建立了资源分配的数学模型。基于此模型，在不允许 多个DUE复用同一块资源的约束下一一即单独复用一一提出了理想算法与贪心 算法，仿真中发现贪心算法较理想算法D2D总吞吐低7%左右，但理想算法的时 间性能远不如贪心算法。在允许多个DUE复用同一块资源一一即联合复用一一 的情况下，提出了一种利用单独复用算法且重新利用各资源段上干扰余量的贪心 算法，仿真中联合复用算法的吞吐性能几乎两倍与单独复用算法中的性能，但时 间复杂度上联合复用算法比单独复用算法稍有提高。另外，考虑到各D2D对通 信公平的问题，提出了将模型中的目标函数改为最大化基于比例公平的D2D速 率，在仿真中可以看到此举有效改善了各D2D对的资源分配公平性问题。

第六章总结与展望
在蜂窝网络中引入D2D通信能够减轻基站负荷，增加网络总吞吐，还填补 了 4G在公共安全方面的空白，近几年来一直是一个研究热点。本文针对蜂窝与 D2D干扰共存中的几项关键技术进行了深入研究，最终提出了相应的优化算法 或完善方案。
本文首先描述了一种可行的LTE-D2D系统的架构，详细梳理了 D2D终端所 需具备的能力：与蜂窝的干扰共存能力（包括干扰感知和干扰控制能力）、D2D 直通通信传输能力。具体地，阐述了 D2D干扰感知的大致流程，总结出其中的 关键点是PDCCH盲解码，下行信道估计作为一个接收基本模块对干扰感知性能 有广泛的影响；阐述了一套可行的D2D控制信道和信令流程，通过实现此流程 中各项功能即可获得直通通信传输能力；简要描述了一种适用于一个无线帧中只 有一对D2D通信的分布式资源分配算法，后文将参考这种算法，考虑一个无线 帧中可以有多对D2D通信的资源分配算法。
然后，本文深入讨论了干扰感知中的关键问题一一PDCCH盲解码。先介绍 了 PDCCH的链路构成、编码及资源映射方式，结合D2D终端与普通蜂窝终端 PDCCH解码过程中的异同，利用最大累积度量优势来判断PDCCH的聚合等级 及DCI长度。由于这种算法在PDCCH聚合等级为1时误判率较高，通过多种配 置下的仿真和对比，最终提出一套能保证在较宽信噪比范围内2CCE及以上聚合 等级31比特DCI解码错误率1%以下、6dB以上1CCE聚合等级31比特DCI解 码错误率较低的PDCCH盲解码方案。最后，提出了适用于PDCCH盲解码的并 行实现框架，以保证系统的实时性。
接着，本文的关注点放在了广泛运用于干扰感知中另一项技术之上一一LTE 下行信道估计。本文所提出的基于DFT的信道估计算法通过添加VCFR来减弱 边界效应，防止出现MSE性能地板现象。所提出的算法使用一种基于能量检测 的高效动态去噪算法来提升信道估计算法在低信噪比下的性能。仿真结果表明： 与传统DFT信道估计算法相比，所提出的算法在高信噪比下不会出现MSE性能 地板：在目标MSE为IO」时，所提出的算法能获得2.5至5.5dB的MSE性能增 益；所提出的算法的rawBER性能也比已有的基于DFT的信道估计算法要好。 另外，分析表明所提出的算法与使用传统去噪方法的VCFR信道估计算法相比， 时间复杂度几乎相同。因此，所提出的信道估计算法可以被使用在实际的LTE 下行信道中以提供准确的CSL进一步地能提高相应下行信道的解码正确性，为 D2D用户的干扰感知准确性的提高奠定基础。
最后，本文重点讨论了多对D2D的资源分配方案。在这部分中，首先结合 实际LTE系统，分析了蜂窝终端和D2D终端在资源分配过程中应满足的基本约 束，在此基础上建立了资源分配的数学模型。根据是否允许多个DUE复用同一 块资源将此问题分为单独复用资源分配问题和联合复用资源分配问题。在单独复 用约束下，本文提出了理想算法与贪心算法，仿真中发现贪心算法较理想算法 D2D总吞吐低7%左右，但理想算法的时间性能远不如贪心算法。针对联合复用 问题，本文提出了一种利用单独复用算法且重新利用各资源段上干扰余量的迭代 算法，仿真中联合复用算法的吞吐性能几乎两倍于单独复用算法中的性能，但时 间复杂度上联合复用算法比单独复用算法稍有提高。另外，考虑到各D2D对通 信公平的问题，提出了将模型中的目标函数改为最大化呈于比例公平的D2D速 率，在仿真中可以看到此举有效改善了各D2D对的资源分配公平性问题。
总的来说，本文工作围绕D2D与蜂窝系统的F扰共存问题而展开。在干扰 感知技术研究方面提出了一套完整的PDCCH盲僻码方案以及一种优化的下行信 道估计算法；在干扰控制技术研究方面提出了多种适用于实际LTE系统的场景 和多D2D对通信的资源分配算法。
本文仍有很多值得继续深入研究之处。关于低聚合等级的PDCCH盲解码, 可以尝试寻找解码错误时的规律来改进解码算法，从而从根本上降低错误率，另 外，如何在实现中降低计算复杂度也是一个重要课题。下行信道估计可以在更高 速的时变信道环境下进行研究。而在多D2D对干扰控制方面，由于这需要蜂窝 基站提供给D2D用户一部分信息，可以进…步考虑如何将D2D干扰控制信息高 效地集成到蜂窝系统之中。

参考文献
[1]吴伟陵，牛凯.移动通信原理[M].北京：电子工业出版社，2005.
[2]彭涛.基于认知无线电技术的混合网络研究[D1北京:北京邮电大学，2010.
[3]王顺程.基于SDR的D2D验证平台系统架构和实时处理保障技术[D].北京: 北京邮电大学，2015.
[4]3GPP. TS36.213, 3rd Generation Partnership Prefect Technical Specification Group Radio Access Network Physical Layer Aspects for Evolved UTRA Physical layer procedures, Release 11 [S], 2015.
[5]王宏宇.蜂窝与D2D异构网络中D2D无线资源管理设计与实现验证[D].北 京：北京邮电大学，2015.
[6]3GPP, TS36.212, 3rd Generation Partnership Project Technical Specification Group Radio Access Network Physical Layer Aspects for Evolved UTRA Multiplexing and channel coding, Release 11 [S]. 2015.
[7]3GPP TS 36.211,3rd Generation Partnership Project Technical Specification Group Radio Access Network Physical Layer Aspects for Evolved UTRA Physical channels and modulation, Release 11 [S] 2015.
[8]杨晨晨，彭涛等.混合蜂窝与端到端系统PDCCH盲解码研究[J],电子技术, 2014： 107-110.
[9]劳子轩，刘子扬等.全盲频谱感知：噪声估计与能量检测联合迭代算法[J].北 京邮电大学学报,2013:1958-1963.
[10]杨晨晨.蜂窝与D2D混合网络的PDCCH盲解码技术[D].北京：北京邮电 大学，2014.
[11]3GPP TS 36.101, 3rd Generation Partnership Project Technical Specification Group Radio Access Network Physical Layer Aspects for Evolved UTRA User Equipment (UE) radio transmission and reception, Release 11 [S]. 2015.
[12]T. Sipila, H. Wang. Ume-domain interpolated channel estimation with noise suppression for multicarrier transmissions [A]. //ISSTA[C], 2004: 462-466
[13]F. Sun, J. Zhang, Y Zhang, et al. A Novel Channel Estimation Scheme for MIMO-OFDM Systems with Mrtual Subcarriers, Vehicular Technology Conference[C], 2008: 928-932.
[14]X. Hou, Z. Zhang, H. Kayama. Low-Complexity enhanced DFTbased channel estimation for OFDM systems with virtual subcarriers, PIMRC,07[C], 2007: 1-5.
[15]H. Hsu, C. Chen, G.C.H Chuang, Windowed DFT-based OFDM channel estimation by adding virtual channel frequency response, WiCom?09[C], 2009: 1-5,
[16]K. Zheng, JL Su? W. Wang. DFT-based channel estimation in comb type pilot-aided OFDM systems with virtual carriers, PIMRC ,07[C], 2007: 1-5.
[17]L. Zhang, Z. Hong, L. Thibault. Improved DFT-based channel estimation for OFDM systems with null subcarriers, Vehicular Technology Conference Fall (VTC 2009-Fall)[C], 2009: 1-5
[18]Y Wang, L. Li, P. Zhang, Z. Liu Channel estimation for OFDM systems in non-sample-spaced multipath channels[J]. Electronics Letters, 2009, 45(1): 66-68
[19]3GPP TS 36.104, 3rd Generation Partnership Project Technical Specification Group Radio Access Network Physical Layer Aspects for Evolved UTRA Base Station (BS) radio transmission and reception, Release 11 [S]. 2015
[20]T. Hoang, L Le, T Le-Ngoc. Resource Allocation for D2D Communications Under Proportional Fairness, GIobalcom[C], 2014: 32-36.
[21]I. C. Wong, O. Oteri, W McCoy Optimal Resource Allocation in Uplink SC-FDMA Systems[J], IEEE Transactions on Wireless Communications, 2009, 8(5): 2161-2165.
[22]M. Zhang, Y Zhu. An Enhanced Greedy Resource Allocation Algorithm for Localized SC-FDMA Systems[J] IEEE Communications Letters, 2013, 17(7): 14794482.
