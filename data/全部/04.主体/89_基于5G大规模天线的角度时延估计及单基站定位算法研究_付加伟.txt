第一章绪论
1.1研究背景及意义
随着社会的发展，位置信息逐渐成为人们赖以生存和发展的重要信息，人类通过精 准的位置信息更加准确的描述整个世界与自己。进入21世纪以来，互联网产业不断发展, 万物互联的时代已经来到，人们对于“我从哪里来，要到哪里去”的需求日益频繁，基于 位置服务(LocationBased Services, LBS)的应用应运而生。目前，以我国北斗导航系统、 美国的全球定位系统为代表的全球卫星导航系统(Global Navigation Satellite System, GNSS)已经融入到交通运输、公共安全、农林渔业、水文监测、减灾灭灾等多个领域 [,]o随着未来智能产业进一步扩大，无人驾驶、智慧医疗、智慧物流与仓储等多种应用 场景对位置服务提出了更高定位性能的精细化需求，在定位精度、可靠性以及位置服务 的可用范围都提出了更高标准。
尽管GNSS系统经过半个多世纪的发展，已经基本解决了室外的定位与导航难题， 但卫星信号在室内、城市峡谷等复杂环境下，信号传输衰减较快，甚至被完全遮挡，从 而难以提供高性能、可持续的位置服务因此，研究开发多种定位技术以适应室内外 的复杂环境成为了定位与导航的新发展方向。当前，基于蓝牙、WIFI、UWB、RFID等 定位技术已经在小范围内的场景下得到应用，并且在短距离的定位中能取得不错的定位 效果[3-8],但以上定位技术需要用较多的设备节点来覆盖所要定位的区域，普适性和系统 灵活性不足，毫无疑问增加了定位的成本；基于惯性导航、地磁等辅助手段的定位技术 受限于设备精度和周围环境因素Pi。〕，导致定位结果不稳定；因为在信号覆盖上具有优 势，利用移动通信网络已经成为弥补GNSS位置服务范围不足的手段，例如利用小区识 别码(Cell-ID)能推算出用户所处小区的大致位置叩，相比于卫星定位技术覆盖范围有 了很大提升，但定位导航精度仍需进一步提高。同时，联合多基站的定位方法可以大大 提升定位服务的范围和精度，例如使用TOA、TDOA、AOA等信号参数信息进行定位， 但其对终端接收基站的数目有一定要求，当某个基站和终端之间不存在直射径时，会导 致定位结果的不准确。
“4G改变生活，5G改变社会”。随着研究的不断深入和实现，第五代移动通信技术 (5th Generation Mobile Networks, 5G)出现，让实现复杂场景下高精度定位与导航成为 可能。我国对于5G相关技术的硏究开始于2012年，2016年工信部正式启动5G技术的研发 试验，2019年6月工信部向中国三大运营商发放5G商用牌照，这标志着我国成为全球第 一批建设商用5G网络的国家。截至2020年底，我国建成5G基站数目累计超过70万个，5G 终端连接数超2亿台，5G手机出货量持续上升。2021年将加快5G网络建设，更多5G应用 将加速落地，5G商业模式更加成熟【"I。


广值規模昨i增长率
图1・1我国5G产业规模与增长预测
随着5G商用规模不断扩大，相关技术研究不断推进，如何利用5G网络特点进行通导 融合定位与导航成为新的研究热点与趋势[⑶。超密集组网技术(Ultra-DenseNetwork, UDN)、大规模天线技术(Massive Input and Massive Output, MIM0)、毫米波(mmWave) 技术等在提高通信质量与速率的同时〔⑷，也对定位性能带来潜在的提升，包括角度时延 估计精度的提高、定位基站信源的增加等[15-17],这些变化让单基站定位成为可能。因此 本文拟利将通信与导航相结合，利用5G网络的技术特点，研究一种基于5G的单基站定 位方法，分析研究单基站定位过程中的重点与难点技术，为“北斗+5G”助力阴，解决导 航与定位过程中的“最后一公里”问题。
1.2国内外研究现状及发展趋势
针对基站室内外定位技术，国内外学者的研究方向多集中在以下两个方面：指纹库 构建与匹配、信号参数估计，下面就这两个方面的研究现状与发展趋势做阐述。
指纹构建与匹配的原理主要是通过提前在特定位置区域采集特征参数，将该特征参 数与位置信息的一一对应关系建立指纹库。在需要定位服务时，利用实时采集到的特征 参数与指纹库中的特征参数相匹配，选取匹配度最高的作为定位结果。常见的位置特征 参数包括：信号强度(RSSI)、信号的幅值和相位等。常见的信号源包括：蓝牙、WIFI 等。Han. K等人根据蓝牙节点的信号强度提出了一种融合惯性导航PDR的室内外定位算 法凹，能够有效抵抗非视距(Non-Line-Of-Sight,NLOS)情况下造成的定位误差，取得 了较好的定位效果，定位精度可达1.2m。但蓝牙信号存在覆盖范围较小，部署成本较高 的缺点。随着WIFI网络节点密集化程度越高，2010年，D.Halperin等人使用WIFI信号的 CSI特征代替了RSSIP0],信号的CSI特征包括幅值、相位，相比于RSSI的单一维度，CSI 能够更加精确的反应无线信道中的多径效应、路径损耗等特征。在CSI数据采集和指纹 库生成阶段，Chapre等人提出的CSI-MIMO系统使用了多天线下的相邻子载波间的幅度 和相位差异作为指纹，在实验环境下取得了亚米级的定位精度0］；而Wang. X提出的 DeepFi系统通过采集CS啲幅值作为神经网络的输入进行模型训练，将该网络的权值视 为指纹©］,该作者进一步开发了基于相位的深度学习系统PhaseFi,进而全面提取CSI统计 特征⑴】。在CSI特征匹配阶段，计算实际测得的幅值和相位与指纹库中的数据的向量距 离，选择最小的参考点作为最终的位置估计，常用的匹配算法有：聚类算法、支持向量 机、随机森林、神经网络等［24,25］。由此可知，利用指纹进行定位的方法要进行离线指纹 的提取与采集，这需要一定的设备支持，目前尚未有5G信号相关CSI提取设备。同时在 匹配过程中，环境因素的改变会导致指纹库失效的问题。
利用信号的估计参数和基站的坐标，从而进行移动终端位置的解算是通导融合定位 的主要研究方向。对信号参数的估计多集中在到达时间(TimeofAiTival,TOA)、到达 时间差(Time Different of Arrival, TDOA)、到达角(Angle of Arrival, AO A)卩®。
随着5G从预研到逐步商用，越来越多的国内外学者开始结合5G网络特点进行相关 定位技术的研究。针对5G毫米波频段的特点，张书楠等对5G毫米波的特性进行了分析， 提出了基于最短路径的TOA估计多基站定位算法Rd； H.E1-Sayed等在毫米波频段复现了 基于RSSI、TDOA、AOA的三种定位方法，证明了利用AOA进行定位拥有更好的定位性 能［28】。针对5G超密集网络的特点，J.Huang等人研究了超密集网络下，随机节点分布与 基于TOA定位性能之间的关系，得出了克拉美罗下界(Cramer-Rao lower bound, CRLB) 129］； E.Y.Menta等人提出了全新的超密集网络架构，利用多个节点上的线性阵列估计得 到的AOA值可实现亚米级的定位精度a〕。针对5G大规模天线的特点，K.Han等人利用了 Massive MIM0带来的角度估计精度的提升，提出~种远近场情况下的AOA直接定位方 法，实现亚米级定位性能冋；K.Zhu在MIM0系统下，提出了一种TOA定义的相同延迟 轮廓交线的定位模型，将局部均方根误差作为评价定位性能的新方法［珂。经过上述分析 可知，尽管己有较多文献对5G网络下的定位性能进行了研究，但基于TOA、TDOA、AOA 信号参数或其中几个参数组合的定位方法都对基站节点的数目和之间的通信有一定要 求(一般情况下基站节点数目要求3个以上)，并且对于拓扑的形状和位置的部署有较高 的要求，以避免NLOS基站带来的定位解算误差。
面对以上多基站定位过程中的问题，不少研究学者也对单基站定位方法进行了探 究。张浩等人研究了具有圆形天线阵列的单基站超宽带(UWB)定位系统，采用MUSIC 算法和对脉冲幅度的测量实现了精确定位［列；张建平对基于大规模天线通信系统的单基 站定位技术进行了研究，阐述了基于支持向量机的单基站定位方法，解决了定位仿真过 程所需要的信道模型建立和定位参数估计等问题［列。吴志国以WIFI信道状态信息作为 研究对象，提出了低信噪比条件下AOA估计方法，并且通过建立支持向量回归的路径损 耗因子动态估计的方法，解决了非视距问题，取得较为良好的单基站定位效果［切。由此 可以看出，上述单基站方法缺少与5G网络特点的结合，例如Massive MIMO,毫米波、 超密集网络等。
综上所述，5G网络发展趋势已经如火如荼，利用其新的技术特点来解决定位问题是 研究的热点。虽然己有较多的有关5G定位技术的研究，但缺少单基站定位方面的研究。 本文拟首先分析5G网络特点对单基站定位能力方面带来的提升，根据单基站定位的基本 原理，在不同场景下合理利用大规模天线、超密集网络、波束成形等特点，实现室内外 高精度无缝定位。同时融合现有的定位技术，解决在复杂环境下单基站定位难题。
1.3论文主要研究内容
考虑到5G网络技术在基站覆盖、角度时延估计等方面带来的提升，本文针对其优势, 结合通导融合的特点，开展了单基站定位及相关算法方面的研究。
众所周知，在室外空旷区域，北斗、GPS等全球卫星导航系统可以实现米级的定位 精度，满足人们的日常位置服务需求。相对而言，在室内或建筑物较为密集的区域，由 于建筑物的遮挡，出现卫星信号无法被终端所接收或接收信号较弱的情况，定位服务效 果和能力大打折扣。同时，未来5G网络将为用户提供不同服务等级和性能的新位置服务, 例如车辆网、智能制造、无线医疗、智慧城市等领域，这需要整个网络具备全时空连接、 高效的数据传输速率、超低的时延，这仅仅依靠全球卫星导航系统是无法完成的。因此 面对多种多样的应用领域，本文开展基于5G网络的定位技术研究是很有必要的。
尽管超密集网络使得定位信号源的数目增加，但多基站定位算法要求至少需要三个 及以上的基站信号测量值，当存在非视距基站时，对定位性能有较大影响，同时在基站 部署上也提高了成本。随着天线阵元的数目的增多，阵列孔径增加，信号估计得到的参 数精度也有所提高，这使得利用单个基站进行定位成为可能，因此本文将开展基于5G的 单基站定位算法研究。定位能力与区域内的环境复杂度息息相关，在较为空旷的区域， 例如体育场、公园等室外场所，定位终端和基站之间遮挡物较少，具备视距信号的条件； 在较为密集的区域，例如城市拐角、地下停车场等室内场所，定位终端和基站之间遮挡 物较多，不具备视距信号条件。综上所述，本文研究了视距情况和非视距情况下的单基 站定位方法，以提升在不同场景下的定位精度。
本文的主要研究内容如图1-1所示：


图IX研究内容槪况
第一部分针对空旷区域遮挡物较少，进而视距信号较为充足的特点，本文提出了一 种基于混合阶的远近场角度时延估计算法，采用角度和时延两个信号参数量完成单基站 定位过程。首先，为了实现快速单基站选取，针对5G波束的特点，本文提出了一种新的 定位架构，根据波形的指向确定视距基站，这减少了定位服务的响应时间和复杂度。然 后，针对传统的角度时延估计算法存在参数匹配和需要频谱搜索的不足，本文建立了时 域和频域信号的传输模型，提出了一种基于混合阶的远近场角度时延估计算法，该算法 能够在不需要参数匹配的情况下，减少搜索的次数，并且通过引入频域信号接收模型解 决了远场时延无法在时域信号接收模型内估计的问题。经过一系列仿真证明，本小节所 提出的基于混合阶的远近场角度时延估计方法能够在远场和近场条件下表现出较好的 估计精度。
第二部分针对复杂区域遮挡物较多，进而视距信号不足甚至不存在的特点，本文首 先提出了一种非视距情况下基于PDR约束的NLOS基站检测方法，通过比较连续两点之 间的PDR估计距离和信号计算得出的距离大小，得出基站的视距或非视距状态。接下来 在非视距环境中，本文考虑到角度时延数据集的特点，利用DBSCAN聚类算法对角度和 时延参数进行分类处理，从而排除误差点。然后，根据已知的建筑平面结构，构造虚拟 基站，将NLOS信号路径转换成LOS信号路径，利用NLOS信号路径参数进行解算。最后 在解算过程中，考虑到存在多条NLOS路径提供的冗余信息，同时借助PDR提供的终端 移动速度矢量等信息，提岀了一种二次加权的NLOS位置估计方法。通过仿真实验证明, 本文结合PDR约束提出NLOS基站识别方法相比于其他识别方法具有较高的正确率。同 时，通过虚拟基站进行加权定位解算的方法对于非视距环境下定位精度也有较高的提 升，定位精度达到亚米级。
1.4论文章节安排
本文的研究内容围绕以下五个章节进行开展：
第一章内容是绪论，首先介绍了5G背景下开展单基站定位技术研究的意义。其次对 国内外基站定位技术研究现状进行分析，总结其发展趋势，分析了5G网络下单基站定位 的潜在优势。最后介绍了本文的主要研究内容及论文章节安排。
第二章以5G组网技术为背景，介绍了5G相关技术知识，分析其对定位性能的潜在提 升，为后续研究方法的展开做铺垫。然后，介绍了移动通信网络中常见的几种基站定位 技术，分析了其中的优势与不足。最后介绍了单基站定位的潜在优势和原理，分析了5G 网络下单基站定位过程中影响定位精度的主要因素：近场效应和非视距误差。
第三章针对空旷场景下，存在视距基站的情况，提出了基于大规模天线的远近场角 度时延估计方法，以解决单基站定位过程中的近场效应问题。首先考虑到空旷场景下基 站数目充足，因此本文提出了一种通导融合的定位架构，通过引入MEC边缘计算服务器 网关，利用波束成形指向性的特点，完成视距基站的选取。然后构建时域信号和频域信 号接收模型，并提出一种基于混合阶的远近场角度时延估计方法，能够对远场和近场的 角度时延参数进行估计。同时，针对本章提出的方法进行了性能理论分析，并通过 MATLAB仿真验证，仿真表明在远近场条件下具备较高的角度时延估计性能。
第四章主要是针对复杂场景下，不存在视距基站的情况，提出了基于PDR约束和虚 拟基站二次加权的方法以抵抗单基站定位过程中的非视距误差。首先将PDR估计距离和 通过角度时延估计得到的距离进行比较，得岀基站所处的视距或非视距状态。然后，针 对处于非视距的情况，本文使用聚类算法对角度和时延估计参数进行聚类，以排除干扰 点。最后根据已知的建筑平面结构，使用虚拟基站的方法将非视距路径转换为视距路径， 并在位置求解的过程，同样使用PDR提供的终端运动状态信息和多路径的冗余信息用以 二次加权终端位置坐标计算，最终实现非视距情况下的单基站定位。通过实验仿真表明， 本小节提出的NLOS基站识别方法具有较高的识别正确率，提出的基于虚拟基站的二次 加权方法在NLOS环境下具有较高的定位精度。
第五章是对论文研究内容的总结和展望，并分析研究中的一些不足之处，为接下来 的研究提供新的思路。
第二章5G单基站定位理论基础
2015年，国际电信联盟ITU正式确认了5G的三大应用场景：增强移动宽带（eMBB）、 海量物联网通信（mMTC）和低延时高可靠的通信（uRLLC）〔殉。为了满足不同场景下 的通信交互需求，5G采用了一系列关键技术：毫米波具有更大的频谱资源开发空间，能 够提供更高的传输带宽和更多的接入设备；大规模天线技术通过波束成形提升在某个方 向上的增益，补齐了毫米波强衰减性的缺陷；超密集网络由于毫米波波长较短，在传输 过程中衰减较快，因此结合MassiveMIMO技术可以实现波束成形，从而提升波束在某一 方向上的增益；超密集网络通过增加不同类型基站的部署密度，提升了空间复用能力， 有效提高了5G网络的覆盖能力和数据传输能力。毫无疑问，以上5G相关技术为单基站 定位提供了新的解决思路。
本章首先对以上几种5G组网技术进行了介绍，宏观上分析了这些技术对单基站定位 能力的提升，接下来介绍了移动通信网络中常见的几种定位技术，分析其中的优势和不 足之处。最后介绍了单基站定位的优势和原理，分析了单基站定位过程中影响定位精度 的主要因素，这是开展本文研究的前提。
2.1 5G组网技术介绍
首先本小节将对5G组网技术进行介绍，分析一系列技术在定位服务过程中起到的作 用。根据通导融合的特点及发展的趋势，本小节重点分析超密集组网技术、大规模天线 技术、毫米波技术。
2.1.1超密集组网技术
未来5G复合场景下数据传输大量增加，传统的4G蜂窝组网技术不能够满足高速率、 高质量的业务需求，这种变化使得超密集组网技术成为5G最重要的技术之一，其主要特 点是异构组网和多连接技术Ml。


图2-1超密集组网部署示意图
所谓异构组网，即考虑到不同场景对通信性能有不同的需求，因此在5G基站中保留
了4G基站，从而有不同覆盖范围的宏微基站。具体部署示意图如图2-1所示。在5G时代 以前，基站的覆盖范围相似，功能基本一致，这就导致了在某些热点区域，例如体育场、 大型商场、办公楼等，出现了用户无法连接或断开服务的情况。为了满足在某些热点区 域的连接请求，5G采用了不同覆盖范围的微基站作为接入点来提高接入的密度与数量。 其中宏基站（MacroSite,覆盖能力200m以上，发射功率10W以上）多采用4G网络的现 有基站来保证整个区域的覆盖密度，在宏基站覆盖盲区内，利用微基站（Micro Site,覆 盖能力50〜200m,发射功率500mW~10W）、皮基站（Pico Site,覆盖能力20〜50m,发射 功率100mW~500mW）等不同类型的基站来补充这些存在信号盲区艮】，从而扩展了整个 5G网络的覆盖面积，保证无缝连接的实现。
在5G网络之前，移动通信网络中存在基站和移动终端的一对多的映射关系，即一个 基站可以给多个移动终端同时提供服务；而单个移动终端和基站的关系是一对一的，即 单个移动终端在同一时刻只能由一个基站提供服务。这样就导致小区边缘的移动终端服 务质量较差，降低了用户的体验。随着5G网络部署逐渐密集，基站间的间距不断减小使 得多连接技术提上日程，以提高小区边缘和整个系统的吞吐量。3GPP标准化组织引入了 基于E-UTRAN的多连接技术，即一个处于RRC连接态的发送或接收终端，可以使用由 X2接口连接的两个eNB （evolvedNode B）分别调度无线资源卩刃。
针对单基站定位服务来说。5G超密集组网技术中的宏微基站使得定位节点更加充 足，增加了单个定位基站处于视距范围内的可能。同时多连接技术使得信令控制与数据 通信得以分离，有利于通信与导航的深度融合。
2.1.2大规模天线技术
随着对通信网容量的需求越来越大，从第三代通信技术开始，多天线技术成为是 3GPP标准化工作的热点。多天线技术通过多个天线单元进行数据的收发，有效发挥了空 间分集和复用技术的优势，提高了对抗信道衰落的能力。在LTE通信系统中，在LTE通 信系统中，基站和终端两侧具备的天线阵元数目较少，一般不超过4个。随着硬件集成水 平的不断提高，单个基站天线上所容纳的天线阵元数量不断增加，基站一侧天线阵元的 数目可达100根以上，由此MIM0技术演变成为MassiveNCMO技术。如图2-2所示，大规 模天线阵列利用波的干涉原理，调整各个阵列单元的发射信号相位，使得有的方向上的 波相互增强，而有的方向上相互抵消，具有较强的方向性，这种波束成形技术称为 MIM0波束成形，有效的增强了波束的覆盖能力和系统的吞吐量。


IS 2-2 大规模天线技术和波束成形技术
天线阵元数目的增加和排布方式的变化使得大规模天线技术在通信系统中具有以 下显著优势〔4°〕：
■提高信道容量
由于单根天线传输的数据容量存在上限，为了提高通信信道容量，我们可以采用增 加天线数目的方法，即大规模天线技术。对于同一条数据或者信令，我们可以将其拆分 成多个部分，每一部分均通过不同天线发送，接收时再合成原信息。就像采用多条线路 传输，将同样信息的传输时间缩短，达到扩大信道容量的效果，提升通信服务水平。
■降低硬件成本
众所周知，天线想要扩大覆盖范围需要昂贵的功率放大设备。而大规模天线的波束 赋形技术能很好的解决单一天线功率不足的问题。多组天线分工合作，在加强方向通过 叠加扩大功率，实现了低功率多天线的覆盖，降低了硬件成本。
■降低时延
根据大数定律信道接近平坦性衰落信道，低延时通信会成为5G MIMO的又一项新 特性。在该场景下，由于衰落接近消失，信道变得良好，可以大大简化对抗深度衰弱的 过程，进而降低通信时延，提升通信服务体验。
综上所述，大规模天线在信道、时延、测角成本上均有较大改善，能很好适应城市 化过程中的热点环境，提升其服务能力。但是，由于天线数量的大幅度上升，大规模天 线技术也带来了一些问题。
■信道测量和建模
天线数目增加导致信道传输参数发生变化，原有的根据实际场景建立的信道模型将 不再适用，针对不同天线数目下信道的相关性、信道衰落等特性需要重新测量和建模， 这将是一个很大的工作量。
■导频设计以及降低导频污染研究
天线数目大幅度增加后，噪声、用户间干扰等因素在信号上的影响力都会减低，信 号上的信噪比及分辨率会提升，而多天线间的导频污染会成为限制其性能的重要因素。 如何分配导频及其功率会成为新的研究重点和难点。
■ FDD模式下，下行信道估计、信号反馈、两阶段预编码等研究
基站天线数目的增加，导致下行信道估计的导频符号开销增加。然而在相干时间内， 天线可发送的符号数目是有一定限制的，导频符号开销过大会大大降低有用数据符号的 比例并影响其发送。同时，当终端完成对信道的估计后，将信道状态信息（CSI）反馈给 基站时仍需较大开销，这就导致频谱效率低。
■降低硬件开销的混合预编码结构和方法研究
传统意义上，信号处理方法需要每根天线对应一个射频通路，然而实际生产中射频 链路往往非常昂贵。随着天线数大量增加，硬件耗材和能量开销都会随之迅速增大，所 以如何设计和研究降低射频链路的预编码方案将成为亟待解决的问题。
清晰明了的了解大规模天线各项特点，合理利用其在定位方面的特色，构建通导融 合的大规模天线系统，将天线数目的提升及波束赋型能力的提升转变为室内外复杂区域 定位能力的提升是本文的关键之一。
2.1.3毫米波技术
在移动通信网络中，载波信号的频段一般分布在0.3MHz-3GHz之间。然而5G网络接 入设备不断增加，现有的频率资源已经不足以满足对更高传输速率，更多接入设备的需 求。随着对更高频率信号研究的深入，以及集成电路技术的进一步发展，在5G网络中将 使用毫米波频段的资源。
顾名思义，毫米波指的是波长在毫米级的信号频率，其频率覆盖在30GHz至300GHz 之间，可利用的频率资源相比当前移动网络提升近100倍。毫米波频段频谱范围的扩大 为接入设备提供了更宽的带宽，同时具有抗用户间干扰能力强、波束方向性强、波束窄、 波束密度大等优点。然而由于毫米波的高频特性，使得其在自由空间中的路径损失较大、 穿透性差、多普勒时延较高等缺点，所以需要结合5G大规模天线阵列来克服这些缺点 [41]0由于毫米波的波长较短，有利于天线尺寸的小型化和密集部署，同时大规模天线阵 列单元可实现对波束的控制，增强了波束在某个方向上的增益，从而一定程度上弥补了 毫米波的路径损耗。
毫米波在自由空间表现岀来的特性无疑为定位服务的高精度实现提供了有利条件。 首先是毫米波频段可用频点较多，可用的带宽大大增加，根据香农信道公式，显然提高 了信道容量，有利于同一时间密集区域内的密集定位服务请求的实现；其次，尽管毫米 波的衰减较强，但这也促使5G网络开展超密集网络和大规模天线部署，有利于定位源数 目的增加，对提高参数估计的精度也有一定帮助。
10


图2-3频率资源和覆盖能力
2.2移动通信网络中的定位技术
在移动通信网络中，随着天线数目的增多，尤其是在基站一侧具备了对来波信号进 行角度和时延估计的能力，因此可以根据估计得到的信号参数和已知的基站坐标，从几 何关系的角度对终端位置坐标进行计算。本小节将重点对几种常见的定位技术和解决方 案做介绍，最后总结了几种定位技术的优势和不足。
2.2.1基于信号强度的定位技术
众所周知，信号接收端的信号强度（RSSI）与收发两端的距离成反比，进而可以通 过信号强度估计出距离，进而用于定位解算。通过对路径损耗建立相关描述模型，可以 准确描述不同场景下接收信号功率和收发两端之间的距离关系，如式（2-1）所示：

其中，耳（〃）表示当信号接收端和发射端距离〃时，接收到的信号功率，卩（必）表示 距离心时的标准功率参数，。表示损耗系数，&表示环境影响因子。基于RSSI的定位方 法常见于蓝牙、WIFI等近距离通信定位场景下，尽管该方法在计算距离参数时比较方便 快捷，然而，不同环境场景下，信号传输路径的损耗系数也不同，并不能建立一个统一 的模型来描述所有的场景，场景的变化可能会导致模型的失效，尤其是在非视距多径影 响较为严重的环境中，单纯利用RSSI进行定位的精度不能满足用户需求。
2.2.2基于时间的定位技术
信号在介质中从发射端传播至接收端需要经过一定的时间间隔，该时间间隔称为信 号的到达时间（TOA）。一般无线电磁波在空气中是以光速C = 3X108^/$的速度传播，
11 因此可由TOA得到收发两端的距离，进而用于定位解算。TOA定位的基本原理如图2-4所
示：


图2-4 TOA定位原理
通过上图可知，要想利用到达时间进行终端位置坐标的解算，需要保证终端能同时 接收到三个及三个以上的基站信号，并且还要求基站和基站之间、基站和终端之间保持 时钟的同步。
在三个基站都处于视距的情况下，假设第/个基站的位置坐标为(兀,必坷)，待估计 终端的坐标为(x,y,z),第Z个基站和终端之间的传输时延为因此可以联立方程组， 得到：
J(x _	+(y-x )2 +(z_zj2 = c * 巧	(2-2)
然而，上述求解过程是在时钟保持严格同步，且没有非视距多径信号的干扰下得到 的。在实际定位过程中，由于设备精度因素的影响，不可避免的会受到时钟同步误差； 同时，由于某些定位场景的复杂性，例如在地下停车场、写字楼等环境下，出现信号的 折射、反射、投射等现象，非视距多径效应较为严重。在这种情况下，多个基站的传输 距离所交出来的不再是一个点，而是一个区域，一般通过取该区域的质心的方法得到最 终的定位结果，但定位误差仍较大。
为了尽可能消除终端和基站之间的时间同步误差，基于到达时间差(TDOA)的方 法被提出。该方法在估计得出终端到多个基站TOA的基础上，相互作差得到TDOA值， 这就将基站与终端之间的同步误差一一抵消。同样的，基于TDOA的位置解算方法仍需 要终端接收到三个及三个以上的基站信号。TDOA的基本原理如图2-5所示：
12


图2-5 TDOA定位原理
将终端和三个基站之间估计得到的TOA值两两作差得到三个TDOA值，根据双曲线 的特点，求解双曲线的交点即为接收端的位置坐标：
TDOA^TOA^TOA,
-TDOA2 = TOA,-TOAX	(2-3)
TDOA^TOA^-TOA^
其中，T04由式(2-2)表示。因此可以求解上述方程组得到待估计终端的位置坐 标。基于TDOA的定位解算方法一定程度上抑制终端和基站之间的时钟误差带来的测距 误差，对非视距多径的处理方法也更加多样，应用范围更加广泛。
2.2.3基于角度的定位技术
随着天线阵列数目的增多，测角精度不断提高，因此利用角度(AOA)进行终端定 位也是一种常用方法。通过两个及两个以上基站估计得到的角度参数，与基站的位置坐 标联立方程，利用正余弦定理即可求得终端坐标。如图2-6所示：

BS1	BS2
图2・6角度定位原理

13
其中，目表示终端和第2•个基站之间的夹角，在二维平面中，假设第Z•个基站的坐标 为(兀,必)，终端坐标为(x,y),当至少存在两个基站能观测到终端的角度参数时，可根据 多条射线的交点确定终端的位置坐标，计算公式如(2-4):
tan 0. = —~~—	(2-4)
y-y,
相比于基于时间的定位技术，利用角度进行定位对基站数目的要求更低，在一定程 度上降低了通信系统的开销，在视距情况下，可以提供较高的定位精度。然而，在建筑 物遮挡较多，楼层较高的情况下，非视距多径干扰较为严重，仅仅利用角度进行位置解 算也难以达到理想的定位精度，难以满足用户的需求。
综上，表2-1给出了上述不同定位技术的比较，分析了其中存在的优势和不足。
表2-1不同定位方法的比较
定位方法
定位所需基站数目
基站间同步
终端基站同步
复杂度
定位精度
RSSI
至少3个
不需要
不需要
低
低
TOA
至少3个
需要
需要
中等
中等
TDOA
至少3个
需要
不需要
高
高
AOA
至少2个
不需要
不需要
中等
高
2.3单基站定位技术
本小节将重点阐述单基站定位相比起多基站定位的优势，分析单基站定位的基本原 理，为后续开展相关研究奠定基础。最后，尽管单基站定位方法相比于多基站定位具备 一定优势，然而仍不能够忽视影响单基站定位精度的两个因素：近场和非视距。
2.3.1单基站定位优势
在2.2节中讨论了常见的几种利用移动通信网络来进行定位的技术，并且分析了其在 定位过程中的优缺点。现阶段基于RSSI、TOA、TDOA、AOA的定位方法都对终端接收 基站的数目有要求，必须满足3个以上，这就增加了部署的成本，同时对基站的拓扑形状 和位置都提出了要求，当终端距离基站较近时，存在基站覆盖问题，如图2-7中北京邮电 大学局部区域无法接收到3个以上的基站信号；其次，基于时间的定位技术都对时钟提 出了更高的要求，在定位系统中，Ins的时钟误差都会导致0.3m以上的定位误差；最后， 非视距多径始终是影响定位精度的主要因素，基站数目越多，带来非视距多径信号的概 率就会越大，从而影响终的定位结果。
14
图2-7北京邮电大学局部基站分布图
5G组网技术的发展，使得大规模天线阵列对角度和时延估计精度不断提高，这给单 基站定位的实现提供了条件。在单基站定位模型中，仅需一个已知坐标的基站节点即可 完成定位服务，无疑降低了部署的成本；同时，对基站之间的同步时钟也不作要求，减 少了基站间的信息交互与系统开销；针对非视距多径问题，可通过相关基站选择方法排 除非视距基站，避免了非视距误差的引入。
综上，结合5G网络特点对单基站定位技术进行研究与探讨是有意义的，是针对联合 多基站定位技术的有力补充。
2.3.2单基站定位原理
在理想情况下，当定位单基站BS与终端UE处于视距路径时，我们可以根据两者的 几何关系计算出移动终端的坐标。

图2-8理想情况下单基站定位示意图
如上图所示，在视距情况下基站BS和终端UE的几何关系图，（A）表示二维平面的 几何关系，（B）表示三维平面的几何关系，这主要取决于大规模天线阵列中阵列单元 的排布方式：
■当阵列单元呈线性排布,此时对阵列接收信号的参数估计是二维的，即（印坷）；
■当阵列单元呈圆阵或面阵排布，此时对阵列接收信号的估计是三维的，即 （印,0,巧）；
15
其中，同表示俯仰角，&/表示方位角，可表示信号的传播时间，取信号的传播速度 为光速C,即可计算得到传播距离0。通过以上对阵列信号估计得到的参数和基站BS坐 标，然后根据三角函数之间的关系可以求出终端UE的坐标位置。
2.3.3单基站定位精度影响因素
相比于联合多基站的定位方法，单基站定位方法在基站数目上要求更低，避免了多 个基站之间的信息交互成本，提升了系统的稳定性。然而，当提供定位服务的单基站处 于非视距环境中时，因为没有额外的视距基站提供信息，将导致较大的定位误差，因此 针对非视距单基站情况需要采取一定的抑制措施。同时，随着人们对定位服务精度需求 的不断提高，将信号波形等效成平面波也成为定位误差的来源之一。

要想实现单基站定位，需要对信号的角度和时延进行估计，仅仅依靠角度或时延一 个信号参数无法得出终端的位置坐标。根据电磁场理论，信号波在传输过程中是以球面 波的形式进行传播的，当终端距离基站的距离较远时，为了便于信号参数估计理论分析 和算法实现，可以将球面波等效成平面波，此时称终端处于远场中；当终端距离基站较 近时，若将球面波等效成平面波将导致信号参数估计产生较大的精度误差，此时称终端 处于近场中。
根据5G基站的覆盖范围，可以将基站分为以下四类，如表2-2所示。
基站类型
表2-2基站分类
覆盖范围
布置区域
宏基站
200m以上
室外空旷区域
微基站
50m 〜200m
室内外复杂区域
皮基站
20m 〜50m
室内区域
飞基站
10m 〜20m
室内区域
远场和近场的判定可通过菲涅尔区半径来区别，即:
^■near -	(2-5)

其中，厶表示接收阵列阵元之间的最大距离，2表示信号的波长。以华为提供的5G 宏/微基站为例，其阵元间最大间隔0.5m至lm不等，载波频率3GHz至30GHz不等。因此 在5G单基站定位过程中，对角度和时延进行估计时，需要考虑远场和近场的混场模型， 以提高角度的估计精度。

实现单基站定位技术的关键在于是否存在视距传输的信号径，在3GPPTR38.901中， 对几种典型场景下的基站和终端之间存在视距信号径的概率进行了实测和数学建模，如 下表所示：


表2-3 不同场景下存在LOS径的概率模型
场景
LOS径概率

根据以上概率模型可以得到不同场景下视距径存在的概率与终端和基站之间距离 的关系，如下图所示：

由图可知，在不同场景下，终端和基站之间建立连接的信号路径是视距路径的概率 基本在50%以上。5G网络中由于毫米波频段的信号具有较强的衰减特性，因此基站部署
17 密度比较大。在接收到"个基站信号的范围内，存在一个视距基站的概率P满足公式(2- 6)(假设各基站信号收发过程相互独立)
P> 1-(50%)"	(2-6)
其中”表示终端能接收到不同基站信号的数目。由此可以得岀，当终端能接收到基 站信号的数目”二3时，存在一个视距基站的概率接近90%。然而在复杂环境下，基站和 终端之间障碍物较多，存在终端可接收到的基站信号的数目小于3的情况，这时候其中 存在一个视距基站的概率比较低，甚至在某些极端情况下，终端只能够接收到一个基站 的信号，终端和基站之间可能不存在直射径。因此要实现单基站定位服务，不可避免的 要考虑视距基站的选择和非视距情况下单基站定位问题。
2.4本章总结
本章节主要介绍了5G组网的相关技术背景，分析了超密集组网、大规模天线、毫米 波等技术在定位过程中发挥的有利作用，是本文开展研究的技术背景。其次介绍了几种 常见的利用移动通信网络进行定位的技术：RSSI、TOA、TDOA、AOA等，分析了它们 各自的优势和不足，进而引导出单基站定位的意义。最后，介绍了单基站定位相比于联 合多基站定位的优势所在，阐述了单基站定位的基本原理，并分析了影响单基站定位精 度的两个主要因素：近场效应和非视距误差。
第三章	LOS场景下面向远近场的单基站定位方法
5G超密集网络使得终端处于视距基站的概率大大提升,波束成形技术使得收发信号 具备了方向性，大规模天线阵列的阵元数目增多，使得对信号参数估计能力增强。本章 首先分析了波束成形在视距基站选择中的作用，并由此提出了一种新的5G定位架构，利 用波束指向性的特点，以实现视距基站的快速选择；然后对远近场条件下，信号在时域 和频域上的接收模型进行了构建，最后提出了一种基于混合阶的远近场角度时延估计方 法，分析了该算法的性能优势，并进行了相应的理论仿真。
3.1基于波束的LOS基站选择方法
根据第二章的分析，5G超密集组网技术的应用，使得终端处于单个基站节点的概率 大大增加。如何快速且准确的选择处于LOS的基站为用户提供单基站定位服务，是本文 研究的起点。针对以上部署特点，本文拟将定位信号与通信信号进行融合，利用波束成 形的特点，在云端实现LOS基站的初选择。通过本方法可以减少连接的次数和运算的复 杂度，同时也较少了NLOS基站对定位结果的影响。
3.1.1 5G波束成形在基站选择中的作用
在通信系统中，终端进行服务小区选择和切换时，判断的依据是综合考虑EUTRAN 小区参考信号的接收功率测量值（RSRP）、参考信号接收质量（RSRQ）、目标小区的 负载情况［42】。只有在一段时间内满足各项指标的触发条件时，才进行服务小区的切换。 而在定位系统中，由于多径NLOS信号是影响定位结果的首要因素，因此在进行单基站 选择时，将该基站是否处于LOS情况下作为首要判决依据。
而在定位系统中，终端和基站之间的距离越远，则增大了传播路径上出现障碍物的 概率，随之而来的信号衰减、噪声干扰等因素的影响也增大。因此可以通过计算终端与 基站距离的方式进行LOS基站的初步选取，距离越近，处于LOS的概率越大［43〕。由于在 定位服务开始前，终端的坐标是未知的，因此可以用估计得到的TOA值表征距离参数。 然而在5G超密集网络下，终端可能在同一时刻接收到很多个基站信号，如果每个基站对 终端发出的定位请求信号进行TOA的估计，并最终判断出LOS基站，这会导致整个系统 复杂度的提升，在判断的准确性上也没有很大提高。

4G	5GNR

图3-1 4G天线波束与5G波束成形天线的区别
在第二章有关大规模天线的介绍中，我们可以知道由于天线阵元数量的增加和排布 方式的变化，5G波束和4G波束有显著不同。在4GMIM0中，存在全向天线和波束成形 天线。全向天线在各个方向上都具有相同的增益，广泛应用于同步信号、广播信号，公 共导频，控制信道等【⑷。4GMIM0波束成形天线将信号功率集中在特定方向上，常用于 数据传输信号。然而其天线阵元数目较少，排布方式多呈线性排列，因此4G网络产生的 波束密度较小，波束较宽。在5GMassiveMIMO中，所有的信号都具备波束成形的性质， 同时天线阵元数目的增加和排布方式的变化，使得5G波束的可控性得到增强，可产生较 为密集的3D波束。由此可以看出，5G波束本身就具备较强的方向性，可以根据波束的方 向判断出信号大致的方向角度。因此本文结合5GMassiveMIM0的波束特点，提出一种 新的通导融合LOS基站选择方法。
3.1.2通导融合LOS基站选择架构与方法
根据不用场景下终端能接收到的不同基站信号的数目，本文将场景分为空旷场景和 复杂场景。在复杂场景下，终端能与基站建立连接的数目较少（一般为3个以下），而且 终端与各个基站之间不存在视距路径；在空旷场景下，终端能与基站建立连接的数目较 多（一般为3个以上），且至少存在两个及以上的基站位于终端的视距范围内。对于复杂 场景下NLOS基站的判断将在第四章进行讨论，本章将重点讨论在空旷场景下的LOS基 站选择方法。
超密集网络下的空旷场景下如图3-2所示，由于建筑物的遮挡终端P处于基站A的非 视距盲区中，此时如果利用基站A测得的AOA和TOA信息进行定位，定位误差较大。而 同时终端P处于基站B、C的视距范围内，因此可以选择基站B、C中的一个作为最优基站， 进行单基站定位的解算。
20



图3-2 UDN网络下的一种典型场景
在5G网络定位架构中，主要包括以下核心网元BI：
(1) AMF (Access and Mobility Management Function,接入及移动性管理功能)： 主要负责在UE和LMF、LMF和NG-RAN之间传输定位消息，并且负责LMF的选取；
(2) LMF ( Location Management Function,定位管理功能)：是整个定位架构的核 心网元，负责对定位请求进行响应和处理。包括从下行或上行链路获取信号估计结果， 并且还可以从NG-RAN处获取相关的辅助定位数据；
(3) UDM (Unified Data Management,统一数据管理功能)：是定位架构的存储网 元，可提供相应的隐私设置和授权信息等；
(4) NG-RAN (Next Generation — Radio Access Network, 5G 无线接入网)：主要包 括两种类型的节点，gNB和ng-eNB；
(5) MEC (MobileEdge Cloud,移动边缘云服务器)：在超密集组网下，添加MEC 网元，为多个基站提供云计算服务。

图3-3基于波束定位架构图
当终端P发送定位请求时，触发定位单基站选择过程，具体步骤如下：
(1) UE向AMF网元发送LCS定位服务请求，因为5G不同场景下对定位服务提出了 不同需求，因此该请求包括对定位的精度、定位的响应时间、定位服务的可用性等一系
21 列参数的要求；
（2）	AMF向UDM查询该服务是否有相关隐私设置及相关授权信息；
（3）	AMF根据UDM返回的授权结果，判断是否授权失败，如果失败则直接跳到步 骤（8）,做出授权失败的响应，定位请求提前结束；
（4）	AMF根据当前用户所处的小区选择LMF；
（5）	由于大规模天线单元可根据来波的方向，对波束进行成形，成形后的波束大致 角度可被LMF网元获取。因此MEC使用多个基站波束的角度进行重叠区域的判断：如果 3个基站的波束仅有2个有方向重叠区域，那么另一个则处于非视距中，因此可将其排除。 剩下的两个可以通过Cell ID来进行选择；
（6）	根据步骤（5）中选取的单基站进行定位结果，进行相应的参数估计和定位结 果计算；
（7）	LMF向AMF响应定位结果；
（8）	AMF向UE响应LCS服务请求，完成整个定位过程；
（9）	加密存储定位结果，可用于用户历史轨迹的查询；
本小节提出了的全新5G网络定位架构，通过引入MEC移动云计算服务器，可利用波 束成形的特点，完成空旷环境下LOS基站的选择。其性能优势相比传统的5G定位架构主 要体现在：
（1）	时间效率。通过引入MEC网元，降低了终端与基站之间建立连接的次数，仅 利用广播控制信道即可获取波束的方向，并且在整个密集网络内，完成波束相交区域的 判断与视距基站的选择，并不需要对信号进行参数估计。这显然提升了定位服务的响应 时间。
（2）	资源占用。传统的5G定位架构需要多次终端和基站之间的交互，才能完成在 终端在多个基站环境下服务基站的选择。终端与多个基站建立连接，浪费了大量的信道 资源，当出现大量定位服务请求时，会导致网络拥塞。因此，本文将计算放置在与多个 基站相交互的MEC网关上，节约了无线信道资源，从而服务更多用户。
本小节提出的基于波束定位的架构图同样可适用于不存在LOS基站的情况，即复杂 场景下。当MEC网元识别到UE能够接收基站的数目小于3或波束之间没有交点时，步骤
（5）的选择方法失效，具体方法将在第四章讨论，本章只考虑存在LOS基站的情况。
3.2远近场信号接收模型
3.2.1远近场分析
根据在第二章中的分析，由于5G异构网络引入了超密集组网架构，因此在基站一侧 对来波信号进行角度和时延估计时，需要考虑近场问题。在远场条件下，阵列的孔径差
22
远小于终端到基站的距离，因此可以将信号等效成平面波，此时对估计得出的角度和时 延的影响完全可以忽略不计。随着基站密度的增加和天线阵元数目的增多，阵列的孔径 和终端到基站的距离相比不可忽略，如果仍以平面波模型进行角度和时延估计，将导致 定位误差增加。
在远场模型中，信号源假设位于大规模阵列无穷远处，因此到达阵列视为平行波， 每个阵元的接收角度一致，阵列间的接收相位差也一致；在近场模型中，信源位于阵列 附近一点，从该点发出信号依次到达各个阵列单元，这就使得每个阵列单元的接收角度 不同，阵列间的接收相位差也不同。具体如图3-4所示。
1
1
1 / /
1 / /
1 / /
1 / /
1
:	才第k个信源
1 //
1 //
1 / /


/



7

/



'''X

-M -A/ + 1
…0 d 1
…A/-1
M
-M -M + 1
…0 d ].
•- M-l	M

(a)远场模型



(b)近场模型

图3-4远近场下信号接收模型图
信号在传输过程中，幅值和相位是表征信号特征的两大参数。其中，幅值反映了接 收信号的强度，相位包含了接收信号的角度、时延等信息。通过对图3-1中近场模型下接 收信号的分析，以坐标轴0处的阵元为参考点，第Z个阵元和参考点的相位差表示为：
久纳	(3-1)
其中
2^dcos0.	一 小
5 二——1	(3-2)
¥k^^-sin20k	(3-3)
特别地，〃表示相邻阵元的间距，久表示信号的波长，仇表示第力个信号和阵元的 夹角，*表示第力个信号的传输距离。显然，当处于远场模型时，信源假设距离阵元无 穷远，即rk~coo此时，妙匕0,相位差®的二次项可以忽略不计。而在近场模型时， 4工8,相位差％的二次项不可忽略。
通过上述分析可以发现，不管终端和基站的关系是近场还是远场模型时，在时域的 相位差中始终包含信号的到达角度参数。而在只有在近场模型时，相位差中包含时延， 即距离参数，由于远场模型成立的前提是八心8,所以在时域的相位差中并不包含距离 参数。因此在对角度和时延进行混合场的联合估计时，需要考虑到这一点。
23

3.2.2信号时域接收模型
假设有K个窄带不相关的远场和近场信号共同射入由2M + 1个阵列单元组成的大 规模天线中，其中远场信号&个，近场信号K2=K-KX个。根据上一小节中的推导，得 到第i个阵列单元在时域中的接收信号表达式，如下：
严 + X s」严 +认）	（3-4）
其中，S"©和”分别表示远场和近场信号源，将以上表达式改写成矩阵相乘
的形式，得到：
x(t) = As(t)+n(t) = AFSF (t)+ANSN (t) + n(t)
(3-5)
其中，



x（t）=兀屛）,胆如兀（/）F
(3-6)

AF =[Q(0"
(3-7)

SF(t) = [Sg(O，"%0(/)F
(3-8)

AN =	‘ ％+i )，…‘。(裟 j N)]
(3-9)

SN(0 = \-SKi+\,far (0, •••» SK,far (^)]^
(3-10)

n(t) = [—(')，•••，%(')]
(3-H)
其中，X（t）表示观测信号的矩阵，AF表示远场信号对应的阵列流形，AN表示近场 信号对应的阵列流形，n（t）表示信号在传输过程中的加性高斯白噪声，$F（t）表示远场信 号矩阵，sMt）表示近场信号矩阵。具体地，在远场阵列流形A，中，由于r严g,因此
。（目“）=［「恥,...,1,..,必丁	， 在远场阵列流形 AN 中，
"（0＜） = ［「5册划，）,...,1,...,/如+%）仁
3.2.3信号频域接收模型
在时域中，可以利用天线位置造成的空间相位差进行角度估计。然而在对时延进行 估计时，无法将远场信号的距离参数反应到空间相位差中，因此需要构建由时间造成的 相移。正交频分复用技术（OFDM）被广泛应用于5G通信中，其能够实现复杂度较低且 具有较高的频带效率，这为在频域上进行时延估计提供了条件。
本小节只考虑图3-4（a）中远场模型，同样以阵元0为参考阵元，则第丘个远场信号到
第z•个阵列单元的相对时延为:
(3J2)
若在时域内发送的信号为单位冲激响应§（/）,耳表示第£个远场信号到参考阵元的 传输时延，仪表示传输衰减系数，则在第〃个观测区间内，第「个阵元的信道冲激响应 为:
24

矿()=乞—q—O，) + ”,(D	(3-13)
假设该OFDM系统包含Z个子载波，则对每个信道的冲激响应在子载波上做傅里叶 变换，第2•个阵元的接收信号对于第I个子载波的频域响应可表示为：
= £仅尹”曲以*")+切⑴	(3-14)
，A-=l	，
其中，/表示载波频率，"为子载波间隔，耳丿(/)表示均值为0,功率为b2的加性 高斯白噪声。因此在第Z个子载波上的频率响应为：


(3-15)
其中，



7 =由,厂2,…"KJ
(3-16)

Eg"」
(3-17)


(3-18)
然后，定义


4(SG =[吗(巧,<1)，勺(了2,<2)，•••</(/])]
(3-19)
ai (q	=[坷(q 5	)5 ai (兔 5 d_M+lai^k 5	)]
(3-20)
其中，©仏久)之切附师叶6)且


於")=［炉,於),
(3-21)

"严=［£)，嗚，…，嘰］
(3-22)
假设一共有N个观测区间，因此，将式(3-15)表示为：


Q=4(T，S+吗
(3-23)
其中，




(3-24)


(3-25)
根据上述分析，可将厶个信道频域的响应进行排列而得到扩展信道频域响应矩阵:

一旦)][4)(^<)1	「如_

H =
H,	A, (r, G	n.
/ =	1 .	B+ ? =A(r,QB + n
(3-26)

HL\ k(^oj

通过以上构造扩展信道的频域响应，虚拟带宽变为原来的(2M + 1)倍，阵列孔径扩 展为(2M + 1)L-1,因而对信号参数的估计精度会提高。

3.3基于混合阶的远近场角度时延估计
目前，超分辨率角度时延估计算法主要分为两大类：基于信号子空间分解的MUSIC 算法和基于旋转子空间不变的ESPRIT算法。在MUSIC算法中，需要对频谱进行搜索，存
25
在着计算量较大的问题；在ESPRIT算法中，可直接通过公式求解出估计的角度和时延, 但需要进行参数匹配。针对以上问题，本小节综合两种算法的优点，提出了一种基于混 合阶的远近场角度时延估计算法。
3.3.1算法原理
对于远场信号，首先在时域接收信号模型下，令距离r = oo,利用MUSIC算法进行 一维远场DOA估计；然后在频域内，根据第一步得到的远场DOA,再次利用MUSIC算法 进行一维远场TOA估计。对于近场信号，首先使用高阶累积量对角度和时延参数进行分 离，得到两个只包含DOA的四阶累积量矩阵，然后利用ESPRIT算法对近场信号DOA进 行估计，最后将得到的DOA值代入一维MUSIC搜索中，得到近场信号的距离估计。
在对远场信号进行参数估计时，该算法避免了直接对频域内的信号进行二维频谱搜 索，减少了运算复杂度；同时，在对近场信号进行参数估计时，不需要进行参数匹配的， 并减少了高阶累积量的计算次数。
3.3.2算法步骤
1 •远场DOA估计
首先对式(3-5)中的时域接收信号求协方差矩阵人，并对协方差矩阵进行特征值分 解，得到：
R = £{x(t)xH(t)} = UsNU? + U卫 Q：	(3-27)
其中，臥是K*K维的对角矩阵，对角线上是中K个最大的特征值，由这K个最 大的特征值张成了(2M + 1)*K维的信号子空间乞。£”是(2M + 1-K)*(2M+1-K)维的 对角矩阵，对角线上是虑中去除信号子空间后剩下的特征值，由这(2M + 1-X)个特征 值张成了(2M +1) * (2M +1 -K)维的噪声子空间£7”。
由于信号子空间和噪声子空间具有正交关系，因此，我们可以得到关于(&/)的频谱
1
aH(0,r)UnU^a(0,r)
其中在{& =仇/ = 8}处，频谱存在&个谱峰，对应于&个远场信号，因此
可以将二维谱峰搜索转换为一维谱峰搜索，进而得到远场信号的DOA：
% =吨 max{町- J 万 7 - }	(3-29)
a气&,8)U”U” a(0,8)
2. 远场TOA估计
26

同样，对式(3-26)中的频率响应矩阵求协方差矩阵尺，并对协方差矩阵进行特征
值分解，得到频谱搜索函数Fg)：
F(0,r) = r	J		(3-30)
由于在步骤1中，通过对时域频谱函数的搜索，己经得到了远场信号的DOA,因此 频谱函数在0 = Q处同样存在着心个谱峰，因此可以从距离参数对Fg)进行
谱峰搜索，进而得到远场信号的TOA。
(3-31)
3. 近场D0A估计
根据式(3-4),我们可以得到阵列的接收信号的四阶累积量：
cum{Xm{t\X*n(t\X*p(t\Xq{t}}
K
=y c	川(旳fIpf)磁+[(沪72)-(护一『)】}必
厶/ ^->Sk.near
k^K{+\
其中，m,n,p,qe[-M,M], c%* = cum{sknear(Z),s*knear(/),s*knear(t),sknear(/)}表示第£ 个信源的峰度，取n = -m, q = —p,则式(3-30)简化为：
c咖无”⑴乂⑴,X；⑴,兀(/)}= X	皿	(3-32)
R=K]+1
显然，在公式(3-32)中去除了近场信源的非线性部分，只保留了角度参数，因此 接下来可以利用ESPRIT算法的思想，对四阶累积量中的角度参数进行估计。首先，构造 两个重叠的子阵，如图3-2所示：
子阵丫
f亠	二’
f'1	 -				 " ■- ■'…	'"2	、
■■'、■a
-M -M +1
…6
< . ..
1
…A/-1
M
v


')

子阵Z
图3-5划分的两个子阵

由图可知，子阵Z包含前2M-1个阵元，子阵丫包含后2M-1个阵元，它们之间具
有固定的相位差，得到的两个子阵在时域上的接收数据为： Z(/) = [z_“+](/),
2一M+2 (，)>•••，(01 二[x„ X-M+] ⑴，…,％2(0] Y⑴=[如+i⑴，灯+2⑴，…,yM-i⑴] =[X_M+2(/)，X_ A4+3
根据子阵的输出数据，可以分别构造两个(2M-1)*(2M-1)维的四阶累积量矩阵G
27

因此，从公式(3-42)中可以得到以下关系：
Ey = EXT]^T = EXP	(3-43)
显然，P和①具备相同的特征值，因此可以通过求解尸的特征值，进而得到①对角 元素的值，从而解算出DOA。因为在实际环境中，测量计算得到的£\和£\存在误差， 因此可以通过总体最小二乘准则对矩阵①求解。
首先构造矩阵，并将其特征分解:



将E分解成K2 * K2大小的子矩阵:

P = -E^
最终得到近场信号的角度估计值：
6k = arccos {-2 arg(2*) / (8兀力)}
其中，心表示公式(3-46)特征分解后的特征值大小。
4. 近场TOA估计
由于经过步骤3得到了近场信号的DOA值，那么同步骤1、2相似，在对近场TOA进
行估计时，同样利用时域信号接收模型，构建协方差矩阵，协方差矩阵分解后，将步骤
3得到的DOA值，依次代入频谱搜索函数，从而得到近场DOA值对应的近场DOA值。
=arg max {
综上，总结上述算法步骤为:
算法一：基于混合阶的远近场角度时延估计算法
1R求:
完成远近场的角度和时延估计
输入：
X(t)：阵列接收信号
输出：
{0k,rk}:远近场下的角度和时延估计值
步骤；
1. 根据公式(3-27)计算接收阵列信号时域上的协方差7?,并对其进行特征分 解，从而构造频谱搜索函数，令rk =co,得到远场信号的角度估计值仇；
2. 通过公式(3-26)构造扩展信道的频域响应H,并计算接收阵列信号频域上 的协方差，同样构造频谱搜索函数，根据步骤1得到的远场信号角度估计值Q, 得到远场信号的距离估计值;
3. 根据公式(3-35) (3-36)构建划分的两个子阵四阶累积量，由公式(3-39胸建 四阶累积量矩阵C,并对C进行特征值分解，得到信号子空间；
4. 利用子空间旋转不变性，将信号子空间分为两部分，并得到(3-43)所示的关 系，最后利用总体最小二乘准则求解，得到公式(3-47)近场信号的角度估计值Q ；
5. 同步骤1,将步骤4得到的近场信号角度估计值Q,代入频谱搜索函数 中，得到近场信号的距离估计值。

3.4实验仿真
3.4.1估计性能分析
本小节提出了一种基于混合阶的远近场角度估计算法，通过构建时域和频域上的信 号接收模型，解决了远近场条件下的角度和时延联合估计问题。对比ESPRIT-Like算法 "6】、高阶MUSIC算法HQ得岀以下分析。
在可估计参数维度方面，ESPRIT-Like算法和高阶MUSIC算法都是基于时域信号接 收模型进行参数估计，在该模型下，远场信号的距离被假设为8,因此无法得到对远场 信号的距离参数估计。相比之下，本文所提的算法，通过联合时域和频域接收模型，完 成了对混合场的角度和时延全估计，提升了信号参数的估计维度；
在参数匹配方面，因为基于MUSIC的算法是利用谱峰进行估计值搜索，所以不存在 参数匹配问题，而在ESPRIT-Like算法中，由于是通过计算的方式得到信号参数的估计 值，所以需要进行参数匹配。本文提出的方法先使用ESPRIT算法估计DOA,再使用 MUSIC搜索TOA,避免了参数匹配；
在算法复杂度方面，主要考虑矩阵的构建与分解、谱峰搜索以及扩展信道频率响应 的计算。
在ESPRIT-Like算法中，一共有4个M维的高阶累积量矩阵，然后对3M维的高阶累 积量矩阵进行了特征值分解，所以算法复杂度为：
O(36M2N+-(3M)3)
在高阶MUSIC算法中，一共有1个4M + 1维的高阶累积量矩阵，并将其分解，进行 了 1次谱峰搜索DOA,步进为A0a K次谱峰搜索TOA,步进为2。所以算法复杂度为:

本文所提的算法中，一共有1个扩展信道频率响应矩阵，2个2M-1维的高阶累积量, 对1个4M-2维的高阶累积量矩阵进行了特征分解，进行了 1次谱峰搜索远场DOA和共 K次谱峰搜索远近场TOA。所以本文所提算法的复杂度为：

经过对比发现，ESPRIT-Like算法的复杂度最低，高阶MUSIC算法复杂度居中，本 文所提算法的复杂度最高，这是因为要对远场TOA进行估计导致需要变换到频域进行时 延估计，提高了算法的复杂度，然而，当不进行远场TOA估计时，本文所提算法的算法 复杂度仍小于高阶MUSIC算法。
3.4.2估计性能仿真
为了验证本章提出算法的性能优势，本小节将在相同条件下，对ESPRIT-Like算法、 高阶MUSIC算法和本章所提的算法做仿真比较。
仿真实验开始前，先对环境参数进行一些设定。由于要比较的其它算法不具备对远 场信源的时延估计的能力，因此将频域信号接收模型下的参数设置为固定值，不参与和 其它算法的比较，即：
表3-1频域接收模型下的参数设置
参数
取值
子载波数量厶
16
载波频率犬
3.0 /30GHz
带宽B
50MHz
观测区间数
100
FFT点数
64
假设每个大规模天线阵列的阵元数目为M = \6，阵元间的间距为d = 2 /8 ,载波频率

根据异构网络的组成取3GHz或30GZfe,定义均方根误差（RMSE）为：
1 隆 K I
其中Me表示蒙特卡洛仿真实验的次数，在接下来的实验中取1000, K为路径数目,
九丿表示通过算法估计得到的信号参数值，人j表示实际的信号参数值。在仿真中，添加 的噪声为加性高斯白噪声，大小定义为：
SM?=101g
现有两个近场信源，角度和时延参数分别为（30°,1.5刃和（60°,2刃，两个远场信源, 角度和时延参数分别为（25。,8）和（55°,8）。
实验仿真（a）：比较不同信噪比下，不同算法的角度和时延估计均方根误差。快拍数
取500,信噪比SM?从-5dB到30dB分布。最终的仿真结果如图3-6、图3-7所示。
31


图3-7 TOA估计误差和信噪比之间的关系
通过以上仿真图可知，本章所提出的算法在D0A和TOA估计上，相比ESPRIT-Like 算法和High-MUSIC算法都具有优势。其中ESPRIT-Like算法由于在构造子阵列的时候损 失了一半的阵列孔径，所以其DOA和TOA估计的性能在里面表现最差。在DOA估计中, High-MUSIC算法和本章所提出的算法相近，而在TOA估计中，二者存在明显差别，这 是因为High-MUSIC算法在对时延进行搜索时，利用了高阶累积量，而高阶累积量的累 积误差大于二阶累积量，因此在TOA估计中，本章所提的算法相比High-MUSIC算法具 有优势。
实验仿真(b)；比较不同快拍数下，不同算法的角度和时延估计均方根误差。信噪比 SNR = \5dB，快拍数从100到1000分布。最终的仿真结果如图3-8、图3-9所示。
32


通过以上仿真图可知，随着快拍数的增加，用于矩阵运算的数据增加，由此带来了 D0A和TOA估计误差的减小。而且，当快拍数大于500时，快拍数对估计误差的影响较 小，快拍数越大将导致运算复杂度呈指数型增长。不同算法之间的比较同实验仿真(a)— 致。
实验仿真(c)：比较不同快拍数下，不同算法的复杂度，其中搜索步进△ 0=O.OV, Ar=0.01A o
33




100	200	300	400	500	600	700	800	900	1000
怏拍数

图3-10不同算法的复杂度比较
通过对算法复杂度的仿真可以看出，由于ESPRIT-Like算法不需要进行谱峰搜索， 所以算法复杂度最低，而高阶MUSIC算法由于使用了四阶累积量进行谱峰搜索，所以算 法复杂度最高。本文所提出的方法复杂度居中。
3.5本章总结
本章的研究重点主要集中在空旷区域下LOS基站的选取与远近场模型下的角度时 延估计算法。通过在5G网络定位架构中引入MEC网元，从而利用波束指向性的特点，实 现了LOS基站的快速选恥在远近场条件下，对时域和频域上的接收信号模型进行了构 建，提出了一种基于混合阶的远近场角度时延估计方法。该方法尽管在算法复杂度上存 在一定缺陷，但它完成了对远场条件下时延的估计，并且在远近场角度时延估计中，相 比ESPRIT-Like算法、高阶MUSIC算法精度都有所提升，为实现单基站定位提供了有力 的数据支撑。
34
第四章NLOS场景下PDR约束的单基站定位方法
复杂环境下，终端与基站之间的传输路径受到建筑物等外界因素的遮挡，存在终端 可接收的基站信号数目较少，或直射径信号被遮挡的情况，因此需要在非视距环境的条 件下对单基站定位方法进行分析与研究。本章将重点解决非视距情况下单基站定位问 题。首先通过引入基于惯性导航的PDR约束，进行NLOS基站识别，PDR的加入使得在基 站数目较少的情况下，增加了额外的观测量，从而完成非视距定位的第一步；然后构建 了NLOS信号传播模型，在位置解算过程中，通过对NLOS信号的角度和时延估计参数进 行聚类，以排除干扰点。最后在假设基站与建筑平面坐标已知的情况下，利用虚拟基站 的方法将NLOS信号等效成LOS信号，通过PDR估计得到的终端运动状态信息和冗余路 径进行二次加权位置估计。该章节主要面向极端复杂环境下的定位方法，旨在提升定位 服务的可适用范围。
4.1基于PDR约束的NLOS基站判断方法
在3.1章节中，本文结合波束的特点，提出了一种空旷场景下的定位架构，通过波束 相交的方式选择出LOS基站。但在一些复杂情况下，存在移动终端接收基站信号数目受 限等问题，此时通过波束的方法无法判断该移动终端是否处于LOS中。惯性导航系统 (Inertial Measurement Unit, IMU)的发展为室内外定位提供了又一数据来源，因此本 文将结合惯性导航技术提出一种新的LOS/NLOS基站判断方法，同时构建NLOS单基站 情况下信号传播模型。
4.1.1 NLOS基站判断方法
惯性导航器件主要包括：加速度计、陀螺仪。其中加速度计根据牛顿第二定律， F = ma得到物体的加速度，对加速度积分后可得到物体的运动速度，二次积分后可得到 物体的位移；陀螺仪在重力力矩的作用下快速旋转的轴方向即是物体运动的方向。因此， 我们可以通过积分的形式，从惯性导航器件中读取到物体的运动状态参数。现阶段，惯 性导航器件已经成为5G移动设备的标准配置，这为复杂环境下导航定位问题又提供了一 种解决思路。


图4-1相邻两个NLOS位置点信号传播路径
图4-1表示一种典型的单基站NLOS情况示意图，A点和B点分别表示两次位置相邻 的定位服务请求，C表示提供定位服务的单基站。在没有障碍物遮挡的理想情况下，线 段AC和BC表示LOS信号传播路径，此时对应的角度和时延估计参数分别为q, 02,叶， 2;而现在由于障碍物的遮挡，基站与终端之间不能够建立起信号的直接传输，只能依 靠散射体的散射，所以两次定位请求信号的实际传输路径为脳'C和BBC,对应的角度 和时延估计参数分别为切，g, r；, r20心纫表示通过加速度计测量得到的两次请求之 间的位移距离。
接下来根据基站C和两个位置点A、B的几何关系，计算A、B两点的距离。
■当A、B两点处于LOS环境时，根据基站C估计得到的角度时延参数G，
&2, I 4 ,可得A、B两点之间的LOS距离dLOS如下：
dLOS = J卅+ 厅 一2M*COS（0 -0J	（4-1）
■当A、B两点处于NLOS环境时，根据基站C估计得到的角度时延参数0；,
0；, 片，可得A、B两点之间的NLOS距离d皿os如下：
dNLOS = J*+§2-2T^*COS（&2-切）	（4-2）
在LOS场景下，定位误差来源主要包括角度和时延的估计误差&帀和金，即：
°严久冏+&5	（4-3）
°2=&2嗣+°2,帀	（4-4）
尸1=4泅+体”	（4-5）
r2^h.real+r2,err	（4-6）
在NLOS场景下，定位误差来源不仅包括角度和时延的估计误差，还包括非视距误 差0”加和仏s，即：
（4-7）
&2+0,”加	（4-8）
36


图4-2相邻两个位置点信号传播路径可能情况
因此，仅仅通过threshold和2*5的大小只能判断出A、B两个位置点的信号状态相 同的状况，当出现A、B两点的视距或非视距情况不同时，需要增加额外的约束参数。由
37
于受到障碍物的遮挡，信号需要经过其他物体的反射，从而绕过障碍物才能到达终端或 基站，显然在该过程中，非视距给信号传输距离的估计带来了正偏差，角度偏差可能为 正或负。因而，可以通过额外比较连续两个位置点之间的信号传输距离差。(单位m), 从而对每个位置点的信号状态做出判断。
综上，最终得到单基站条件下NLOS基站的判决策略：
threshhold > A.*3,	B都为LOS
threshhold < 2*5且：—斤〉A为LOS, B为NLOS
threshhold < 2 * 6且0 < q — q < 4, A、B都为NLOS
threshhold < A*3, r2-r{ <0, A为NLOS, B为LOS
4.1.2 NLOS信号传播模型
3GPP中将终端和基站建立一次连接的收发信号称为一个信号簇，信号簇中包含一 个主径和多个非主径，主径表现为增益最强。复杂环境下建筑较为密集，终端和基站之 间由于受到建筑物等障碍物的遮挡，存在大量多径NLOS信号。根据受遮挡情况不同， NLOS信号可以分为NDDP (non-dominant direct path )和UDP (undetectable direct path) 两种类型[48],如图4-3所示。

图4-3两种不同的NLOS信号
在NDDP非视距信号中，终端或基站能够接收到直射径信号，但是该直射径信号并 非整个信号簇的主径，这容易导致直射径漏检的情况出现。在UDP非视距信号中，由于 受遮挡比较严重，终端和基站之间不存在直射径，二者完全不可见，由该信号进行定位 将会导致较大的定位误差。在5G异构组网架构下，大规模天线具备波束成形的能力，毫 米波的路径损耗较大，穿透能力较弱，所以在本文中的NLOS多径信号的类型假定为 UDP,即终端和基站之间不存在直射的信号径。
考虑到复杂环境下障碍物密集，在非视距情况下，散射体位置较为固定，基站与终 端之间的反射路径较为集中在某些反射体上，同时存在信号多次反射的情况。为了便于 接下来的理论分析，本文采用的NLOS传播模型如下：根据基站周围环境布局结构，同 一位置点的终端可能接收到经过多次墙面反射的信号，将每次反射的区域定义为以某一
38 点为中心，半径为固定值的圆形区域中［例。该区域中信号的时延和角度估计参数具备一 定的聚集性。由于人群走动等环境因素影响，可能存在一定数量的误差区域。因此,NLOS 信号传播模型如下图所示：

用户终端	V
误差区域
图4-4 NLOS场景定位模型
在上图中，圆形区域表示反射区域，菱形区域表示由于环境因素干扰导致的误差点， 基站对上行信号进行角度和时延估计得到(必如丸2,...“, %表示信号从终端到基站 的传播距离，可以通过时延乘以光速获得，G表示大规模天线阵列估计得到的方位角， "表示多径的总数目。在接下来的讨论中，为了便于理论分析，需要对NLOS环境作岀如 下假设：
(1) 假设基站位置已知，反射体所在直线和基站在统一坐标系下，反射体所在直线 可通过建筑平面结构图已知为Ax + By + C = 0.
(2) 因为信号在反射过程中存在损耗，以典型的建筑材料为例，其反射损耗系数为 0.5,那么每反射一次，信号的能量值将减半a〕,当反射次数大于等于三次时，信号的衰 减超过87.5%。所以在本文中只考虑反射一次和反射两次的情况。
4.2基于虚拟基站的NLOS位置解算方法
4.2.1参数聚类
根据构建的NLOS场景定位模型，可知针对经过相同反射体反射的路径，其角度和 时延参数具备相似的分布，因此，本文将采用聚类算法对角度和时延参数进行聚类，通 过聚类算法可以实现无标签数据的分类，从而对误差反射点的角度和时延进行排除。由 于通过时延得到的信号传输距离幺和角度估计Q在数量级上存在较大差异，直接用于聚 类效果较差，因此本文将样本数据集定义为S = {»S2,其中
39
5,. = {(//,., V,.) I = di * cos 6>., V,. =a*sin0}	(4-15)
显然，在不同反射次数之间，信号的传输距离％存在差异，经过的反射次数越多， 么越大，而不同反射次数之间的0并无明显规律。目前，现有的聚类算法较多，其中K- Means算法使用欧式距离表征各个数据点的差异，将数据点划分到距离最近的中心点中， 并更新中心点的位置坐标。尽管K-Means算法计算快捷，但需要已知数据分类的组数， 并且运行结果与初始点的选择有关。在本文中，路径的反射情况未知，无法提前获取分 类的组数，孤立的干扰点对聚类结果的影响较大。因此将采用DBSCAN基于密度的聚类 算法来进行数据集的分类，该分类方法不需要知道分类的组数，而且对偏离反射区的干 扰点单独划分类别［旳。
DBSCAN算法的关键是确定簇的密度阈值MinPts和簇的半径参数r。其中，MinPts的 值比较容易确定，当总数据量为"时，MinPts—般取"/25」［52］。根据第三章的实验仿真， 可知在对信号的角度和时延参数进行估计时，存在一定的时延误差和角度误差, 所以数据集S中的真实数据值为：
jui = (d. + A^.)* cos© + △$)
Vi = (% + AJ;.) * sin(目 + △ g)
由于△目较小，因此cos△目Hl, sinA^»A^o将上式展开，得到:
禺=di cosq + \di cos0 -(％ + Ac?.)A0j sin0j = dt cos0 + Ax：
Vi = di sin 0i + sin 0 + (g + △%)△目 cos 6i = dt sin
其中，Ax,和®表示由于测量误差等导致数据偏移量。最终，簇的半径参数可取:
r = j2+3	(4-18)
具体算法流程，如下所示。
算法二：DBSCAN基于密度的分类算法
需求：
完成角度和时延样本数据集S的分类，排除干扰点
输入：
S：样本数据集
r；簇的半径参数
MinPts：每个簇的密度阈值
步骤：
6-	标记所有的数据对象为non-visited;
7.	随机选择一个non-visited的对象s,并将该对象标记为visited;
如果对象啲噸域内至少有MinPts个对象，则执行步骤3
&	创建一个新的簇C,并将s添加到C中;
9. 令N为对象s的r领域中的对象集合；
For循环N中的每个点s，

如果s'是non-visited的状态，则执行步骤5
10. 标记 s'为 visited；
如果s啲噸域至少有MinPt洽对象，则执行步骤6
11. 将这些对象添加到集合N中；
如果s，不是任何簇的成员，则执行步骤7
12. 将s•添加到集合C；
END For；
13. 输出集合C；
否则标记s为噪声；
直至没有标记为non-visite娥态的对象.
~	^的情况下，对时
延和角度参数进行聚类，从而能够排除相应的NLOS误差点，聚类效果如下图所示，显 然可以排除噪声干扰点。



(b)聚烁；数据集
图4-5聚类前后数据集对比
4.2.2 NLOS虚拟基站生成
由于非视距误差的存在，并不能将第三章估计得到的时延和角度值用于终端位置坐 标的计算，因此本小节将从虚拟基站的角度出发解决单基站NLOS定位问题。首先以单 个反射体上的单次反射路径为例，说明虚拟基站的原理。
41


在图中，假设反射体为平滑的墙面，且所在的直线l-.Ax + By + C = 0可通过建筑平面
结构图已知。因此根据BS,辺坐标七=［兀,必F，可计算出关于直线/对称的虚拟基站
的坐标％：
-2Z cos(^ / 2 -
2L sin(龙 / 2 — 0)
其中，Z表示BS丽到直线/的距离，°作表示直线/与x轴的夹角，计算公式如下： 厶=±| Axb + Byb + C\/^A2 + B2	(4-20)
(p = - arctan" / B)	(4-21)
厶的正负取决于Axb + Byb + C的正负，当其大于0时，Z的取正值，否则取负值。
因此结合以上信息和通过大规模天线阵列估计得到的时延和角度参数，可计算终端UE
的位置坐标XJE :

其中，£•和仇分别表示第j条NLOS信号对应的传输距离和接收角度。复杂环境下 反射体的数目较多，单个NLOS信号的路径可能经过多次反射，如图4-7所示。
42


图4-7多次反射虚拟基站原理图
假设存在/个反射体，其所在直线分别表示为（厶仏‘…仏），我们可以通过对单次反射
虚拟基站生成方法进行迭代，从而生成多次反射的虚拟基站，迭代的基站初始坐标为

-2L; cos(;r/2—
® ~ X"" + _ 2L. sin(” / 2 — ％)
£ cos 3.
直至迭代至心/此时得到的XUQ即为最终得到的终端坐标值。
以上讨论的虚拟基站生成方法是基于单一的NLOS传播路径一次或多次反射的情 况，但复杂环境下，反射体数目增多，不可避免的导致终端和基站之间存在多条NLOS 路径。因此，本文将创建一个终端位置候选集合，从集合中选取正确的位置并计算相应 的虚拟基站。
假设定位场景中共有Z个反射体，”条NLOS路径，首先根据NLOS信号模型中的 假设，单个反射信号反射次数不大于2,因此将/个反射体按照任意顺序进行排列组合， 共得到Total种可能：
Total ^A'+Aj	（4-25）
其中，£表示排列数。然后通过迭代的方式计算不同反射体组合下可能的虚拟基站 坐标，构成最终的候选集C = {cl,c2,...,cnum},加劝表示去除重复元素后虚拟基站可能的 个数。对于每一条NLOS路径对应着集合C中可能的虚拟基站坐标，通过公式（4-24） 计算，可以得到第j条NLOS路径对应的终端坐标候选集U产{UE「,UEf,...,UE— 显 然，在每个终端坐标候选集U},U2,...,Un中都存在一个正确的终端位置估计坐标。因为存 在角度和时延估计误差和环境噪声，同时考虑到反射次数不超过2次，因此可以通过穷 举的方式在U„U2,...,Un中找到”个期望的终端坐标，使其之间的欧式距离最小。
43

4.2.3二次加权位置估计方法
根据以上推导过程，可以得到任意一条NLOS路径所对应的虚拟基站的坐标 “	并计算出实际终端的位置坐标xUEii=[Xi,y,Y.但由于NLOS信号在估
计和反射过程中存在误差，如果利用单一 NLOS路径进行解算将导致定位结果不准确。 所以本节将对多个NLOS路径兀余信息进行加权估计，以减少估计误差和环境误差的影 响。假设第,条NLOS路径估计得到的时延和角度参数为(£厨)，由于存在噪声误差△石 和因此：
巧=$+△巧	(4-26)
9i = ei+\6i	(4-27)
其中，$和$表示理想情况下的NLOS路径的时延和角度，即：
Q =arctan[(儿厂必)/(“-£)]	(4-28)
苴先将终端和虚拟基站之间的几何关系线性化，便于后续矩阵运算：
—2XjX — 2yt y+ x2 + y2 = c2(ri — Ar)2	(4-29)
x sin 目 一 y cos 0 = xi sin 0i - y(. cos - cri sin	(4-3 0)
因为天线阵元数目的增加，基站的测角能力提升，因此邂较小，sin",可近似为 cos A6；.近似为 1。
将上述公式写成矩阵的形式：
h = Gz + N
其中，
(4-32)
xn sin 0n 一 yn cos 0„
—2X]	-2	1
-2% -2yn 1 G =.
sin 0\ 一 cos Qi 0
sin -cos& 0
N = [-A 巧2 一 2"[△巧，…厂△ 丁； 一 2crn △ q, "i △ q,・・.,c乙△仇 F	(4-34)
Z^[x,y,x2+y2]表示待估计的量，可以通过加权最小二乘的方式计算得出，即：
Z = (GyWG)}GrWh	(4-35)
其中，
44

FF = covT(N)
显然，通过一次加权由公式（4-35）获得的终端位置坐标容易受到环境噪声和信号 参数估计误差的影响，不能够满足人们对于高精度定位的需求。同时，惯性导航PDR技 术的发展，让终端可以获取到自身的运动状态和信息。因此，接下来将结合PDR提供的 数据支撑，对（4-35）的位置估算结果进一步处理。
由于在同一个位置上，基站可以接收到多条终端同一时刻发送定位请求信号的时延 和角度参数，针对同一次请求，令仏山,…“｝为信号到达基站的时间。 xt/£（O = [x（rf）,XO]r表示待定位终端在时刻右的位置坐标，假设终端在每个时刻间隔内 速度矢量也（為），叮扁）F保持不变，因此可以得到如下终端的运动模型：
(4-37)
Wo)+ Z
其中，匕仏）』仏）孑表示终端的初始位置，d表示PDR数据的发送间隔。在式（4-37） 中，由于速度参数可通过PDR获得，因此只有初始位置点仏）]丁未知。因此，弓|入 以下优化函数：

其中，XUEEU）表示在右时刻由第一步加权估计得到的坐标值，xUE<seconM表示由 （4-37）计算得出的坐标值，SM?爲表示在/泪时刻由测量得到的信噪比，在此作为二 次估计的权重，根据第三章的仿真实验可知，信噪比越高，角度和时延估计的误差越小。 因此，未知参数[班/。）』仏）『同样可用加权最小二乘估计得出：
J、	J、
工 SNR&ep加［(/step ) 一 工匕(0-1)山)
Hep-1	y'-l
(4-39)
X SNR爲 ®UE加(爲)-工 Vy (/")△/)
因此，根据（4-37）和（4-39）可以得到在乙时刻的终端位置坐标:
讹)+ X
XVE(4 )=
丁仏）+工乙亿砂一

以上提出的方法在单基站定位环境参考信息较少的情况下，利用角度时延估计得到 的坐标值，融合终端PDR提供的速度信息，有效的提升了NLOS情况下终端的定位精度。
4.3实验仿真
4.3.1基于PDR约束的NLOS路径判断方法的验证
为了验证基于PDR约束的NLOS路径识别方法的准确率，我们在二维坐标系内建 立仿真环境，如图4-7所示，假设整个空间大小为100*100m,基站位于(50,50)米的 坐标处，在该空间范围内随机生成定位点A,在A点的基础上随机生成定位点B,两个 点的距离表示为〃PDR。

图4-7 NLOS路径识别方法仿真场景图
接下来通过实验仿真的形式寻找合适的判决门限值2和〃。在本次实验中误差来源 主要包括NLOS误差、角度和时延估计误差、惯性导航器件引入的PDR误差。
首先假设A、B两点的收发信号均为NLOS信号，假设NLOS传播距离误差是在 (10,50)米上服从均匀分布的随机变量，NLOS传播角度误差是在(-込刃上服从均匀分 布的随机变量，用标准距离偏差b血和标准角度偏差7”孕表示大规模天线阵列的估计误 差，用表示PDR的估计误差。信号在传输和估计过程中的误差参数(6血,巧,輕QPQR) 分别取(lm, 0.5°,0.75m)、 (2m, 0.5°,0.75m)、 (lm, l°,0.75m)、(lm, 0.5。,1.5m), 在上述仿真环境下，对4.1所提岀的方法进行了 1000次蒙特卡洛实验仿真，仿真结果如 图4・7所示。

图4-8不同误差下Q、少和NLOS识别正确率之间的关系
通过图中(a) (b)两图的比较，可知随着距离估计误差b為的增加，要想保持较 高的NLOS识别正确率，需要提高"的值；比较(a) (c)两图，可知随着角度估计误 差5”如的增加，同样需要提高提高4的值；比较(a) (d)两图，可知NLOS识别正确 率对PDR估计误差并不敏感。由于A、B连续的两个点都处于NLOS的情况，在 实际非视距环境下移动时，反射墙体表面的光滑程度并不理想，信号在经过反射时，导 致镜面反射定律失衡，表现在时延和角度的估计误差中，从而影响NLOS判断的结果。 而对于PDR的估计误差刃册来说，其大小与NLOS引起时延和角度误差表现在距离上的误差较小，因此可以忽略其对参数2、少的影响。以上实验是基于A、B两点都处于 NLOS的情况，研究了 NLOS识别正确率和信号传输过程中各个误差之间的关系。接下 来将固定误差参数(OdisQggieQpDR)为(Im, 0.5°,0.75m),研究A、B信号状态不同的 情况下，NLOS识别正确率和参数2、帀的关系，同样进行1000次的蒙特卡洛实验，仿 真结果如下图所不。
图4-9 A B两点信号状态不同时，几、"和NLOS识别正确率之间的关系
通过上面两图的比较可以发现，相比起A、B两点都位于NLOS的情况，A、B两 点的信号状态不同时，NLOS识别正确率和◎的取值关系不大，而且在久取值较小时即 可实现较高的NLOS识别正确率。结合4.1小节的理论分析可知，当A、B两点的状态 发生变化时，基站侧估计得到的时延和角度值发生较大的变化，由此计算得出的A、B 两点的距离在2取值较小时，依然能够满足大于threshhold的条件。
因此，综合上述仿真实验，得出如下结论：当A >0.5且77»2.5时，能取的较好的 NLOS识别率。
通过以上实验，得出了 2和乃的取值范围，因为在进行上述实验时将NLOS误差设 定为均匀分布的参数。所以，接下来的实验将固定门限参数2和研究NLOS识别正 确率和NLOS误差之间的关系。进行1000次蒙特卡洛实验后，仿真结果如图4-9所示。
49

图4-10NLOS误差和NLOS识别正确率之间的关系
由图4-9可以看出，当NLOS误差增加时，经过反射的信号径与直射径之间的距离 差将会显著增加，因此导致NLOS识别正确的概率增加。
表4-1相同条件下不同方法之间的NLOS识别正确率
方法
NLOS识别正确率
基于PDR约束的NLOS识别方法

在表4-1中，将本文提出的NLOS识别方法将其他方法做了比较，可以看岀，由于 增加了 PDR的约束条件，NLOS识别正确率有了显著的提升。


4.3.2基于虚拟基站的单基站NLOS定位算法验证
为了验证实际环境下，本文所提出的单基站定位算法的正确性，选取北京邮电大学


其中，在图4-ll(b)中，红色区域表示非视距区域，蓝色区域表示视距区域，黑色虚 线表示终端的移动路径。起点为蓝色五角星，终点为绿色五角星。
由于MIMO天线部署成本等因素的考虑，因此本文采用模拟MIMO基站，以仿真 模拟的形式给出角度和时延的估计结果，针对NLOS情况下的角度和时延以及反射墙 体，根据文献［55］所提的射线追踪的方法生成。终端的速度矢量参数通过华为智能手机 P9内置的加速度计和陀螺仪进行数据采样，采样完成后的数据结合仿真生成的角度时 延参数进行融合定位解算。同样，在实际测试中，也用到了激光测距仪，用来测量周围 环境的距离参数。

表4-2智能手机参数
设备名称
操作系统
加速度计
陀螺仪
华为P9
安卓&o
ICM20690
ICM206990


图4-11实验用到的测试仪器
在以上仿真实测条件下，得到以下结果。

1 …

♦衣眷浑先冷少;*犬,;纽心汕*.**："*：.?：.‘、
A	■ .■-"	.
0.9




0.8




0.7 -
J



06




0.5




04
f
X


0.3・
f J



02









0.1


1—^--

0 U









0
0.5
1	1.5	2
2.5
3






图 4-14
不同定位方法的CDF图

在图4-13中，我们采用不同方法进行仿真测试，并选取了在终端在运动过程中的几 个时间点的定位精度（总计运动时间约为35s）。在图4-14中，我们进行了多次仿真和 实测，得到了不同定位算法下的累积误差概率分布图。可以发现经过二次加权的位置估 计方法在定位精度上有明显的提升，尤其是在环境中存在非视距干扰的情况下，定位精 度仍达到亚米级，同时角度和时延参数的加入，一定程度上也抵消了 PDR带来的累积 误差。
4.4本章总结
本章节重点研究了复杂环境下单基站利用非视距信号进行定位的问题。首先考虑到 单基站情况下接收信号的数目较少，因此引入PDR约束关系，进而提出一种新的NLOS 路径识别方法，通过仿真的形式确定了比较的门限值，可以发现门限值的获取对PDR估 计误差不敏感，这样在实际PDR估计距离误差较大的情况下，也能实现NLOS识别正确 率95%以上。然后构建了NLOS传播模型，由于存在干扰误差点，因此通过聚类算法对干 扰误差点进行区分。最后，在假设基站与建筑平面坐标已知的情况下，利用虚拟基站的 方法将NLOS信号等效成LOS信号；最后通过PDR估计得到的终端运动状态信息和冗余 路径信息进行二次加权位置估计。仿真结果表明，在复杂环境下，该方法能够实现亚米 级的定位精度。
52
第五章总结与展望
5.1总结
位置是人类赖以生存和发展的重要基础性信息，人类通过精准的位置信息更 加准确的描述整个世界与自己。进入21世纪以来，互联网产业不断发展，万物互 联的时代已经来到，基于位置服务(Location Based Services, LBS)的应用应运而 生。目前，以我国北斗导航系统、美国的全球定位系统为代表的全球卫星导航系 统已经融入到交通运输、公共安全、农林渔业、水纹监测、减灾灭灾等多个领域。 随着未来智能产业进一步扩大，无人驾驶、智慧医疗、智慧物流与仓储等多种应 用场景对位置服务提出了更高定位性能的精细化需求，在定位精度、可靠性以及 位置服务的可用范围都提出了更高标准，5G网络的出现，赋予了可实现无缝定位 的能力。本文针对多基站定位过程中，对终端接收基站数目要求较多，基站与基 站之间存在时钟误差等缺点，结合5G组网的技术特点，提岀了基于角度和时延估 计的单基站定位算法，本文主要完成了以下几方面的工作：
1.针对空旷场景下，超密集网络下基站覆盖密度较大，终端和基站之间存在 直射路径的概率大大增加，同时也带来了信号传播过程中的近场效应等问题。本 文提出了基于混合阶的远近场角度时延估计方法。首先，针对5G网络定位架构进 行了优化，利用波束完成视距基站的筛选；然后在远近场的信号传播条件下，建 立了时域和频域传播模型；最后通过引入高阶累积量进行角度和时延估计。通过 仿真可知，本文提出的方法可在远近场条件下保持较高的时延和估计精度。
2•针对复杂环境下，缺少视距基站导致定位过程中的非视距误差问题，本文 首先提出了一种基于PDR约束的非视距基站判断方法，通过和门限值比较的方式 识别出单基站条件下的非视距基站；然后，引入了虚拟基站的概念将非视距路径 转换为视距路径，再进行坐标位置的解算；最后在位置解算的过程中，通过非监 督聚类的方式排除干扰点，并利用PDR估计得到的终端运动状态信息和冗余路径 信息进行二次加权位置解算。通过仿真分析得到比较门限值，非视距路径的识别 准确率达到95%以上，并且通过聚类和加权的算法相较于传统的算法实现了较高 的定位精度，实现了非视距环境下单基站定位的高精度覆盖。
通过针对不同场景下定位性能的影响因素，本文提出的单基站定位方法的定 位精度和效率均有所提升。同时，本文提出的方法与5G网络进行了有机融合，为 未来单基站定位算法的研究提供了新思路、新方法。
53
5.2展望
本文分析了 5G组网技术的特点，提出了一种基于大规模天线阵列的单基站定 位技术，并针对单基站的非视距情况，提出了一种基于虚拟基站的位置解算方法。 但在本文的理论基础上，其实还有工作需要继续推进：
1•在对远近场的角度时延进行估计时，没有考虑天线阵型排布方式对角度时延 定位估计精度的影响。接下来，可进一步探究大规模平面阵列的远近场角度时 延估计方法；
2.在对NLOS情况下的信号进行处理时，虚拟基站的方法较为理想，接下来可以 从电磁波传输规律的角度进一步研究信号在复杂环境下的反射规律；
导航与通信相互促进融合是未来广域室内定位技术发展的大趋势，随着5G时 代的到来，位置产业蓬勃发展，相信通导融合一体化解决方案能够更好的为我们 的日常生活带来更好的体验，为国家的一些重要领域做岀重要贡献。
54
参考文献
[1] 谢钢.GPS原理与接收机设计[M】・电子工业出版社,2009
[2] B. Kim, M. Kwak, J. Lee and T. T. Kwon, "A multi-pronged approach for indoor positioning with WiFi, magnetic and cellular signals," 2014 International Conference on Indoor Positioning and Indoor Navigation (IPIN), Busan, Korea (South), 2014, pp. 723-726, doi: 10.1109/IPIN.2014.7275551.
[3] 余晔•基于K-means聚类的蓝牙室内定位算法研究[J].城市勘 测,2019(05):34-38.
[4] 郭少彬，沈锋，李颖•基于WiFi/PDR融合的室内定位方法[J].电子信息对抗 技术,2019,34(05):24-27.
[5] 蔡有柱.WIFI定位技术在智慧校园建设中的应用研究[J].中国新通 信,2019,21(19):121-122.
[6] Stavrou Vasilis,Bardaki Cleopatra,Papakyriakopoulos Dimitris,Pramatari Katerina. An Ensemble Filter for Indoor Positioning in a Retail Store Using Bluetooth Low Energy Beacons.[J]. Sensors (Basel, Switzerland),2019,19(20).
[7] 夏敬潮，汪善根，金向农,许国辉，曾秋.WiFi辅助的基于坐标搜索格网的卫 星定位[J]•测绘地理信息,2020,45(01):27-32.
[8] 杨刚,柴雅文•基于矩阵填充和压缩感知的蓝牙室内定位方法卩].光通信研 究,2019(05):58-63.
[8] 陈皓，何杰，马凯，黄琴•基于BP神经网络补偿卡尔曼滤波的UWB精定位算 法[J].电子设计工程,2019,27(24):103-107.
[9] 朱澄卓.基于超宽带和惯导数据融合的高精度室内定位系统[D].重庆大 学,201&
[10] 黄鹤，张新宇,仇凯悦.PDR算法对地磁室内定位精度的提升研究[J].测绘 通报,2019(12):18-21.
[11] Jiyun Shen and Y. Oda, "Direction estimation for cellular enhanced cell-ID positioning using multiple sector observations," 2010 International Conference on Indoor Positioning and Indoor Navigation, Zurich, Switzerland, 2010, pp. 1-6, doi: 10.1109/IPIN.2010.5647833.
[12] 赛迪智库无线电管理研究所.5G发展展望白皮书(2021)[NJ.中国计算机 报,2021-03-01(008).
55
[13] 张平，陈昊.面向5G的定位技术研究综述[J] •北京邮电大学学 报,2018,41(05):1-12.
[14] 张中山，王兴，张成勇,吕少波•大规模MIMO关键技术及应用[J]•中国科学: 信息科学,2015,45(09):1095-1110.
[15] Q. Liu, R. Liu, Z. Wang and Y・ Zhang, HSimulation and Analysis of Device Positioning in 5G Ultra-Dense Network/* 2019 15th International Wireless Communications & Mobile Computing Conference (IWCMC), Tangier, Morocco, 2019, pp. 1529-1533, doi: 10.1109/1 WCMC.2019.8766743・
[16] J. Talvitie et al.? "Positioning and Location-Based Beamfbrming for High Speed Trains in 5G NR Networks/ 2018 IEEE Globecom Workshops (GC Wkshps), Abu Dhabi, United Arab Emirates, 2018, pp. 1-7, doi: 10.1109/GLOCOMW.201 &8644311.
[17] N. Garcia, H. Wymeersch, E. G. Larsson, A. M. Haimovich and M. Coulon, "Direct Localization for Massive MIMOJ in IEEE Transactions on Signal Processing, vol. 65, no. 10?pp. 2475-2487, 15 Mayl5,2017, doi: 10.1109/TSP.2017.2666779.
[18] 昌飞.北斗+5G室内外融合定位技术的应用展望[J]•集成电路应 用,2021,38(01):24-25.
[19] HAN, Ke, et al. A RSSI/PDR-based probabilistic position selection algorithm with NLOS identification for indoor localisation. ISPRS International Journal of Geo- Information^ 201 & 7.6: 232.
[20] Halperin D, Hu W, Sheth A, et al. Predictable 802.11 packet delivery from wireless channel measurements[J]. A CM SIGCOMM Computer Communication Review, 2010, 40(4): 159-170.
[21] Chapre Y, Ignjatovic A, Seneviratne A，et al. CSI-MIMO: An efficient WiFi fingerprinting using channel state information with MIMO 卩].Pervasive and Mobile Computing, 2015, 23: 89-103.
[22] Wang X, Gao L, Mao S，et al. CSI-based fingerprinting for indoor localization: A deep learning approach [J]. IEEE Transactions on Vehicular Technology, 2016, 66(1): 763-776.
[23] Wang X, Gao L, Mao S. CSI phase fingerprinting for indoor localization with a deep learning approach[J]. IEEE Internet of Things Journal, 2016, 3(6): 11131123.
[24] 余丹，谢世成庁全可,邰晓曼，仲臣•基于Wi・Fi的室内定位技术研究进展 [J]・现代信息科技,2020,4(21):48-52.
56
[2习徐亮•基于深度信念网络的室内定位算法研究[D].徐州:中国矿业大 学,2018.
[26] G・ Sun, J. Chen, W. Guo? and K. J・ R. Liu, "Signal processing techniques in network-aided positioning: a survey of state-ofthe-art positioning designs/5 IEEE Signal Processing Magazine,vol. 22, no. 4, pp. 12—23, July 2005・
[27] 张书楠.基于5G毫米波信号的TOA估计及定位算法的研究[D].北京邮 电大学,2019.
[28] H・ EI-Sayed, G. Athanasiou, and C・ Fischione, "Evaluation of localization methods in millimeter-wave wireless systems," in 2014 IEEE 19th International Workshop on Computer Aided Modeling and Design of Communication Links and Networks (CAMAD), Dec 2014, pp. 345-349.
[2刃 J. Huang, J. Liang and S. Luo, "Method and Analysis of TOA-Based Localization in 5G Ultra-Dense Networks with Randomly Distributed Nodes/1 in IEEE Access, vol. 7, pp. 174986-175002,2019, doi: 10.1109/ACCESS.2019.2957380.
[30] E. Y. Menta, N. Malm, R. Jantti, K. Ruttik, M. Costa and K. Leppanen, nOn the Performance of AoA-Based Localization in 5G Ultra-Dense Networks/ in IEEE Access, vol. 7, pp. 33870-33880, 2019, doi: 10.1109/ACCESS.2019.2903633.
[31] K. Han, Y, Liu, Z・ Deng, L. Yin and L. Shi, "Direct Positioning Method of Mixed Far-Field and Near-Field Based on 5G Massive MI MO System/* in IEEE Access, voL 7, pp. 72170-72181, 2019, doi: 10.1109/ACCESS.2019.2906330.
[32] K. Zhu, Y. Wei and R. Xu? nTOA-based localization error modeling of distributed MIMO radar for positioning accuracy enhancement/* 2016 CIE International Conference on Radar (RADAR), Guangzhou, 2016, pp. 1-5, doi: 10.1109/RADAR.2016.8059316.
[33] Zhang, Hao, et al.nStudy on distance and angle measurement for single-basestation UWB positioning system with circular antenna array.1* 2013 10th International Computer Conference on Wavelet Active Media Technology and Information Processing (ICCWAMTIP). IEEE, 2013.
[34] 张建平• MIMO移动通信系统中的单基站定位技术研究[D].电子科技大 学,2011.
[35] 吴志国.基于WiFi信道状态信息的单基站室内定位研究[D].北京邮电大 学,2018.
57
[36] Y. Yifei and Z. Longming, "Application scenarios and enabling technologies of 5G,n in China Communications, vol. 11, no. 11, pp. 69・79, Nov. 2014, doi: 10.1109/CC.2014.7004525.
[37] 周桂森.5G超密集组网关键技术与组网架构探讨[J].电信工程技术与标 准化,2020,33(10):64-67.
[38] 刘海燕.面向5G的超密集网络中分布式无线资源管理的研究[D].北京 交通大学,2016.
[39] 海涵• UDN部署下的多连接技术研究[D].北京邮电大学,2018.
[40] L. Lu, G. Y. Li, A. L. Swindlehurst, A. Ashikhmin and R. Zhang, "An Overview of Massive MIMO: Benefits and Challenges," in IEEE Journal of Selected Topics in Signal Processing, vol. 8, no. 5, pp. 742-758, Oct. 2014, doi: 10.1109 /JSTSP.2014.2317671.
[41] Z. Pi and F. Khan, "An introduction to millimeter-wave mobile broadband systems," in IEEE Communications Magazine, vol. 49, no. 6, pp. 101-107, June 2011, doi: 10.1109/MCOM.2011.5783993.
[42] 张玲.TD-LTE基于RSRP/RSRQ的小区切换算法优化[J].数字通 信,2013,40(02):54-58.
[43] 闫文江.无线通信基站的定位算法研究[D].南京大学,2017.
[44] 江帆.4G网络中无线基站的设计分析[J].通信电源技术,2020,37(01):210- 212
[45] 李娜，刘亮，陈宁宇，胡南，李男・5G本地定位架构发展趋势探讨[C].中国 通信学会.2019中国信息通信大会论文集(CICC2019) •中国通信学会:人民邮电 出版社电信科学编辑部,2019:27-35.
[46] N. Yuen and B. Friedlander, nPerfbrmance analysis of higher order ESPRIT for localization of near-field sources/* in IEEE Transactions on Signal Processing, vol. 46, no. 3,pp. 709-719, March 1998, doi: 10.1109/78.661337.
[47] J. Li et al., nSimplified High-Order DOA and Range Estimation With Linear Antenna Array," in IEEE Communications Letters, vol. 21, no. 1, pp. 76-79, Jan. 2017, doi: 10.1109/LCOMM.2016.2613867.
[48] J. He, Y. Geng and K. Pahlavan, "Modeling indoor TOA ranging error for body mounted sensors/ 2012 IEEE 23rd International Symposium on Personal, Indoor and Mobile Radio Communications - (PIMRC), Sydney, NSW, Australia, 2012, pp. 682-686, doi: 10.1109/PIMRC.2012.6362871.
58
[49] 吴啟弘，田增山，周牧，罗斌，余箭飞.基于散射区模型与参数聚类的室外 NLOS单站定位算法[J]•重庆邮电大学学报(自然科学^),2020,32(06):909-916.
[50] Dian Zhang, Y・ Liu, Xiaonan Guo, Min Gao and L・ M. Ni? nOn distinguishing the multiple radio paths in RSS-based ranging/ 2012 Proceedings IEEE INFOCOM, Orlando, FL, USA, 2012, pp. 2201-2209, doi: 10.1109/INFCOM.2012.6195605.
[51] Q. Zhu, X. Tang and 乙 Liu, "Revised DBSCAN Clustering Algorithm Based on Dual Grid," 2020 Chinese Control And Decision Conference (CCDC), Hefei, China, 2020, pp. 3461-3466, doi: 10.1109/CCDC49329.2020.9163926.
[52] 冯振华，钱雪忠,赵娜娜.Greedy DBSCAN: —种针对多密度聚类的 DBSCAN 改进算法[J].计算机应用研究,2016,33(09):2693-2696+2700.
[53] Momtaz, Abbas Abolfathi, et al. nNLOS identification in range-based source localization: Statistical approach.n IEEE Sensors Journal 18.9 (2018): 3745-3751.
[54] Liu, Xia, Qun Wan, and Wan-Lin Yang. "Maximum likelihood location for identification of line-of-sight base stations.n TENCON 2006-2006 IEEE Region JO Conference. IEEE, 2006.
[55] TANG, Ya-ping, et aL "Radio Wave Propagation Prediction Based on 3D Reverse Ray-tracing.f, Computer Engineering 40.3 (2014): 143-146.
59
