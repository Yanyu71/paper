

第一章绪论
1.1课题研究背景及意义
近年来，随着无线通信技术的快速发展，人们对无线频谱资源的需求逐渐增 长，而实际上，一些超低频和超高频频段无法应用于目前的通信技术中，可用的 频谱资源其实非常有限囚。而为了提高可用频谱的使用效率，人们相继提出了一 些新的无线通信理论及技术，如链路自适应技术⑵、多天线技术DI等，但它们对 频谱效率的提升比较微弱，仍然远不能满足人们的需求。而且，频率管理部门出 于对特定通信业务进行保护的目的，为防止它们被其他业务干扰，将一些特定的 频段授权给它们使用，但一般情况下这些通信业务只是间歇性地使用授权频段， 这导致授权频段的利用率特别低。而且就总的可用频段来说，授权频段占用的比 例更大，也就是说,非授权频段在频谱资源较少的情况下却承担了更大的业务量, 这造成了频谱利用的极端不平衡。因此，可以得出这样的结论：现阶段的频谱资 源划分方案使得本来就稀缺的频谱资源利用率低下，造成了极大的浪费，频谱资 源紧缺和频谱资源利用率低下之间的矛盾亟待解决。在此背景下，认知无线电技 术（CognitiveRadio）作为一种有效提高授权频段利用率的技术手段受到广泛关 注和研究。
Joseph Mitola博士是认知无线电概念的提出者，他于1999年首次提出此概 念网。Molita提出的认知无线电有别于现在普遍使用的认知无线电技术，通常被 称为“全认知无线电”，是对软件无线电的特殊扩展，以模型为基础对用户和通 信环境进行推理。然而，这样的认知无线电较复杂，自提出后从来没有被实现过。 现今人们对认知无线电的研究主要以提高授权频谱的利用率为目标，一般被称作 “频谱感知认知无线电”。综合以上信息，对认知无线电的定义可以这样表述： 认知无线电是一种智能无线通信系统，它能感知周围环境，运用“理解一构建” 的方法学来从周围环境中获取信息，并通过实时改变诸如传输功率、载频、调制 方式等传输参数来适应运行环境的变化【叽
认知无线电的核心功能是使授权频段不只能被授权用户（主用户）使用，除 了授权用户外，非授权用户（次用户）也应能工作在授权频段内，不过，授权用 户可以随时接入授权频段，而次用户只能在主用户的空闲时间段内机会性地使用 授权频段，并尽量避免和主用户的冲突。
认知无线电的关键技术主要包括频谱感知和自适应频谱分配技术。其中，频 谱感知是认知无线电功能实现的重要前提。虽然授权频谱已经分配给主用户使 用，但在一定的时间内主用户可能处于空闲状态，频谱感知技术能灵敏地感知周 围环境，发现在一定的时间内未被主用户使用的已授权频谱一一频谱空穴，使得 认知无线电能结合周围通信环境，机会性地接入这些空闲频段。
人工智能也在认知无线电中占据比较重要的地位。认知无线电要使认知基站 具有感知、推理、学习和决策的能力，其中学习和决策既可以是对历史数据的简 单统计或一些最优算法，也可以是较复杂的数据预测算法。近年来，随着计算机 硬件存储能力和软件处理速度的快速提升，数据预测技术蓬勃发展，并逐渐被应 用到各个领域。事实上，数据预测在认知无线电中的应用已逐渐引起人们的关注。
1.2频谱感知技术概述
频谱感知是认知无线电的前提和关键技术，常用的频谱感知技术分为三大 类：能量检测、循环平稳检测和匹配滤波检测。
能量检测㈤的工作原理是在待检测频段范围内进行能量累积，然后通过一定 的准则计算出判决门限，比较各频点的累积能量值和判决门限的相对大小，得到 判决结果。能量检测的优点是复杂率较低，感知时间短，而且不需要先验信息， 所以使用较为广泛。但是它的判决门限设置无法平衡虚警率和检测率之间的矛 盾，所以存在检测信噪比门限，在低信噪比环境下检测性能较差。能量检测也无 法对信号的调制方式进行检测。
循环平稳特征检测図利用调制信号的统计特征具有循环平稳性这一特点，通 过分析频谱相关性函数可以检测出调制信号的特有特征。由于信号特征会离散地 分布在循环谱的循环频率中，而噪声却没有这个特性，所以这种方法具有较高的 信号检测率。而且对于不同的循环平稳信号来说，它们的频谱冗余性也不同，所 以可以利用循环谱对信号的调制方式进行区分，这是能量检测无法做到的。虽然 循环平稳特征检测具有以上的优点，但由于频谱相关性函数为二维变换，所以它 的缺点也是显而易见的：计算复杂度较高、感知时间长、系统相对较复杂。
匹配滤波检测"°】在授权用户信号先验信息已知的情况下具有最好的检测性 能。匹配滤波检测的设计准则是使信号的输出信噪比最大，通过对授权信号进行 解调或者导频检测来实现频谱感知功能。其优点是检测时间相对较短，缺点是只 能工作在先验信息已知的情况，当先验信息不准确或存在干扰信号时，检测性能 会大大下降。
以上三种频谱感知技术各有其优缺点及适用场景，在应用时需结合实际情况 进行选择。
以上介绍的三种频谱感知技术都是单用户的，而在实际应用中，无线环境不 可避免地存在多径、衰落等因素，所以单个用户的感知结果往往是有偏差的，在 这种情况下，人们提出了协作频谱感知［川的概念。协作频谱感知通过将处于多个 不同地点的认知用户的感知结果综合起来，能有效消除单用户检测时阴影衰落的 影响，提高认知的准确性。协作频谱感知中对结果影响较大的是协作策略的选择, 包括参与感知的非授权用户数目的选择、感知节点权重的分配等等。由于协作频 谱感知能降低对单个认知用户的检测要求，以较小的资源消耗得到较大的感知精 度提升，所以目前己有较多学者针对它进行了研究。
1.3数据预测技术概述
上节所述即时频谱感知技术只能满足用户在当前时刻的通信需求，如果感知 结果显示有多个信道可供选择，那么选择一条可用时间较长的信道能有效降低切 换率，且能避免对主用户的干扰。信道的可用时长等信息是要由未来一段时间信 道内的干扰水平来决定的，而从历史数据中寻找有用信息用以预测未来正是数据 挖掘的内容。
近年来，计算机技术飞速发展，无论是硬件存储能力还是软件处理速度都得 到极大的提升，在这种背景下，具有数据存储、管理和査询功能的数据库技术也 得到广泛应用，使得数据以前所未有的速度大量聚集在计算机中。如果能从如此 庞大的数据量中提取出有用信息为决策服务，必然会大大增加准确性，减少无用 功。于是，数据挖掘技术掀起一股研究热潮，并广泛应用到各个领域，包括认知 无线电领域，但目前数据挖据技术在认知无线电中的应用场景相对较简单。参考 文献［7］利用支持向量机对信道空闲时长的概率密度分布进行估计从而获得信道 状态信息，以机会性地接入空闲信道。但是，只对信道状态进行单一的预测有时 并不能满足系统的需要，例如，有些信道虽然是被占用状态，但是由于干扰水平 较低，也能满足次用户的正常通信需求。所以，如果能对频带内干扰值进行预测， 动态频谱接入将会有更大的灵活性。
对数据挖掘的较普遍的定义是：数据挖掘是从大量的、不完全的、模糊的、 随机的实际应用数据中，提取隐含在其中的，人们事先不知道的、但又是潜在有 用的信息和知识的过程2）。数据挖掘由于要应用于不同的数据类型和挖掘目的， 所以其研究分为很多分支学科，主要为两大类：描述性任务和预测性任务。描述 性任务主要是对数据中存在的特性、规则等的总结和归纳，包括聚类、关联分析、 异常检测等，而预测性任务则往往是根据历史信息对数据项的未来发展进行推 断，包括回归和分类。
分类的目的是训练出一个分类函数，能把待分类数据项正确地判定为给定类 别中的某一个，在实际中应用较广泛，如垃圾邮件的检测就是比较常见的分类技 术的应用。相比于分类技术的定性输出，对预测值进行定量输岀的技术称为回归。 常用的回归挖掘算法有：支持向量机，人工神经网络，线性回归，树回归，ARIMA 模型等。
支持向量机卩4｝的使用时间较短，是近年出现的数据挖掘的新方法，无论应 用在分类还是回归中都具有良好的性能。支持向量机的基础是结构化风险最小以 及VC维理论，由于算法最终转化为二次型寻优问题，所以能克服局部极小得到 全局最优解。支持向量机还使用核映射的思想，将低维空间投影到高维，能有效 避免维数灾难，并且在解决非线性问题时显示出卓越的性能。但由于支持向量机 在二次型寻优时涉及到矩阵的运算，而矩阵运算比较耗费机器内存和计算时间， 当样本数目很大时对机器要求非常高，所以不适合大规模训练样本的情况，它的 另一个缺点是训练时间较长。
神经网络卩习模仿人脑的工作机制，由大量神经元节点连接而成，具有并行 处理、分布式信息存储、良好的自组织自适应性等特点。人工神经网络提出时间 较早，可以追溯到20世纪40年代，但是其经过一段时间的快速发展后进入了沉 寂期，而近年来，人们对人工神经网络的研究又达到了一个新的高潮，并且取得 了很大的进展，尤其在数据挖掘和预测领域。但是，神经网络存在学习过程较复 杂，学习时间过长等缺点，而且缺乏统一和权威的理论指导。
时间序列Ml,又称动态数列，是将同一统计指标的数值按其发生的时间先 后顺序排列而成的数列。时间序列预测，即是通过分析序列的过去值，构造出随 时间变化的时序模型，用以预测序列在未来某个时刻可能达到的水平。因为几乎 在任何一个领域都存在能够用时间序列表示的信息，所以时间序列预测的应用也 非常广泛，无论是在经济学、社会学还是在工程技术等领域都能发挥其作用。传 统的时间序列预测的研究主要针对线性预测模型，其中以自回归滑动平均模型 (ARMA)为核心。ARMA能以较低的计算复杂度获得较为理想的预测结果， 所以具有很高的普及性。后来的研究主要针对非线性、非平稳的时间序列预测问 题，在线性预测模型上进行改进或者将时间序列预测与神经网络或支持向量机相 结合，以使其具有更高的准确度和更好的适应性。
1.4论文主要研究内容
能量检测作为一种应用最广泛的频谱感知方法，具有计算量小，无需先验信 息等优点，但其在低信噪比条件下感知性能较差。在实际通信环境中，由于距离 造成的信号衰减和其它衰落的影响，接收信号的信噪比可能很低，此时使用传统
的能量检测方法达不到性能需求。但是更适用于低信噪比环境的循环平稳特征检 测，由于其计算量大、检测时间长等缺点，在很多情况下不能取代能量检测算法。 所以，为提高认知无线电网络的检测性能及最大化对主用户的保护，需要对能量 检测算法进行改进以使其更适用于低信噪比环境。
时间序列预测能以较低的复杂度获得较为理想的预测结果，具有很高的普及 性。如果将时间序列预测应用到认知无线电技术中，把信道内的干扰水平值简化 为时间序列，利用历史数据建立预测模型对某信道未来一段时间内的干扰值进行 预测，就能结合预测结果对基于即时频谱感知结果的信道选择进行修正，利用可 用时间较长的信道进行通信，能有效延长平均信道使用时长，降低切换率，并且 避免对主用户的干扰。
针对以上背景，本文研究内容可以概括如下：
1.研究在未知关于主用户的先验信息时，如何对噪声功率进行准确地估计， 并结合噪声功率估计值对宽带频谱上主用户的存在与否进行检测。由于在实际应 用场景中，很多有关频带内信号的先验信息无法提前获知，其中包括噪声功率， 而使用能量检测算法进行频谱感知时，噪声功率的值是必不可少的，所以本文在 前人研究的基础上，利用噪声功率估计和能量检测联合迭代的算法对宽带频谱进 行检测，并分析几种传统的能量检测算法的优劣性，从而证明改进能量检测算法 的必要性。
2.研究低信噪比条件下如何有效提高能量检测算法对信号的检测率。一般情 况下，信号的带宽会大于频率分辨率，所以在功率谱密度中，属于同一信号的连 续多个频点的幅值之间会具有相关性，而对于高斯白噪声来说，噪声频点的幅值 会在噪声功率值附近上下浮动，之间并没有相关性。基于这种功率谱密度相邻频 点间相关性的差异，本文提出了一种改进的能量检测算法，仿真结果表明其能有 效检测出信噪比较低的信号，且不会引起虚警率的提升，同时具有较低的复杂度。
3.利用时间序列预测算法预测信道内干扰水平。仅基于即时频谱感知结果的 信道选择可能具有较低的成功率，这是因为所选择的信道可能很快又被主用户使 用，可用时长较短，这样会造成频繁的切换，增大开销，严重时还会干扰主用户 的通信。因此，如果能将数据预测技术应用到认知无线电系统中，对信道内的干 扰水平进行预测，并结合预测结果对基于即时频谱感知的信道选择进行修正，就 能有效延长平均信道使用时长，降低跳变率。时间序列预测算法具有较短的预测 时间和相对准确的预测结果，符合认知无线电技术对预测性能的需求，所以本文 选择时间序列预测算法应用到频谱数据预测中。通过对认知无线电应用场景中地 理模型、传播模型和用户业务模型的建模，仿真出信源数据，用以验证时间序列 预测算法应用于频谱数据预测的有效性，并提出在线预测方式，提高预测精度。
4.设计了一种结合即时频谱感知结果和频谱预测数据的动态频谱接入模型。 模型利用存储的历史频谱数据训练出各信道的干扰预测模型，在利用即时频谱感 知结果寻找到可用信道后，利用各可用信道的干扰预测模型预测出未来干扰水平 从而得到信道可用时长，结合信道可用时长进行可用信道的选择。而且由于信道 使用模式的变化或突发干扰等，会导致干扰预测模型不再适用，所以给每个信道 设置变量记录碰撞频率用于对预测模型进行更新。
1.5论文主要工作的组织结构
论文总共分为五章，本文的组织架构如下：
第一章为绪论，主要介绍了本论文的研究背景，认知无线电的定义及它的关 键技术，随后介绍了常见的几种频谱感知算法和数据挖掘技术及它们在认知无线 电中的应用。
第二章介绍了先验信息全盲条件下的宽带能量检测模型，包括信号产生模型 和判决统计量的计算、几种常用的能量检测判决门限，以及噪声功率估计和能量 检测联合迭代算法，最后通过仿真结果分析各算法的性能，并提出传统能量检测 算法的局限性。
第三章提出了一种基于功率谱线间相关性的改进能量检测算法，首先给出改 进算法的理论基础，然后对算法进行仿真，研究信噪比、信号带宽等参数对检测 结果的影响，分析仿真结果证明算法的优越性，同时提出算法局限性并分析局限 性产生的原因。
第四章设计了频谱感知数据的预测模型，结合频谱数据的特点选择时间序列 预测算法，重点研究求和自回归滑动平均模型（ARIMA）及其预测步骤，包括 训练数据的预处理、模型阶数的确认等，并通过仿真产生信源数据，利用此信源 验证时间序列预测算法在认知无线电应用中的有效性，最后设计了一种利用预测 结果对基于即时频谱感知结果的信道选择进行修正的动态频谱接入模型。
第五章是对本文的总结与展望，总结了本文的研究成果以及下一步的研究工 作方向。
第二章先验信息全盲的宽带能量检测模型
2.1概述
认知无线电作为提高频谱利用效率的关键技术，能够灵敏地感知周围环境， 发现频谱空洞供次用户使用，并且可以通过推理、学习等手段智能地改变自己的 参数，与周围通信环境相适应。认知无线电的其它部分，包括动态频谱接入和资 源分配等模块的正常工作都是以频谱感知的正确结果为基础的，因此，频谱感知 是认知无线电系统的一个重要的前提。
传统通信系统中用到的信号检测技术，如匹配滤波检测、能量检测和循环平 稳特征检测，均可以应用于频谱感知中。在主用户的先验信息己知时，匹配滤波 检测是最适合的频谱感知方式，因为它能使接收到的信号的信噪比最大化。但是, 如果信号的先验信息不准确，例如调制方式和脉冲波形等，则其检测性能就会大 幅下降，同理，其对干扰信号的抵抗力较差。另外，由于每个主用户的特殊性， 认知无线电要为每一类型的主用户准备一个专门的接收器，这也为匹配滤波检测 的实现带来较大的困难。虽然经过数字调制后的信号数据本身是静态随机的，但 其均值和自相关函数具有周期性，称这种内在的周期性为循环平稳特征。而噪声 并没有这种内在周期性，所以可以通过分析频谱自相关函数的周期性特征来进行 信号的检测。循环平稳特征检测的优点是抗噪声能力较强，所以即使在低信噪比 下检测率仍然很高，但是，检测需要己知先验信息，也存在着计算复杂度较高， 检测时间较长等缺点。
在主用户的先验信息未知的情况下，最佳的频谱感知方式是能量检测。能量 检测的原理是在观测时间段内对信号的能量进行累积，通过检测准则计算出判决 门限，并将累积能量值和判决门限，进行比较，从而检测出频谱空洞。能量检 测具有实现简单，不需要信号的先验信息等优点。但是，利用门限进行检测的方 式由于存在虚警率和检测率之间无法调和的矛盾，在低信噪比环境下性能较差， 而且只能检测调制信号的有无，而不能区别信号的类型。传统的能量检测算法主 要有两种门限设计准则：恒虚警率准则(Const False Alarm Rate Criteria,简称 CFAR)和恒检测率准则(Const Detection Rate Criteria,简称 CDR)。参考文献[17] 提出了一种基于最小错判率准则的最优判决门限，当宽带内信号具有相同功率水 平时，能综合考虑漏检和虚警所付出的代价，使错判损失最小，但是，虚警率和 漏检率之间的矛盾仍然存在，最优判决门限只能在一定程度上降低错判率。
无论是哪种能量检测算法，判决门限的计算都要用到噪声功率，所以在先验
信息未知时需要对噪声功率进行估计。一般文献中噪声功率的估计方法是先找到 频带内的频谱空洞，然后通过测量空洞内的噪声水平得到，但是在先验信息全盲 的条件下，频谱空洞的位置信息也无法预知，所以需要一种新的噪声估计方法。 参考文献［18］提出一种能量检测与噪声估计联合迭代的算法，通过将能量检测过 程和噪声估计过程相结合，能在先验信息全盲时对噪声功率进行较准确地估计， 并且具有较低的复杂度和优良的性能。
本章首先在未知主用户先验信息的场景下，利用高于奈奎斯特的采样频率对 时域信号进行采样，再变换到频域并进行能量累积后，给出能量检测检验统计量 的概率密度分布。然后介绍三种常用的能量检测判决准则及对应的门限计算公 式，引入能量检测与噪声功率估计联合迭代的算法，并对基于三种判决门限的迭 代检测算法进行性能比较并分析三种算法共同的局限性，提出可能的解决方案。
2.2系统模型
2.2.1信号产生
信号的时域釆样及能量检测模型如图2-1所示。仿真产生宽频带时域信号， 其中频带内噪声为高斯白噪声，用高于奈奎斯特频率的釆样频率九进行时域釆 样，每次的采样点数为N,总采样时长为沖，（时域观测时长）。本文假设认知 系统没有任何关于信号的先验信息，只能通过比较各频点的平均功率和判决门限 的相对大小来判断主用户是否存在，当频点平均功率值高于判决门限时判定该频 点被占用，当频点平均功率值低于判决门限时判定该频点未被占用。由此，能量 检测被简化为二元假设模型，下文中用伍代表频点未被占用，反,代表频点被占 用0



图2-1信号模型

2.2.2模型参数
记b；为噪声功率，b：为信号功率，y =。： E为信噪比，火"）为时域采样 值，匕代表对信号时域采样后再进行快速傅里叶变换（Fast Fourier Transformation,简称FFT）的结果，由FFT的定义可知：
匕=*￡川）叫（-玲如）=*#（〃）?海牵出）-/$卽”）响号如）（2.]）
-^reoZ + jY）mag
由概率论相关知识可知，当H。为真时，％和上均服从均值为0,方差为 /?/2的高斯分布，且相互独立。区| =启五二7服从参数为局I的瑞利分布。 |匕|2服从参数为l/b“2的指数分布，其均值为与2,方差为b.L
同理，当用为真时，|耶服从参数为l/（b；+b；）的指数分布，均值为 方差为g；+b,2）2。
由能量检测的定义可知其检验统计量如下：
7；=（1叫￡| 折	（2-2）
T代表各频点的平均功率，根据中心极限定理可知T近似服从高斯分布。
Ho：T~ NormaRcr：/N,）	（）
H、:T?Normaig； +b：,（b； 4-cr/）2 /N,）
能量检测的性能指标一般用虚警率和漏检率来表示，虚警率指噪声被误判为 信号的概率，漏检率指信号被误判为噪声的概率。在能量检测算法中，当判决门 限为厶，虚警率的计算公式为7>=P{T>4|%},检测率的计算公式为 4	，错判率为尺=P,P（H°） + （l-Pd）P（M）。
2.3基于迭代的能量检测模型
2.3.1能量检测判决门限
能量检测算法性能的优劣取决于门限的设计，如果门限值偏低，会造成噪声 虚警，而虚警会减少次用户的接入机会，相反，门限值也不能设置过高，否则会 造成信号被漏检，漏检有可能造成对主用户的干扰。所以在实际判决中，应综合 考虑这两方面的因素，设置合理的判决门限。目前门限设计准则主要有恒虚警率 准则（CFAR）,恒检测率准则（CDR）,由上节可知，待检测的检验统计量服从 如下分布：
Normal（CN,）	（	）
Ht :T ?Normaig； +b],（b； +勺 IN）	-

当为真时，7服从均值为％：,方差为驾IN,的高斯分布，记CFAR的目 标虚警率为pf,统一判决门限为v,hCPM,由pf=p｛T> v,hCFAR|伍｝,计算可得：

匕MCFAR = 	7== + d
JN,
当更为真时，7服从均值为％：+九,方差为g；+°*N,的高斯分布。记
CDR的目标检测率为均，统一判决门限为W班，由4=P（T>*,cdr回｝，计算可 得：
(2-6)
在能量检测中，有时不能只将虚警率或漏检率其中之一作为门限设计的依 据，这样有可能会造成较高的整体错判率，此时应综合考虑这两个因素。虚警或 者漏检会分别给系统带来一定的损失，如果分别设置系数表示虚警和漏检给系统 带来的损失的相对大小，就可以在设置门限时以代价损失最小为原则对虚警率和 漏检率进行平衡。例如，如果将虚警对系统带来的损失系数记为q,而将漏检 带来的损失系数记为C,,,,信号的占用率为〃，艮卩〃 = P（"D，信噪比为y	驾,
则总的错判的损失函数人为卩气
R = G .(D . Q(匝告马+E ? (1 - 0 丑也4性二^))	C2-7)
能量检测的目标是使错判概率尽可能低，所以如果综合考虑虚警率和漏检率 这两个错判指标，应使代价损失函数最小。对式（2-7）进行求导可得到人取最 小值时的判决门限，记为最小代价门限V,hm,:
° Y<~~，°<N,叫
A+>Ia2 +4B
Others
其中
2 + /
NyQ + y) r) Cm

当代价损失系数（〉=Q,时,最小代价门限便退化成了最小错判率门限七g, o


2.3.2联合迭代模型
由上一小节的理论推导可知，三种判决门限％咐，和匕响站的计算都 需要己知噪声功率b；,而在先验信息全盲的条件下，噪声功率b；无法进行简单 地估计。针对这种情况，参考文献［18］提出了一种全盲条件下噪声估计与能量检 测联合迭代算法。
迭代模型的流程图如图2-2所示：

图2-2迭代模型流程图
算法首先设置初次判决门限七* "払的经验公式为％=C.mean?,即初次 判决门限等于频点的平均功率值乘以一个非负系数C, C的取值范围通常为 1<C<2［，81o利用初次判决门限对各频点进行判决，功率值低于门限的各频点被 判为噪声，对噪声频点功率进行平均即得到本次估计噪声功率。同理，功率值高 于门限的各频点被判为信号，对信号频点功率进行平均即得到信号功率和噪声功 率的和值的估计值。估计的功率值如下：

利用公式（2』2）和（2-13）求出％和名.后，计算可得信噪比的估计值:
(2-14)
当进行宽带频谱感知时，由于宽带内可能存在多种信噪比不同的信号，所以

在利用公式（2-14）进行信噪比的求解时得到的是宽带内信号的平均信噪比，而 如果以平均信噪比去求取判决门限，必然会造成信噪比低于平均值的1 言号被漏 检。在三种门限设计准则中，恒检测率门限和最小错判率门限的计算都要用到信 噪比的值，其中一种可行的办法是设置目标最低检测信噪比来替代计算得到的平 均信噪比。
当利用估计噪声功率、信噪比、占用率等计算出判决门限后，判决模块根据 此门限值再次对信号进行判决，并利用更新后的判决结果计算出新的估计噪声功 率等值，从而可以得到新的判决门限。如果相邻两次判决门限之间的差值小于预 设的固定阈值或者相对阈值时，迭代流程结束，并输岀最终的判决结果，否则利 用新的判决门限继续对信号进行判决，直至迭代终止条件满足。
由于门限值的大小未知，一般情况下采用相对阈值的方式来终止迭代过程。
其迭代终止条件为：| V^-V^\!V,hk <p, Q为相对收敛阈值（迭代精度）。




图2-3宽带能量检测算法模型
2.4仿真结果及分析
2.4.1宽带内信号信噪比一致
在2.3节介绍了几种常用的能量检测门限设计准则及其对应的门限计算公式， 为了验证噪声估计和能量检测联合迭代算法的有效性及局限性，用MATLAB仿 真产生宽频带信号，然后经过时域采样、FFT变换等得到待检测频点的平均功率 值，再分别利用噪声估计与三种能量检测方法相结合的迭代模型对各频点进行判 决，分析仿真结果，得到信号的信噪比、占用率对检测性能及迭代次数的影响。
在本章下文中，为了简便，将传统CFAR能量检测和噪声估计联合迭代算法
简记为ICFAR,将传统CDR能量检测和噪声估计联合迭代算法记为ICDR,将 最小错判率准则和噪声估计联合迭代算法简记为minE (min Error)□
首先分析当宽带内各信号的信噪比保持一致时，能量检测算法的检测性能， 仿真参数如表2-1所示：
表2-1仿真参数
总带宽	50M
单次釆样点数	5000
时域观测时长	200
频率分辨率	10K
信号信噪比	—致且可变
信号占用率	可变
ICFAR目标虚警率	0.005
ICDR目标检测率	0.90
ICDR目标检测信噪比	由检测结果计算

由图24不同信号占用率下错判率随信噪比变化的仿真结果可以看出，在宽 带内信号的信噪比水平保持一致时，总体来说minE比ICFAR和ICDR的检测性 能要好，在信噪比较低时，minE和ICFAR的错判率随信号占用率的增大而增加, 而ICDR的错判率随信号占用率的增大而减小。分析图2-5可知，因为在低信噪 比下minE和ICFAR的漏检率较高，信号占用率的增大只能导致更多信号被漏检。 而ICDR是以固定的检测率作为目标，所以即使在低信噪比下漏检率也不会升 高，但是由图2-6可知，ICDR保持漏检率不变是以牺牲虚警率为代价的。在使 用传统能量检测算法的判决门限对信号进行判决时，虚警率和漏检率是一对不可 调和的矛盾，所以将虚警率和漏检率利用代价系数综合起来，以求得总错判率最 小的minE算法具有更好的检测性能。但是在实际应用中，也应根据检测的具体 需要来进行算法的选择。

由图2-5和图2-7可以看出，minE在信号信噪比高于-IdB时，漏检率和虚 警率几乎都为0,证明当宽带内信号信噪比水平保持一致时，minE在较高信噪 比下检测性能非常良好。当信噪比逐步下降时，minE相较于ICFAR来说，以提 高虚警率的代价获得了漏检率的降低，从而降低了总的错判率。
-0-0.1 JCFAR -*-0.3,ICFAR -4-0.5JCFAR -O0.1.ICDR -*■ 0.3.ICDR -4-0.5,ICDR 令 0.1,minE *0.3,minE + 0.5,minE
图2-5不同信号占用率下信噪比对漏检率的影响
O0.1,ICFAR *0.3,ICFAR +0.5JCFAR -0 0.1,ICDR *0.3,ICDR + 0.5,ICDR ?0.1,minE -^-0.3,minE + 0.5,minE
图2.6不同信号占用率下信噪比对虚警率的影响

图2-8是对迭代模型中总迭代次数的仿真，结果表明，在信噪比较高时，三 种检测方法的迭代次数相差不多，而且随着信噪比的降低，三种方法的迭代次数 都开始升高，但是当信噪比降到-9dB及以下时，由于几乎已经不能检测出信号,
迭代次数又开始下降。

图2-8不同信号占用率下信噪比对迭代次数的影响
2.4.2宽带内信号信噪比不同
在2.4.1节我们研究了宽带内信号信噪比一致时各传统能量检测门限设计准 则与噪声功率估计相结合时的检测性能。结果表明，相较于ICFAR和ICDR, minE确实能在一定程度上减小错判率。但是在实际环境中，宽带内信号信噪比 水平一致的情况几乎不可能实现，而当信号的信噪比相差较大时，可能会影响能 量检测算法的性能，宽带内存在的信噪比较高的信号有可能导致对低信噪比信号 的漏检。所以，下面我们仿真研究当宽带内存在不同带宽，不同信噪比的信号时, 各传统能量检测方法与噪声估计相结合的迭代模型的检测性能。
仿真参数如表2-2所示，其中在ICDR算法中，由于宽带内信号信噪比不一
致，如果使用由感知结果计算得到的平均信噪比来进行门限的设定，会造成低于
此信噪比的信号被漏检，一个可行的解决办法是设置最低检测信噪比来代替计算
得到的平均信噪比，例如，在本次仿真环境中，设置最低检测信噪比为-5dB,但
是这种做法在信噪比较高时会影响检测性能，所以ICDR算法并不适用于先验信
息全盲的宽带感知场景，这在第三章3.1节初次能量检测算法的选择中也会提到。
表2-2仿真参数
总带宽	50M
单次采样点数	5000
时域观测时长	200
频率分辨率	10K
ICFAR目标虚警率	0.005
ICDR目标检测率	0.90
ICDR目标检测信噪比	最低检测信噪比-5dB
在50M带宽存在四种信号：

表2-3宽带内信号参数
序号	信号类型	带宽	信噪比
1	窄带信号	100K	7dB
2	窄带信号	200K	4dB
3	窄带信号	400K	IdB
4	宽带信号	可变	可变

图2-9是分别使用三种传统能量检测方法与噪声功率估计相结合的迭代算法 时，不同信号占用率下宽带信号信噪比对错判率的影响。分析可知，minE算法 并没有表现出较好的检测性能，证明minE算法适用于窄带能量检测，而当宽带 内存在多种信噪比不同的信号时，其检测性能并没有提升。

图2-10表明了漏检率随信噪比的变化，对比图2-5可知，在相同信噪比下， 漏检率有所提升，这是因为在宽带内存在多个信号时，信噪比相对较高的信号会 在一定程度上提高检测门限，从而造成低信噪比信号的漏检率增大。

SNR(dB)
图2-1()不同信号占用率下信噪比对漏检率的影响
由以上仿真结果可知，三种传统能量检测方法与噪声估计联合迭代模型在低 信噪比下性能较差。在信噪比低于-5dB时，随着信噪比的降低，错判率上升很 快，而由图2-5和图2-10可知，其主要是由信号漏检造成的，尤其是信噪比较 低时，几乎全部的信号都会漏检。但当信噪比较高时，三种迭代模型的错判率都 相对较低，并且差别不大。在宽带内信号的信噪比水平保持一致时，minE表现 出更好的检测性能，但是当信噪比不一致时，minE的检测性能反而低于ICFAR 和 ICDRo

2.5本章小结
本章首先给出先验信息全盲条件下的时域信号采样模型，然后将采样信号变 换到频域，再在频域进行能量累积，得到能量检测模型的检验统计量。然后介绍 了三种常用的能量检测门限设计准则，再给出能量检测和噪声功率估计联合迭代 的算法，最后仿真产生宽带信号，分别利用三种传统能量检测方法与噪声估计联 合迭代的模型进行感知，给出感知结果。分析感知结果可知，在宽带内信号的信 噪比水平保持一致时，minE表现出更好的检测性能，而当宽带内存在多个不同 信噪比信号时，低信噪比信号更容易被漏检，且minE的检测性能要低于CFAR 和CDRo而无论哪种能量检测方法，迭代模型在信号信噪比较低时检测性能都 很差，需要对其进行改进。

第三章基于功率谱线间相关性的低信噪比能量检测
由第二章的仿真结果可以看出，无论釆用哪种门限设计准则，能量检测算法 在低信噪比下的检测性能都较差，而目前低信噪比环境下频谱感知的研究重点放 在循环平稳特征检测上，虽然取得了一定的成果，但是其计算复杂度过高，而且 要求的观测时间较长，所以在真实应用场景中并不适用。如果能对能量检测算法 进行改进，使其在低信噪比环境下检测率提升，将能有效解决计算复杂度和检测 能力之间的矛盾。
能量检测通过判定功率谱密度中各频点功率值和门限值的相对大小来确定 信号的存在与否，鉴于此，除去功率值的相对大小之外，如果能从功率谱密度中 找到另外的可以用来区分信号与噪声的特征，那么在此特征的辅助判决下，可能 能有效提高能量检测算法的检测率，降低算法的最低检测信噪比门限。
—般情况下，信号的带宽大于频率分辨率，所以在功率谱密度中，属于同一 信号的相邻频点的幅值之间会具有相关性，而噪声频点的功率会在噪声功率值附 近上下浮动，相邻噪声频点的幅值之间并没有相关性。基于信号和噪声在功率谱 密度相邻频点间相关性的差异，可以提出一种改进的能量检测算法。改进算法以 噪声功率作为门限值，判断是否有连续多个频点的功率高于此门限，从而判断信 号是否存在。此检测方法适用于具有一定带宽的信号，另外，由于传统能量检测 算法能很好地检测出具有较高信噪比的信号并且复杂度更低，所以在宽带能量检 测中，可以先釆用传统算法进行检测同时估计噪声功率，再将估计的噪声功率用 于基于功率谱线间相关性的检测，能有效降低漏检率。
3.1初次能量检测算法
由第二章的仿真结果可知，在信噪比较低的情况下，三种能量检测方法性能 都较差，但随着信噪比的升高，检测性能会逐渐变好。在信噪比高于OdB的情 况下，传统方法也具有良好的检测性能。而由于改进的算法利用功率谱密度中相 邻谱线之间的相关性，比传统能量检测算法复杂度高，所以在基于功率谱线间相 关性的检测之前，可以先利用传统能量检测算法检测出信噪比相对较高的信号， 这样既能提升算法的检测率，又能有效地降低复杂度。
在使用恒检测率准则或者最小错判率准则进行能量检测门限值的计算时，需 要用到信噪比的值，而在宽带能量检测中，由于宽频带内可能含有多个具有不同 信噪比的信号，所以计算得到的信噪比往往只是一个均值。如果将此均值用于门限值的计算，那么信噪比小于此均值的信号很有可能会被漏检，一个可行的解决 办法是设置最低检测信噪比来代替计算得到的平均信噪比。而最低检测信噪比的 设置对检测结果影响较大，设置过高会增大漏检率，而设置过低又会增大虚警率, 相比较之下，恒虚警率门限的计算不需要用到信噪比，也就不会出现最低检测信 噪比设置不合理对检测性能造成不良影响的情况。所以在本文中，初次能量检测 选用恒虚警率准则，而由于系统先验信息全盲，所以使用第二章中介绍的噪声估 计与能量检测联合迭代的模型。
在初次能量检测结束之后，利用估计出的噪声功率，基于功率谱线间相关性 对判决为非占用的频点进行二次检测，将其中可能存在的漏检的低信噪比信号检 测出来，从而提高算法在低信噪比环境下的检测率。
3.2漏检信号位置确定
在利用传统算法检测出信噪比相对较高的信号后存在两种情形，一种是信号 已经全部被检测出来，不存在漏检信号，另外一种是存在漏检的低信噪比信号。 在不确定是否有漏检信号存在以及未知漏检信号位置的情况下，由于功率谱密度 中各频点的功率值具有较大的方差且利用判决门限进行初次能量检测后有一些 频点的功率值都很接近于门限值，所以无法根据某频点的功率值来确定漏检信号 的位置，而需要遍历整个频带，并利用功率谱线间的相关性来判决信号的存在与 否。如果实际并无漏检信号存在或者漏检信号在宽带内占用率特别小的情况下， 遍历频带会带来很多无用功。而且，在先验信息未知的情况下，噪声功率是根据 判决结果中噪声频点的平均功率确定的，为了使噪声功率估计更准确从而降低漏 检率，在每一次检测出干扰信号后，都要更新噪声功率值进行新一轮的判决。如 果每次判决都采用遍历频带的方法，那将是很大的工作量。所以，如果能在基于 功率谱线间相关性的检测方法之前，先用较简单的方法找出频带中最有可能存在 漏检信号的位置，再确定此位置附近是否真的存在漏检信号，如果不存在，则检 测过程结束；如果存在，利用功率谱线间相关性确定漏检信号的带宽，然后更新 估计噪声功率，重复以上过程直到检测过程结束。
能量检测在低信噪比下性能较差，由式(2-4)可以看出，增大观测时长可 以减小判决统计量的方差从而在一定程度上提升检测性能，但这会造成感知时间 过长，不适合实际应用。而由此想到，除了增大观测吋长之外，滑动平均窗也能 起到相似的平滑作用。在宽带信号的功率谱密度上使用滑动平均窗进行低通滤波 后，由于方差的减小，频点功率值较大的位置就是信号最有可能存在的位置。
滑动平均窗的低通滤波作用可以由中心极限定理0"来解释：设随机变量序列{X,},〃 = L2...独立同分布，且具有有限的期望和方差，E(X~ ,
D(Xl) = a2 ^0,/ = 1,2...,则随机变量
(3-1)
的分布函数F?(X),对于任意的实数X,有

也即Ify,服从均值为〃，方差为〃/〃的正态分布。
n /=i
记初次能量检测后被判决为非占用的频点序列为se务，利用滑动平均窗对se% 进行低通滤波之后得到的序列记为昵务。滑动平均窗的窗口大小记为S”，根据中 心极限定理：
H。:码?Nomaigm /(S/,))	?二)
H\ L ?Normal^ + ri)oj, (1 + h)2	/ (SWN,))	'
由式(3-3)可知，经过滑动平均窗的低通滤波之后，s级的方差远小于啲， 所以如果有漏检的信号存在，在se%中漏检信号所在处频点的平均功率值应高于 其他位置。记se务中最大值所在的位置为妣，/oc即为漏检信号最可能存在的位 置。在使用滑动平均窗确定漏检信号位置之后，在此位置附近利用功率谱线间相 关性进行信号的检测，如果检测结果表明漏检信号确实存在，则确定信号带宽然 后根据此次判决结果对噪声功率值进行更新，然后重复以上过程直到判定不再存

图3-1滑动平均窗示意图
基于功率谱线间相关性的能量检测利用相邻频点幅值间的相关性进行判决，
而滑动平均窗的工作原理是将窗口内频点的平均功率值作为新序列中窗口中心处的值，所以滑动平均窗会破坏相邻频点间的相关性。而且在未知信号的先验信 息的情况下，无法.确定信号的位置及带宽，从而无法确定信号和噪声的边界，会 出现滑动平均窗内既有信号频点又有噪声频点的情况，这会使信号与噪声之间的 边界变得平滑从而使检测更加困难。所以滑动平均窗只能用来确定漏检信号的位 置，接下来要进行的基于相关性的检测，都是在初始序列阳9上进行。
窗口的大小也会对检测带来影响，如果窗口过小，低通滤波的作用不明显， 窗口过大将会使信号淹没在噪声中。而另一方面，利用功率谱密度中相邻频点幅 值之间的相关性进行检测，前提条件是待检测信号的带宽不能过小，后面的理论 推导与仿真分析也将会对此进行证明。所以，可以根据待检测信号被检出所需的 最小带宽昨来设置滑动窗口的大小，当滑动窗口的大小小于吧，而又不过小时， 既不会造成信号淹没在噪声中，又能起到低通滤波的作用。由3.5.1的仿真结果 可知，滑动窗口的大小可以设置为吧,=10。
3.3基于功率谱线间相关性的检测
3.3.1观测时长的选取
在基于功率谱线间相关性的改进能量检测算法的理论证明中，需要用到单个 频点其功率值高于噪声功率的概率，而此概率的一个决定因素为观测时长N,, 只有确定了观测时长N,,才能进行后续的理论推导过程。所以本小节先来研究 一般能量检测算法中观测时长对检测结果的影响，并对观测时长的选取做理论上 的分析。
由本章第一节的内容可知，初次能量检测选用恒虚警率准则最为合适，此时 能量检测的判决门限为：

而利用此门限进行检测时，具有信噪比/的信号的检测概率为:
由式（3-5）可以看出，信号的检测概率由目标虚警率、信号信噪比和观测 时长决定。下面我们研究在限制虚警率的情况下，不同信噪比信号的检测概率与 观测时长N,的关系。根据公式（3-5）,固定目标虚警率为乃=0.005 ,随着信噪比 /的改变，信号检测概率与观测时长的关系如图3 -2 ：


图3-2不同信噪比下N,值对检测率的影响

由图3-2可以看出，在目标虚警率固定的情况下，信号信噪比越小，使用恒 虚警率门限达到一定的检测概率所需观测时长越长。例如在信号信噪比为-8dB 时，当N,=50G才能达到80%的检测率。而在信噪比为-5dB以上时，N, = 200能保 证检测率在90%以上，所以本文中所用信号观测时长为N, =200。
3.3.2理论基础
在传统能量检测中，由于虚警率的限制，判决门限必须是一个相对噪声功率 来说比较大的值，但这必然会造成低信噪比信号的漏检，而如果门限设置过低， 很大一部分噪声又会被判决为信号，虚警率会过高。所以一般来讲，虚警率和漏 检率几乎是一对不可调和的矛盾，导致能量检测在低信噪比环境下检测性能较 差。参考文献［17］提出了一种最小错判率门限，通过对漏检率和虚警率分别设置 代价损失系数来平衡漏检率和虚警率，使总的错判率达到最小，但此种方法不能 从本质上提高检测性能，能量检测的局限性依然存在。
如果将噪声功率的值设置为门限并按传统方法进行判定，那么至少将会有一 半的噪声频点虚警，但是简单的概率知识就能告诉我们，功率谱密度中连续N 个噪声频点的功率值均高于噪声功率的概率会随着N的增大而减小，当N比较 大的时候，概率甚至会接近于0,这种情况对于信号频点来说就会不同，由于在 功率谱密度中，属于同一信号的频点的幅值之间存在相关性，连续多个信号频点 高于噪声功率的概率会远大于0。由此可知，如果已知噪声功率，将门限值设置 在噪声功率附近，然后基于频点幅值之间的相关性进行判决，就能有效地检测出 信号，示意图如图3-3所示：



=0.973 (N, = 200, y =-8db)

如式（3-6）和式（3-7）所示（中（?）是标准正态的分布函数），在se%中，对 于单个频点来说，非占用频点功率值高于b；的概率为0.5,而对被占用频点来说, 其功率值高于b；的概率正比于N,和/ ,设N, =200 , y = —Sdb ,则 "孑O.o如果我们将噪声功率b；设为门限并按传统方法进行判决， 几乎一半的噪声频点都会虚警，但是连续多个噪声频点功率值都高于％2的概率 非常小，与此相反，由于功率谱线间相关性的存在，属于同一信号的连续多个频 点功率值高于b；的概率就会高很多。例如，分别计算当频点实际被占用和非占 用两种情况下，10个连续频点中有9个及以上频点功率值高于噪声功率的概率, 结果如式（3-8）和（3-9）。可以看出两种情况下概率差别很大，所以可以通过 连续〃个频点中是否有〃I个及以上频点功率高于噪声门限来判定是否存在信号， 其中n1<no由3.5.1的仿真结果可知，％的值取0.8左右时检测性能较好。
爲,0.9739(1 - 0.973) + O.97310 = 0.972
C% 0.5, (l-0.5) + 0.5i° =0.011
3.3.3检测过程
上文中已经证明利用滑动平均窗可以简单快速地找到漏检信号最有可能存 在的位置，然后要做的就是确定漏检信号是否真的存在，如果存在的话确定其带 宽。在s翎中，从/”处开始向左右两边搜寻，如果确实存在漏检信号，则附近漏 检的频点功率值大部分都高于噪声功率b：,所以在碰到功率值低于噪声功率的频点时有两种可能的情况，一种情况是并不存在漏检信号或者此次搜寻己经到达 信号和噪声频点之间的边界，还有一种是碰到了信号频点功率值低于噪声功率的 特殊情况。一种简单的仗分这两种情况的方法是对此频点附近连续多个频点进行 判断，即利用功率谱线间相关性进行判决。
在搜寻的过程中碰到功率值低于以2的频点，需要判定其是否为特例，判定 方法如前所述，对与此频点相邻的后〃个连续频点进行检测，如果有％或以上个 频点功率值都高于b；,则认为此频点实际为被占用，否则，认为找到了信号与 噪声的分界并停止搜寻，其中站＜"。而且，由于判决是基于功率谱线间的相关 性，所以要求信号具有一定的带宽。在判决结束后，统计本次判决中判定为漏检 的连续频点的数目（即此次检测岀的漏检信号带宽），如果数目小于"，认定其 为虚警并结束此次判决。
3.4联合迭代算法
由以上内容可知，在基于功率谱线间相关性的判决中，噪声功率是一个 重要条件，所以准确估计噪声功率也是提高检测率的关键。这里，釆样和第二章 中类似的迭代算法对噪声功率进行估计。首先，计算序列seg】的平均功率记为估 计噪声功率仁2,并利用滑动平均窗找到se%中最有可能存在漏检信号的位置 loc,然后利用丸2对se0进行基于功率谱线间相关性的检测，更新检测结果得到 一个新的非占用序列seg和估计噪声功率&。如果相邻两次估计噪声功率的差 值大于预设值，则继续对seg进行检测，直到相邻两次估计噪声功率差值小于预 设的相对阈值。图3-4是相关性判决的迭代流程图：

估计噪声功率3/
基于功率谱线间相关性的能量检测



更新判决结果，计算出新的估计噪声功率


图3-4迭代算法流程图
考虑实际并不存在漏检信号的情况，搜寻过程在对少数几个频点进行判决后 就会发现不满足相关性条件，判定此处没有漏检信号，所以相邻两次估计噪声功 率值相等，迭代流程终止，基于功率谱线间相关性的判决结束。在传统的能量检 测算法中，由于门限是唯一判决要素，所以虚警率和漏检率是一对相互矛盾的因 素，此消彼长。但在基于功率谱线间相关性的判决中，漏检率降低的同时并不会 增大虚警率，这也是此算法的另一优势所在。
当宽带内信号的信噪比都较高时，初次能量检测能很好地检测出所有信号， 而基于功率谱线间相关性的检测能很快发现并没有漏检信号的存在从而不会增 加无用功，也不会造成虚警率的提升。而当信号的信噪比逐渐下降时，传统算法 的漏检率增大，这时基于功率谱线间相关性的检测开始发挥作用，漏检信号的检 测和噪声功率的估计联合迭代进行，能有效提高检测率，但是当信号信噪比进一 步降低时，基于功率谱线间相关性的检测方法性能也开始下降，此时就要运用复 杂度较高的算法例如循环平稳特征检测才能将其检测出来。
综合以上步骤，基于功率谱线间相关性的能量检测算法的总流程图如图3-5 所示：



CF AR进行初次能量检测
」得到判决为噪声的序列及
* 估计噪声功率
相邻估计噪声功紊—'疽4/
差值小于预设值一--"f "来
找到低通滤波后序列的最大值处
向左右两边搜索，直到遇到
低于估计噪声功率的频点后n个频点中是否至少有nl
个频点高于估计噪声功率一
更新判决结果
图3-5改进能量检测算法流程图
3.5仿真结果及分析
在本章下文中，为了简便，将传统CFAR准则能量检测和噪声估计联合迭代 算法简记为ICFAR,将传统CDR准则能量检测和噪声估计联合迭代算法记为 ICDR,将CFAR能量检测过后再使用基于功率谱线间相关性的能量检测算法（即 本文所提改进算法）记为RBED。


下面将给出本文所提基于功率谱线间相关性的能量检测算法的性能仿真及 结果分析。仿真参数如表3-1所示：
表3-1仿真参数
总带宽	50M
单次采样点数	5000
时域观测时长	200
频率分辨率	10K
ICFAR目标虚警率	0.005
ICDR目标检测率	0.95
ICDR目标检测信噪比	最低检测信噪比-5dB

在宽带内仿真产生多个具有不同功率不同带宽的信号，其中有三个窄带信号 具有相对较高的信噪比，且其参数保持固定不变，同时存在一个宽带低信噪比信 号，信噪比和带宽均可调，以验证基于功率谱线间相关性的检测对低信噪比信号 的检测能力，并研究信噪比和带宽对此算法检测性能的影响。宽带内各信号的参 数如表3-2：
表3-2宽带内信号参数
序号	信号类型	带宽	信噪比
1	窄带信号	100K	7dB
2	窄带信号	200K	4dB
3	窄带信号	400K	IdB
4	宽带信号	可变	可变

3.5.1 n和n1值的设置对判决结果的影响
在3.3.2小节介绍改进算法的理论基础时，指出可以通过连续〃个频点中是 否有％个及以上频点功率高于噪声门限来判定是否存在信号，所以本小节研究" 值和小值的设置对感知结果的影响。固定低信噪比宽带信号的带宽为10MHZ, 信噪比为-8dB,图3-6表示n取不同的值时，％的值对检测结果的影响。由图 3-6可以看出，当取时，错判率相对较大，这是因为设置巧=〃相当于不容 许岀现信号频点的功率值低于估计噪声功率的情况，然而在实际中这种情况是可 能发生的。当取0.6时，会将一部分噪声误判为信号，导致虚警率的上升。 所以当//, hi取0.8左右时检测效果最好。由图3-6还可知，当"取值小于10时,虚警率开始上升，所以在实际中，可取m = 10, ?1/” = 0.8或％/" = 0.9。
基于功率谱线间相关性的能量检测是利用功率谱密度中相邻频点幅值之间 的相关性进行检测，而由仿真可知，〃取大于10的值时这种相关性才能有效发 挥作用，当〃值过小时会造成虚警率的上升，所以要求待检信号至少具有10*10K （10K为频率分辨率）的带宽，当信号带宽过小时检测性能会下降。
由3.2节内容可知，可以利用待检测信号所需的最小带宽必来设置滑动窗口 的大小，由于心10能达到检测性能要求，所以设置滑动窗口的大小*=10。
0.06
0.05
0.04
# 0.03
0.02
0.01


3.5.2信噪比对判决结果的影响
首先研究信噪比对基于功率谱线间相关性的检测方法性能的影响。固定低信 噪比宽带信号的带宽为5MHz,图3-8为分别使用三种能量检测与噪声功率估计 联合迭代算法情况下对低信噪比信号的检测率。由图3.8可以看出，当信噪比低 于?5dB时，传统能量检测算法检测性能较差，但基于功率谱线间相关性的能量 检测算法即使在-8dB情况下也能把低信噪比信号几乎全部检测出来。在信噪比

由图3-8可知，基于功率谱线间相关性的能量检测算法能有效地提高对低信 噪比信号的检测率。一般情况下，检测率的提高会以增大虚警率为代价，所以下 面我们研究三种检测方法分别带来的虚警率，如图3-9所示。由于初次能量检测 使用的是ICFAR,而由图3-9可以看岀，RBED和ICFAR的虚警率几乎完全一 致，说明在ICFAR之后的基于功率谱线间相关性的检测并没有提高虚警率，与 上文的分析完全一致。


图3-10是对整个宽带内信号的错判率。由于基于相关性的检测能在保持虚 警率的条件下有效提升检测率，所以整体错判率会下降，如图3-10所示。

3.5.3信号带宽对判决结果的影响
在研究信噪比对检测结果的影响时发现，在低信噪比情况下，基于功率谱线 间相关性的能量检测算法具有较好的检测性能，而在前文中我们也提到，基于功 率谱线间相关性的能量检测要求待检测信号具有一定的带宽，那么如果待检测信 号的带宽过小时会有什么现象发生，而且在整个宽带内低信噪比信号的占用率过 高，会不会给噪声功率的估计带来困难，从而影响判决结果，下面我们研究低信 噪比信号的带宽对检测结果的影响。
固定宽带信号的信噪比为-8db,图3-11为三种能量检测算法对低信噪比信 号的检测率随低信噪比信号带宽的变化。由图可以看出，当信号带宽小于30MHz 时，基于功率谱线间相关性的能量检测相较传统算法性能提升较大。在带宽进一 步增大时，基于相关性的能量检测算法检测性能会随着带宽的增大而降低，但与 传统算法对比仍然有较大的性能提升。


由本小节仿真结果可知，当低信噪比信号的带宽占用率较大时，基于功率谱线间相关性的能量检测算法性能开始下降，分析原因可知是因为占用率较大时， 初次能量检测后漏检信号过多，估计得到的噪声功率高于实际值，迭代法的初始 值设置过高，导致判决结果漏检率升高。下面以理论证明验证此猜想的正确性：
记初次能量检测的门限值为心?加，在M和<7；固定时，L袂的值由目标虚 警率丹决定，所以当目标虚警率保持不变时，Lqg也保持不变，从而对于某待 检测信号来说，其被漏检的概率
p _ 1	成％CFAR - (Z； +CT/ ))
心 0	)
也保持不变，记信号在总频带中占用率为〃，则漏检信号频点在总频点中的占用 率为:
rjPm冲反也半竺
随着〃的增大而增加。
在初次能量检测过后，功率低于匕虹，僦的频点被用来估计噪声功率，其中包 括没有虚警的噪声频点和漏检的信号频点，其中漏检信号频点在总频点中的占用 率为〃 R，正确判决的噪声频点在总频点中的占用率为（1-〃）（1-与），计算可得估 计噪声功率为



_(5 )頒 +r)p” +X1
卩—, ~ — -1 1 1 ~ —
%；	(5)6弓+7)4
记#为估计噪声功率与实际噪声功率的比值，当设置目标虚警率为7>=0.005，信 噪比y = —8dB时，计算可得此时R=0.6136,由式（3-13）仿真得到#与信号占用 率〃的关系为：

由图3-12可知，估计噪声功率和实际噪声功率的比值〃与信号占用率成正 比，当低信噪比信号的占用率过大时，初次CFAR能量检测过后，噪声功率估计 值过大，这样被占用频点的功率值高于估计噪声功率的概率会降低，如图3-13 所示，从而导致本章提出的基于连续多个频点功率值髙于噪声功率的检测方法漏 检率增大。
单个被占用频点高于估计噪声功率的概率为：
(<V -(1+/K)何、—(/2-1- y)回、
~~(17^7)=0—FT?―)
仿真得到其与占用率的关系为:
由图3-13可以看出，信号带宽占用率越大，H「.P(T>&；)越小，连续多个被 占用频点高于估计噪声功率的概率相应减小。例如当占用率火为0.6时， Hx : P(T> )= 0.84,此时 C%0.843，(l-0.843) + 0.843'。=0.519 ,所以在占用率较大时, 基于功率谱线间相关性的能量检测也会有较大的漏检率。

图3-14为实际仿真中，初次能量检测过后噪声功率估计值与实际噪声功率 的比值，对比图3-12可知，与理论结果几乎完全一致。

图3-14带宽占用率对估计噪声功率理论值和实际值的影响对比

以上分析了当低信噪比信号占用率较大时漏检率升高的理论原因，为了验证 理论分析的正确性，在仿真中以实际噪声功率代替估计噪声功率进行基于功率谱 相关性的能量检测，检测率和迭代次数如图3-15和图3-16所示。

图3-15噪声功率已知时信号带宽对检测率的影响



图3-16噪声功率已知时信号带宽对迭代次数的影响
结论：如图3-15所示，如果噪声功率已知（或噪声功率估计正确），在信号 占用率高时，基于功率谱线间相关性的能量检测也具有很好的检测性能，这证明 了 RBED在高占用率下性能较差的原因是对噪声功率的估计不准确。而对比图 3-16和图3-18可知，当噪声功率估计正确时，信号占用率过高不会造成迭代次 数的不正常减少，从而也不会造成漏检率的升高。
以上内容都是在低信噪比信号具有较大带宽时的仿真结果，而基于功率谱线 间相关性的能量检测要求待检测信号具有一定的带宽，所以下面我们来研究当低 信噪比信号带宽过小时的检测性能。


图3-17所示仿真结果中，横坐标的单位为信号频点的数目，仿真条件己知 频率分辨率为10K。由图示可以看出，当信号带宽较小，占用频点个数小于32 时，改进算法的检测性能开始下降。这与前文的推理一致，即基于功率谱线间相 关性的能量检测算法要求待检信号具有一定的带宽。


3.5.4迭代精度对结果的影响
迭代法能很好地在先验信息全盲的条件下对噪声功率进行估计，迭代终止的 条件为|丸其中〃值代表了迭代精度的大小，疗设置越小，迭代精 度越高，代表需要较多的迭代次数以完成较高的精度，下面研究『的设置对迭代 次数和检测性能的影响。固定低信噪比宽带信号的信噪比为-8dB,图3-18和图 3-19表明在不同信号带宽下迭代精度月对迭代次数和检测率的影响，结果显示, 户越小，检测性能越好，但迭代次数会增加。在月固定的情况下，迭代次数会随 着低信噪比信号的带宽增大而增多，但在低信噪比信号接近1的时候，迭代次数 反而会降低，由3.5.3的分析可知，这是由于对噪声功率估计不准确造成的。


sopIq u.21￡￡
5	10	15	20	25	30	35	40
bandwidth(MHz)
图3-18不同迭代精度下信号带宽对总迭代次数的影响
bandwidth(MHz)
图3-19不同迭代精度下信号带宽对检测率的影响

3.6本章小结
传统的能量检测算法在低信噪比环境下性能较差，往往会造成信号的漏检。 而在一般情况下，信号的带宽大于频率分辨率，所以在功率谱密度中，功率谱线 之间会具有相关性，表现为属于同一信号的多个频点会连续高于噪声功率，而属 于噪声的频点其幅值会在噪声功率附近上下浮动，噪声频点之间并不具有这种相 关性。基于信号和噪声在功率谱线间相关性的差异，本章提出了一种改进的能量 检测算法，能有效检测出传统算法漏检的低信噪比信号，而滑动平均窗的使用能 快速找到最有可能存在漏检信号的位置，大大降低工作量。仿真结果表明，改进 算法在低信噪比环境下的检测性能得到了明显的提升，当信号占用率过大时，由 于噪声功率估计不准确，检测性能会随着信号占用率的增大而下降，而当待检测 信号的带宽过小时，功率谱线间的相关性不能发挥作用，所以检测率也会下降。

第四章频谱感知数据的预测
认知无线电的主要功能是感知和利用空间内的可用频谱，尽量避免和主用户 之间的冲突。频谱感知技术是对周围频谱环境的实时感知，能找到频谱空洞供次 用户使用，但次用户在使用频谱空洞的同时应监测主用户是否重新出现，如果主 用户出现，应马上停止对该频段的使用，以免冲撞主用户。如果认知基站仅根据 即时感知结果进行频谱空洞的选择，那么很有可能会选择到一个可用时长较短的 频段，从而不得不在短时间内进行切换，这不仅会增大开销，还有可能对主用户 造成干扰。所以在实际应用场景中，如果能找到一个频段，其不仅在当下未被占 用，并且能在未来较长时间内都为空闲状态，这样就能有效地降低切换率，避免 频繁切换带来的开销。而想要实现此功能，需要知道频段未来一段时间内的干扰 值，这就必然要用到数据预测技术。而在近现代，由于计算机和数据库技术的蓬 勃发展，无论是存储数据的能力还是处理数据的速度都得到大大提升，在此基础 上，数据预测技术也引起人们的研究热潮。目前常用的数据预测技术有支持向量 机、人工神经网络、时间序列分析等。
虽然在众多学者的研究下，大批优秀的数据预测方法己经广为使用，但并不 是每一种数据预测方法都适用于所用数据。数据都有其自身独特的特点，每种预 测方法也有其优缺点，所以在实际应用中，应根据数据的规模、维数等特点来选 择合适的预测方法。例如，支持向量机是近年内出现的比较优秀的数据挖掘新方 法，能解决高维、非线性问题，还可以避免局部极小值，但是它在处理大规模数 据时存在训练时间过长和占用内存空间过大的问题⑵］。神经网络具有强大的自 学习自组织能力，能处理不完整的、模糊不确定的或规律性不明显的数据，但其 学习速度过慢，而且网络结构的选择较困难，没有成熟的、统一的理论指导。所 以，下面我们将会先分析频谱数据的特点，结合认知基站对数据预测精度、时间 等的要求，进行预测方法的选择。
4.1预测方法的选择
在设计频谱感知数据的预测模型时，应首先分析频谱数据的特点，根据其特 点进行预测方法的选择。由于认知基站对周围环境的感知是间隔性的，而且感知 数据是数字方式的，所以频谱数据具有非连续性；而在实际场景中，频带内的干 扰水平往往随着时间呈现周期性的趋势，比较常见的情形是某一频段在一天的不 同时间段内具有不同的干扰强度，也即以天为周期，所以频谱数据一般具有周期性；由于感知的时间间隔较短，而且在每次感知中宽带内频点较多，随着时间的 累积，基站将会存储海量的频谱数据，所以海量性是频谱数据的另■一个特点。
认知基站在进行空闲频段的选择时依赖于两个因素，第一是即时感知结果， 第二是频段内干扰水平的预测结果。而其中即时感知结果是决定性的因素，因为 再精准的预测都不能达到100%的正确率，所以认知基站只能在确定频段空闲可 用的情况下，再结合预测结果在空闲频段中进行选择。对频带内干扰的预测也有 两种方法可选：第一种是进行全频段各频带的预测，但是这会带来非常大的工作 量，因为各频带内干扰预测模型可能不同，而且对那些即时感知结果中非空闲的 频带进行干扰预测对动态频谱接入没有任何意义。所以，如果只对此次感知中判 断为空闲的频带进行干扰预测，能大大减少工作量。而因为感知结果是即时的， 需要在感知出空闲频段后马上对此频段未来的干扰水平进行预测，由于需要结合 预测结果进行动态频谱接入，如果预测所需时间较长，即时的频谱感知结果可能 不再有效，而且会降低效率，所以要求预测方法应具有较短的预测时间。
一般情况来说，在相同的硬件条件下，预测速度和精度往往不能兼得。例如, 神经网络、支持向量机等具有较高精度的预测方法共同的缺点就是学习时间过 长，预测速度过慢，而且适用于高维（特征值较多）的数据集。而像线性回归， ARMA模型等方法，虽然在精度上略逊一筹，但是由于其计算相对较简单，所 以具有很快的预测速度。
由于频谱数据具有非连续性和时间周期性，并且系统需要较快的预测速度， 所以本文选取时间序列预测方法，在本章后续内容中，首先介绍其理论基础及利 用时间序列预测模型进行预测的常用步骤，最后验证时间序列预测在频谱预测场 景中的有效性。
4.2时间序列预测
时间序列是指将某种现象的某一个指标在不同时间上的各个数值，按其出现 时间的先后，且具有相同的间隔时间，进行排列而形成的序列。时间序列预测是 一种定量预测方法，根据存储的历史序列数据，建立以时间为自变量的描述序列 的模型，然后对未来值进行预测。时间序列预测方法以统计学为基础，是一种被 广泛应用的预测手段。目前时间序列预测算法有很多，如何找到合适的预测算法, 并能够在现有算法的基础上提岀一种能够适用于频谱感知数据序列的算法，以提 高预测的准确性是本文硏究的重点。
常用的时间序列预测算法：
移动平均法
移动平均法又称滑动平均法(MovingAverage,简称MA),它的基本思想是 由历史数据的平均值来预测长期的趋势，而且随着时间增长，历史数据项应向后 推移。移动平均法历史悠久，其原理和计算简单，在预测过程中能平滑掉时间序 列的随机波动，显示岀事件的趋势，但也正因为此，其对数值实际变动不敏感， 预测精度较低。
分解方法
分解方法的基本思想是将时间序列分解为由季节因子、趋势因子、循环因子 等组成。这种方法目前主要作为其它预测方法的组成部分，一般并不单独使用。
指数平滑方法
指数平滑法[列其实是一种特殊的加权平均法，它的工作原理是如果观察值 离预测值越远，则其权重越小，并且权重是按指数规律递减。
ARIMA 模型
ARIMA模型的全称为求和自回归移动平均模型(Auto Regressive Integrated Moving Average Model),简记为 ARIMA (p,d,q)模型，其中 AR(p)代表 p 阶自 回归模型，MA(q)代表q阶移动平均模型，d代表在去除时间序列的非平稳性时 所做的差分次数，一般为1或者2。ARIMA模型是一种时序短期预测模型，其 基本思想是：预测对象是以时间t为主要变量的一个随机序列，虽然其中的单个 值是随机变量，但对于整个序列来说，可以找到一定的规律来描述它们，而一般 这种规律都可以简化为数学模型。
在以上几种时间序列预测算法中，ARIMA模型理论较成熟，预测精度相对 较高，所以获得了广泛的应用。本文也将重点研究ARIMA模型的理论基础、预 测的基本步骤及其在频谱感知数据预测中的应用。
4.2.1 ARIMA模型理论基础
求和自回归移动平均模型在时间序列预测中占据重要地位，由自回归模型 (简称AR模型)与移动平均模型(简称MA模型)为基础“混合”构成，下面 将首先分别简单介绍两种模型的理论基础，然后将两种模型结合起来得到 ARIMA模型【23】。
移动平均模型
g阶移动平均过程MA(q)由式(4-1)表征：
Y, =M + e,+ 牛,+ ? ? ? + 財 f	(4-1 )
其中｛号｝为白噪声，满足条件 E(e,)=(, ￡(￡,2) = cr2 ? ￡,(￡[￡r) = 0 (Z*r),

〃，岫.?&为任意常数。下面我们先来研究K的数字特征。
匕的期望：￡(匕)=〃
匕的方差：E(Y,-jU)2 =(1 +尊+弯+... +君商
丿阶自协方差为：
八」，+辭耳+旦诙+??? + "“"勺=1，2,?*	(4_2)
J 1°	J>Q
由于上述均值和协方差与时间无关，所以对于任意的(幻凡,…,％)值，MA(q) 都是协方差平稳的，对于高斯勻，MA(q)过程关于所有的矩是遍历的，由式(4-2) 可知，超过g阶滞后的自相关系数为零，此特性决定了后续过程中ARIMA模型 阶数的确定。
自回归模型
P阶自回归过程，记作AR(p),满足K=c+^t+/-2+"? + "e + s,也即 (1-解依所用=钥)T =CE,其中爲为满足条件E(e,)= (, E(") = —, E(県) = 0(，E 的白噪声，B为滞后算子。缗是特征方程 中(3) = 1-辭_液瘁——俨"=0的根，为保证平稳性，我们要求|引<1。
经数学计算可知，其自相关函数丹满足PjM\PZSPx+?“ +虬Pf丿= 1,2、...
上式的通解为？=&"+&後+g3々""+gM/，在实际中，如果我们假定根是 互异的，会有两种不同的情况：
1.人，是实根，由于|4|<i,所以g,紀随/的增大会逐渐衰减到零，这种衰减一 般被称作为指数衰减。
一对共斩复根，这使得自相关函数呈衰减的正弦震荡。
一般情况下，一个平稳自回归过程的自相关函数会岀现指数衰减和正弦震荡 衰减相混合，此时很难根据衰减来确定自回归过程的P值，但是可以根据自相关 函数的P个非零函数来描述其自身的特性，这就是偏自相关函数的定义，用4记 力阶回归表达式中的第丿个系数，直*就是最后一个系数，久满足下面方程组：
Pj -KxPj-x	+'"+<!>kkPj-k j = 1,2,…,k	(4-3)
一个p阶自回归过程，当(小于或等于p时，偏自相关函数久不为零，而上大 于p时，旅为零。也就是说，”阶自回归过程的偏自相关函数是截尾的，而截尾 的阶数即为p。
由以上理论推导可知，当MA过程的阶数有限时，其自相关函数会呈现截 尾特性，而有限阶的MA过程等价于一?个无限阶的AR过程，所以其偏相关函数 会无限衰减，且由指数衰减和正弦震荡衰减混合而成，与此相反，AR过程的偏自相关函数具有截尾性，但是它的自相关函数由指数衰减和正弦震荡衰减混合。
求和自回归移动平均模型(ARIMA)
如果时间序列匕满足X * +站_] +M-2 +???。匕一，+耳+醐T +??? +辭*，则 称时间序列匕为服从(P，Q)阶自回归移动平均混合模型。自回归移动平均模型能 有效处理平稳性时间序列。而对于一些非平稳性时间序列来说，虽然均值与时间 t有关，但是如果去除掉随时间，变化的均值的影响，整个序列会呈现出平稳性。 如果均值随r的变化是由周期性带来的，那可以通过差分的方式使序列平稳化， 一般情况下1阶差分可以满足需求，而有些序列需经多次差分才能去除非平稳 性，记差分的次数为d,称这种首先通过差分进行平稳化的模型为求和自回归移 动平均模型。
ARIMA过程定义为如下方程：
4(B). = c+6(B)弓	(4-4 )
这里0(B)和9(B)分别是滞后算子B的p阶和q阶算式，它们的零点都在单位 圆外，△为差分算子。该模型根据p和0的取值不同，可以分为自回归模型，移 动平均模型，自回归移动平均混合模型，以及所有这三种模型的任意求和形式。
一般设计AR1MA模型的步骤为：1.对匕进行差分去除其非平稳性，差分的 次数由序列的特性决定，因为只有平稳时间序列才能由自回归移动平均混合过程 0(B)s=c+6(B)弓表示，其中0,=A^。2.识别所得到的ARMA过程。为了实现1 和2,样本的自相关函数和偏相关函数是我们最重要的工具，可以根据它们的截 尾特性来确定模型的组成形式以及各项阶数。
4.2.2 ARIMA模型预测
平稳性判断
伍德里奇《计量经济学导论》里说：如果允许两个变量之间的关系在不同时 期随意变化，那么，在只能得到时间序列的单个实现的情况下，我们就无法知道 一个变量的变化如何影响另一个变量"I。这句话的意思是说在时间序列具有非 平稳性时，我们无法对其进行建模，所以对时间序列进行平稳性的判断是建立模 型的首要步骤。在时间序列呈现非平稳性时，要先利用差分法或其它方法去除时 间序列的非平稳性。判断时间序列的平稳性有几种常用的方法HA：
数据图直接检验法
自相关、偏相关检验法
特征根检验法
R*检验
其中自相关、偏相关检验法的原理是：对于平稳序列来说，由4.2.1小节的 理论基础可知，其自相关函数和偏相关函数要么具有截尾性，要么具有拖尾性， 不可能具有第三种形态。所以如果一个序列的自相关函数和偏相关函数既不截尾 也不拖尾，就认为序列非平稳，此时要通过差分或其它方法去除其非平稳性。
平稳性判断的第一步是得到零均值序列，所以要首先求取时间序列的均值， 然后将序列中的各个数据减去均值，然后画出此零均值序列的自相关和偏相关函 数图。如果函数图截尾或者拖尾，则证明时间序列是平稳的，直接进行下一步操 作，而如果函数图既不截尾也不拖尾，证明时间序列具有非平稳性，则要先去除 其非平稳性。
去除非平稳性
ARMA模型只能用来预测平稳性数据，而实际数据往往是非平稳的，所以 如果在利用自相关和偏相关函数图发现时间序列非平稳性之后，要先去除其非平 稳性，才能继续进行下一步操作。去除非平稳性的方法主要有：
小波分析法
小波分析法由于其优良的性能得到快速的发展，被广泛应用在信号分析、图 像处理等领域。在去除非平稳性时是利用小波分析将非平稳性的时间序列进行分 解，分解为多个平稳或近似平稳时间序列之和，然后再分别对各个平稳时间序列 进行建模，最后将预测模型进行非线性组合，得到非平稳时间序列的预测模型。
差分法
如果时间序列的非平稳性是由周期性带来的，那么差分法是一种有效的去除 非平稳性的方法。在实际应用中，可以先对非平稳时间序列进行一次差分，然后 对差分后的序列进行平稳性判断，如果非平稳，则进行二次差分。如果二次差分 后序列仍然具有非平稳性，证明差分法可能不适应于此时间序列，可以改用分解 法等别的方法。
模型阶数确立
由上…小节对ARIMA模型的分析可知，自相关函数和偏相关函数在模型阶 数的确定中占据重要地位。对于移动平均模型来说，超过g阶滞后的自相关函数 为零，而対于自回归模型来说，超过p阶的偏相关函数为零。但是在实际中，样 本的相关函数往往不会在理论截尾之后立马衰减为0,会有小幅度的震荡。

一般有两种方法来判断ARMA(p,q)的阶：
第一种是试验法，任取一组p和q的值，建立ARMA (p,q)模型，利用此 模型对时间序列进行拟合。为了验证取值是否合适，需要求得,原序列和拟合序列 的差值，如果差值是白噪声，那么证明此次试验得到了正确的结果，而如果差值 不是白噪声，那么要重新换一组值。试验法盲目性较大，所以一般会釆取第二种 方法。
第二种方法是首先固定ARMA混合模型中其中一个模型的阶数，然后利用 这个单独的模型进行拟合后，求取拟合序列和原序列的差值，再分析差值的相关 函数得到另一个模型的阶数。例如，可以先固定AR(p)模型的p值，利用AR(p) 模型对序列进行拟合，如果差值的自相关函数截尾，那么证明p值的选取合适， 并且将此截尾阶数作为MA的q值，而如果差值的自相关函数不截尾，证明p 值选取不合适，要重新进行p值的设置。
模型的训练和预测
在去除时间序列的非平稳性步骤中，如果利用的是差分法，则得到一个差分 后的平稳时间序列，在确定ARMA模型阶数之后，利用差分后的平稳时间序列 进行模型的训练，训练出预测模型之后，对未来值进行预测。而由于建模使用的 是差分后的序列，所以应该对预测值进行反差分，才能得到正确的预测值。
综上，利用ARIMA模型对数据进行预测时，基本流程如下图所示：


模型训练

*
预测
〔结束丿
图4-1 ARIMA模型预测流程
4.3信源数据产生模型
为了验证时间序列预测技术能应用于认知无线电领域，也即能有效预测频谱 感知数据，本节将首先模拟现实中认知基站实时感知的频谱图，也即模拟认知基 站在运动过程中接收到的信号干扰情况，简称信源。本文设定信源为认知基站在 地球表面上空进行循环感知得到的，下文将分别从地理模型、传播模型、用户业 务模型三个方面介绍信源仿真模型，最后给岀信源仿真结果。
4.3.1地理模型
地球表面由不同经度与纬度所表示的地理位置构成，在本文中，假设认知基 站沿着某一纬度线围绕地球旋转，所以对地球某一纬度内的地理区域进行模拟。 由于地球的形状为球形，所以实际中同一纬度的地理区域应为环状，而在本文中 为了方便表示将其展开为条形区域，并将总的感知区域简化为由三种不同的地理 类型构成。由于不同的地理位置具有不同的人口密度，而不同的人口密度会造成不同的干扰接入强度，所以可以结合地球表面的特性将感知区域划分成三种不同 的地理类型，并建模为由大小相同的地理格构成。由于认知基站运动在地球表面 上空，所以其感知覆盖区域有限，而且随着认知基3占的运动，其覆盖区域也在变 化。
认知基站感知模型如图4-2所示，三种不同的地理区域分别为陆地，海边和 海洋，陆地由于人口密集所以其干扰接入强度最大，海边次之，海洋最小，每种 地理区域由一定数目的地理格构成，由于地理格是大小相同的，所以地理格的数 目代表地理区域的面积，具体的分配如表4-1所示。本文设定地理格为正方形， 其边长为250协，总的感知区域被划分为100个地理格，认知基站在地面上空 500血，一次感知覆盖的地面范围为9*1个地理格，而在每次感知间隔内，由于 认知基站的移动，覆盖区域移动1个地理格。由于感知区域本身是环形，只是为 了方便展示将其展开为条形，所以当认知基站的覆盖区域中心到达最后一个地理 格后会重新回到第一个地理格。记起始感知时刻为9:00,感知时间间隔为 7.2mins,基站感知覆盖区域的中心从第一个地理格到最后一个地理格记为一轮， 则一轮感知时间为12小时。






图4-2认知基站感知模型图 表4-1地理格分配
区域类型	海洋	海边	陆地	海边	海洋
地理格个数	25	5	40	5	25
4.3.2传播模型
由于认知基站位于地面上空，地球表面的用户信号到达认知基站会有一定的 损耗，并且感知覆盖范围为9*1个地理格，覆盖范围内不同地理格到达认知基站 的距离不同，所以损耗也会不同，需要建立模型计算信号传播过程中的损耗。自 由空间传播模型是无线电波传输的最简单也最常用的模型，在自由空间传播模型 中，无线电波的损耗只和传播距离和电波频率有关系。自由空间损耗模型描述了 电磁波在空气中传播时候的能量损耗，是比较常用的模型。式(4-5)为自由空 间损耗模型的计算公式0】，其中人为电磁波的波长，。为传播距离：

101g((—)2) = 20 lg(^F)+ 20 lg f(Hz) + 20 lg d{m)
4" 10
=201g(—y-) + 20 lg f(MHz) + 20 lg d(Km) =32.45 + 20 lg( J) + 20 lg(/)
其中距离d的单位为出”，频率/的单位为MHz,匕的单位为必。
每个地理格内的用户散落在地理格内，到达认知基站的距离都各不相同，但 是为了简便起见，某一地理格内用户到达认知基站的距离均简化为地理格中心到 达认知基站的距离。将通信的频率固定在2GHz,由地理格的边长和认知基站到 地面的距离可以算出各地理格中心到认知基站的距离，再由自由空间损耗公式计 算岀感知覆盖区域内各个地理格内的用户信号到达认知基站所经受的损耗，如下 表所示(感知覆盖区域为9*1的地理格，编号分别记为-4, -3, -2,-1, 0, 1, 2, 3, 4)：
表4-2覆盖区域损耗表
地理
格编
号	-4	-3	-2	-1	0	1	2	3	4
损耗
/dB	179.5	177.6	175.5	173.5	172.5	173,5	175.5	177.6	179.5

4.3.3用户业务模型
上文中已提到，不同的地理类型决定了不同的人口密度，而人口密度决定了 干扰接入的强度，所以给不同的地理类型设置不同的用户接入强度，而每个地理 格内用户的接入数目服从泊松分布：
也 (4-6)
11 k\
其中％即为用户接入强度，即单位时间内接入的用户数，记感知间隔为『，由概 率论的知识可知，在感知间隔内接入单个地理格的用户总数的均值应为爲T。而 在实际应用中，不能将地理格内的接入用户数作为最终的用户数目，还要考虑用 户的退出数目，而用户的退出由通话时长决定，一般用负指数模型来对通话时长 进行建模。设用户通话时长服从负指数分布/(x) = ^(x>0),那么经证明可知， 用户的接入数目减去退出数目后，地理格内实际的用户数也服从泊松分布，分布 参数为爲?(1 一。一打)/刃2刀。
对于同一地理类型来说，设置白天和黑夜具有不同的用户接入强度。而且在 真实情形中，可能会存在一些固定的或者移动的干扰，所以在感知区域内设置固 定干扰和移动干扰，固定干扰代表感知基站在每一轮感知中，总会在相同位置受 到此干扰影响，而移动干扰代表每次干扰产生的位置是随机的。
假设每个用户发射的信号强度相同，则由地理格内用户的数目和单用户信号 强度可以算出每一地理格内信号的强度，再结合上文中的传播模型将各地理格到 达认知基站的信号强度累加即为此时基站感知到的信号的强度。
表4-3用户接入强度表
区域类型	海洋	海边	陆地
用户接入强度(白天)	10	30	100
用户接入强度(夜晚)	7	25	60

根据以上仿真条件，认知基站在每次感知时，能得到某频段总的感知信号强 度，随着时间的累积，某频段的信源数据如下图所示：


由上图可以看出，仿真产生的信源数据是既有一定的时间规律性，又有干扰 随机性的时间費列。
4.4 ARIMA模型预测信源数据
在仿真出信源数据之后，下一步要做的就是验证ARIMA模型是否能有效预 测信源数据。本节将按照ARIMA模型预测过程中的常用步骤来处理信源数据， 并给出每一步骤的处理和分析结果。其中，训I练数据取5*24小时内感知到的信 源数据，也即5*2*100=1000点数据作为训练数据，对接下来24小时内的信源数 据（2* 100=200点）进行预测。
4.4.1信源数据的平稳性分析
图4-4信源数据的自相关函数图，由图示可知，自相关函数既不截尾也不拖 尾，所以信源数据是非平稳的，在建立ARMA模型前需要先去除其周期性。
Sample Autocorrelation Function



4.4.2去除非平稳性
在实际中，时间序列的非平稳性往往是由其周期性成分引起的，如果能准确 地分析出其周期特性，不仅能更好地对时间序列进行描述，还能以序列的周期为 间隔进行差分，以消除时间序列中由于周期性成分带来的非平稳性。上文分析中 已经提到，信源数据的其中一个特点就是周期性，但是其周期未知，所以需要先 确定其周期性。
傅里叶变换的本质是将信号分解成各不同频率正弦波信号的叠加，变换到频 域后表现为各频率分量处的幅值代表该频率信号分量的大小。对于具有周期性的

时间序列来说，利用傅里叶变换进行频域分析，除原点外（代表直流分量）最大 幅值所在的位置代表了最强的周期性对应的频率。所以可以利用傅里叶变化对时 间序列的周期性进行分析。?
下图为对信源数据进行傅里叶变换后得到的能量谱的正半轴，为了直观性己 将原点处的值去掉，分析可知除原点外最大值所在位置为X = 10处。记时间序列 的“釆样频率”为力，则对整个时间序列贡献最大的信号的频率为10/1000*九， 由此可得时间序列最强的周期性为1000/10*1=100。
X: 10
Y: 4.42e+06
3
2.5
2
0.5
50	100	150	200	250	300	350	400	450	500
图4-5信源数据的频谱分析图
以得到的周期100为间隔对初始时间序列进行差分，然后画出差分时间序列 的自相关函数图：
Sample Autocorrelation Function



图4?6差分序列的自相关函数图
由差分后时间序列的自相关函数图可以看出，满足拖尾性，即差分有效地去 除了序列的非平稳性。


4.4.3模型阶数的确立
?在得到平稳性时间序列之后，先用AR （1）拟合序列，然后考察残差序列 的样本自相关函数，发现自相关函数没有截尾特性，证明p值选取不合适。所以 增加p值，用AR （2）拟合序列，再考察其残差序列的样本自相关函数，自相 关函数如下所示：

'0	50	100	150	200	250	300	350	400	450	500
Lag
图4-7残差序列的自相关函数图
从图示可以看出，此次残差序列基本满足1阶截尾（在实际中，由于样本的 复杂性，样本的自相关函数往往不会在理论截尾之后立马衰减为0,会有小幅度 的震荡），所以将ARMA模型的阶数设置为（2, 1）,由于在前述步骤中巳经对 时间序列进行一阶差分，所以对信源数据进行预测的模型为ARIMAC2, 1, 1）。
4.5预测结果及分析
在确定ARIMA模型的各阶数之后，下一步就是诊断检验过程。首先根据训 练数据进行模型的训练，训练过程结束之后，利用预测模型对未来200个数据进 行预测，并将预测结果与真实值进行比较，判断此预测模型的准确性。而为了对 预测准确性进行衡量，应首先选取评价指标。
基于预测误差的评价指标常用的有：1.均方根误差（RMSE） 2.平均绝对误 差（MAE） 3.平均绝对百分误差（MAPE） 4.希尔不等系数（TIC）。其中MAPE 值是比较常用的衡量预测误差的指标，其计算公式如下：
帅=丄￡畋二2	（4-7）
X
在本节后续部分对预测结果的准确性衡量中，将会选用MAPE值作为评价 指标。
4.5.1普通预测模型
下图为利用训练出的预测模型对测试集进行预测的结果与实际值的比较，预 测 MAPE 值为 0.3190：


No.
图4-8普通预测结果与实际值对比
分析预测结果可知，训练得到的ARIMA预测模型预测结果相对较准确，但 是不能对感知过程中遇到的移动干扰进行预测。这是因为普通的预测模型只是根 据历史数据进行预测模型的训练，得到预测模型后直接预测出未来一段时间内的 数据，所以无法应对突发性事件。但是分析时间序列的特性可知，时间序列是将 某种现象的某一个指标按其出现时间的先后进行排列得到的，所以在对时间序列 进行预测的过程中，可以将最新获取的实际值应用于预测模型中，而且一般性的 相关性分析都表明离预测值越近的数据与预测值之间的相关性越大，也就是说应 在预测模型中占据更大的权重。基于此，本文提出了一种ARIMA模型的在线预 测方法。
图4-9是普通预测模型的示意图，在训练出预测模型之后，将训练数据作为 预测模型的输入，一次性预测出所有测试数据。

图4-9普通预测示意图

4.5.2在线预测模型
在普通的预测模型中，往往将训练集和预测集分开，训练集用来训练预测模型，预测集用来验证模型的准确度。而对于一般的数据而言，离预测点越近，对 预测值的贡献应越大，因为其代表了序列随时间变化的趋势，所以如果在预测的 过程中根据最新的实际数据来进行在线预测，将会使预测更准确。
图4-10是在线预测模型的示意图。假如记“现在”为时刻f,在线预测模型 只对t~t + M时间段内的数据进行预测，而随着时间的推移，当“现在”时刻变 为t +每时，，?，+攵时段内的数值也变为已知，再将t-t + At时段内己知的真 实值也用于预测模型的输入，对/+A/-/+2A/时段内的数据进行预测，如此直 到将测试数据全部预测完毕。





图4-10在线＜预测示意图
图4-11是在线预测的预测结果，预测MAPE值为0.1477,由图可以看出， 在线预测模型能对突发的随机干扰进行预测。
在线预测虽然比普通预测模型预测精度要高，但存在一个缺点是只能对未来 较短时间内的数据进行预测，而且如果&设置比较短，例如像4-10示意图中所 示每次只对一个数值进行预测，会要求预测速度较快，才能保证预测系统正常运 行，这无疑会对硬件设备带来较大的压力，增大整体的资源开销。

4.6动态频谱接入模型
动态频谱接入技术，是在频谱感知的基础上动态地进行信道的选择，以避免 对主用户的干扰为前提，最大化网络的吞吐量。而仅利用即时感知结果进行的信 道选择可能存在由于信道可用时长较短从而导致频繁切换甚至干扰主用户的情 况。如果能对信道内干扰水平进行预测，并对基于即时感知结果的信道选择进行 修正，就能很大程度上避免切换和碰撞。
在认知无线电系统中，宽带感知相比于窄带感知来说，具有更好的灵活性和 更高的效率。而宽带内往往存在多个不同的信道，各个信道可能由于授权用户不 同而具有不同的使用模式，所以也应具有不同的预测模型。认知无线电的历次感 知能积累大量的频谱数据，基于这些频谱数据可以训练出各信道的干扰水平预测 模型，以在认知用户进行信道选择时提供各个可选信道的预测结果。
在频谱感知过程结束之后，如果感知结果表明有&个候选信道供选择，那么 只需对这上个信道未来一段时间内的干扰水平进行预测，并由预测结果得到各信 道的可用时长等信息，再结合次用户的通信时长需求进行信道的选择，选择原则 为在保证次用户通信时长需求的前提下尽量避免信道的切换。
而在实际中，由于授权用户对信道的使用模式的更改，或者一些突发事件的 发生，往往会导致某些信道的预测模型不再适用，此时需要对预测模型进行更新。 每个信道应使用一个变量/记录在使用此信道进行通信时与主用户发生碰撞的 频率，当碰撞频率过高（大于预设门限）时存在两个可能的原因，一是频谱感知 结果不正确，二是预测模型不再适用，而不论是哪种原因，此时都应停止使用此 信道，对该信道的预测模型进行更新，同时重新进行频谱感知。
图4-12描述了本论文设计的基于信道内干扰水平预测的动态频谱接入模型。


图4-12动态频谱接入模型
4.7本章小结
本章首先分析频谱感知数据的特点，根据其特点选定时间序列预测算法进行 预测，然后介绍几种常用的时间序列预测模型，并对ARIMA模型的理论基础和 预测步骤进行研究。为了验证ARIMA模型在认知无线电技术中的适用性，综合 地理模型、传播模型和用户业务模型产生信源数据，并首先对信源数据进行相关 性分析，然后使用差分法去除信源数据的非平稳性，确定ARIMA模型的阶数后, 利用训练数据训练出预测模型，将预测结果和实际值进行对比，结果表明MAPE 值较小，ARIMA模型能很好地应用于认知无线电技术，最后对基于信道内干扰 水平预测的动态频谱接入模型进行了介绍。

第五章总结与展望
5.1全文工作总结
近年来，随着无线通信技术的快速发展，人们对无线频谱资源的需求逐渐增 长，而实际上，可用的频谱资源其实非常有限，在此前提下，大部门的频段却被 授权给特定的通信业务使用，这导致授权频段的利用率特别低。如果能提高这些 授权频段的利用率，会在一定程度上缓解频谱资源稀缺的压力。认知无线电技术 由于能机会性地接入频谱空洞（暂时没有被授权用户使用的已授权频段），提高 授权频谱的利用率，有效解决频谱资源紧缺和授权频段利用率低之间的矛盾，得 到了广泛的应用。认知无线电的核心技术是频谱感知和动态频谱接入，频谱感知 能实时地感知周围的频谱环境，发现频谱空洞，而动态频谱接入通过判定信道的 可用时长、干扰水平等信息，结合一定的算法选择出最合适的信道供次用户使用。
本文主要针对宽带频谱感知技术和频谱数据预测技术进行了深入的研究，并 提出了改进算法，主要工作内容和成果为：
在主用户先验信息未知的场景下，研究了噪声功率估计和传统能量检测联合 迭代的宽带频谱感知算法。此算法将能量检测的结果用于噪声功率估计，又把估 计出的噪声功率反过来用于能量检测门限值的计算，如此循环迭代直到两相邻门 限值的差小于预设阈值。仿真结果表明其具有良好的收敛性，在信噪比较高时检 测性能良好。但是由于传统能量检测算法在低信噪比下检测性能较差，所以此算 法并不适用于低信噪比环境。
传统能量检测算法在低信噪比环境下性能较差，而目前针对低信噪比环境的 频谱感知算法像循环平稳特征检测具有较高的复杂度。基于以上两点，本文提出 了一种基于功率谱线间相关性的改进能量检测算法。此算法在先验信息未知的前 提下，对噪声功率进行较准确地估计，并基于信号和噪声在功率谱线间相关性的 差异检测出低信噪比信号，仿真结果表明改进算法在低信噪比环境下具有良好的 检测性能，并且在降低漏检率的同时不会造成虚警率的提升，同时具有较低的复 杂度。
目前的认知无线电技术主要根据即时感知结果进行信道的选择，但是可能存 在信道使用时长较短从而造成频繁跳变的问题，此种信道选择机制也容易造成对 主用户的干扰。本文以时间序列预测算法研究频谱干扰，对信道内未来干扰情况 进行预测，以使认知中心能结合预测结果对基于即时感知结果的信道选择进行修 正，有效延长平均信道使用时长，降低跳变率和跳变开销。

5.2下一步的工作
针对本文所做的对于频谱感知和频谱数据预测技术的研究，在很多方面还有 改进和提升的空间，今后的研究方向主要包括以下几点：
本文提出了一种基于功率谱线间相关性的改进能量检测算法，此算法相 较于传统的算法更能适应低信噪比环境，且不会造成虚警率的提升。但是改进算 法的能力有限，当信号的信噪比进一步降低时，改进算法也不能将信号完全检测 出来。是否能进一步改进算法，使其适应于更低信噪比环境，是下一步研究的一 个方向。
当低信噪比信号在宽带中占用率过大时，由于噪声功率估计不准确，检 测性能会随信号占用率的增大而下降。所以如何提高噪声功率估计的准确性，或 者能不能采用除迭代法之外其它的噪声功率估计方法，并与基于功率谱线间相关 性的改进能量检测算法相结合，使高占用率下的检测性能更良好，将会是提高本 文所提改进算法适用性的关键。
在仿真产生信源数据的过程中，对地面类型和用户数目进行了抽象和简 化，如果能进一步细分地面类型，使其更接近真实情况，同时细分地理格，并使 每个地理格内的用户接入强度差异化，会使仿真产生的数据更真实，用来验证时 间序列预测在认知无线电中的应用更具有说服性。
结合即时频谱感知结果和频谱预测数据的动态频谱接入模型还较简单， 下一?步可以重点研究信道选择算法和预测模型更新算法。

参考文献
[1]P Kolodzy. FCC Spectrum policy task force report [R]. Washington: ET Docket, 2002: 2-155.
[2]Taki M, Lahouti F. Discrete Rate Interfering Cognitive Link Adaptation Design with Primaiy Link Spectral Efficiency Provisioning [J]. IEEE Transactions on Wireless Communications, 2010, 9(9): 2820-2832.
[3]Catreux S, Driessen P F, Greenstein L J. Data throughputs using multiple-input multiple-output (MIMO) techniques in a noise-limited cellular environment [J]. IEEE Transactions on Wireless Communications, 2002, 1(2): 226-235,
[4]Mitola J, Maguire G Q. Cognitive radio: making software radios more personal [J]. Personal Communications, 1999, 6(4): 13-18.
[5]周小飞，张宏纲.认知无线电原理及应用[M].北京邮电大学岀版社，2007.
[6]贺新颖.基于支持向量机的认知无线电若干关键技术研究[D].北京：北京邮 电大学,2009.
[7]贺新颖，曾志民，郭彩丽.基于概率密度估计的认知无线电动态频谱接入算 法[J].北京邮电大学学报，2009, 32(1).
[8]Sobron I, Diniz P S R, Martins W A. Energy Detection Technique for Adaptive Spectrum Sensing [J]. IEEE Transactions on Communications, 2015, 63(3): 617-627.
[9]Juei-Chin Shen, Alsusa E. Post-combining Based Cyclostationary Feature Detection for Cognitive Radio Over Fading Channels [C]. Proc, of Global Communications Conference, 2013: 1095-1100.
[10]Pu Wang, Sahinoglu Z, Man-On Pun. Persymmetric Parametric Adaptive Matched Filter for Multichannel Adaptive Signal Detection [J]. IEEE Transactions on Signal Processing, 2012, 60(6):3322-3328.
[11]Atapattu S, Tellambura C, Hai Jian. Energy detection based cooperative spectnjm sensing in cognitive radio networks [J]. IEEE Transactions on Wireless Communications, 2011, 10(4): 1232-1241,
[12]康桂华，李佳垠.认知无线电中基于HMM的动态频谱接入技术[J].解放军 理工大学学报:□然科学版,2008, 9(6).
[13]葛道凯.E-leaming学习过程中的数据挖掘[J].中国远程教育，2011,22: 44-44.
[14]邓乃扬，山英杰.支持向量机-理论，算法和拓展[M].科学出版社，2009.
[15]Hippert H S, Pedreira C E, Souza R C. Neural networks for short-term load forecasting: a review and evaluation[J]. IEEE transactions on Power Systems, 2001, 16(1):44-55.
[16]壬丽贤’时间序列预测技术研究[D].天津：天津理工大学，2011.
[17]刘子扬，彭涛，郭海波等.干扰系统先验信息未知的宽带能量检测卩].北京 邮电大学学报，2012, 35(5).
[18]劳子轩，刘子扬，彭涛等全盲频谱感知：噪声估计与能量检测联合迭代算 法卩丄 电于」丿信息学报，2013, 35(8): 1958-1963.
[19]袁龙.基于噪声估计特性的频谱感知能量检测技术[D].北京：北京邮电大 学，2014.
[20]壬玉孝.概率论-与随机过程[M]北京邮电大学出版社，2005.
[21]Cao L J, Tay F E H. Support vector machine with adaptive parameters in financial time series forecasting [J]. IEEE transactions on Neural Networks, 2003, 14(6): 1506-1518.
[22]Abderrezak L, Mourad M, Djalel D. Very short-term electricity demand forecasting using adaptive exponential smoothing methods[C]. Proceeding of the 15th International Conference on Sciences and Techniques of Automatic Control and Computer Engineering, 2014,
[23]詹姆斯D.汉密尔顿.时间序列分析[M].中国社会科学岀版社，1999.
[24]J.M.伍德里奇,计量经济学导论：现代观点[M],中国人民大学出版社，2003.
[25]朱军生.小波分析在害虫预测中的应用研究[D],南京：南京农业大学，2011.
[26]Katircioglu O, Isel H, Ceylan O. Comparing ray tracing, free space path loss and logarithmic distance path loss models in success of indoor localization with RSSI [C]. Proceeding of the 19th Telecommunications Forum, 2011: 313-316.
[27]邢禄.卫星通信易配置干扰源仿真技术[D].北京：北京邮电大学，2014.

