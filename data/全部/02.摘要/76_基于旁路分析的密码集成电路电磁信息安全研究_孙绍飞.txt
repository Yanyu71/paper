摘要
万物互联(Internet of Everything, IoE)使得越来越多的智能硬件 融入到现代生活当中，随之而来的智能硬件设备间物理信息安全问题 也逐渐显现。密码集成电路是智能硬件的基础，其安全性往往是通过 密码算法来进行保护。虽然密码算法设计在数学理论上是安全的，但 是这并不能保证其在物理实现上的安全性。电磁旁路分析主要是利用 密码算法在实现过程中的电磁发射泄漏来获取其中秘密信息的方法， 目前已经对密码集成电路的信息安全构成严重的威胁电磁旁路分析 的优势在于非侵入式、隐蔽性强、易于实现的同时分析效果又比较好， 是目前旁路分析的主要方式之一。近年来，电磁旁路分析技术已经成 为国内外研究的重点，尤其是在密码集成电路的旁路分析和检测的领 域，已经成为密码分析最具发展潜力的方向之一。
随着密码集成电路的发展，电磁旁路分析现阶段所存在的问题还 包括以下几个方面：
(1)密码集成电路的电磁旁路泄漏和密码算法之间缺乏一个通 用的模型来进行解释，大都是依据特定模型的前提假设下而进行旁路 分析；
(2)传统电磁旁路分析往往仅使用密钥的单个字节进行分析， 而在硬件并行实现过程中单字节分析会出现信息浪费的情况，从而造 成信噪比不高，分析效率低下。
(3)密码集成电路的硬件木马存在着形式多样、隐蔽性强，触 发概率低的特点，加之工艺偏差对密码集成电路造成物理参数的差异, 使得硬件木马的检测存在一定的难度。
本论文主要聚焦于密码集成电路的电磁旁路分析和检测技术，旨 在解决现阶段所存在的问题，以分组密码算法的高级加密标准 (Advanced Encryption Standard, AES)为基础，对密码集成电路信息 泄露的电磁分析模型、传统电磁分析在硬件并行实现时信息利用不足 和硬件木马的检测困难等问题进行了研究。本论文的主要内容和贡献 如下：
(1)密码集成电路信息泄露的电磁分析建模
针对密码集成电路的电磁旁路泄漏与密码算法之间缺乏一个通
I
用模型来解释刻画的问题，对密码算法在密码集成电路中的工作机制 进行了研究，根据密钥所在寄存器前后数据变化引起的电流波动，将 其用电偶极子来进行等效刻画，并建立密码集成电路的电磁发射模型。 与此同时，对用于接收电磁泄漏的近场探头也进行了分析，根据其等 效电路建立起输出与输入之间的关系用于构建电磁接收模型。电磁发 射模型是前因，电磁接收模型是后果，二者共同构成了密码集成电路 信息泄露的电磁分析模型。最后，构建了基于多元线性回归的电磁分 析模型，通过统计学中多元线性回归理论来验证所提出信息泄露的电 磁分析模型的正确性。该模型可推广至一般密码集成电路设备进行电 磁旁路分析。
(2)基于智能算法优化的多字节电磁分析
为解决传统电磁旁路分析在硬件并行实现时存在信息利用不足 的问题，提出了一种多字节电磁分析的方法来提高信息利用率。并引 入粒子群优化算法和遗传算法将电磁分析的密钥恢复问题转化为密 钥寻优的问题，利用智能算法迭代寻优启发式的特点在密钥搜索空间 中高效寻找出正确密钥。通过对智能算法的改进使密码算法的密钥求 解更加高效，对粒子群优化算法的速度更新公式增加惯性权重，而位 置更新公式增加突变移动；对遗传算法增加排序算子和筛选算子，经 过改进后的智能算法不仅提高了信息利用率，同时在密钥的寻优上也 获得了极大的改善。相较于传统相关电磁分析的方法，基于粒子群优 化的多字节电磁分析采用递进式的方法实现了对电磁发射迹线数目 约13.72%的改进，基于遗传算法的多字节电磁分析采用全覆盖式的 方法更进一步减少了电磁发射迹线数目的使用，实现了约42.72%的 改进。
(3)基于迁移学习的电磁旁路硬件木马检测
针对密码集成电路的硬件木马存在着形式多样、隐蔽性强、触发 概率低和工艺偏差的问题，提出了一种基于迁移学习的硬件木马检测 框架。利用迁移学习在放宽训练数据限制的同时又能节省训练时间的 优势，运用到硬件木马的检测上获得了比较好的效果。通过连续小波 变换对采集到的硬件木马的电磁旁路信号进行时频信息提取，并将提 取到的时频信息送入到迁移学习网络中进行检测分类。其中，通过卷 积神经网络获得了 90.5%的分类准确率，相较于传统的支持向量机改 善了近20%,迁移学习在相对更短的时间内获得了 90.9%的分类准确 率。除此之外，利用迁移学习来进行硬件木马的特征提取，使用支持
II
向量机作为分类区分器替代原来的区分器。通过迁移学习与支持向量 机的结合，进一步提升硬件木马的检测分类效果，获得了 94%的分类 准确率。
关键词：电磁旁路分析，信息泄露建模，多字节，智能算法，硬 件木马
in
RESEARCH ON ELECTROMAGNETIC INFORMATION SECURITY OF CRYPTOGRAPHIC INTEGRATED
CIRCUITS BASED ON SIDE-CHANNEL ANALYSIS
ABSTRACT
With the advent of the era of Internet of Everything (loE), more and more intelligent hardware devices appear in modem life. At the same time, the problems of physical information security among intelligent hardware devices are gradually exposed. Cryptographic integrated circuit is the basis of intelligent hardware devices, and its security is often protected by cryptographic algorithm. Although the cryptographic algorithm design is secure in mathematical theory, it can not guarantee the security in physical implementation. Electromagnetic side-channel analysis is mainly a method to obtain the secret information by the electromagnetic side-channel leakage information in the process of implementing the cryptographic algorithm. At present, it has posed a serious threat to the physical information security of cryptographic integrated circuit. The advantages of electromagnetic side-channel analysis are non-invasive, strong concealment, easy to realize and has good analysis result, which has become one of the main side-channel analysis methods. In recent years, electromagnetic side-channel analysis technology has become the focus of research at home and abroad, especially in the field of side-channel analysis and detection of cryptographic integrated circuits, which has become one of the most promising directions of cryptanalysis.
With the development of cryptographic integrated circuits, the current problems existing in electromagnetic side-channel analysis also include the following aspects:
(1)	There is no general model to explain the relationship between electromagnetic side-channel leakage of cryptographic integrated circuits and cryptographic algorithms, which is mostly based on the premise of the specific model.
(2)	Traditional electromagnetic side-channel analysis often uses a
IV
single byte of the key for analysis. In the process of hardware parallel implementation, there will be a waste of information, resulting in low signal-to-noise ratio and low analysis efficiency.
(3)	Hardware Trojan of cryptographic integrated circuit has the characteristics of diverse forms, strong concealment, low trigger probability and the difference in physical parameters caused by process deviations on cryptographic integrated circuits. Both of them make the detection of hardware Trojans difficult.
The dissertation mainly focuses on the electromagnetic side-channel analysis and detection technology of cryptographic integrated circuits, aiming to solve the current problems existing in electromagnetic sidechannel analysis. Based on the Advanced Encryption Standard (AES) of block cipher algorithm, the dissertation analyzes the problems of the electromagnetic analysis model of information leakage in cryptographic integrated circuits, insufficient information utilization of traditional electromagnetic analysis in hardware parallel implementation and the difficulty of hardware Trojan detection. The main contents and contributions of the dissertation are as follows:
(1)	Electromagnetic analysis model of information leakage in cryptographic integrated circuits
In view of the lack of a general model to explain the relationship between electromagnetic side-channel leakage of cryptographic integrated circuit and cryptographic algorithm, the working mechanism of cryptographic algorithm in cryptographic integrated circuit is studied. According to the current fluctuation caused by the key data change, the electromagnetic emission model of cryptographic integrated circuit is established by electric dipoles. At the same time, the near-field probe used to receive electromagnetic side-channel leakage is also analyzed, and the relationship between the output and the input is established according to its equivalent circuit to construct the electromagnetic receiving model. The electromagnetic emission model is the antecedent and the electromagnetic receiving model is the consequence. They together constitute the electromagnetic analysis model of information leakage in cryptographic integrated circuits. Finally, an electromagnetic analysis model based on
multiple linear regression is constructed. The correctness of the proposed electromagnetic analysis model of information leakage is verified by the multiple linear regression theory in statistics. The model can be extended to general cryptographic integrated circuit equipment for electromagnetic side-channel analysis.
(2)	Multi-byte electromagnetic analysis based on intelligent optimization algorithm.
In order to solve the problem of insufficient information utilization in the hardware parallel implementation of traditional electromagnetic sidechannel analysis, a multi-byte electromagnetic analysis method is proposed to improve the utilization of information. Particle swarm optimization algorithm and genetic algorithm are introduced to transform the key recovery problem of electromagnetic analysis into key optimization problem. Using the characteristics of iterative optimization and heuristic way of intelligent algorithm, the correct key can be found efficiently in the key search space. Through the improvement of intelligent algorithm, the key solution of cryptographic algorithm is more efficient. For particle swarm optimization algorithm, the inertia weight is added to the speed updating formula, while the mutation movement is added to the position update formula. The sorting operator and the sieve operator are added to the genetic algorithm. The improved intelligent algorithms not only improve the information utilization, but also greatly improve the key optimization. Compared with the traditional correlation electromagnetic analysis method, the multi-byte electromagnetic analysis method based on particle swarm optimization adopts a progressive method to achieve an improvement of about 13.72% in the number of electromagnetic emission traces. The multi-byte electromagnetic analysis based on genetic algorithm adopts a full coverage method to further reduces the traces, which has achieved an improvement of about 42.72%.
(3)	Hardware Trojan detection by electromagnetic side-channel based on transfer learning.
Aiming at the problems of diverse forms, strong concealment, low trigger probability and the difference in physical parameters of hardware Trojan in cryptographic integrated circuit, a hardware Trojan detection
framework based on transfer learning is proposed. Using the advantages that transfer learning can not only relax the limitation of training data, but also save training time, it has been applied to the detection of hardware Trojan and achieved good results. The time-frequency information of the collected electromagnetic side-channel signal of hardware Trojan is extracted by continuous wavelet transform, and the extracted timefrequency information is sent to the transfer learning network for detection and classification. The classification accuracy of 90.5% is obtained tihrough the convolutional neural network, which is nearly 20% improved compared with the traditional support vector machine, and the accuracy of 90.9% is obtained in a relatively shorter time by transfer learning. In addition, transfer learning is used to extract the features of hardware Trojan and support vector machine is used as the classifier to replace the original classifier. Through the combination of transfer learning and support vector machine, the detection classification accuracy of hardware Trojan is further improved, which has achieved a classification accuracy of 94%.
KEY WORDS: electromagnetic side-channel analysis, information leakage model, multiple bytes, intelligent algorithm, hardware Trojan.
