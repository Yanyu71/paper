第一章绪论
1.1	研究背景及意义
由模拟器件引起的系统非理想特性，如I/Q不平衡、功放非线性等，在一定程 度上降低了通信的质量，故对系统非理想特性的估计和补偿成为学者们研究的重要 领域之一。在研究通信系统的过程中，人们通过更先进的技术以提高系统的通信性 能，但由于开发资源受限，研究者们需要尽量优化系统来节省开发成本，故研究者 们需要在设计系统的过程中综合考虑系统的成本和功耗。一般通信系统中，我们对 信号的放大和滤波处理设计在基带，以减小硬件系统的设计成本和功耗，但是同时 还是不可避免的存在其他非理想特性的问题，比如IQ不平衡、功率放大器非线性 和相位噪声等。另外，通信系统的性能日渐提高，人们通过采用高阶调制方案以达 到更高传输效率的目的，此类方案中非理想特性的问题会更加凸显⑴⑵，严重制约 系统性能，加大低信噪比条件下良好性能的系统实现难度。
单载波频域均衡系统(SC-FDE)将时域均衡转换到频域均衡，不仅能有效克服 码间干扰，并且大大降低了实现复杂度。SC-FDE相比OFDM不存在峰平比的问题， 同时具有其它的一些优势，但其性能不可避免的受I/Q不平衡、功放非线性等非理 想特性的影响，所以设计性能良好的非理想特性的检测和补偿方案必不可少。
目前建造低成本且灵活的无线电收发机的趋势，是使用直接转换原理，该原理 一般基于复杂的(I/Q)上下变频转换。然而，这种情况下的收发器对I/Q不平衡很敏 感，这种非理想特性在任何实际实现中都是不可避免的，并且会导致镜像频率的大 幅衰减。除了镜像频率干扰问题，I/Q不平衡还会严重影响基于预失真的功放线性 化性能。随着高阶调制波形和宽带多信道信号的应用和发展，这种非理想特性的影 响会愈加凸显。以利用I/Q下变频的通信接收机为例，该种情况下，通信链路的性 能受到I、Q分支之间的幅度和相位不平衡的困扰。在实际应用中，这些失配是不 可避免的，并且在实际接收机中，镜像频率衰减可达到20-40-dB。为缓解器件非理 想特性的性能影响，相比引入大面积或者高功耗的电路，数字矫正不需要牺牲太多 整体系统效率而受到青睐。因此，对于各类系统中非理想特性的基带补偿算法研究 十分重要。
1
通信系统中，非线性的功率放大器使发送信号产生非线性失真，由于传播的开 放性，相邻信道之间会产生不同程度的干扰，对于高功率的射频发射机，此类失真 信号虽然远小于输出信号，但其绝对值还是很大，对系统造成不可忽视的影响。故 为了减小符号间干扰，使系统能在规定的频段内传送信号，功放线性化的研究工作 很有必要。传统解决功放非线性的方法中，大多采用的是功率回退法，即降低输入 功率，使功率放大器的工作点尽量远离饱和点，该技术能抑制功率放大器的互调分 量，保证功放工作在线性范围内。回退法即通过降低输出功率的方法来减少非线性 失真，执行难易度低，但能保证功率放大器获得优越的线性度，但是由于晶体管功 率放大器的直流工作状态不变，其功率相应降低了，同时晶体管本身的能力没有被 充分地发挥出来，若方案改变需要更大的输出功率时，则需要替换使用输出功率更 大的的晶体管功放，这大大增大了硬件成本，同时还降低器件的环保性能。综上， 传统使用率较高的回退法并不是最佳的功放线性化技术解决方案。
1.2	相关技术发展状况
1.2.1	MIMO 和 SCFDE 系统
早在1908年，人们为了解决衰落的问题，已有人提出了 MIMO技术，之后由 于贝尔实验室的研究，MIMO技术被真正应用于无线通信领域并且发挥关键作用。 MIMO系统能够达到相当高的通信容量和频谱利用率，从其原理上分析，主要原因 之一是其把发射端到接收端的所有模块整体化，从整体上进行性能的优化。整体优 化的思路能使系统趋近于最优的空、时域联合分集和干扰对消处理的优异性能。由 于MIMO技术的引入，通信信号的传输距离和天线的接收范围得到很大的提高和 优化，并且大幅度提高整个通信系统的抗干扰能力、可靠性与精准度。
新一代宽带无线通信系统需要以更低的成本，提供更高的数据速率和更高的可 靠性。正交频分复用（OFDM）和单载波频域均衡（SC-FDE）,采用基于快速傅里 叶变换（FFT）的信令方案，可以很大程度地恢复频率选择性衰落的性能，同时简 化均衡复杂度。OFDM系统已经在许多文献中进行了广泛的研究，并且已经在许多 标准中被采用（例如WLAN, WiMAX, DVB等）。在LTE标准中，SC-FDE被认 为是上行链路中OFDM的有力的替代方案。图1-1给出了 SC-FDE和OFDM系统
的具体运作框架，从中可以直观地看出SC-FDE系统和OFDM系统的设计机制与流 程非常相似，不同点在于FFT （Fast Fourier Transform,快速傅里叶变换）/ IFFT
（Inverse Fast Fourier Transform,快速傅里叶逆变换）模块位置的不同，FFT/IFFT 的应用不同导致两个系统有本质的区别。在OFDM系统中，IFFT/FFT模块对信号 进行调制，将多载波信号转化为并行信号进行传输;在SC-FDE系统中，FFT和IFFT 模块在接收端对信号分开操作，方便信道均衡技术的实行，其将信道失真转化到频 域中进行补偿，降低了对功放的要求。
SC-FDE系统具有比OFDM系统更低的峰均功率比（PAPR）,这有利于提高 发射端高功率放大器的效率。另外，SC-FDE对载波频率偏移（CFO）的敏感度也 低于OFDM。凭借强大的编码，OFDM优于SC-FDE,但在没有纠错码的情况下， OFDM的性能不如SC-FDEo
SC-FDE
OFDM
图1T SC-FDE和OFDM的系统框图
1.2.2	VQ不平衡概述及其研究现状
通信系统理想状态下，I路和Q路相差90。的相移差，两路的幅度增益相同，但 是实际系统中由于模拟器件的影响，如低通滤波器、数模转换器和功率放大器等， 使相移偏差、幅度增益不一致，如此产生了 IQ不平衡。I/Q不平衡可分为与频率无 关的I/Q不平衡（FI）和与频率相关的I/Q不平衡（FD）,窄带通信系统中，我们 可以忽略频率选择性I/Q不平衡，只考虑与频率无关的I/Q不平衡，但在宽带通信 系统中，与频率相关的I/Q不平衡是我们主要研究的对象之一。
I/Q不平衡是由硬件系统的条件受限引起的，它使系统产生镜像干扰，不可避免
3
地影响符号判决，提高系统误码率。我们可以采用高性能的模拟器件（放大器、模 数数模转换器、滤波器）能从根本上解决IQ不平衡的非线性问题，但是这是以高 功耗和高成本为代价的。上述方法存在另一个弊端，再优越模拟器件也不能完全抑 制IQ不平衡，它还受到多种外界因素的影响，所以在模拟域抑制IQ不平衡并不可 取。除了在模拟域对IQ不平衡进行性能矫正，我们还可以从数字域出发，通过数 字信号处理对IQ不平衡进行抑制和补偿。分析在数字域进行IQ不平衡的补偿的利 弊，主要有以下优点：
1）在不同环境下的模拟器件所表现的性能不同，其对系统产生的IQ不平衡的影 响也不同，无法实时估计系统的非理想性能，但在数字域做IQ不平衡的估计 是能做到这一点的，即数字信号处理能针对不同的环境做出相应的补偿。
2）在数字域上，对补偿算法做性能优化和提高，能有效降低非理想特性的补偿 成本，而且性能会随着芯片工艺的提高而不断提升。
针对对于I/Q不平衡问题的研究，国内外的学者都投入了许多的精力，提出了 一系列的估计和校正方法。文献［4北5］只考虑了存在于发送端的I/Q不平衡，文献 ［6］-口0］只考虑了存在于接收机的IQ不平衡，其中主要考虑的是与频率无关的 I/Q不平衡，该部分的非理想特性主要由接收机的变频器产生，［7］-口0］研究了与频 率相关的UQ不平衡。由于发射机和接收机都会引入I/Q不平衡，故上述的文献研 究都有局限性。文献中的研究拓展到收发端同时存在I/Q不平衡的OFDM 系统，本论文则讨论在低信噪比的SC-FDE系统中，收发端同时存在I/Q不平衡的 研究。
1.2.3	非线性功放概述及其研究现状
一般通信系统中的大功率放大器的效率仅为8%〜9%,若不采用额外的处理，要 达到系统所需要的线性度，如在系统WCDMA中，采用回退的方法，使系统达到方 案要求的线性度，功放额效率仅有1%〜5%,功率的低有效性使系统在简单的运算过 程中，没有足够的功率保证系统正常运行。现今移动通信技术高速发展，各前沿技 术层出不穷，如自适应天线系统、软件无线电等，都需要高线性的功率放大器的支 持。
目前为减少功放非线性对通信系统传输信号的影响，各研究者主要考虑从两方 面切入，一方面考虑降低输入信号的峰均比，另一方面则考虑采用功放的线性化技
术。后者是本论文主要探讨的方向。
对于功率放大器的线性化技术的研究，现今已有功率回退技术口3】、前馈法口4］、 非线性器件线性化〔⑶、预失真法等。功率回退法实现较简单，可以使放大器从饱和 区回退到线性区域，但实际效率不理想，现今研究者们几乎不再考虑这种方法的应 用【⑶。前馈法适用于宽带系统，线性度高，但其物理尺寸大，结构复杂，成本高口旬。 非线性器件线性化技术效率高、线性度好，但适用于窄带通信，自适应性差〔均。预 失真具有优越的带宽特性和功效，是目前最具有发展前景的技术口叫
预失真技术可分为两类，即数字预失真（DPD）和模拟预失真。目前有很多算 法设计数字预失真技术，一种是基于查询表的数字预失真⑵】，通过构建预失真查询 表来对信号进行预失真处理，另一种是基于多项式的数字预失真【2”,主要基于多项 式方程处理。考虑到查询表在表示记忆非线性特性上的困难，研究者倾向多项式预 失真方向的研究，其中Volterra级数、Hammerstein模型、神经网络等数学形式被广 泛用于记忆预失真器的研究。
1.3	本文结构和主要研究内容
本文主要研究低信噪比通信链路中的非理想特性，VQ不平衡和功率放大器的 非线性是无线通信系统中存在的两种常见的影响系统性能的非理想特性。本文以无 线通信系统中的I/Q不平衡和功放非线性为研究对象，研究SC-FDE系统中非理想 特性的检测与补偿，主要章节安排如下：
第一章简要概述了当前的无线通信发展状况，并引出本文的研究背景和意义， 同时简述本文所研究技术基于的SC-FDE系统，以及主要研究的通信链路中的两类 非理想特性，I/Q不平衡和功放非线性，简要介绍其基本内容和研究现状。
第二章介绍功率放大器非线性特性的表现，以及其对宽带信号产生的畸变影响。 然后介绍目前常见的功放模型，针对MIMO SC-FDE系统，我们采用有记忆功放模 型作为DPD应用系统的宽带功放建模。
第三章研究发送端和接收端VQ不平衡同时存在的情况，建立I/Q不平衡的时 域模型，从上变频和下变频两方向切入，一方面对发端信号做预畸变，抵消通信链 路中的VQ不平衡干扰；另一方面，基于循环复杂随机信号，利用自适应滤波原理 的迭代方法，研究信号I/Q不平衡的检测和补偿。
5
第四章对MIMO和单载波频域均衡(SC-FDE)通信系统的模型和原理做出了 更进一步详尽的分析，在了解各自的技术优势后介绍MIMO SC-FDE系统模型，主 要介绍了发射机的FPGA硬件实现思路，同时针对极低的信噪比通信环境，对I/Q 不平衡和数字预失真的关键技术做出研究和分析，分别从FPGA硬件和C语言平台 给出实现分析。
第五章对全文的内容进行总结和展望。
第二章功率放大器非线性特性分析与校正
本章研究低信噪比通信系统中的功放线性化技术，非线性的功率放大器使发送 信号产生非线性失真，由于传播的开放性，相邻信道之间会产生不同程度的干扰， 对于高功率的射频发射机，此类失真信号虽然远小于输出信号，但其绝对值还是很 大，对系统造成不可忽视的影响。故为了减小符号间干扰，使系统能在规定的频段 内传送信号，低信噪比系统中的功放线性化研究工作很有必要。目前为减少功放非 线性对通信系统传输信号的影响，各研究者主要考虑从两方面切入，一方面考虑降 低输入信号的峰均比，另一方面则考虑采用功放的线性化技术，后者就是本章的主 要研究内容。
2.1	功率放大器非线性特性
功率放大器一般被设计在通信发射机的末端，是通信系统中发挥重要作用的部 件，为了提高功率放大器的效率，功放的工作状态常常临近饱和点，但是此时的功 率放大器有很强的非线性特性。下图2-1可以明显地表示功率放大器工作时的特性 曲线，左图是理想功率放大器的输入输出特性曲线，右图是实际的功率放大器特征 曲线，特别是接近饱和点时，输入输出关系表现为强非线性关系。
%UT
图2-1理想功率放大器和实际功率放大器的输入输出特性曲线
几乎所有的实际电子线路系统都存在非线性的非理想特性，只是各系统的非线 性程度不同，对于非线性程度较小的系统，我们可以将其看作是近似线性系统，但
7
是当电路系统设计有较高频率的射频频段时，则该系统的非线性程度加剧，严重影 响系统的性能。
模拟放大器的三种工作区域一截止区、线性区和饱和区中【22］，线性区处在输 入信号相对较小的区域，当输入信号幅度过大时，输出波形进入饱和区，若静态直 流工作点变化，输出波形则进入截止区，从图2-1的右图我们可以看出，随着输入 信号的增大，输出信号的幅度基本保持不变。功率放大器的非线性失真与线性失真 对比最大的不同，就是其会产生新的频率分量。常见的非线性功放非线性可以表现 为谐波失真、互调失真、交调失真、幅度AM/AM和相位AM/PM失真。
2.1.1	谐波失真
假定非线性系统的输入信号和输出信号之间呈现幕级数关系:
(2-1)
»=0
式（2-1）中，X。）和〃/）分别表示非线性系统的输入和输出信号，a“表示幕级数 中各项的系数。在实际应用中，如果没有额外的线性化处理，为了保证通信系统的 线性度，功放一般工作在功率回退状态，只考虑式（2-1）中"为1、2、3的三项， 故可简化上式为（2-2）：
歹（。=%武。+ <22卜«））2 +a3 （X（C）3	（2-2）
若果功率过滤放大器此时的输入信号是一个单频信号，即x（f） = ZcosfiV，则可得到 输出信号为：
帕=竽+
(3	2、	1	2	1	,
ax +—IAcosa)1f +—a2A cosla)^ + — a3A cos3co}t
(2-3)
2
4
从式（2-3）可以看出，信号经过功率放大器放大后，输出信号中包含了频率为例的 基波项、直流项，以及各次谐波项，此时谐波项的频率与输入信号的基波频率成整 数倍关系，总的谐波功率与基波输出功率之差称为谐波失真。由于滤波器的作用， 谐波一般能被系统过滤掉。
8
2.1.2	互调失真与交调失真
两种或多种不同频率的信号通过放大器或扬声器后产生差拍与构成新的频率分 量，此时功率放大器的输出信号中就包含了互调分量，互调分量是多种输入信号频 率分量之间的组合，产生的干扰称为互调干扰。交调干扰是由三次失真产生的；互 调干扰则是二次，三次失真都产生。交调失真和互调失真一般同时产生。交调失真 是一种幅度失真，互调失真是属于频谱失真。
假设功率放大器的输入信号为多频信号，即x(/) = Zcos呻+ &os%，显然输入 信号中包含两种不同的频率分量，对应的非线性输出信号为：
y = ki(Acosa)it + Bcosa)2t) + k2(A2cos2a)it + B2cos2a)2t + 2 ABeos a),cos 吗。
(2-4)
+ k：3(A3 cos3卬 + B3cos3(o2t + 3 AB 2coscd} tcos 2co2t + 3A2Bcos2a)ltcosa>2t)
上式(2-4)中，%对应项表示期望得到的信号，A2对应项是二阶失真产生的，网对 应项是三阶失真产生的。对二阶、三阶产物进一步分析，由于滤波器的作用，大多 数的谐波和互调项能被滤掉，但在四接近例时，此时的三阶交调分量2助-例和 24-q接近于基波信号频率，难以被滤波器滤掉，这就是设计线性化功放的主要 解决的问题之一，若能降低三阶交调的干扰信号，功率放大器的性能会有很大的提 升。
2.1.3	幅度AM/AM和相位AM/PM失真
描述功率放大器的非线性行为的方法有很多，最基本方法之一是功率放大器的 AM-AM (幅度调制-幅度调制)和AM-PM (幅度调制-相位调制)特性㈤，此类描 述比较直观。AM-AM描述的是功率放大器输出幅度作为输入幅度的函数，与 AM-AM类似，AM-PM行为描述的是功率放大器的输出相位作为输入功率的函数。 对于无记忆的功率放大器，若输入信号X(r) = Z(f)COS(0j + 0(。)，对于带通无记忆 非线性特性的功率放大器，失真的输出信号可表示为：
y(/) = G(Z(t))cos®J + c(f ) + <!>(/(7)))	(2-5)
上式(2-5)中，输出信号的幅度为输入信号幅度的非线性函数G(4(/)),相移也为 输入信号幅度的非线性函数①(2(。)o
9
AM/AM
O 96765432.10 O.O.SO.6O.O.O.O.
(Dprn-U6sDd-rlo pez=EUJ-ON
0.1	0.2	0.3	0.4	0.5	0.6	0.7	0.8	0.9	1
Normalized Input Magnitude
图2-2功率放大器的AM/AM曲线
AM/PM
2 泡
5 5
oseqdDd-no
-155
-156
0	0.1	0.2	0.3	0.4	0.5	0.6	0.7	0.8	0.9	1
Normalized Input Magnitude
图2-3功率放大器的AM/PM曲线
图2-2表示功率放大器的AM/AM曲线，图2-3表示功率放大器的AM/PM曲线。 分析图中曲线，当功率放大器的输入功率进入非线性区时，其表现出十分明显的幅 度和相位的非线性失真。
2.2	功率放大器建模
本节主要分为两部分对功率放大器的行为模型进行分析和研究，行为模型主要 用于系统级的仿真，模型相对简单、易求解，且求解时的计算量小，完全依赖于系
10
统的输入和输出数据，比较适合用于复杂的系统信号的建模。下面介绍描述功率放 大器非线性特性的无记忆模型和有记忆模型，无记忆模型主要用于不考虑记忆效应 的窄带通信系统，有记忆模型主要用于宽带通信系统。本论文对通信链路中的非理 想特性的研究主要是基于MIMO SC-FDE系统，它是一个宽带通信系统，故后者的 有记忆模型是我们本文研究的重点。
2.2.1	无记忆功率放大器建模
对于窄带通信系统，输入信号的带宽远远小于放大器自身的带宽，在此情况下， 我们可以忽略功率放大器的记忆效应，对无记忆功率放大器的非线性特性进行建模。 功率放大器的无记忆表示其输出信号与之前的系统输入和状态无关，只与当前的输 入信号有关，此时我们可以将其建模为塞级数：
K
30 =春/⑺	（2-6）
k=l
其中的a为实系数，/⑺为功率放大器输出的带通信号，4。为功率放大器输入的 带通信号。则对应的基带信号模型为：
刈=»M（f）|z （。/	（2-7）
AT kodd
'k、
bk=2'k+' k-1 bk	（2-8）
、2 ,
在上述的基带模型中，由于偶数阶信号项的信号频率远离载波频率，对基带信 号的影响小，故只考虑其中的奇数阶信号。
2.2.2	有记忆功率放大器建模
本文研究的MIMO SC-FDE系统是宽带系统，显然功放的输出信号与输入端的 历史系统状态和信号有关，放大器的记忆效应特征明显，此时若用上节介绍的无记 忆模型进行建模，会导致系统的各项指标的误差都很大，降低模型拟合的准确性，
11
故这里将其建模为有记忆非线性模型。常用的有记忆功率放大器模型有Volterra级 数模型、记忆多项式模型、Hammerstein模型、Wiener模型等。
222.1 Wlterra级数模型
Vblterra级数是近来被广泛应用的非线性系统模型，它的优点在于只要阶数足够 高，就能完全拟合功率放大器，存在的建模误差极小，但同时随着阶数的增加，计 算复杂度也呈指数形式增长。考虑到这一问题，在实际应用中，我们会衡量准确性 和计算量，对模型做简化处理，以达到系统能接受的精度。
Vblterra级数模型的输入输出基带等效关系为：
M，) = Z/…版(以)X庄« F )以	(2-9)
k	r=l
其中，=［马，…，公(，dTK =dTxdT2...dTk ,力£0是K阶Vblterra级数的实数部分， 表示为离散形式，如下式：
rix*(° ~i1)	(2-1°)
k Zj %+1	i=l	i~k+2
取Vblterra级数的对角核，即当％ =- = G+i = /，为上+】为常数，可记为功放 系数%,上式(2-10)可简写为：
p 1-1
他)=22%武"-，)卜(九-/)/	(2-11)
p=l 1=0
其中P = 2K+1是功率放大器的最高阶数，x(%)是功率放大器的输入信号，”功是 功率放大器的输出信号，L是模型的记忆长度。对于MIMO SC-FDE的宽带系统来 说，当式(2-11)中的。为偶数时，产生的偶次谐波和交调信号的频率远离载波频 率，这些非线性特性产生的干扰信号能通过滤波器滤去，所以对上式(2-11)做进 一步简化，去掉偶项系数，模型的复杂度能大大降低：
〃")=	—	(2-12)
p=l 1=0 podd
12
2.2.2.2	记忆多项式模型
记忆多项式模型是简化的Vblterra级数模型，它保留了 Vblterra级数内核中对角 线上的值，非对角线上的值设为零，具体表示为：
加2，“，/2kl
0, mx — m2 =...=叫 p_i = m =0,其他
(2-13)
令（町，加2，..,加2p-l） = a〃,m，最终得到记忆多项式模型的表达式:
p M
p=\ m=0
n —m)|x(
(2-14)
1
式（2-14）中P表示非线性的阶数，M表示非线性的记忆深度。记忆多项式也能准 确地描述功率放大器的非线性特性，但是对比Vblterra级数模型，记忆多项式的计 算复杂度大大降低。
2.2.2.3	Wiener 模型
下图2-4给出的是Wiener模型的简化图，可以明了地看出Wiener模型主要由 两部分组成，前一部分”（q）是线性时不变系统，用于描述记忆效应，后一部分N（・） 是无记忆非线性系统，用于描述非线性特性。
图2/Wiener模型简化图
根据Wiener模型，功率放大器的输出可以表示为:
y(〃) = N 田⑷ x(〃)] =
(2-15)
其中"代表记忆深度，6,,,表示线性时不变系统H。）的系数，与表示无记忆非线性 系统N（・）的系数。这里的Wiener模型和上节的记忆多项式模型类似，只考虑公式
13
中的奇次项，这样实际应用中的计算复杂度能大大下降。
2.2.2.4	Hammerstein 模型
类比上节的Wiener模型，这里介绍的Hammerstein模型也由两部分组成，前一 部分N(・)表示无记忆非线性系统，用于描述非线性特性，后一部分H(g)是线性时 不变系统，用于描述记忆效应，如下图2-5所示。
x(n)	N(')		>	H(q)	y(n)

图2-5 Hammerstein模型简化图
功率放大器的输出可以表示如下：
M P	..
〃〃)="(4)"[武〃)]=20£勺-1卜5一加)|°-，(〃—相)(2-16) 加=0	p-1
其中〃代表记忆深度，0表示线性时不变系统〃(q)的系数，与表示无记忆非线性 系统N(。的系数。
2.2.2.5	并行Hammerstein 模型
对上节介绍的Hammerstein模型进行拓展，我们能得到并行Hammerstein模型， 两者不同之处在于各阶数的无记忆非线性系统后级联的线性时不变系统不同，下图 2-6是并行Hammerstein模型的简化结构图。
x(n)
图2・6并行Hammerstein模型简化图
利用并行Hammerstein模型对功率放大器进行建模，其输出信号表示如下:
y[n) =b2二(q)|x(〃)|"T)x(〃) =	卜(〃	x(“ -。)	(2/7)
p=\	p=l m=Q
总的来说，Wiener模型和Hammerstein模型都是有记忆多项式的特殊情况，实 质上，有记忆多项式与并行Wiener模型、并行Hammerstein模型是完全等效的。对 于Wiener模型和Hammerstein模型而言，两者较记忆多项式而言，虽然项数减少， 但是求解并不方便，有记忆多项式数字预失真算法在求解复杂度和性能之间能取得 最有的平衡。
2.3	功率放大器预失真技术
如前几节分析的，在现代通信系统中，为了获得较高的功率效率，功率放大器 常工作在接近饱和区的非线性区域，此时的非线性特性会使系统受到带内带外失真 的双重影响。带外失真削减了系统的频带利用率，带内失真使信号的幅度和相位产 生畸变，提高了系统的误码率。对于低信噪比系统来说，信号受到相对强大的噪声 影响，这就要求我们尽量提高系统的抗误码能力。同时为达到方案匹配的信号速率 和高频谱利用率，这也要求功率放大器能有很好的线性度。
功率放大器的非线性特性以及其线性化技术的研究已经比较成熟，各技术有各
15
自的优缺点。常用的线性化技术有功率回退法、负反馈法、前反馈法和预失真法。 预失真技术是在功率放大器之前设置一个预失真器，预失真器具有与功率放大器相 反的特性曲线。根据预失真器在发射机中位置的不同，我们可将预失真技术分为基 带预失真"6］口7］口8］、中频预失真［19］、射频预失真［2。］。其中基带预失真技术在基带实 现，无需对射频信号进行处理，相对于其他两种技术而言，易于实现，且适应性强、 线性化效果好，是目前预失真技术的主要应用技术。
下图2-7中，在功率放大器之前设置的非线性单元就是预失真器，我们令预失 真器的特性函数尸（嗫）和功率放大器的特性函数G（右）具有相反的特性，即 尸（匕）・G（%） = K （式中的K是常数，表示系统的增益），使整个系统呈现线性放 大的效果。
预失真器	功率放大器
图2-7功率放大器预失真原理框图
接下来是对低信噪比系统中记忆多项式的数字预失真算法的性能仿真。
2.4	仿真结果分析
针对模型（2-14）,武冷和z（〃）分别是预失真滤波器的输入和输出，为得到良 好的线性性能，我们要将预失真滤波器逼近功率放大器特性的反函数，即满足 2 =尸（y），代入模型（2-14）可得
P M
Z （"） =	V （"一 机）,5 一 嘲	（2-18）
p=\ m=0
P M
定义（〃-而）卜（”-加）『，代入可得，矩阵形式可表示为 Z = UA,两边分别乘上U"可得
W = VA	（2-19）
其中W = UtA, V = UtU,最后用乔莱斯基分解求解方程组（2-19）可得到系数o 在浮点仿真中，采用模型（2-14）所示的数字预失真滤波器以及式（2-18）、（2-19）
16
所示的DPD训练算法进行数字预失真系统性能仿真。
1	.加载信源了⑺，将功率归到0.2784；
2	.计算信源x(〃)经过维纳功放模型的输出歹(〃)；
3	.将输出信号M")的功率也归到0.2784；
4	.系统初始化不加入数字预失真滤波,得到z(〃) = x(n),根据式(2-14)、(2-18)、 (2-19)得到矩阵『和跖
5	.将系数4和信源x(〃)代入式(2-14)中，可推得数字滤波器的输出z(〃)；
6	.数字预失真滤波器的输出z(〃)经过维纳功放模型后，可得系统结合数字预 失真后的功放输出信号。
步骤1可以得到不经过功放的输出信号，步骤2得到信源直接经过功放的输出 信号，步骤6得到信号先经过数字预失真滤波器，再经过功放后的输出信号。下图 2-8给出了上述三种情况下的输出信号的功率谱图，蓝线是信源功率谱密度，红线 是没有DPD的功放输出功率谱密度，绿线是有DPD的功放输出功率谱密度，比较 上述三种曲线，可以明显地看出，信号经过数字预失真滤波器后的曲线逼近不经过 功放的信号曲线，频带利用率得到提高，说明数字预失真器很好地补偿了功放的非 线性特性，表现出良好的线性度。
17
0 5 0 5
-2
(ZH、ECQp)A±su8aro」o8ds .ISM0CL
5 巧
0 5 0 5 0
3 3 4 4 5 _ - _ _ ■
-5	-4	-3	-2	-1	0	1	2	3	4	5
Frequency（Hz）	x 107
图2-8数字预畸变算法仿真功率谱
这里我们用EVM （Error Vector Magnitude,误差向量幅度）来衡量数字预失真 的补偿效果。下图2-9是信源没有经过功率放大器的星座图，EVM为0.0181%,图 2-10是信源经过维纳功放后的信号星座图（此时没有加入数字预失真），EVM畸 变为5.32%,图2-11是信源先经过数字预失真器后经过功放的信号星座图，EVM 补偿为0.0924%。可以看出系统增加数字预失真补偿之后，EVM指标有了明显地改 善，使分散的QPSK星座图上的数据点收敛到理想星座点附近，说明数字预失真有 效地改善了功率放大器的非线性特性，很大程度上消除了码间干扰带来的非理想影 响。
18
0.8 r
• •
0.6 -
0.4 -
0.2 -
f 0 -
-	0.2 -
-	0.4 -
-	0.6 -
• •
-0.8 --------1-------1--------1---------1-------1--------1--------1--------1
-	0.8	-0.6	-0.4	-0.2	0	0.2	0.4	0.6	0.8
X轴
X斐
图2-10信源直接经过功放的星座图EVM=5.32%
19
0.8
0.6
0.4
0.2
-	0.2 -
-	0.4 -
-	0.6 -
, ♦
-	0.8 -1---1----!---1---1----1---1---1
-0.8	-0.6	-0.4	-0.2	0	0.2	0.4	0.6	0.8
X轴
图2-11信源经过预失真后再经过功放的星座图EVM=0.0924%
2.5本章小节
本章首先介绍了功率放大器的非线性特性，包括其对信号幅度和相位等方面的 失真影响。为更清晰地分析功放非线性的失真性能，本章介绍了相关的无记忆功放 和有记忆功放建模，基于我们的算法是在低信噪比MIMO SC-FDE系统上进行仿真 实现，考虑到模型的实现难度和性能，我们对记忆多项式功放模型的数字预失真算 法进行研究展开。之后我们对低信噪比系统中的记忆多项式数字预失真算法进行仿 真，给出了相应的浮点仿真结果，从算法上验证了数字预失真算法的线性化性能。
20
第三章I/Q不平衡分析、检测与补偿
上章我们研究分析了低信噪比系统中功放非线性的非理想特性，本章将研究分 析另一类非理想特性，即I/Q不平衡在低信噪比通信链路中的检测与补偿。随着通 信系统带宽的增加，与频率相关IQ不平衡越来越常见，所以如何准确地估计和补 偿频率相关的IQ不平衡越来越重要。本论文研究低信噪比通信链路中，频率选择 性I/Q不平衡的检测与补偿，假设宽带直接转换发射机中存在与频率相关的I/Q不 平衡，针对基于数字信号处理器的I/Q不平衡做校准研究。本章会从发射端和接收 端两方面，对系统中的IQ不平衡采用估计和补偿算法，研究的技术主要引用自参考 文献［27］和［31］。
3.1	I/Q不平衡系统模型
理论上，收发端所有模拟器件（例如混频器，滤波器和A/D转换器）和分支 都会造成IQ不平衡主要可分为两种一一与频率无关的I/Q不平衡和与频率相关的 I/Q不平衡。前者由IQ两路本振信号幅度或者相位失配造成，通常存在于理想系统 中，或者在窄带系统中，我们只考虑此类I/Q不平衡，这部分的IQ不平衡在整个信 号频谱范围内不随频率发生变化，为恒定值；后者是由于模拟器件输出响应不相同 造成的IQ不平衡，其在不同频率上IQ不平衡的程度不同，因此称作频率选择性IQ 不平衡［26］,具体可见图3-1。在低频段系统中，由于信号带宽较窄，IQ不平衡的频 选特性影响并不显著。
图3-1 I/Q不平衡模型系统结构图
这些模拟器件产生的IQ不平衡的综合影响，对I / Q处理时产生的图像衰减是 有限的，会导致图像信号在所需信号之上“混叠”，详情可见图3-2。
21
Rmix ⑴ 八
图3-2接收信号r (t)和混频器输出信号r (t)的频谱，镜像信号和所需信号混叠
因此，本论文对模拟部分中的分支和分支之间的整体不平衡进行建模，对本地 振荡器L0的信号建模为cos(叱。t)和-gsin(七0t +(p),其中g和。分别代表幅度、 相位不平衡的程度，且。= 2%/。故等效复振荡器建模为：
cos (<y£Ot) - jgsin («£Ot + (p) =	exp[->£Ot]+7C2 exp[j<yiOt] (3-1)
其中不平衡参数a可表示为：
+	(3-2a)
K2牛-g叫/2	(3-2b)
当IQ平衡时，g = l, <p = 0,此时(=1、K2=0.这里请注意，仅在本地振荡 器信号的I、Q路分支中引入不平衡可认为是一个有效的模型，因为实际上本文研 究注重的是I、Q路通道之间的差异而不是干扰参数的绝对值。根据式(3-1), 我们能定义I/Q不平衡导致的图像衰减为：
LquaD =因「/|&「	(3-3)
作为有限的镜像信号抑制的模型，接收信号r(f)与信号兀。«)正交混合。由于 非理想特性IQ不平衡的存在，(不等于零，这导致混频输出的信号。xO中，所
22
需要的信号与镜像信号混合。这里定义镜像信号为干扰信号。
对模型进行进一步的分析，如果I/Q混频器是唯一的不平衡干扰源，则I/Q下 变频号可表示为：
乂(。= /仔(。+&2*(。	(3-4)
其中z(t)代表I/Q平衡的基带理想信号，上述模型是对理想信号z(t)的瞬时(无 记忆)变换，因此我们假定I/Q不平衡的有效值不依赖于信号带宽内的频率。实 际上，由于滤波器、ADC等模拟器件的作用，不同频率上的I/Q分支的频谱响应 是不同的，这就导致了与频率相关的DQ不平衡干扰。
用H⑴表示整体频率响应，相应的脉冲响应为〃⑺，观察到的I/Q信号由下式 给出：
x(t) = gi(f)*z«) + g2«)*z*(/)	(3-5)
其中
© (,)全[6。)+gexp (-/。)3)]/ 2	(3-6a)
g2(，)2[3(t)-gexpQa)/?(f)]/2	(3-6b)
*/)代表脉冲信号。显然，模型(4)是(5)的一个特例，需满足条件Mt) = b(f), 刍(£)= 46(/), g2(t) = K26(t)o
如模型(3-4)和(3-5)所示，VQ不平衡导致下变频信号中镜像频率之间的串扰。 这通常是因为，时域中的复共短信号对应于频域中的复共匏和镜像信号，即z(。的 频谱是Z(f) , z*(Z)的频谱是Z*(-f),不平衡信号x(t)的频谱为 X(f) = G1(/)Z(f) + G2(/)Z，(-f)o换句话说，理想信号的缩放滤波的镜像信号 叠加在其自身之上。
因此，基于模型(3⑷和(3-5),以分贝为单位测量的图像抑制比(image
rejection ratio,
IRR)可以定义为:
，fe = ^ogi0旦或者心 ⑺生10/。©。些!
网	区⑺
(3-7)
3.1.1	幅度不平衡的影响分析
23
幅度不平衡指的是I、Q两路本振信号的振幅不同，I/Q不平衡模型建模中，g 代表了幅度不平衡的程度。由于在星座图上I、Q两路的值分别对应横纵坐标的坐 标值，因此当出现幅度不平衡时，I/Q两路的信号能量将发生变化。下图3-3是低 信噪比系统中，发送端存在不同程度的幅度不平衡时的系统性能曲线图，可以看 出，随着幅度不平衡参数的增大，系统性能受到破坏的程度也不断增加。接收端 存在I/Q不平衡与发送端存在I/Q不平衡的情况类似，收发端都有I/Q不平衡时， 是两者效果的叠加，这里不再赘述。
图3-3发射端幅度不平衡影响下的系统性能曲线图
3.1.2	相位不平衡的影响分析
当发生相位不平衡时，I、Q两路出现相位差，I/Q不平衡模型建模中，0代 表了相位不平衡的程度，下图3-4是低信噪比系统中，发送端存在不同程度的相 位不平衡时的系统性能曲线图，可以看出，随着相位不平衡参数的增大，系统性 能受到破坏的程度也不断增加。接收端存在I/Q不平衡与发送端存在I/Q不平衡的
24
情况类似，收发端都有I/Q不平衡时，是两者效果的叠加，这里同样不再赘述。
SNR (db)
图3-4发射端相位不平衡影响下的系统性能曲线图
3.2	I/Q不平衡在上变频的估计和预补偿算法
3.2.1	基于预畸变的I/Q不平衡算法基本原理
在这一节中，我们在发端对信号做I/Q不平衡预畸变，以抵消通信链路中的 非理想干扰。首先利用新型宽带线性校准结构，该结构适用于与频率相关的校准 问题，基于该结构，采用了两种可用于校准参数估计的方法。第一种估计方法源 于复杂通信信号的二阶统计量〔2刀，而第二种方法是基于线性最小二乘模型拟合得 出的［271。这两种估计方法通过模拟表明，都具有非常好的校准性能。
为研究I/Q上变频发射机中的镜像频率干扰问题，及其基于数据信号的抑制 技术，针对实际补偿阶段采用一种新的广义线性（WL）预失真方案。然后，利用 从数字基带的反馈信号，研究估计预失真滤波器的新技术。基于对I/Q不平衡干
25
扰的建模和讨论，I/Q不平衡补偿的目的是去除(3-5)中的共扼信号项。对公式 (3-5)做线性信号转换，可得出预畸变信号模型：
Zp(t) = z«) + w0)*z*(/)	(3-8)
其中w(t)代表预畸变冲击响应信号。如此，我们代入式(3-8)可得到
Xp	4 ⑺ * z/t) + g2 (。* z；⑺	(3-9)
或者
Xp(f) = g】,p(£)*z«) + g2?0*z*(。	(3-10)
其中
(0 = gi。)+g2 (。* W* (。	(3-1 la)
g2,p(f) = g2(f) + giG)*M。	(3-1 lb)
基于以上分析，预畸变的最优解是令g2(/)+w(/)*g；(r)=0,vr,对应的傅里叶变 化为：
%"㈤殳一器312)
直接使用式(3-12)进行求解是不可能的，因为实际系统中的I/Q不平衡参数(这 里指代gjQ)、82(。或者5(/)、G2(/)都是未知的。
在实际的系统实现中，为了避免由反馈分支下变频引起的任何额外的I/Q不平 衡，我们使用模数转换器进行实际采样后，在数字域上完成从IF到基带的频移以及 低通滤波。以这种方式，我们可以尽量完美地观察到实际I/Q调制器输出的基带等 效值。发射机的整体结构，包括预失真处理以及I/Q不平衡下的相关频谱图，如图 3-5所示。
26
图3-5基于I/Q上变频的宽带多信道发射机。使用WL预失真滤波执行I/Q不平衡补偿，利 用从RF到IF的实际下变频的内部反馈分支获得的校准系数。
在实际反馈信号的处理中，不可避免地仍然受到其他几个非理想因素的影响， 其中包括反馈环路的频率响应、定时同步等。基于这一点我们深入分析，在评估预 失真滤波器时，我们发现反馈环路中的非理想响应的影响能被抵消。与现有文献提 出的技术相比，本论文采用的该技术能拥有上述特性，是一个关键的优点。发送信 号和反馈信号之间的同步算法，对于本文所采用的数据辅助算法也是必不可少的。 故现有的实验室SC-FDE系统中的同步算法,为本文的IQ不平衡预补偿技术奠定了 基础。由于反馈链的信号处理是在发端内部处理的，因此频率同步显得并不是那么 重要，因为单个“母”振荡器就可用于生成上变频和反馈下变频L0信号。
I/Q路信号调制器中的L0信号会泄漏到RF输出信号中，这也是另一个影响IQ 不平衡预补偿技术的非理想因素，从波形和传输的角度来看，在整个传输频带的中 心会产生杂散信号能量，从反馈基带信号的角度来看，该影响映射为直流偏移（de）, 会在一定程度上使预失真滤波器估计产生偏差。因此，在计算I/Q校准参数之前， 需要先去除反馈信号块的样本均值。在信号通过调制器前，对I、Q信号添加正则 的（相反的）直流偏移项，也可以从发送信号的波形中减轻LO泄漏的影响。该方 向内容的研究也是研究者们关注的一个非理想特性中的研究领域。
通过A/D转换、基带转换、低通滤波后，去除延迟和可能的直流偏量后，得 到可观测的反馈信号
27
加=g，% «) * (既⑴ *Zp ⑴ + g2 (。* z； (/)) = : (，)*Zp(t) + g2(f)*z；(t)
(3-13)
上式中，未知参数｛g,仇麴(/)｝分别代表反馈环路的增益、相位和脉冲响应，且 gi (0 = ge% (。*& (。，g2(z) = ge，％, Q)*g2 (。。虽然 © (/)、g2 (。不能从式 (3-13)中直接观测或估计得到，但是模型(3-12)的最佳预失真滤波器还是可以推算 得到：
a⑺ 6⑺
用⑺G")： G式介
g西。丽厂而)
geje.
(3-14)
由此我们由估计实际的不平衡参数gi⑺、g2(o,改为检测间接参数目(0, g2(/)。
3.2.2	二阶统计法
我们切换到离散时间矢量矩阵表示法：
= z(n-l) ... z｛n-Ng +1^	(3-15)
式(3-15)表示原始基带矢量信号，
售=[勖 羡2… 跳]\ = 1，2	(3-16)
式(3-16)表示不平衡模型的冲激响应矢量矩阵，式(3-15)、(3-16)中的矩阵长 度都为效。假定预畸变滤波器矢量为w：
w = [W] w2 ...叱J	(3-17)
w的长度为N,初始化为全零矩阵。反馈模型(3-13)可转化为：
y(") = g：z(%) +例z*(")	(3-18)
反馈信号与发送信号的互相关可表示为：
=E[z* (n)7(w)] = ... = R*g1	(3-19a)
% =E[z(n)y(n)] = ... = R2g2	(3-19b)
其中Rz=e[z(h)zh(〃)]是发端信号z(小的自相关函数。本节中我们假定原始基带 信号z(。是正则的，即互补自相关函数(Complementary Autocorrelation Function,
28
CACF) E[z(f)z(t-t)] = O,Vt,大多数实际的通信信号都具有该信号特性，详细推 导和介绍在3.3节中说明，这里不做赘述。
从式(3-19a)、式(3-19b),假定我们能预先获得发端信号的自相关参数Rz， 且该参数矩阵是可逆的，我们能推算的得到百，游，具体表达式如下：
g. =R：X	(3-20a)
豆=灯匕，	(3-20b)
根据检测得到的I/Q不平衡参数番，或，预失真滤波器基本可通过它们的傅里叶变 换得到-a(/)/G(/)。或者，使用时域矩阵表示法，根据g2(/)+w(/)*g：⑺=0,0 推导得到下式：
g°+G1W = 0	(3-21)
式(3-21)可求解得到预失真滤波器参数w为：
w = -(GfIGiy1G1Hg"	(3-22)
其中弓是名的卷积矩阵，/=「器0 ... 0丫是由至与尾部N-1个零组合得到。 实际仿真时，在发端数据和反馈信号之间的样本数据中，选择适当的块长度，计算 式(3-19a)、(3-19b)中所需的相关量。
3.2.3	WL-LS 法
本节将推导一种替代估计器的方法，该方法使用直接时域模型进行拟合，即找 到番、备使原始信号序列z(〃)趋近于观测信号序列”")。首先在发端没有设置I/Q 不平衡预失真的系统下，反馈信号矢量可表示为：
y (〃) = Z(〃阍 +Z* (")委=[Z(〃)|Z* (%)]]勺]=(“J T ]	0-23)
I_g2」	L_g2.
其中y(〃) = [y(〃)y(«-l) ... 丁(“-4+1)T,4表示观测信号块的长度，z(〃)
表示z(〃)的卷积矩阵，故l/Q不平衡滤波器矢量可以直接求解为：
F =Z；(〃)y ⑺	(3-24)
_§2_
29
式(3-24)中Z；⑺代表4(“)的伪逆矩阵，如果Z：(〃)Z.(“)是可逆的，则 Z；(〃) =(Z：(〃)Z,(〃)［Z：(〃)。通过上述方法估计得到番、委后，I/Q不平衡 预 畸变参数则可通过式(3-22)得到。
对推导公式(3-24)做进一步分析，项Z；(〃)是广义逆阵(建构广义逆阵的 目的是针对可逆矩阵以外的矩阵，例如非方阵的矩阵，可以找到一矩阵有类似逆 矩阵的特性)，矩阵Z；5)Z&(〃)实际上是信号矢量［zS)T;z(〃)H『的自相关矩 阵的样本估计，2：5)丫(可是信号［z(〃)T；ze)H『和'⑻信号间的互相关矢量的 样本估计。WL-LS技术可以被视为早期基于统计的方法的扩展，本方法中也综合 考虑到了原始有限长度发送数据样本的CACF特性。故总的来说，WL-LS技术适 用于任何正则或非正则的信号波形。
在发射信号z(n)的频谱支持很窄的情况下，矩阵Z：e)Z,(〃)可计算性能很 差，此时我们可以在估计过程中，通过对信号z(")添加低幅度循环白噪声信号来 解决上述问题。噪声的添加体现在矩阵Z：G)Z6(〃)的对角系数上，这能让我们 在仿真过程中跟好地调节矩阵。
实际情况下，系统百、备的顺序未知，该问题将导致估计器的参数化不足或 者过度参数化，同时可能降低估计器的性能。这里我们可以通过使用顺序递归LS 结构或多模型LS估计器来解决该问题。由于预期模型的阶数相对较小，故以上 方案不会增加实际应用中的计算负担。
324仿真结果与分析
本节中，我们将使用计算机模拟来仿真上文中采用的I/Q不平衡补偿方案的 补偿性能。在所有仿真中，我们都假设发射机模拟前端的镜像频率衰减是跟频率 相关的。另外，在仿真中，我们将直流偏移添加到反馈基带信号中，以模拟L0 泄漏，之后通过在I/Q不平衡参数估计阶段之前，从信号中减去样本均值来减轻 直流偏移对性能的影响。
分别仿真信号频率IM、2M、3M的频率混合信号，经过IQ不平衡的系统后, 补偿前后的信号频谱图。假设包、星的估计长度设定为3个抽头系数，预失真滤
30
波器的长度为3,分别仿真两个预补偿算法前后的信号频谱图，如下图3-6和3-7, 图3-6是采用二阶统计法进行预补偿操作后的得到的补偿前后的频谱图，图3-7 是采用WL-LS法进行预补偿操作后的得到的补偿前后的频谱图，可以看到信号的 镜像频率幅度在预补偿操作后明显被削减。
2500
2000
500
1500
1000
1000
■■4 Hz
0	1	2
%率HZ
首先仿真具有5MHz信号带宽和3MHz发射中频的低中频发射信号，假设信 号经过线性QPSK调制，在没有校准的情况下，发射机的镜像频率衰减是频率选 择性的，图像抑制比(Image Rejection Ratio, IRR)在信号带宽内波动在26到35dB 之间。最佳的预失真滤波器理论上有3个非零抽头。本次仿真中，假设反馈链路 的实际增益和相位是未知的，在反馈支路中采样100000个信号样本块，采样率是 15.36MHz,分别采用二阶统计法和WL-LS估计系统的I/Q不平衡参数。
我们再设定百、备的估计长度为3个抽头系数，分别仿真预失真滤波器的长 度为1、2、3情况下的补偿性能，即& =3, N=l、2、3o最后得到的镜像频率
31
衰减关于频率的关系，对多次独立仿真结果进行整体平均，得到仿真性能图3-8。
90
mp)HS_
80
70
60
50
-IQ不平衡不补偿
T—二阶统计法，N=1
ML-LS, N=1
-G—二阶统计法，N=2
ML-LS, N=2
二阶统计法，N=3
—ML-LS, N=3
O~~ 后--O—G—O - O - Gqq	o. --Q-

40
30
20
-8	-6	-4	-2	0	2	4
频率(MHz)
6	8
图3-8基于二阶统计法和WL-LS两种补偿算法，针对具有不同长度的预补偿滤波器的低频发 射机的IRR与频率的关系仿真图
分析仿真图3-8,所采用的两种I/Q不平衡预补偿算法，即二阶统计法和 WL-LS法的补偿性能基本没有差别，当滤波器长度朝最佳长度方向增加时，最终 仿真得到的镜像频率衰减或者镜像抑制比有明显地改善。原始信号的有限频谱特 性也能反映到镜像抑制比上，在某种意义上，我们能通过采用的I/Q不平衡预补 偿算法，在镜像频率干扰确实存在的区域中获得最高的抑制比。由于信号的中频 特性，本次仿真使用的有限长度样本中，原始序列的非正则特性（CACF的样本 估计）非常小，二阶统计法和WL-LS法的补偿性能基本相同。因此，考虑到CACF, 本次仿真条件下不会为估计带来其他的附加信息。
3.3	I/Q不平衡在下变频的估计和盲补偿算法
32
3.3.1	I/Q不平衡下复数随机信号的二阶统计量
复杂随机信号s«)的普通二阶统计量，我们定义为自相关函数(autocorrelation function ,ACF ),即/(5)生。如果信号的均值是常数， E[s«)] =加s，则该信号被定义为广义平稳信号(wide-sense stationary, WSS).> 若其自相关函数是时不变的，则ACF只与时间差t相关。我们重新定义ACF为：
八⑺全	(3-25)
在本节之后的研究分析中，假定所有信号均为广义平稳信号，且其均值为零。
为完全描述复杂随机信号s(f)的二阶统计量，ACF并不能满足所有情况下的 分析，为补充二阶统计量的表示，我们定义了 CACF, Cs&r)2E[s(f)s(f-r)]。 CACF可以理解为是自相关补充函数(complementary ACF),也可理解为是伪自 相关函数(pseudo-ACF)或关系函数。如果一个信号是广义平稳的，且其CACF 只与时间差7•有关，则该信号被认为是二阶平稳信号。具体表示为：
Cs ⑺全	(3-26)
此时我们定义复杂随机循环信号s(f)满足下述条件：
q(0)生"]«)] = 0	(3-27)
显然，公式(3-27)并不适用于所有一般意义上的实数信号。我们在实部和 虚部上拓展上述信号，并考虑信号的期望项，可以看出式(3-27)等价于描述实 部、虚部等能量且互不相关的信号。基于式(3-25) > (3-26),式(3-27)也代 表信号s(/)、s*(。在相同时间点是互补相关的。
信号正则特性是对信号二阶循环特性的进一步定义，我们定义在任意时间差 r的条件下，此时式(3-26)中的CACF为零：
q ⑺2 E[s(t)s(r-T)] = 0Vr	(3-28)
显然，从上述内容我们得知，正则信号一定是循环信号，但反之不一定成立，即一 个循环信号可能是非正则的。另外，与循环信号不同的一点是，正则信号的实部和 虚部不必与r = 0不相关，但它们的ACF是相同的，且相应的互相关函数是奇函数。 在复杂信号水平上分析，正则特性表示信号s(/)和s*(f)在所有可能的相对时间偏移 点是互不相关的。在之后的不平衡补偿技术研究中，上述观点将发挥关键作用。通
33
常，大多数基于复信号的实际通信信号，例如普通正交幅度调制 (Quadrature-amplitude Modulation , QAM)信号和 M 相移键控(M-phaseshift
Keying , PSK) (M>2)信号是正则信号，故也是循环信号。当然实数调制信号是 例外，例如二进制PSK信号和M阶脉冲幅度调制(M-pulse-amplitude Modulation , PAM)信号，此类信号的CACF等于ACF,在时延为零时不为零。
深入分析上述的基本二阶统计量，以覆盖矢量值复数随机信号。首先定义 S(0殳[M«),S2(/)”../“(/)『，现在尚未对s⑺或其元素的详细结构做出进一步假 设。然后，向量s(t)的NxN的矩阵ACF可定义为：
I；⑺金耳5(小十一明	(3-29)
式(3-29)的对角线上包含了各个信号20的ACF,非对角线元素上是信号与(。和 信号之间的互相关函数。同时，对于完备的二阶表征特性，本节定义了 互补统计特性。NxN的矩阵CACF可表示为：
Cs⑺殳片区小丁白一刀	(3-30)
可以同样对式(3-30)做出解释阐述，对角线上元素包含了各个信号CACF,非对 角线元素上是各信号之间的互相关函数。对标量信号做进一步扩展，当复杂随机向 量信号满足条件Cs(0) = 0,则该信号可认为是循环信号，其中的各个信号元素都是 循环信号(= 0Vz.),同时各信号之间也满足循环特性 (E[s,«)Sj(f)] = 0Vi,/")。信号之间满足循环特性的假设，在假设独立的零均 值信号源的场景下是可行的。另外，对于所有的时间差?，若某向量信号满足条件 Cs(0)= 0,则认为该向量是正则信号。基本上，s(f)中的元素代表不同接收RF载 波的各个基带等效信号。
接下来，本节继续对I/Q不平衡条件下的二阶基本统计量进行探讨，进一步推 导式(3-4〉、式(3-5)中I/Q不平衡信号x(t)的二阶统计量，推导得到的二阶统计 量会运用在之后的补偿算法中。我们假定式(3-5)中的信号模型是与频率相关的， 且假定理想平衡源信号z(f)是正则信号，即g(* = 0Vt,同时用忆(二)表示信号的 ACFo通过相应的运算之后，I/Q不平衡信号的二阶统计量可表示如下：
=gi ⑺* g： (f) * .⑺ + g2 ⑺ * g； (-7)* . (Y)% (r)
34
%⑺殳E[x«)x"r)]
=gi ⑺ * Si (一* * . (* + Sy (—) * g2 ⑺* 九(t)
(3-32)
上式是通过式（3-5）和正则信号z«）推算得到的。显然，当时间差r趋近于0时， 此时的I/Q不平衡信号武。不是正则信号。为了进一步解释上述结论， 我们假定在与频率无关的I/Q不平衡且r = 0的简单情况下，对式（3-32）进行分析。 为描述信号x（Z）的非正则特性，代入符号无。［匕（以2］,式（3-32）在时延为零时
的互相关表示为q（0）= 20K用*0 o
理想平衡信号z（。的循环假设特性，是文献［15］和［16］中与频率无关的I/Q不平 衡补偿研究的基础。文献［17］中介绍了利用信号的正则特性对与频率相关的不平衡 进行盲补偿的研究结果。文献［15］对I/Q不平衡的处理中，假定在单信道或窄带直接 转换接收器情况下，信号z（。对应于单个RF载波的理想基带等效信号。因此，信 号zQ）的循环特性具有良好的理论基础和推导证明，特别是在I/Q线性调制条件下， 能简单明了地表述两路不相关、等方差的I、Q路信号数据。但是文献刀中， 虽然研究相对其他文献更简单的I/Q接收器，其中假定z（f）信号为任意的正则/循环 信号，但是没有给出对循环或正则特性信号假设的分析证明。之后我们将通过信号
循环特性或正则特性，分析多频率信号在收端下变频转换，并经过模拟转换器件后
的I/Q不平衡补偿技术研究，具体结构示意见图3-9。
ANALOG FRONT-END
DIGITAL BASEBAND
DIGITAL
FRONT-END
图3-9基于I/Q下变频的通用接收机结构
由于本文没有局限于对与频率无关的I/Q不平衡补偿的研究，如文献［15］、［16］ 中所述，故本文研究的方法更具有普适性。本节研究将更普遍地运用信号正则特性, 之后会分析建立多载波复合接收信号的正则特性的充分必要条件，并将其运用于之 后的VQ不平衡补偿技术研究中。
为推导证明多载波中频信号的正则特性，我们先证明等效基带单载波中频信号 的正则特性，并假定各个基带波形中间的联合正则特性，之后拓展覆盖至多信号集
35
合(即多载波中频信号)。另外，我们还继续探讨信号的循环特性和正则特性在频 谱上的直观体现。
3.3.1.1	单频率信号的二阶统计量研究
本节对I/Q不平衡的补偿研究主要是针对接收端多频率射频信号，每个射频信 号经过I/Q下变频后，出现在各自的中频频谱上，我们首先分析推导单频率中频信 号的正则特性。定义中频复信号为z02exp[(〃v)s(/)],其中g代表中频信号的 频率，s(/)代表等效基带信号。若中频信号对应的等效基带信号是正则的，即满足 条件q«) = OVt,则单载波中频信号z(。也是正则的，该结论可通过中频复信号 z«)的二阶统计量CACF推导得知：
cz	= E^z(t^z(t-r)J = exp(/2为一t/ 2))(r) = 0, Vr (3-33)
当7 = 0时，信号的循环特性则是上式的一种特殊情况。另外，通常情况下，假设接 收端的输入信号的确切相位是不现实的，故为了体现相位的不确定性，我们在复数 调制指数中加入随机相位项6 ,则单频率中频信号可表示为 z(r) = exp[(j<o0r + 0)5(z)]o假定随机相位项。均匀分布在单位圆上，且在统计上与 基带信号相互独立，则式(3-33)可更新为式(3-34)：
Cz ⑺合 E [z z (/ - t )] = exp (j2a>§ « - t / 2)) E [exp Q26)k (7) = 0,V t (3-34) 当E[exp(_/26)] = 0或q⑺=0时，式(3-34)为零。由此可知，对应于正则基带信 号，且有随机相位的中频信号也具有上文的二阶统计特性。
3.3.1.2	多频率信号的二阶统计量研究
接下来研究分析多频率中频信号的二阶统计特性，复合中频接收信号可表示如 下：
N
z(。2 Zexp[0w)s,⑺]=fT (r)s(r)	(3-35)
其中S,«)代表 N 维中频信号S⑴殳[与⑺应⑺,…,Sn⑺T和 f (/) = [exp(jrw/), exp(/电。,exp (/%0了中的各个基带等效波形。假定各个基带
36
等效信号S，(f)是正则信号，各信号之间也符合信号的正则特性，即满足上文所述的 条件Cs«)全E[s0sT« — r)] = OVz,则复合多频率中频信号的正则特性可表示为：
=f T ⑴ E [s ⑺ s'(I)] f (i)	(3-36)
=户 3 cs(r)f(i)
= OVt
考虑复中频信号中存在随机均匀分布的相位项q (用«0,2句)，以模拟相位不同 步的情况，此时的复合中频信号可表示为：
N
Z (y 2Lexp[/W + q.)k (r) = fT (r)s(r)	(3-37)
j=I
其中f⑴合[expD(卯 + a)],expE^y2^ + e2)]，…，expD®N/ + 夕N)]]T。包含不同相位 项仇的源信号之间是不同步的，信号之间相互独立，即 Cf⑺M[fG)fT(…r)] = 0V7 ,该式可以通过公式直接代入得到。若假定 Cs(r) = F[s(Z)sT(Z-r)] = OV7,对信号(3-37)的正则特性可表述为：
生⑺ 2 E[z(/"«_,)] = e[z(/)zT (/一t)]
= £[fT(z)s(r)sT(z-7-)f(/-r)]
Mr (fT (Os(/)sT {t - r)f (/
■/r(s(Z)sT(f-r)f(/-r)fT(/))]	。幽
二"(月风小丁(£-r)f (f-T)fT(E)]) B(£ [s (/)sT (f - r)] . [f (r - r) fT (B = Zr(Cs(r)Cf(r)Tj
= OVt
上式进一步假设随机相位项q在统计上独立于各个基带信号s, (/),这从物理上解释 是合理的。从上述推论可知，多频率中频信号是正则信号，类比于公式(3-34), 当Cs⑺=0或Cf(T)= O时，生⑺趋向于零。对比上述本节和上节的二阶统计量推 导与研究，我们可知式(3-37)中的复合信号的正则特性比各个基带信号的正则特 性更完备。
37
3.3.1.3	二阶统计特性的频谱解释
信号基本二阶统计特性，即对信号正则特性的度量C,(T)合E[z(f)z(f-0],本 节从频谱角度进行进一步解释。根据式片[2(英(“切=石口(/)卜*(…7))*]可知， C，S)也能度量信号Z”)与其自身复共拆信号的相关性。直观地说，若信号Z(f)是一 个解析带通信号(如上述分析的频率中频信号)，则信号Z(。和其共轲信号Z*⑴占 据不同的频带，故两信号之间是互不相关的。更进一步分析，假设两个复杂随机信 号“«)、V”)是联合广义平稳的，则可推导出下式：
忸Js„v(7)# <]\Suv(f)\df<]^Su{f)Sv(f)df (3-39) -00	—00	—oo
其中S.(7)和Sv(/)分别代表信号”⑺、4/)的频谱密度，黑(/)代表两个信号间 的交叉谱密度。公式(3-39)是根据法则除(/)『K S“ (/)尺(/)得出的。若信号"⑺、 v(f)位于不同的频带上，即邑(/)凡(7) = 0可，可得出E[“(f)n*a)] = O。基于上 述分析，我们回归信号正则特性的原始定义，令〃(t) = z(f)、v(f) = z*(f-T),并代 入公式(3-39),可以明显地看出信号z(f)和2*(/-？)的频谱是不交叉的，即满足 E[z(f)z(f —7)] = e[z(*z*(-叫*卜0,以上就体现了信号的正则特性。另外，z⑺ 表示为z(t) = w[/N + e)]s(f), 脑和z*«)之间的联合平稳性意味着基带信号 s(r)是正则信号。理论上，这基本能排除实数基带信号的等价情况，为接下来I/Q 不平衡在下变频的补偿技术做下铺垫。
3.3.2	盲补偿技术的基本补偿结构
接下来，我们将探讨在数字域中的I/Q不平衡盲补偿技术囱1,以提高多载波或 多信道宽带接收机中的镜像频率抑制比。基于上文的讨论分析，我们能假定理想复 合中频信号是正则信号。
上文中的式(3-4)、(3-5),已表明I/Q不平衡引入的镜像频率干扰是由观 察信号x(f)的共轨信号转化而来的，我们由此得至(I I/Q不平衡补偿结构的基本原理:
刈=W] +叫 «)*x* ⑺	(3-40)
38
其中叱⑺和卬2⑺代表补偿器的脉冲响应。通常意义上，式(3-40)代表的系数估 计结构被定义为广义线性(WL)结构，用于区分估计器对观察信号的共朝项和非 共辗项的依赖程度。类似的补偿结构在3.2节中也提到过。现将观察信号 x(t) = g|()*z(/) + g2()*z*(f)代入式(3-40)中，则输出信号y(t)可表示为 V⑴=(叱⑺ *&(。+ 叱⑺ * g；⑺)*z «) + (叱(。* g2 (，) + 叫 «) *g；(3 *z* ⑺。为了 去除镜像频率干扰，UQ不平衡补偿系数吗(。、叱(。需满足 叱 «)*g2(，) + W2(f)*g；(/) = 0。为 了简化上式,可以假定 W] Q) = S«)、卬2 (/) = 3(，)， 这样就简化了 WL补偿器的工作原理，具体可见图3-10。
> (• )*
filter _ ।
w	[
। ।	!
(a)	'	(b)	1
图3-10基于(a)处理模块和(b)迭代模块的WL补偿结构的基本操作原理图
若满足g2(f) + Mt)*g") = 0,则消除所有镜像频率干扰的最优解w(f)对应的 傅里叶变换为%>T(f)2—G2(/)/G：(/),同式(3-12) o模型(3-4)描述的是与频 率无关的特殊情况，此时补偿器只有一个抽头系数，最优解卬(。表示为 卬8式。=-&/&*；而模型(3-5)表示的是一般情况下的补偿器模型，此时的滤波 器具备多抽头系数。
对于频率选择性的DQ不平衡，观察信号41)=刍«)*2(/) + 82«)*2*(。的互相 关函数为Cx(r) = gi(r)*g2(-r)*/z(r)+gi(T)*g2(T)*7z(T)。利用 WL 补偿器模 型，可进一步推导得到模型表示如下： H) = X(f) + W«)*X*0 = [&(f) + W0*g；G)]*Z(f) + [g2G) + W(t)*g；(f)]*Z*(f)， 同时对应的补偿器输出信号的互相关函数为：
S ⑺=♦⑺ * g；㈠ * .⑺ + £ (-寸 * g； (r) * . (-7)	(3-41)
其中的 g； (f) = gi t) + M)*g； (0，g2 (，) = g2 (/) +W«)*g： (/)，当信号 g2 (/)或 g； (f) 为零时，补偿器的输出信号是正则信号。
下面分析g；(。或g；Q)分别为零的情况：假设g2(r)为零，即 g2«) + W(f)*g：(/) = O,等价于印⑺= -G2(/)/G：(—/) = %pT(/),此时补偿滤波
39
器w«)等价于式(3-12),使输出信号为正则信号，并且完美补偿了 I/Q不平衡； 当g；(。为零时，对应于/(/) = 1/唯•(/)，此时的补偿方案补偿的是信号z*«), 并没有按照预期解决镜像干扰的问题。为避免上述的补偿问题，我们之后会采用基 于自适应滤波的补偿器初始化等技术，下节会做详细描述。
我们采用最优解参数%口(7) = -62(/)/可(-/)的补偿器，输出信号为
J^OPT (0	(0 +^opt (0*^2	，其傅里叶变换后的表达式为
6t(7) = {[G(/)G；(—/) —G2(/)G；(—7)]/G；(-/)}z⑺。从形式上来说,在消除 镜像频率干扰的过程中，一些微小的幅度缩放、相位旋转和残余的符号间干扰 (Inter-symbol Interference ,ISI)仍保留在补偿后的复信号中。但是在实际情况中， 对于任意程度的I/Q不平衡，由于|g(/)「》G(/)「，且以上的残留项 并不会起到多大的影响。此外，实际系统会在数据检测前引入数据调制技术，这包 括增益控制、相位同步、信道均衡等，其中增益控制能削弱可能存在的信号缩放， 相位同步能矫正接收信号的相位旋转，信道均衡能消除由 [G (/) G：(-『)-G? (/) G； (-/)] / G； (―/)引起的符号间干扰。
对于在宽带系统的下变频进行I/Q不平衡盲补偿技术的研究，我们采用将I/Q 不平衡信号通过补偿器输出为正则信号的思路，基于实际采样信号样本，有效估计 上文推导的最优解。本文主要针对盲补偿技术进行研究探讨，避免了选择特定训练 数据的复杂性，同时也能在宽带系统接收器的正常工作时即时即用。
3.3.3	基于信号正则特性的自适应滤波补偿
本节介绍利用接收信号的瞬时采样数据样本，对I/Q不平衡系数进行盲估计的 算法。为方便起见，我们首先定义补偿器工作的基本原理为y(/) = xG)+w：x*⑺， 其中的…,%/T表示在时间t时刻的N抽头系数补偿器，另外其中 x*(f)含…,x*(-N+l)],为了使补偿器的输出信号的互相关为零， 滤波器的抽头系数更新为：
w,+i=w,-封⑴州	(3-42)
40
式中的入代表自适应滤波器的步长，y(t)殳…，y("N+l)]T,算法 (3-42)背后的驱动机制是使输出信号趋向正则信号。事实上，我们能分析得到，
当w,+I=w,时，自适应滤波器达到平衡点，根据推导式 E[w,+J = E[w]— A4y(t)y(f)],司・]是线性函数，我们可以得到E[y(t)y«)] = 0 (也可以表达为词＞(/)y(/T)] = O, re{0,l,...,2V-l})。因此，上述的自适应算 法通过设计，能使输出信号收敛于正则信号。需要注意的一点是，上节中我们分析 利用信号的正则二阶统计特性，会将信号引导向两个方向，得到两种不同的最优解, 即%pt(/)和1/%pt(/)，前者正确的衰减了镜像频率干扰，后者消除的是通信所 需的有用信号，为区分这两种情况，或者说是引导自适应滤波算法向正确的补偿方 向进行收敛，估计得到正确的系统最优解%pt(/)，我们将补偿器的系数初始化为 w0=Oo另外，选取迭代的步长也很重要，这会影响自适应滤波器的收敛速度和稳 态估计的性能。
通过在式(3-42)的基本算法中构建平滑运算，可以进一步提高系统稳态、准 确度的性能。这里，为降低稳态点的参数w,的残余波动，我们进一步优化自适应迭 代算法：
w.=w,—>^t)y(z) w,+I=aw,+(l-a)w,+1
(3-43)
上式中= x(f)+w：x*⑴是基带补偿器的输出信号，其中/⑴=x(f) +可x*⑴代 表使用平滑系数W,后对应获得的输出信号。平滑参数a用于调整算法的存储深度， 可以由1/(1-a)大致表示，虽然平滑参数a能减小式(3-43)中基带自适应的稳态 系数方差，但其在收敛速度上存在1/(1 -a)的延迟。注意一点，w和的的收敛速度 是相同的。
3.3.4	算法仿真说明
下面是对低信噪比系统中，收端盲补偿技术的实现分析说明。根据上文所介绍 的自适应盲补偿算法是直接对下变频的复信号进行补偿操作，除了利用了信号的正 则特性以外，没有依赖任何训练序列或者其他特定的系统结构，例如特定的信号调 制方式或信号概率分布形式。另外，我们也追加考虑了目标信号z(f)会包含一些必 要的信道或射频干扰，比如加性噪声、信道线性失真和频率偏移(只需保证信号的
41
正则特性)，这些会或多或少地影响其他文献中提到的一些I/Q不平衡补偿算法的 性能。接下来分析频率选择性、衰落无线电信道，以及频率偏移之类的实际通信影 响因素对信号正则特性的影响。
3.3.4.1	线性失真和频率偏移
为了更明了地分析信道线性失真对通信复信号的正则特性的影响，我们进行如 下操作。首先，信号s(t) = s/(r)+网⑴代表基带等效发送信号，咐)=矶。+德9) 代表基带等效信道的脉冲响应，则基带收信号为 z(。=	= hi «)*S/ (/) —% (0*s° (/)+/[%(£)+ % (f)*S/(Z)] = z； (t)+jzQ (0
，其中*表示信号的卷积运算。为使信道失真信号z«) = M0*s(。复合二阶统计特性 正则特性，即Cz(r) = E[z(f)Z("叨= 0)7,可将互相关函数表示如下：
c2(r) = £[z(/)z(/-T)]
00 00
=j	4)s«-4d4	(3-44)
-00-00
oo oo
—oo—oo
若发送信号s(。是正则信号，即满足q⑺= 0V7,那么我们可以得出 Cz(r) = E[z(t)z("0] = 0V7,这就推导证明了信道失真信号z«)的正则特性。上 述证明是对文献[15]中阐述的初步补偿算法的有力推广，表明了频率选择性信道并 不会影响通信复信号二阶统计特征，即信号的正则特性和循环特性。
另一个实际通信中的影响因素是频率同步。假定正则信号z(f),由推导公式 E [exp	z x exp -	一 t)] = exp (j2^(o(t -?72))E[z(f)z(r- t)] = 0
可知，信号z(。任意的频移信号都是正则信号，上式中的代表频率偏移。通过 上述分析，我们得知基于循环信号或者正则信号的I/Q不平衡补偿算法，在设计上 与载波同步无关。因此，在信道失真的情况下，我们可以在不平衡补偿阶段之后再 矫正频率偏移。这个是本文设计的算法实际实施时的一大亮点。
3.3.4.2	移动性和衰落无线信道
上节的信道失真分析是假定在时不变的任意信道脉冲响应下，然而，在实际的
42
移动通信中，信道显然是时变的，这里我们就假设了具有L条路径的基本多径模型。 S⑺是基带发送信号，对应的信道输出等效基带信号表示为Z(f) = £^S("盯)，其 1=0
中的用和可分别代表衰落信道的复脉冲响应增益和时间延迟。若延迟分辨率是固定 的，而复信号增益是随机的，则衰落特性可以表示为：
=也s (f Js « -〜々 )]	(3-45)
/1=0/2=0
/] =o/2—0
我们在这里也同时假设了信号的统计独立性和信道的统计独立性。基于发送信号的 正则特性，信号z(t)满足q(T)= E[z(f)z«-T)] = OX/T,假设衰落路径相互独立， 即对任意的乙片3 上[九%] = 0,则该二阶统计特性在衰落信道条件下也满足。此 外，当存在循环复高斯信道增益时，对任意的/满足£[吊]=0 ,推导证明 £[/z/Aj = OVZ1,Z2,故衰落信道在一定程度上增强了信号的正则特性特征。
基于之前的讨论，我们可以明了地知道，本文采用的算法具有很强的鲁棒性， 大多数与无线通信相关的缺陷并不会影响此算法的性能。我们能在接收端完成数字 I/Q不平衡补偿后，再在基带进行减小信道失真(信道均衡)、频率偏移等操作， 上述操作独立于实际的不平衡补偿，如图3-9所示。
3.3.4.3	时变I/Q不平衡
由于系统工作在跟踪模式时，具有固定的自适应特性，故本文所采用的迭代补 偿器也可以适配不平衡特性中任意的时变特征。事实上，这些时变特征可能是由影 响模拟前端特性的温度变化引起的。在衰落环境中，导致I/Q不平衡发生有效变化 的类似效应，也可能是由下变频中对I、Q信号进行作用的自动增益控制机制引起 的。该问题通常在许多文献研究中都不会被涉及，但是它的确会限制许多I/Q不平 衡补偿技术的性能。虽然这些时变差异的具体特性是系统高度设定的，但是识别和
43
处理这些时变特征仍然是项重要的工作。
3.3.4.4	直流偏移
假设的理想基带等效信号的均值是零，且具有二阶统计特性正则特性。显然， 如果两个信号路径中的其中一个(I路或Q路)存在直流偏移，例如ADC中存在某 些偏置影响，则系统信号就不再是正则信号，这个可以通过 三(f) = Z/(f) + d/ + j[zoQ) + %] = z(t) + d推导得到，式中的d/和%表示两个信号分 支中的直流偏移。假设信号z(t)的均值为零，且是正则信号，若考虑直流偏移干扰 后，可以推导得研7)] =矶Z«)Z(E —7)] +/=〃2,如果为H0或% *0, 该信号的二阶统计特性就不为零。因此，当通信信号引入直流偏移干扰时，本文采 用的解决算法会使系统实际补偿性能产生偏差。通过上述分析，为避免此问题，需 在I/Q不平衡补偿阶段之前补偿直流偏移，或者与I/Q不平衡补偿操作一起矫正直 流偏移。通常，我们会利用估计消除器或者滤波器，在ADC之前后者之后补偿或 去除直流偏移，系统很容易在数字域上对残余偏置进行估计和补偿，故零均值的假 设在实践中是有效的。
3.3.5	仿真结果与分析
本节对算法3-42和3-43进行模拟仿真，基于采用的自适应滤波补偿算法，下 图3-11是补偿前后的频谱图，右图是通过算法8次迭代后得到的频谱图，可以看到
镜像频率的幅度被有效地衰减，之后随着迭代次数的增加，IRR指数保持稳定。
2500
2500
2000
2000
44
3
1000
图3-11基于信号正则特性的自适应滤波补偿算法，补偿前（左图）和补偿后（右图）的频谱图
计算机模拟中主要性能指标是以分贝为单位进行测量的总镜像频率衰减，即模
拟前端镜像频率衰减和数字处理增益的叠加影响。对于WL补偿器
y(0 = %(，)+地)*x*«)=(/ (。+w«)*g； «))*z(t)+(g2 (t)+M)*g； 0))*z* (。，整体 的图像抑制比可表示为：
AoT(/) = ioiog10
忸⑺+沙⑺弓（-“ 6（/）+沙（，）可（-/）「
(3-46)
利用测量数据进行仿真时，模拟前端不平衡的确切参数G（/）和G2（/）是未知 的，因此不能直接评估整体的镜像频率衰减。故在实际实验室仿真中，当已知理想 发射信号时，可以通过上述方法估计系统的图像抑制比。除了图像抑制比的估计， 我们还可以通过数据监测阶段中产生的误比特率，来评估I/Q不平衡的影响和补偿 器的增益。
未进行I/Q不平衡补偿时，系统的IRR波动在27到33dB,下图3-12是补偿器 分别为a = 0.9时，单抽头系数和三抽头系数的补偿效果，获得的仿真数据是多次独 立模拟结果平均后得到的平均数值。分析图3-12中单抽头补偿曲线和三抽头补偿曲 线可知，使用三抽头系数的补偿器获得的图像衰减效果更好。在某种程度上，图像 衰减的最终效果还取决于对自适应算法步长的优化，但当参数一定时，即不随时间 发生变化，上述的仿真结论在实际中是基本成立的。
45
30
25
-8	-6	-4	-2	0	2	4
频率(MHz)
6	8
图3-12基于单抽头和三抽头的迭代补偿滤波器的补偿效果图
3.4本章小结
本章首先分析了 I/Q不平衡对信号性能的影响，以及对I/Q不平衡系统的基础 建模。之后通过两部分对低信噪比通信链路中的非理性特性I/Q不平衡进行探讨。
第一部分讨论了在发射端上变频阶段进行DQ不平衡预补偿的算法，主要采用 了两种用于估计预失真滤波器的算法，分别是二阶统计法和WL-LS估计法，两种 技术都是利用调制器输出返回到数字基带的反馈信号进行参数估计。通过仿真，我 们能发现本章采用的预补偿方案，能抵消反馈路径中的非理想频率响应。二阶统计 算法建立在发射信号和反馈信号之间的互相关关系上，此算法明确假设了发射信号 是正则信号，因此该算法最适合于低中频型移动发射机。第二种算法是基于WL-LS 模型拟合原理，没有对发送数据做二阶统计特性的假设，因此，WL-LS算法普遍适 用于任意结构的信号或任意调制方式的信号。通过对两种算法的仿真来评估其性能, 我们证明两种算法有非常好的I/Q不平衡补偿校准性能。
46
第二部分探讨在接收端下变频阶段进行I/Q不平衡补偿的算法，该算法建立在 复杂随机信号的二阶统计特性正则特性上。在相互独立和各自符合正则特性的信号 条件下，由多个调制频率组成的宽带复合中频信号符合正则特性，由于I/Q不平衡 的非理想特性的存在，源信号的正则特性被破坏，通过恢复观测信号的正则特性来 对信号进行I/Q不平衡盲补偿。根据共视信号去相关的相关解释，本章提到的自适 应算法计算简单，能处理频率选择性的I/Q不平衡的复杂情况，可以有效地应用于 低信噪比系统的补偿器实现中。对自适应盲补偿算法的性能进行分析，在静态不平 衡场景中，自适应算法通过设计能遵循不平衡属性的时变性。总之，通过仿真结果 可知，即使输入信号处在很高的动态范围内，自适应盲补偿算法也能有效地消除I/Q 不平衡效应带来的镜像频率干扰。在算法的推导过程中，我们没有设定特定的信号 调制条件（除了信号二阶特性，循环特性和信号正则特性），因此所采用的方案非 常通用，能广泛适用于大多数通信系统信号。另外，通过仿真分析显示，自适应盲 补偿方案在设计上独立于基础通信信道（时间选择性衰落或频率选择性衰落等）以 及载波同步误差，这一突出优点使我们采用的补偿结构，在实际系统和接收器实现 场景下可行性较高。
47
48
第四章关键技术的设计与实现
经过前三章对通信链路中非理想特性——I/Q不平衡、功放非线性的检测和补偿 的相关理论研究之后，本章主要阐述远距离、超低信噪比环境下的MIMO SC-FDE 系统的基本原理和发射机部分关键技术的FPGA设计与实现，再重点分析和研究非 理想特性的相关技术应用于MIMO SC-FDE系统基本原理。为达到低信噪比系统下 的技术实现，我们通过帧结构设计，在收端累加码块以提高信噪比，为非理想特性 的检测和补偿奠定基础。
4.1	MIMO SC-FDE 模型
在宽带无线通信系统的发展中，频率选择性和多径干扰严重影响系统的性能， 前者会带来码间干扰，我们通过单载波频域（SC-FDE）技术进行对抗，后者我们通 过MIMO技术，在不增加发送功率和发送带宽的条件下进行性能改善。故将这两种 技术进行结合，统筹MIMO技术和单载波频域技术的优点【3旬，是近来研究人员的研 究热点，也是本实验室主要攻略的实验项目。
本文研究的技术也是基于MIMO SC-FDE系统，以实现远距离低信噪比条件下 的无线通信。MIMO SC-FDE系统能利用多天线技术在信息传输性能上的技术优势， 并结合分块传输技术，降低信道均衡环节的系统复杂度，同时引用单载波频域系统 的技术优点对抗频率选择性衰落。
图4-1是MIMO SC-FDE系统发射机的架构示意图，在发射端，比特序列经过串 并转换后，各路转换信号通过并行传输分别进行符号映射，添加循环前缀等操作， 然后经过信号调制完成发射端的信号发射，每路信号对应一个发射天线。图4-2则是 MIMO SC-FDE系统接收机的架构图，系统通过接收天线获取多路传输信号后，对每 路信号去除掉循环前缀，得到有效信号数据，之后对信号做快速傅里叶变换（FFT）, 将信号转化至频域进行关键操作，即频域均衡，之后再通过快速傅里叶逆变换（IFFT） 转化至时域，最后通过解调译码，得到发射的原始信号序列。
49
符号映射
加CP
7
串并转换
图4-1 MIMO SC-FDE系统发射机架构图
比特序列》
图4-2 MIMO SC-FDE系统接收机架构图
从上述分析可知，MIMO SC-FDE系统结合了 MIMO技术和单载波频域技术的 双重优势，首先SC-FDE技术将宽带的频率选择性衰落信道转变为窄带的平坦衰落 信道，之后引入的MIMO技术，将多路信号分别调制到各自的发射天线。MIMO SC-FDE系统采用的空间复用技术和空间分集技术，有效提高系统传输的有效性和可 靠性，同时误码率性能有很大的提高。综上，结合MIMO技术和单载波频域技术的 技术优势，MIMO SC-FDE系统有效对抗多径干扰和频率选择性衰落问题。
4.2	测试平台实物环境
50
图4-4 MIMO-SCFDE系统平台的实现正面实物图
51
图4-5 MIMO-SCFDE系统平台的实现反面实物图
本硬件实现方案中采用Xilinx公司的Virtex-6芯片,通过硬件描述语言Verilog HDL,在ISE开发环境下开发完成。
4.3	发射机关键技术设计
4.3.1	发射机总体架构
本文设计方案确定的发送端架构如图4-6所示，其中主要包括数据采集、Turbo 编码、速率匹配、QPSK映射、空时块编码、成帧、成型滤波、中频调制、DAC等 环节。比特源信号经过编码成帧后，得到时间长度为20ms的业务信息数据块。
52
图4-6 MIMO SC-FDE系统发射端架构图
数据采集得到的信号比特流采用128kb/s等多种传输速率，数据采集得到的比特 源信息先通过Turbo编码器。本MIMO SC-FDE系统中采用的信道编码是CCSDS标 准的Turbo码，Turbo编码器交织方式采用QPP交织。本文设计方案中，Turbo编码 器的码长为6144,根据查表可以知道QPP交织地址的生成多项式为 /(x) = (263x+480x2)mod6144 o Turbo编码器的上下两个前向纠错卷积码(RSC)编 码器的生成多项式分别为(023,033,025,037)和(023,033,037)。编码器内部包含上下 两个前向纠错卷积码子编码器，由于码率设置为1/6,即1比特码元通过Turbo编码 器对应输出6比特，其中一个编码器输出1比特信息位，3比特校验位，另一个编码 器直接输出2比特校验位。根据上述机制，业务信息数据块经过Turbo编码后，数 据块长度增长为原来的6倍，另外还需在末尾部分28比特作为尾比特处理。
信号经过Turbo编码后进行速率匹配操作，对应于本文的设计方案提供的传输 速率，对Turbo编码后的数据块重复读取，并顺序读取数据块前的比特数完成对应 的码块长度，完成速率匹配后进入QPSK映射单元。在QPSK映射单元实现中，顺 序读取相邻的两个比特映射为一个符号，一共有4种映射方式。数字信号经过QPSK 映射后，并行输出I、Q两路，其中I路信号对应QPSK映射后的实部，Q路信号对 应QPSK映射之后的虚部。经QPSK映射后的数据传输速率减半，之后进入空时块 编码(STBC)单元。
MIMO SC-FDE系统采用典型的Alamouti空时编码，将串行码块编码后并行输 入成帧单元。在一个符号周期内，两路信号同时从两根发射天线发出，在QPSK映 射后的数据块中，取1024个符号作为一个数据时隙，具体编码原理可参考表4-1, 其中定义两个相邻串行传输的奇偶数据时隙上的数据块为H和S2,天线1发送的两 个奇偶数据时隙的数据块分别为5和-S；2,天线2发射的两个奇偶数据时隙的数据 块分别为S?和S；」。其中上标*表示对各个符号取共辗，下标r表示对符号向量中的
53
1024个符号采取逆序排列。其数学表达式为（本方案中^=1024）：
S；j=［s；（0）,s：（M—1）,…,s：（l）］	（4-1）
…,$（1）］	（4-2）
数据码块经过STBC完成串并变换后进行成帧操作，根据时序将帧头、导频、 业务数据组合成20ms的单元帧结构。帧头由2个相同相位的8192长度的格雷序列 组成，插在第一个数据时隙前；数据部分读取每个数据时隙的尾部16个符号作为短 循环前缀符号（CP）插入到数据时隙头部；在数据时隙之间设置导频块，由2个不 同相位的8192长度的格雷序列组成。帧头和导频由格雷同步序列组成，设置对应的 相位和长度，用于收端信号的同步工作。对数据时隙进行组合，插入帧头，导频， 帧CP后即完成成帧。
根升余弦滤波器嫩有效对抗码间干扰，本文选用了 68阶FIR型根升余弦滤波器 来实现滤波，滚降系数a的取值影响着系统对抗码间干扰的性能，本文设计方案设 定a = 0.22。考虑本文设计的符号传输速率和带宽，设定3dB带宽为12.288MHz, RRC的频率响应可见图4-7o
--0.158
--6.7318
—13.6217
--20 5116
--27.4014
--34 2913
图4-7滤波器频率响应
25
Frequency (Hz)

AD9125是双通道、高动态范围的数模转换器，其在中频接口中起重要作用，信 号完成RRC滤波后，通过FIFO缓存（FIFO缓存深度为8,数据位宽为32bit）、频 谱搬移、插值滤波等操作，进行I、Q两路累加，再进行数模转换，完成基带信号到 中频调制和数模转换的功能。信号通过上述操作，转变为中频信号，再通过发信机 调制至射频频段经天线发射出去。
54
4.3.2	帧结构
本节对MIMO SC-FDE系统设计的帧结构进行介绍分析，本文系统设计在100M 时钟频率条件下，每帧时间长度为20ms。前10ms包括2个帧头、200个数据时隙和 若干导频，后10ms包括200个数据时隙和若干导频，两个10ms的帧结构尾部均包 含相同长度的帧CP,前后两个半帧除了帧头区别外基本相似。每个帧头时隙由8192 格雷互补序列构成，2个帧头之间的相位相同，每个帧头时隙时间长度为l/3ms。数 据时隙由16个符号的循环前缀符号和1024个信息数据调制符号组成，其中循环前 缀是1024个信息数据调制符号的尾16个符号，循环前缀符号插在数据时隙的头部。
帧结构中导频的时域间隔和位置影响整个系统的传输性能，设计时主要考虑扩 频增益、导频间隔及位置和开销，同时结合考虑系统实现时适配的不同速率和复杂 度。帧头和导频的设计主要用于收端的信号同步和信道估计，本方案中帧结构的帧 头和导频时长2/3ms,能提供足够的扩频增益。为对抗远距离通信中对流层散射信道 干扰特性，本方案设计在每相隔10ms的帧结构中插入导频，该导频的时间长度较长， 能提供较好的系统性能和开销折中。为适配方案设计的不同速率，帧结构中的数据 时隙设计统一，40ms中800个业务数据时隙设计完全等效，考虑到系统实现时FFT 的复杂度和信道时延扩展等因素，每个数据时隙设计为包含16个CP和1024个调制 符号，可以任意拆分配通过速率匹配支持不同的传输速率。
帧头导频我们采用格雷序列进行填充，格雷序列具有优异的自相关性能和互相 关性能，其中格雷序列的自相关函数在零相位以外的其他相位均为零，另外，格雷 序列的互相关值和自相关旁瓣值都非常小，利用这个特性，许多系统采用格雷互补 序列实现同步中的捕获操作。由于格雷互补序列的优异特性，在通信系统中能够将 信号从噪声中有效分离出来，其在通信系统的同步性能发挥关键的作用，因此得到 了广泛的应用。格雷互补序列可以通过以下方式生成：
(7?1 ,R2) = (5凡,S2 (-S]))	( 413)
(&凡)=(即2，(-民)&)	(4-4)
(% 鸟)= (S5，(-AW)	(45)
(舄通)=(监,5(/))	(4.6)
55
（耳,&）= （SR, $2 （-S］））	（4-7）
其中，S£=6q商J,…同5工0，&，…龌NT）表示两个序列的连接。
考虑对流层散射信道的特点，本方案设计的帧结构中，帧头和导频用8192长度 的格雷互补序列填充。由于本文MIMO SC-FDE通信系统采用2x2模式的MIMO天 线架构，所以需要两种不同的格雷互补序列分别应用于两根天线上，记这两种长度 为8192的格雷互补序列分别为GCS_A&B0和GCS_A&B1O本文帧结构的帧头部分 所包含2个相同相位，长度为8192的格雷互补序列对；而对于导频序列的结构设计 部分，通过格雷互补序列和小m序列运算转换得到导频序列，选取一组游程长度为 5的小m序列，并在此序列后面补一个0,构成一个长度为32的伪随机序列M ,针 对大序列M做信号映射处理，即0映射为+1, 1映射为-1,对应得到序列K,再构 造出一组长度为32个时隙，相位相同的格雷互补序列P,将序列K以码片为单位和 序列尸以时隙为单位进行对位相。通过上述操作我们得到导频序列，在实现中将此 序列插入帧结构中的相应位置。
4.3.3	FPGA 实现
本项目的FPGA实现通过硬件描述语言Verilog HDL,在ISE开发环境下开发完 成，发射机的各级模块（主要包括数据采集、Turbo编码、速率匹配、QPSK映射、 空时块编码、成帧、RRC成型滤波）的信号处理流程如图4-8所示：
56
数据采集
S ource_data_v 盟
S°urce-datw
Turbo 编 石马器
urbo aata val id
Turbo data
Qpsk data valid
H>i-------------
Qpsk data	STBC 编码
Q-'nd 宜。
I 舄 pg'二
I I ▼ 0EPI06SI01
I I ▼ Iwpgslol
OWPJqls4
*3 趁 E-WPIBSEUI PUPAIBlBpyBJIUI

Interface pulse
接口单元
data valid
成帧状态机
与 amedataval id
TO rrc datal
frame datal
DA
工 OrrcdataQ
RRC滤 波
frame dataQ
c datal
tl frame datal
T1 rrc dataQ
，JYame dataQ
图4-8发射端FPGA设计流程图
由于硬件资源有限，为尽可能地节省资源，并提高数据流的处理效率，MIMO SC-FDE硬件实现过程中采用流水和并行处理技术，从上图的设计流程图可看出发射 端的FPGA实现过程中采用模块化设计，下面从数据流经过各模块的时序角度进行 分析。
接口单元控制速率切换和数据采集，采集的低速率比特流根据成帧模块返回的 采数标志信号，周期性地流入Turbo编码器。进入Turbo编码器的比特数据先经过 QPP交织器完成信号交织，再经过编码器完成Turbo编码，输出比特流扩展为原来 的6倍，再加上尾比特28bit。由于各模块运行的时间不等，为避免相邻的数据块在 时序上发生冲突，Turbo编码器的输出信号turbo_code根据标志信号turbo_valid,通 过乒乓操作存入位宽为两块输入位宽为1位输出位宽为2位深度为65536的缓冲 ram,即turbo_ramO和turbo_ram 1 0之后通过成帧模块给出的指示标志信号，从该两 块ram中读取2048个2bit的数据同时完成QPSK,通过每次顺序循环读数完成对应 系统传输速率的速率匹配，之后根据标志信号qpsk_code_valid遵循乒乓操作送入两 块独立的STBC单元，两个STBC单元的设计分别采用8块深度为1024位宽为2位
57
的RAM完成。不同于之前几个模块的缓存RAM,考虑到硬件资源上的节省和平衡, STBC模块采用分布式RAMo STBC模块完成编码的数据流流入成帧模块，根据时 序从ROM中读出对应的帧头序列和导频，结合数据部分完成成帧。
在成帧模块实现中，为方便匹配时序操作，根据帧结构的划分对应设置状态机, 在成帧过程中，每切换一个状态机，此状态成帧所需的数据已完成前阶段的调制处 理存于缓存RAM中。按照上文给出的帧结构，本文的成帧状态机划分为8个不同的 状态，分另!J 是 IDLE、FRAME_HEAD、FRAME_DAIA1、FRAME_PILOT1 > FRAME_CP1、FRAME_DATA2、FRAME_PILOT2> FRAME_CP2o 每个状态转换之 间注意数据乒乓操作的切换以及时序的匹配，具体成帧状态机的状态转化如图4-9
图4-9成帧状态机的状态转化流程图
下面将对状态机的8种不同状态的工作机制与状态转换做出介绍：
IDLE：状态机的初始状态，当工程发射端全局复位时进入初始状态，等到成帧 开始标志 frame_begin_pulse 进入 FRAME_HEAD 状态。
58
FRAME_HEAD：此状态下从ROM中顺序读取8192长的格雷互补序列，循环 读取两段相同相位的帧头序列构成帧头，之后直接进入FRAME_DATA1状态。此状 态结束之前提前给出业务数据读数指示标志，传送给前级STBC模块。
FRAME_DATA1：进入此状态前，业务数据已完成前阶段的编码调制存入STBC 模块中的缓存RAM中，从前级模块中读取200个1040长度的数据时隙，只需提前 两个数据时隙即可，数据读出到传送给成帧模块，数据流从时序上对接之前的帧头 序列，200个数据时隙之间穿插读取导频，故按照子状态机在FRAME_DATA1和 FRAME_ PILOT1状态之间跳转。
FRAME_PILOT1 ：本状态对应导频状态，从ROM中读取8192长度的格雷互补 序列，导频序列的相位区别于帧头序列的相位，防止同步定位偏差。
FRAME_CP1：该状态用于在前10ms的数据帧后插入较长的帧CP,完成后即 进入FRAME_ DATA2状态。此状态结束之前提前给出业务数据读数指示标志，传送 给前级STBC模块。
FRAME DATA2：进入此状态前，业务数据已完成前阶段的编码调制存入STBC 模块中的缓存RAM中，从前级模块中读取200个1040长度的数据时隙，只需提前 两个数据时隙即可，数据读出到传送给成帧模块，数据流从时序上对接之前的帧头 序列，200个数据时隙之间穿插读取导频，故按照子状态机在FRAME_DATA2和 FRAME_PILOT2状态之间跳转。
FRAME_PILOT2：本状态对应导频状态，从ROM中读取8192长度的格雷互补 序列，导频序列的相位区别于帧头序列的相位，防止同步定位偏差。
FRAME_CP2：该状态用于在后10ms的数据帧后插入较长的帧CP,完成后即 进入FRAME_DATA2状态。此状态结束之前提前给出业务数据读数指示标志，传送 给前级STBC模块。
4.4	功放数字预失真滤波器的实现
本节介绍数字预失真滤波器的FPGA实现，主要是记忆多项式的数字预失真滤 波器的关键操作，包括硬核乘法器的调用和求取输入数据的平方根。
(1)硬核乘法器
许多系统的FPGA实现都需要调用乘法器，硬核乘法器就是Xilinx Xtreme DSP
59
核心构成部分，本实验室项目MIMO SC-FDE的某些环节也调用了乘法器，无需过 多地占用FPGA的逻辑和路由资源，其组成结构如图4-10。根据数字预失真滤波器 的具体实现参数配置乘法器，图4-11是具体的IP core配置界面。
图4-11乘法器IP core的配置界面
60
硬核乘法器的仿真结果如图4-12所示，乘法器的计算时间是一个时钟，用户可
在IP core中添加流水线，最佳选择是三级流水线。
图4-12乘法器IP core的仿真波形
(2) CORDIC算法实现
数字预失真滤波器的具体实现需要调用CORDIC的IP core,可实现多种复杂运 算，如坐标旋转、三角函数、反三角函数和求平方根等，这里我们需要依赖CORDIC
算法实现求平方根的运算，具体配置界面如下图4-13。
图4-13 CORDIC算法的IP core配置界面
具体实现代码的仿真结果如下，延迟18个时钟后，可以得到输入数据的平方根 值。
61
图4-14 CORDIC算法仿真结果
(3)数字预失真滤波器顶层模块测试
实际仿真实现时，我们仿真固定源信源，作为仿真模块的输入数据，进行 MODELSIM仿真至跑出最后的输出数据，写入文本文件，与MATLAB运算结果进 行对点，使实现与仿真的运算结果一致。数字预失真模块的逻辑资源列表如下表4-2o
表4-2 FPGA资源使用情况
资源名称	使用量	总量	使用率
Slices	3520	455040	1%
LUTs	3511	227520	2%
lOBs	349	600	58%
RAM/FIFO	4	416	1%
BUFG/BUFGCTRLS	1	32	3%
DSP48E1S	52	576	9%
(4)硬件系统测试结果
实际调试中，对单载波频域均衡系统进行测试，信源经过发射端编码调制之后， 通过网口采数，并用MATLAB得到未经数字预失真处理的频谱图4-15,在发射端增 加数字预失真模块，通过网口采数和MATLAB绘制得到经过DPD非线性修正的频 谱图4-16,比较两图可知，发射信号频谱的扩展边带得到矫正，频带利用率提高， 数字预失真模块的线性度有一定的改善，从而验证了硬件设计的正确性，同时有力 证明数字预失真算法在低信噪比MIMO SC-FDE系统中的良好性能。
62
-4	-3	-2	-1	0	1	2	3	4	5
Frequency(Hz)	x107
-5
图4-15没有数字预失真滤波的发射波形频谱图
一 一 一 一 一 一 一 一 一 7 一-5 50 505050 50-1-2
(ZH、UJcop)A±±su9a-B」o(Dds」9M0d
4	5
x107
-4	-3	-2-10	1	2	3
Frequency(Hz)
图4・16有数字预失真滤波的发射波形
63
4.5 I/Q不平衡补偿技术的实现
本节基于MIMO SC-FDE的常规速率32k的硬件平台，对DQ不平衡补偿算法进 行实现。实验室系统设计的目的是能在-2OJB和-4OdB低信噪比环境下稳定工作，故 设计了两种帧结构。对于-2OdB低信噪比条件下的系统，基于本实验平台我们能得到 没有I/Q不平衡时的系统性能曲线，在系统中引入I/Q不平衡，可以得到系统在非理 想特性I/Q不平衡影响下的性能曲线。
对于-20dB低信噪比条件下的系统设计，由于信噪比较低，需要重复发送多组同 步序列通过时隙累加来提高增益。I/Q不平衡的预补偿技术是基于帧头导频的数据进 行参数估计，帧头由12*64共768个时隙组成，其中每个时隙是长度4096的格雷序 列，导频部分共有64个时隙，每个时隙为与帧头处起始相位不同的格雷序列，在发 端成帧时将导频处的格雷序列通过长度为64的m序列进行时隙映射。
实际FPGA实现时，我们依赖同步技术定位到帧结构的帧头，SC-FDE中的同步 原理具体可见下图4-17。
图4-17系统同步原理框图
对于I/Q不平衡在发端的预补偿技术，通过网口采数采得收端的帧头数据，以 4096为单位进行累加，提高收端信号的信噪比，结合发端的帧头数据，我们通过二 阶统计法和WL-LS法能估计得到I/Q不平衡的参数估计,估计长度设定为最佳长度, 即3个抽头系数。在发射机中增加预补偿滤波器，使信号在发射之前先进行信号预 畸变，通过误码仪记录对应信噪比的误码率数据参数，我们能得到二阶统计补偿和 WL-LS补偿算法的性能曲线。
64
图4-18 I/Q不平衡预补偿前后的BER图
对上图4-18进行分析，二阶统计法和WL-LS的预补偿滤波器长度均为最佳长 度3个抽头系数，两者的补偿特性基本相同，系统的性能曲线没有太大的差别，上 图中的补偿曲线接近于I/Q理想平衡的系统性能曲线，说明二阶统计法和WL-LS的 预补偿技术对I/Q不平衡的系统起到很好地校正效果。通过硬件实现，我们能发现本 文采用的预补偿方案，能抵消反馈路径中的非理想频率响应。二阶统计算法建立在 发射信号和反馈信号之间的互相关关系上，此算法明确假设了发射信号是正则信号, 因此该算法最适合于低中频型移动发射机。第二种算法是基于WL-LS模型拟合原理, 没有对发送数据做二阶统计特性的假设，因此，WL-LS算法普遍适用于任意结构的 信号或任意调制方式的信号。通过对两种算法的硬件实现来评估其性能，我们证明 两种算法在低信噪比系统中有非常好的I/Q不平衡补偿校准性能。
另外，在系统的接收端对信号进行I/Q不平衡的盲补偿，由于信噪比较低，我们 通过时隙叠加提高提高信噪比，对于算法(3-42)在实际实现过程中的计算复杂度很 低，故特别适合应用于自适应解决方案中。对于长度为N的补偿滤波器，该迭代算法 的自适应部分需要4N + 1次实数乘法运算和4N-1次实数加法运算，而补偿器 y(t) = x(t) + w『x*(t)本身需要4N次实数乘法运算和2N + 2次实数加法运算。总之，
65
在自适应模式下，每个输出样本信号需要经过8N + 1次实数乘法运算和6N + 1次实 数加法运算。当系数收敛后，停止系数的更新操作，每个输出样本信号需要4N次实 数乘法运算和2N +2次实数加法运算。因此，从算法实现的角度看，本文采用的自 适应解决方案是相关文献中提到的所有针对I/Q不平衡补偿技术中最简单的解决方 案之一。通过误码仪记录对应信噪比的误码率数据参数，我们能得到基于自适应滤 波器的盲补偿算法性能曲线。
图4-19 I/Q不平衡盲补偿前后的BER图
分析图4-19,该图显示了理想I/Q不平衡、I/Q不平衡补偿前后的系统性能曲线, 从中能看出，本文采用的盲补偿技术能有效地去除镜像频率干扰。另外，与单抽头 算法相比，多抽头算法表现出更好的性能，表明模拟前端的镜像频率衰减确实存在 一定的频率选择性。由于镜像频率干扰主要来源的窄带特性，单抽头补偿器能提供 良好的性能，并且单抽头算法和三抽头算法在所获得的误差率之间的差异相对较小。 该算法建立在复杂随机信号的二阶统计特性正则特性上，在相互独立和各自符合正 则特性的信号条件下，由多个调制频率组成的宽带复合中频信号符合正则特性，由 于I/Q不平衡的非理想特性的存在，源信号的正则特性被破坏，通过恢复观测信号的 正则特性来对信号进行I/Q不平衡盲补偿。根据共聊信号去相关的相关解释，自适应
66
算法计算简单，能处理频率选择性的I/Q不平衡的复杂情况，可以有效地应用于低信 噪比系统的补偿器实现中。对自适应盲补偿算法的性能进行分析，在静态不平衡场 景中，自适应算法通过设计能遵循不平衡属性的时变性。
总之，通过硬件实现可知，即使在低信噪比的系统条件下，通过接收端的码块 累加提高信噪比，自适应盲补偿算法能有效地消除I/Q不平衡效应带来的镜像频率干 扰。在算法的推导过程中，我们没有设定特定的信号调制条件（除了信号二阶特性, 循环特性和信号正则特性），因此所采用的方案非常通用，能广泛适用于大多数通 信系统信号。另外，通过分析显示，自适应盲补偿方案在设计上独立于基础通信信 道（时间选择性衰落或频率选择性衰落等）以及载波同步误差，这一突出优点使我 们采用的补偿结构，在实际系统和接收器实现场景下可行性较高。
67
68
第五章总结
5.1	总结与展望
在无线通信系统中，I/Q不平衡和功率放大器非线性是通信链路中两个很有研究 意义的非线性特性研究领域，故IQ调制解调器和功率放大器就是两个重要研究对象。 功率放大器的非线性失真给通信系统带来带内失真和带外失真，带内失真造成信号 的幅度失真和相位失真，提高系统的误码率，带外失真则降低系统的频带利用率。IQ 不平衡会引入系统的镜像频率干扰，对接收端的信号译码性能造成影响。综上对两 类非线性特性影响的综述，本文中我们对其估计和校正算法进行研究，以减小非线 性特性对系统性能带来的不良影响。
本文第二章主要分析了功率放大器的非线性特性极其相关校正技术。现如今， 功率放大器线性技术主要分为两大类，即前馈法和预失真法，前者由于复杂的硬件 条件很少被应用在实际系统中，而预失真法是研究者们研究的热点领域之一。其中 数字预失真由于算法和性能的优越性，是无线通信领域内的热门研究技术，本文针 对数字预失真技术进行分析和研究，重点讨论了记忆多项式数字预失真算法的性能 仿真。
本文第三章分析了 I/Q不平衡对信号性能的影响，以及对I/Q不平衡系统的基础 建模。之后通过两部分对通行链路中的非理性特性UQ不平衡进行探讨。
第一部分讨论了在发射端上变频阶段进行I/Q不平衡预补偿的算法，主要采用了 两种用于估计预失真滤波器的算法，分别是二阶统计法和WL-LS估计法，两种技术 都是利用调制器输出返回到数字基带的反馈信号进行参数估计。通过仿真，我们能 发现本章采用的预补偿方案，能抵消反馈路径中的非理想频率响应。二阶统计算法 最适合于低中频型移动发射机，WL-LS算法普遍适用于任意结构的信号或任意调制 方式的信号。通过对两种算法的仿真来评估其性能，我们证明两种算法有非常好的 I/Q不平衡补偿校准性能。
第二部分探讨在接收端下变频阶段进行I/Q不平衡补偿的算法，该算法建立在复 杂随机信号的二阶统计特性正则特性上。对自适应盲补偿算法的性能进行分析，在 静态不平衡场景中，自适应算法通过设计能遵循不平衡属性的时变性，能广泛适用
69
于大多数通信系统信号。另外，通过仿真分析显示，自适应盲补偿方案在设计上独 立于基础通信信道（时间选择性衰落或频率选择性衰落等）以及载波同步误差，这 一突出优点使我们采用的补偿结构，在实际系统和接收器实现场景下高度可行。
第四章主要概括介绍了实验室的MIMO SC-FDE项目，以及我在其中负责的发 端系统，即远距离、低信噪比无线信道环境下的高可靠性的发射机系统，系统采用 独特的发射架构和相应的数据帧结构，利用编码增益、空间分集增益等，实现远距 离、低信噪比条件下的高可靠通信。基于设计的发端系统，结合I/Q不平衡补偿算法 和功放数字预失真技术，实现对通信链路中的非理想特性的检测与补偿。在硬件设 计上面本文采用的是Xilinx公司的XC6VLX365T-1FFG1156芯片，考虑到硬件资源 和数据的处理效率，发射机力求在设计上做到模块化和流水化的并行处理模式。
5.2	未来展望
首先，线性化技术是近几年来无线通信技术高度发展而提出的新研究领域，具 有高度的应用价值和经济意义。为适应未来更加高效率、高线性、带宽的无线通信 系统，功放线性技术需要进一步的算法研究和分析。
对于本文采用的I/Q不平衡检测与补偿算法,未来发端的预补偿技术可以重点关 注下面几方面：（1）在补偿系统中结合LO泄漏估计和校正的技术；（2）进一步推 导设计得到预失真滤波器系数估计的自适应方案；（3）进行更精细的实验室射频信 号的测量。而基于收端的I/Q不平衡检测与补偿算法，未来的工作可以集中在对算法 的进一步分析。
对于收发端同时存在IQ不平衡和功放非线性的联合估计与校正算法的研究，是 下一步主要研究的方向，这部分有很多的工作需要做。将本文采用的频率选择性的 I/Q不平衡模型与功率放大器非线性模型相结合，找到一种普适性更高、复杂度更低 的优良性能的联合模型，对两种非理想特性的联合失真进行研究与分析。
70
参考文献
[1]	Der L, Razavi B. A 2-GHz CMOS image-reject receiver with LMS calibration[J]. Solid-State Circuits, IEEE Journal of, 2003, 38(2):167-175.
[2]	Come B, Ness R, Donnay S, et al. IMPACT OF FRONT-END NON-IDEALITIES ON BIT ERROR RATE PERFORMANCE OF WLAN-OFDM TRANSCEIVERS [C]// Radio & Wireless Conference. 2000.
[3]吴芬芳,IQ不平衡在OFDM系统中的估计与补偿算法研究[D].浙江大学,2015.
[4]	Brotje L, Vbgeler S,Kammeyer K.-D J Estimation and correction of transmitter-caused I/Q imbalance in OFDM systems”,Proc.7th jnt] OFDM Workshop, Sept. 2002, pp.178-182.
[5]	Yoshida Y, Hayashi K, Sakai H, et al. Analysis and Compensation of Transmitter IQ Imbalances in OFDMA and SC-FDMA Systems [J]. IEEE Transactions on Signal Processing, 2009, 57(8):3119-3129.
[6]	Tarighat A, Bagheri R, Sayed A H. Compensation schemes and performance analysis of IQ imbalances in OFDM receivers [J]. IEEE Transactions on Signal Processing, 2005, 53(8):3257-3268.
[7]	Shafiee H , Fouladifard S . Calibration of IQ imbalance in OFDM transceivers[C]// Proc Inti Conference on Communications. 2003.
[8]	Xing G,Shen M,Liu HJ Frequency offset and I/Q imbalance compensation fbr direct-conversion receivers,Wireless Communication,IEEE Transactions on5Mar.20055vol.4,no.2?pp.673-680.
[9]	Valkama M, Renfbrs M, Koivunen V Compensation of frequency-selective I/Q imbalances in wideband receivers: models and algorithms[C]// Wireless Communications. 2001.
[10]	Pun K P, Franca J E, Azeredo-Leme C, et al. Correction of frequency-dependent I/Q mismatches in quadrature receivers[J]. 2001.
[11]	Feigin J, Brady D. Joint Transmitter/Receiver I/Q Imbalance Compensation for Direct Conversion OFDM in Packet-Switched Multipath Environments^]. IEEE
71
Transactions on Signal Processing, 2009, 57(11):4588-4593.
[12]	Chrabieh R, Soliman S. IQ Imbalance Mitigation via Unbiased Training Sequences[C]// IEEE Global Telecommunications Conference. 2007.
[13]	Seymour C D. Development of spacecraft solid-state high-power L-band amplifiers[J]. lee Proceedings F Communications Radar & Signal Processing, 1986, 133(4):326-338.
[14]	Chen J T, Tsai H S, Chen Y K. The optimal RLS parameter tracking algorithm for a power amplifier feedforward linearizer[J]. Circuits & Systems II Analog & Digital Signal Processing IEEE Transactions on, 1999, 46(4):464-468.
[15]	Garcia P , Ortega A, De Mingo J , et al. Nonlinear distortion cancellation using LINC transmitters in OFDM systems [J]. IEEE Transactions on Broadcasting, 2005, 51(1):84-93.
[16]	Muhonen K J, Kavehrad M, Krishnamoorthy R. Look-up table techniques for adaptive digital predistortion: a development and comparison[J]. IEEE Transactions on Vehicular Technology, 2000, 49(5):1995-2002.
[17]	Bo A, Zhi-Xing Y, Chang-Yong P, et al. Improved LUT Technique for HPA Nonlinear Pre-Distortion in OFDM Systems[J]. Wireless Personal Communications, 2006, 38(4):495-507.
[18]	Besbes H , Le-Ngoc T . [IEEE Global Telecommunications Conference - San Francisco, CA, USA (27 Nov.-l Dec. 2000)] Globecom \H00 - IEEE. Global Telecommunications Conference. Conference Record (Cat. No.00CH37137) - A fest adaptive predistorter for nonlinearly amplified M-QAM signals[J]. 2000, 1:108-112.
[19]	Akaiwa Y, Nagata Y Highly Efficient Digital Mobile Communications with a Linear Modulation Method[J], IEEE Journal on Selected Areas in Communications, 1987, 5(5):890-895.
[20]	Biglieri E , Barberis S , Catena M . Analysis and compensation of nonlinearities in digital transmission systems[J]. Selected Areas in Communications IEEE Journal on, 1988, 6(1):42~51.
[21]艾渤，杨知行，潘长勇，et al.高功率放大器线性化技术研究[J].微波学报,2007, 23(1).
[22]田耘.数字预失真技术在WCDMA直放站中的应用[D].北京邮电大学,2009.
72
[23]	Boumaiza S, Ghannouchi F M. Realistic power-amplifiers characterization with application to baseband digital predistortion for 3G base stations[J]. IEEE Transactions on Microwave Theory & Techniques, 2002, 50(12):3016-3021.
[24]	David Su W M. An IC for linearizing RF power amplifiers using envelope elimination and restoration [J]. Solid-State Circuits, IEEE Journal 1998, 33(12):2252-2258.
[25]	Kim Y D, Jeong E R, Lee Y H. Adaptive Compensation fbr Power Amplifier Nonlinearity in the Presence of Quadrature Modulation/Demodulation Errors [J]. IEEE Transactions on Signal Processing, 2007, 55(9):4717-4721.
[26]	Ding L , Ma Z , Morgan D R , et al. Frequency-dependent modulator imbalance in predistortion linearization systems: modeling and compensation[C]// Conference on Signals, Systems & Computers. IEEE, 2003.
[27]	Anttila L, Valkama M, Renfors M. Frequency-Selective I/Q Mismatch Calibration of Wideband Direct-Conversion TransmittersfJ]. IEEE Transactions on Circuits & Systems II Express Briefs, 2008, 55(4):359-363.
[28]	Windisch M , Fettweis G . Adaptive I/Q imbalance compensation in low-IF transmitter architectures[C]// IEEE Vehicular Technology Conference. IEEE, 2004.
[29]	Valkama M , Renfors M , Koivunen V . Blind signal estimation in conjugate signal models with application to I/Q imbalance compensation]J]. IEEE Signal Processing Letters, 2005, 12(11):733-736.
[30]	Anttila L, Valkama M, Renfors M. Blind Moment Estimation Techniques for I/Q Imbalance Compensation in Quadrature Receivers[C]// IEEE International Symposium on Personal. 2006.
[31]	Anttila L, Valkama M, Renfors M. Circularity-Based I/Q Imbalance Compensation in Wideband Direct-Conversion Receivers [J]. IEEE Transactions on Vehicular Technology, 2008, 57(4):2099-2113.
[32]	Cavers J K. The effect of quadrature modulator and demodulator errors on adaptive digital predistorters fbr amplifier linearization[J]. IEEE Transactions on Vehicular Technology, 1997, 46(2):456-466.
[33]	Anttila L, Valkama M, Renfors M. Blind Compensation of Frequency-Selective I/Q Imbalances in Quadrature Radio Receivers: Circularity -Based Approach[C]// IEEE
73
International Conference on Acoustics. 2007.
[34]	60GHz通信系统中IQ不平衡的影响分析与补偿算法研究[D].电子科技大学, 2014.
[35]	Schenk T C W, Smulders P F M, Fledderus E R. Estimation and compensation of TX and RX IQ imbalance in OFDM-based MIMO systems[C]// Radio & Wireless Symposium. 2006.
[36]徐静.宽带移动通信中自适应MIMO SC-FDE系统的研究[D].山东：山东大学， 2011.
74
