第一章绪论
1.1研究背景及意义
近年来，随着科学技术的进步，我国的高速铁路飞速发展，目前总里程已超 过1万公里，并拥有世界上最大规模的高铁体系［1］。在日本、法国等发达国家， 700系、TVG等高速列车最高时速早已超过350km/ho我国的380A列车更是达 到了最高380knVh的峰值速度。怎样保障在如此高的移动速度下进行正常的通信, 已经成为LTE中亟待解决的问题。将具有较高相对移动速度的通信环境和低速、 静止的通信环境相比较，多普勒效应［2］已经成为重要的影响通信系统性能的因 素之一。相对移动速度越大，多普勒频率偏移就会越高［3］,系统的误码率就会 越大。在下一代移动通信系统ETE中，我们要针对高速铁路的信道环境，设计 出合理的频率偏移估计与补偿的方法，这样才能对传输数据进行可靠的恢复。
正交频分复用OFDM ［4］是一种应用于无线通信系统的多载波调制技术° OFDM技术本身具有很多优点，如采用重叠的子载波使得其可以完成很高速率 的数据传输，如在传输信号前端插入循环前缀［5］使得其具有很强的抗多径衰落 能力等等。目前，在LTE通信系统的下行链路中，正是釆用了 OFDM技术。但 是与此同时，OFDM技术也存在一些缺点：对频率偏移和相位噪声极度敏感［6］； 发送功率的峰均比较大［7］等等。能否有效的克服上述缺点已经成为了实际应用 中考虑的关键问题。
由于高铁列车相对基站移动速度很大，在OFDM系统各类频偏干扰中，多 普勒效应带来的频率偏移CFO (Carrier Frequency Offset)十分明显［8］［9］»造成 这一特性的原因是与低速的信道环境相比，高速移动的信道环境具有更大的多普 勒频移［10］,频率偏移数值在短时间内可能发生剧烈跳变等特点。其中最明显的 差异就是信道的相干时间显著缩短［11］，信道参数将会在很短的时间内发生剧烈 变化。使用OFDM技术虽然有效的避免了多径信道带来的频率选择性衰落，却 扩大了 LTE系统下行链路中多普勒效应带来的影响。由于高速移动会带来较大 的频偏，而OFDM系统又对频偏十分敏感，这导致LTE中OFDM系统的频偏估 计与补偿显得尤为重要［12］o
在OFDM技术中，对于载波的频偏估计的准确性要求很高。这是因为OFDM 技术中采用的子载波在频域上是正交且重叠的［13］,并不存在保护间隔。这样一 来，虽然通过提高频带的利用率带来了高速率的数据传输，但是对于子载波正交 的依赖性，造成其必须在接收端保持十分精确的子载波频率。对于OFDM系统 来说，在时域上，每个符号都是用一组频域上正交的子载波调制叠加而成。而这 些子载波之间保持正交，是在接收端正确的还原信号的重要需求。目前，载波的 频偏估计包括整数倍频偏估计和小数倍频偏估计两部分，一般的通信系统中，先 进行整数倍频偏估计，然后再进行精确的小数倍频偏估计。目前，OFDM技术 中的整数倍频偏估计技术已经较为成熟[14],在本文中主要针对了小数倍的频偏 估计进行了研究。
载波频偏的准确估计对改善和提高LTE通信系统的性能起着重要的作用 [15],对于一般的单载波系统，锁相环可以达到所需的技术指标。但是对于OFDM 这种采用多载波正交的系统来说，这种简单的保持频率同步的方法显然有着种种 不足。锁相环进行频率同步的缺点十分明显，首先，这种方法对于载波的频率捕 获和跟踪耗费的时间较多，在高速数据传输系统中，无法提供如此充裕的时间。 其次，锁相环系统即使已经完成锁定，输入和输出信号之间还有可能存在一个相 位差，这对于对相位噪声特别敏感的OFDM系统来说是致命的缺陷。因此对于 LTE通信系统来说，需要新的方法来解决频率同步这一问题。目前已经存在不少 低速场景下应用的频偏估计算法，本文研究了其中一些经典的频偏估计算法，主 要包括以下几种：Moose频率同步算法[16],该算法是Moose等人提出的，基于 最大似然估计方法的频偏估计算法，其优点是原理简单易于理解，缺点是性能不 足、相关运算计算量较大，实际运算会占用较多的硬件资源；T. Schmidl&D. Cox 算法又名S&C算法[17],这种算法是利用在发送端插入训练符号，在接收端通 过训练符号来进行频偏估计，是在时域上进行估计与补偿的算法。该算法中的训 练符号具有特殊的帧结构，利用了 IFFT的特性，在输入的序列符号中间隔插入 零和PN序列，使得接收端的训练符号在去除循环前缀CP后前后半段相同。这 样通过前后半段的相关运算得到频率偏移，该算法在低速环境表现尚可，因此在 后续研究中着重应用该算法针对高速环境进行改进；Classen和Meyr提出了一种 利用导频序列的频偏估计算法[18],其利用在发送信号中插入的导频来进行频偏 估计，算法复杂度尚可，在频域阶段进行频偏估计；基于循环前缀的频偏估计算 法[19],该算法利用了 OFDM符号的循环前缀来进行频偏估计。由于在OFDM 符号中循环前缀和后端相同长度的数据帧完全重复，我们可以利用这两段相同的 序列来进行相关运算估计出频偏。但是，由于循环前缀在实际系统中很可能受到 多径信道带来的干扰，所以这种方法在实际应用中表现欠佳。这些经典算法在实 际应用中往往需要针对信道环境进行调整，在本文中，针对高速移动环境的特点， 创造性的将导频算法和S&C算法进行了改良，使其更加适用于特殊的信道环境。
1.2论文完成的主要工作
在本论文中，我们主要研究和讨论了在具有较大的相对移动速度的信道条件 下，OFDM系统中频偏估计与补偿的算法。首先，我们在第二章中讨论了 ITE 下行链路中OFDM符号的帧结构和OFDM系统的基本原理，以及较高的相对速 度会给信道带来哪些变化。然后，在第三章中对于经典的频偏估计算法进行了归 纳和总结，分析了四种经典的频偏估计算法在实际应用中的优势和缺点，并指出 在本文中是基于S&C和导频的算法进行的拓展。然后在第四章中，阐述了本文 中提及的改进算法原理，一种是基于导频算法进行迭代，另外两种是基于S&C 算法的变形，并将改进算法和经典算法进行了仿真对比。最终，第五章对于全文 进行总结。
本论文各章节内容具体安排如下：
第二章：先介绍了 LTE中信号的传输过程和ETE中OFDM符号的帧结构。 然后介绍了 OFDM系统的子载波结构和信号传输过程。最后简要分析了高速移 动条件下的信道特点，讨论了仿真过程中信道参数如何设置等问题。其中包括多 径传播、多径衰落、时变信道、多普勒频移、高斯白噪声等等，并在此基础上确 定了本文中仿真平台中釆用的信道参数。
第三章：对目前已存在的四种经典频偏估计算法进行分析，指出其优劣性和 可能的改进方向，是本论文的第一个核心点。本章分为四个小节，每个小节包含 一种经典的频偏估计算法，分别是Moose算法、S&C算法、导频算法、循环前 缀算法。本章对每个经典算法的原理进行阐述,将算法中所涉及的公式迸行推导, 釆用图示法，形象的将算法原理表述出来。在此基础上，还分析了每个经典算法 在实际应用中优劣性，着重研究了导频算法和S&C算法，这两种算法是本文第 四章中三种改进算法的原型。
第四章：改进算法的原理以及和经典算法的对比仿真。在第三章的基础上, 本章着重讲解了改进算法的算法原理，并在第二章的仿真平台下对改进算法和经 典算法进行仿真对比，这是本文的第二个核心点。本章中，深入研究了在符号中 插入导频的算法，在该算法基础上，创造性的引入迭代思想，提出了一种基于插 入导频的迭代算法，并进行了仿真分析，性能优于经典算法。对S&C算法进行 了深入讨论，并在此基础上提出了两种改进的频偏估计方法，一种是适用于具有 符号间干扰ISI (Inter-Symbol Interference)信道环境的改进算法，另一种是适用 于高速变化信道的自补偿算法，并对于第一种适用于ISI信道环境的改进算法进
行了仿真分析。
第五章:在总结全文内容的基础上，对频偏算法未来的发展方向进行了展望, 并提出了一些有待进一步研究和仿真验证的问题。
第二章OFDM系统原理与高速信道模型分析
本章对LTE系统原理、OFDM技术原理和高铁信道模型参数三个方面进行 了研究和探讨。其中，LTE通信系统主要阐述了系统架构和符号的帧结构。在 OFDM技术分析中，指出了其对频率偏移的敏感性，从而引出了频偏估计的重 要性。对于高速铁路信道环境的研究，结合目前对于高铁信道环境的研究成果， 引出了该信道环境特点，并给出了本文仿真所使用的信道环境。
2.1 LTE通信系统概述
与第二代移动通信技术相比，第三代移动通信技术在通信的质量和容量上有 了较为明显的提高［20］。但是，随着智能移动终端飞速发展，3G通信技术的数 据传输速率已经不能满足目前用户的需求。目前，用户需要使用移动终端设备观 看网络视频、浏览质量较高的图片和进行FACETIME即时视频等业务，这些业 务对移动网络的数据传输能力有很高的要求。所以，我们需要提供性能更好并且 数据传输能力更强的通信系统，才能满足目前移动通信用户的需求。LTE是第三 代合作伙伴计划(3” Generation Partnership Project, 3GPP)在2004年多伦多会议 提出的［21］,是针对目前的3G移动通信技术的长期演进(Long Term Evolution, LTE)o准确的说，LTE是3.9G全球通信标准。在LTE系统中，下行链路中采用 了 正交频分复用(Orthogonal Frequency Division Multiplexing, OFDM)技术来传 输数据。OFDM 技术和多入多出(Multiple-Input Multiple-Output, MIMO)技术 作为其网络进行演进的唯一标准。LTE系统支持的网络带宽有1.4MHz、3MHz、 5MHz、10MHz、15MHz、20MHz总计六种。目前中国移动采用的TDD-LTE配 置的是20MHz的带宽，总计获得130MHz的频率资源，分别为1880-1990MHz、 2320-2370MHZ、2575-2635MHz,下行理论峰值速度约为80Mbps。中国联通获 得了 FDD的运营牌照，总计40MHz的频率资源，分别为2300-2320MHz和 2575-2635MHzo中国电信获得了 40MHz的频率带宽，分别是2370-2390MHz和 2635-2655MHzo可以看出，相比于3G通信系统的频段，LTE通信系统中分配的 频段更高［22］,这既有好处又有坏处。好处是高频段开发较少相对纯净，相应的 受到的干扰会低一些，加上高频频段频谱资源丰富，同样的带宽条件下，容量要 优于低频段，在信号较差的条件下也能够有不错的表现。坏处是频率高意味着穿 透性差，室内若没有部署专用基站信号就会不太理想，另外用户在移动过程中受 到多普勒效应的影响也会增大。目前LTE数据速率已经可以充分的满足目前用 户对上网业务的需求，LTE技术的系统性能要求、网络部署、网络架构和市场需 求［23］如下表2-1所示。
表2-1 LTE系统需求
需求名称	需求内容
下行链路
-	峰值传输速率	>=100Mbit/s
峰值频谱效率	>=5bit/s/Hz
小区平均频谱效率	1.6-2.1 bit/s/Hz/cell
小区边缘频谱效率	0.01~0.06bit/s/Hz/user
上行链路	峰值传输速率	>=50Mbit/s
峰值频谱效率	>=2.5bit/s/Hz
小区平均频谱效率	0.66-1.Obit/s/Hz/cell
小区边缘频谱效率	O.O2~O.O3bit/s/Hz/cell
系统
-	连接建立时延	<=100ms
运行带宽	1.4,3,5,10,15,20MHz

2.1.1 LTE系统架构
LTE系统中的网络结构相对于3G通信系统而言较为简单。其釆用了扁平化 部署方案［24］,有效的减少了通信协议的层次，实现了网络简化。具体系统架构 如下图2-1所示。整个通信系统由两部分组成，分别是演进型分组核心网(Evolved Packet Core, EPC)和演进型基站(Evolved Node B, eNB)。其中，eNB 之间的链 接是通过X2接口来实现的，每个eNB和LTE核心网EPC通过S1接口相连， 而用户和基站之间是通过Uu空中接口相连在一起，这样通过几种接口来实现了 网络上的互联［25］O
在ETE接入网中，取消了单独的无线网络控制器(Radio Network Controller, RNC),将其和3G通信系统中的NodeB集成在一起组成eNB,这样通过集成减 少了通信协议层次，使得系统更加扁平化。LTE核心网主要由三部分组成，分别 是负责信令处理的MME (Mobility Management Entity).负责本地网络用户数据 处理的S-GW (Serving Gateway)和负责用户数据包与其他网络的处理的P-GW (PND Gateway)□其中，MME是移动管理实体，是LTE接入网络的重要控制 节点，主要负责用户的定位、传呼等信令处理、接入层安全控制、空闲状态移动 性管理等。S-GW主要用来处理用户的平面功能，包括终止寻呼产生的用户平面 数据、支持由于UE移动性而产生的用户面切换、合法监听、用户计费、分组数

据的路由与转发等。P-GW的主要功能是基于用户的包过滤、IP分配、上下行传
输层数据包标示等。
MME / S-GW
LTE基站
eNodeB
LTE基站 eNodeB
LTE核心网
EPC
LTE接入网
E-Utran

















图2-1 LTE系统总体架构
2.1.2 LTE帧结构
在LTE系统中，支持两种不同的工作模式，分别是频分双工(Frequency Division Duplexing, FDD)和时分双工(Time Division Duplexing, TDD) [26]o 国 内在实际应用中，中国移动使用的是TDD制式，中国联通和中国电信都是使用 的FDD制式。这两种不同的工作模式分别对应Typel和Type2两种帧结构。这 两种帧结构在时域的帧长均是10ms,帧内部的子帧结构有所不同。其中，Typel 应用于FDD工作模式，即FDD帧结构。Type2应用于TDD工作模式，即TDD 帧结构。
在FDD的帧结构中，釆用了简单的等长时隙帧结构[27]o如下图2-2所示, FDD-LTE通信系统中沿用了通用移动通信系统(Universal Mobile Telecommunications System, UMTS) 一直釆用的10ms无线帧长度。在时隙划分 时，由于LTE系统在数据传输延退方面要求单向延迟小于5ms,这对发送时间 间隔(Transmission Time Interval, TTI)就提出了很高的要求。一般情况下，通信 系统中的TTI和子帧长度相同，由此造成了 FDD-LTE系统的子帧长度也必须较 小。所以，在FDD-LTE系统中将每个帧分为20个长度为0.5ms的时隙。较小的 子帧长度虽然可以提供较小的传输延迟，但是与此同时，过大的调度信令开销也 会使得系统的频谱效率下降。所以，最终确定了子帧的长度为1ms,两个时隙组 成一个子帧。这样，在FDD-LTE系统中，就使用了共10个子帧，20个时隙的 结构，其中1个子帧中包含两个时隙。
TDD-LTE系统中的无线帧长度与FDD-LTE系统相仿[28].-均是10ms,其中 包含两个结构完全相同的半帧，每个半帧的长度为5ms。和FDD-LTE系统一样， TDD-LTE系统中为了平衡调度信令的开销和数据传输的延迟，将每个子帧长度 也设置为1ms。与FDD帧结构不同的是,TDD的子帧有两种类型，一种是与FDD 帧结构相同的普通的子帧结构，其中包含两个长度为0.5ms的时隙，每个半帧中 有4个普通的子帧结构。另一种是特殊的子帧，其中包含3个特殊的时隙，分别 为上行导频时隙(Uplink Pilot Time Slot, UpPTS)、保护时隙(Guard Period, GP) 和下行导频时隙(Downlink Pilot TimeSlot, DwPTS),这三个特殊时隙的总长度 是1ms,每个半帧中有1个特殊的子帧。


图2-2 LTE系统Typel和Type2帧结构示意图
在Type2帧结构的特殊子帧中，UpPTS、GP和DwPTS的长度可以有多种 分配方式，只要总长度保持1ms即可。ETE下行链路中的OFDM符号中，有两 种不同的插入循环前缀(Cyclic Prefix, CP)的方法，其中一种叫做一般的循环前 缀(Normal Cyclic Prefix, NCP),在这种插入NCP的符号结构中，一个0.5ms的 时隙里可以传输7个OFDM符号。另一种插入拓展循环前缀(Extended Cyclic Prefix, ECP)的OFDM符号，在一个0.5ms的时隙里只能传送6个。由于相比于 插入ECP,插入NCP的系统容量更大，所以在默认的情况下LTE系统中使用的 是插入NCP的OFDM符号。由此可知，在一个Type2的特殊子帧中，一般情况 下会占用14个OFDM符号，这里就会有多种不同的分配方法，如下表2-2所示：
表2-2插入NCP的OFDM符号特殊子帧的配置
特殊子帧的 配置方法	插入NCP的OFDM符号的配置方法
DwPTS	GP	UpPTS
0	3	10	1
1	9	4	　　　1
2	10	3	　　　1
3	11	2	1
4	12	1	　　　1
5	3	9	2
6	9	3	2
7	　　　10	2	　　　2
8	11	1	　　　2
在上表2-2中，目前厂家支持的配置方法是第5种和第7种。在第5种配置 方法中,3:9:2的配置特点是可以有效的避免远距离的同频干扰和某些TD-S配置 引起的干扰。第7种10:2:2的配置方法目的是为了提高下行吞吐量。
2.2 OFDM技术简介
在数字无线移动通信中，无线信道的频率资源有限，要求有效利用信道频带。 尤其是作为第三代移动通信技术的演进,ETE通信系统中希望支持更高信息速率。 在ITE通信系统中，期望系统能够达到传输100Mbps的峰值信息速率［29］。正 交频分复用技术早在20世纪50年代就已经被提出，并且应用于一些军工、航天 等使用高频段的通信系统。但由于该技术在实际实现过程中的复杂性较高，一直 并未投入民用。
从频域的角度来看，若两个信号的频谱不重叠，并存在一定的保护间隔，那 么他们之间自然是正交的。但是，频谱不重叠并不是正交的必要条件，由三角级 数系的正交性可知，只要保证每个三角函数的频率是某一固定频率的整数倍，那 么不同频率的三角函数或同频率的正交级数在［-兀,兀］上相乘后积分的结果就为 零，也就是所谓的正交。在OFDM系统中，就是应用这样一系列相互正交的三 角级数系当作子载波来实现多载波调制。其中，子载波间隔是子载波上符号间隔 的倒数，各子载波虽然重叠，但仍然正交。这种频率上的重叠使得频谱效率大大 提高，而快速傅立叶变换(Fast FourierTransfonnation, FFT)和其反变换(Inverse Fast Fourier Transformation, IFFT) ［30］让OFDM技术能够低成本的以数字的方式 实现。

在OFDM技术中，传输信号的基本特征有别于窄带传输的直接多载波扩展。 首先，OFDM系统中使用相对较多的窄带子载波，这些子载波频域上重叠，时 域上正交。其次，子载波具有简单的矩形脉冲成型。最后，频域上子载波排列紧 密，子载波间隔为苗=1/孔，烏是子载波的调制符号周期。OFDM系统中子载 波频域上波形如图2-3所示，由于矩形脉冲的频谱是SINC函数波形，该波形具 有带外频谱衰减慢的特点，这一特点会带来较大的底噪。在实际应用的通信系统 中，我们还要加快带外频谱的衰减来降低系统的底噪，从而提高OFDM系统性 能，并且降低其对频偏的敏感性。与此同时，还需要通过不同的发送信号脉冲成 型技术来改善OFDM系统的子载波频谱结构[31]o
OF DM中的子栽波
频率
图2-3 OFDM信号子载波频域波形图
在OFDM符号调制过程中，一般釆用正交振幅调制技术(Quadrature Amplitude Modulation, QAM)调制。QAM调制过程中星座点的数量M决定了 OFDM符号数据传输速率，一般的QAM主要釆用16-QAM和64-QAM两种方 式，星座点越多符号速率越快，相应的信号传输质量也就越差。由于本文在仿真 过程中使用的是16-QAM调制，所以以该种调制方式为样本介绍。信号的调制 原理图如图2-4所示，一组包含数据信息的二进制比特流以7?》的传输速率进入 QAM调制系统。首先经过串并变换模块，成为N路比特速率相同的数据流，将 单路速率降低为Rb/N。然后使用两两正交的子载波分别对每路数据进行16QAM 调制，此时每路上的子载波速率应为R〃4N。最后将每路上的信号合并后一起发 送。若釆用M进制的QAM调制，那么每个子载波上的符号速率是珞=Rb/log2M, 子载波间隔是= Rs。
io


16QAM



图2-4 OFDM系统中的16-QAM调制
在［0,1/21/］时间内，以Sk表示第k个子载波上传输的经过16-QAM调制后的 信号，那么第k路上的调制结果可以这样表示：
Sk(t) = Akcg(t) cos(2nfkt) - Aksg(.t) sin(2nfkt)
=Re{[Akc +/仙]9。)必sq
其中Akc和Aks分别表示16-QAM星座点的同相分量和正交分量，氐表示第 k路上的载波频率，其应该满足九=fc+ 4/■的条件来实现子载波正交。
假设每个OFDM符号持续时间为Ts，起始时刻为0,那么对于含有N个子 载.波的OFDM系统，发送信号在一个符号持续时间内的表达式可以写成:
N-1
S(t) = £ Sk,
fc=0
N-l
=Re{£[4kc + 為如④必 #丐，0<t<7； fc=0

上式中，a(t) = Xk=o^kc+ Mks］g。)，是OFDM符号在时域上表示时的复 包络。通过a(t),我们可以采用另一种方法实现OFDM系统，即令I(t) = Re{a(t)), 令R(t) =	那么发送的OFDM信号可以表示为：
s(t) = I(t) cos(2nfkt) — R(t)sin(2兀益t)
使用复包络的方法来实现OFDM信号的调制过程如下图2-5所示：
11


图2-5使用复包络来实现OFDM
接收端接收到调制在不同子载波上的数据，这些数据虽然被调制在不同频率 的子载波上，但是在一个符号持续时间Ts内，都经历了整数倍的符号周期。由 于相邻子载波之间频率的间隔为1/Ts，这就满足了三角函数系中正交对于频率的 要求。在接收端，我们并不需要使用带通滤波器来通过频率上的分离来解调信号, 而是通过三角函数系的正交性来还原。具体的实现过程和上述调制过程相反，原 理如下公式推导。还原的过程就是通过三角函数系的正交性来进行积分运算，从 而得到传输信号。
小 fts+T (，2所(—乌八
y(t) = J exp(			丿 s(t)dt
6 rts+T
=2_,sfc] exp(/2n(/c	ts)/T)
k=0 ts
= sk-T
在数字通信系统中，上式可以分别由IDFT和DFT变换来实现。一个OFDM 符号持续时间内的发送信号序列可表示为： x(n) = ~z 2 s(k) exp (“甘*), n = 0,1,, N - 1
仆k=0
在上式中，1/伽是功率归一化因子，是为了保证数据经过IDFT和DFT变 换后，总功率保持不变而引入的。在实际应用中，IDFT和DFT有其快速计算方 法，分别是快速傅立叶逆变换IFFT和快速傅里叶变换FFT。正是IFFT和FFT 的出现才让OFDM技术得以推广。在实际应用中，由于OFDM信号经过串并变 换后是先经过IFFT变换，所以我们认为系统的串并变换和QAM编码等过程是 在频域上进行的，而在无线信道中传输的过程中是映射到时域上的。同样的，在 接收端也是先在时域上进行串并变换和解码等过程，然后再经过FFT变换到频 域上得到最终的信号。由此引入了两种不同的频偏补偿方法，一种是在时域上的
12
补偿，另一种是在频域上进行补偿。图2-6给出了 OFDM系统的原理框图。

图b接收端解调过程
图2-6 OFDM调制的数字实现
在OFDM技术中，我们将以高速率Rb传输的比特数据流降速，分成N组并 行的速率为Rb/N的数据流，在经过M-QAM编码，速率再次降低logzM倍，最 终经过正交子载波的调制，成为一组低速率且正交的数据并行传输。这样通过降 低实际传输速率，使得传输过程中OFDM信号的频率弥散变小，实现由频率选 择性信道衰落到平坦衰落的改变，有效的减小了符号间干扰。
在无线通信系统中，信道一般具有多径效应，多径效应是指：相同的发送信 号由于物体的反射折射等因素，最终在接收端接收的时间不同步，这种现象也会 引发符号间干扰。OFDM技术中通过插入循环前缀CP来有效的避免多径干扰。 循环前缀是指在一个经过IFFT变换的传输信号前面，插入一段与符号结尾相同 的数据。在实际应用中，有两种插入循环前缀的方案，分别是插入一般长度的循 环前缀NCP和插入拓展长度的循环前缀ECP,后者适用于多径效应较强的信道 环境。循环前缀在OFDM符号中的帧结构如下图2-6所示。
13


图2-6 OFDM循环前缀示意图
OFDM符号中加入循环前缀不仅仅是为了避免符号间干扰，同时也是为了 实现符号的部分周期性。在连续的时间域上，两个信号在时域上卷积等价于这两 个信号在频域上进行乘积。但是在离散线性系统中，该特性成立的条件较为苛刻， 要求离散系统中的样点值趋于正无穷或者卷积信号中有一个是周期性的。在实际 的通信系统中，样点值一定是有限的。所以为了使得OFDM符号满足这一特性， 我们需要将OFDM符号的结构进行调整，使其在某些时间内具有一定的周期性。 插入循环前缀也恰恰可以实现这一要求。所以，OFDM系统中的循环前缀既可 以减小多径信道带来的影响又可以保持符号的周期性，在后面的频偏估计算法研 究中，本文还会阐述一种基于循环前缀的简单的频偏估计方法。
近年来，由于用户对于高速率的数据传输业务的需求，加上终端设备的不断 发展使得其可以完成更加复杂的运算，让OFDM技术在实际系统中的应用越来 越受到关注。究其原因，主要是因为OFDM技术具有一些其他技术无法比拟的 优点：首先，OFDM技术的频谱利用率很高，重叠的子载波让系统可以有效的 传输更多的有用信息，实现更快的数据传输速率；然后，OFDM技术中使用了 长度可变化的循环前缀，这在实际的应用中既能有效的对抗码间干扰，又能实现 信号在时域上的周期性，灵活的满足了系统的多种需求；另外，OFDM符号在 调制解调过程中可以使用IFFT和FFT来实现，这就可以使用低复杂度的收发机 来完成相应工作，有效的降低了设备成本；最后，由于OFDM符号中的子载波 属于窄带子载波，可以准确的限制其信号所占用的频率，即实际使用的频带可以 最大化利用且不超出分配范围。但是OFDM技术并非完美，由于其原理上的特 殊性目前还存在一些困难需要克服。在频域上重叠的子载波带来了较高的频带利 用率，但同时也带来了对频率偏移的敏感性，并且OFDM符号中还存在较高的 峰均比(Peak to Average Power Ratio, PAPR)等。而多普勒效应产生的频率偏移， 或者发射接收机之间存在的频率偏差，都会导致OFDM符号中子载波正交性遭 到破坏，从而引发载波间干扰。这种频率偏差敏感是OFDM系统的主要缺点。
14
2.3高速移动信道环境
2.3.1多径传播和多径衰落
在无线通信系统中，最主要的特性是信号并非通过可靠的固定线路传输，而 是以电磁波的形式在整个空间内传播［32］。在信号传播的空间中，存在着数量极 为庞大的影响因素，如树木、山峰、建筑物、水流等等。任何因子都有可能引起 电波的反射和折射，这就带来了许多条不同的路径。由于在不同的路径上电波传 输需要的时间可能不同，这将导致同一信号经过不同的路径后，到达接收端的时 间上有所差异。因此，接收信号是一组时间上不同步的发送信号组成的，这就是 所谓的多径传播。
由于路径的长短、介质、散射次数等条件不同，电波在不同的路径上传输时， 可能会发生相位偏转。在接收端,相同的相位偏转叠加在一起会让信号强度增加， 相反的相位偏转会使信号强度减弱。接收信号强度在这种相位带来的改变下，会 随之发生剧烈的变化，这种剧烈变化是由于多径传播引起的，我们称之为多径衰 落。
在移动通信系统中，由于多径效应，接收信号相比于发送信号在时域上占用 的时间更多，直观上的感受就是信号变长了，这也就是所谓的时延扩展。时延扩 展会给信号带来严重的失真，同时也会带来严重的符号间干扰。并且，由于是移 动用户，即使一直保持在相同基站的覆盖范围内，也会由于相对移动而产生信道 随时间的变化，即多径衰落也会具有时变性［33］。
在此我们假设无线信道中具有Np条散射路径，并且令其延迟扩展远远小于 发送符号的间隔，假设路径中的延迟可以用它的均值〒来表示。为了描述方便， 在此我们忽略多径衰落的时变性，那么信道的脉冲响应h(t)可以如下表示：
h(r, t) ® z(t)5(r — f)
这里z(t) = E籍L④exp(-/2/爲。))，其中an为第n条路径的衰落系数, 弓为第n条路径的相对时延。若不考虑高斯白噪声带来的影响，接收到的信号可 以如下表示：
广 8	r co
r(t) = I h(z, t)x(t — T)dv = I ［z(t)S(T — T)］x(t — x)dx =	— f)
丿一8	丿一8
通过上述公式不难看出，在我们假设的条件下，多径信道给发送信号带来了 一个大小为z(t)的复数时变幅度增益，和一个大小为T的传输时延。
15
2.3.2多普勒频移
在移动通信场景中，由于用户相对基站来说一般是具有相对速度的，而相对 运动的产生就会带来多普勤效应，从而引入多普勒频偏［34］o多普勒效应是奥地 利物理学家Doppler在1842年首先提出的理论，主要内容是物体间传播的电波 波长由于波源和观测者的相对运动会发生变化。若波源和观测者相向运动，那么 电波在时域上被压缩，即波长变短频率升高，又叫做蓝移(Blue Shift)。若波源 和观测者背向运动，则会岀现相反的现象，叫做红移(Red Shift)o蓝移和红移
频率的计算公式^Af = fsvs/c,与电波的频率&和波源的移动速度Vs正相关，c 是光速常量。如下图2-7所示，蓝移会使信号在时域上压缩。
多普釦效应引起的时域压縮


图2-7相对运动产生的蓝移效应
下图2-8是将受到多普勒蓝移效应影响的信号在频域上的仿真结果，图中实 线表示原始信号的频谱图，虚线表示受到影响后信号的频谱图，横坐标以多普勒 频率偏移量Af为单位。如图我们可以看出，相比于原始信号，多普勒频移就好 像对信号的频谱进行了频率调制，频率搬移量为多普勒频移的大小，蓝移向远离 原点的方向搬移，红移则向靠近原点的方向搬移。由于在实际通信系统中，多普 勒频移是普遍存在并且大小是连续分布在一定范围内的。若这时进行频谱研究, 我们会发现，信号的频谱并不是冲击响应，而是分布在［f0~Af,f0+Af］这一范 围内的一组连续频谱，也就是产生了多普勒频移扩展。这时信道中的多普勒效应 带来的巳经不仅仅有频率搬移，还存在多普勒扩展。
16
I	多普勒效应在频域上的频率搬移
0.9 -	i	-
0.8 -	:	-
0.7 -	j	-
0.6 -	j	-
0.5 -	!	-
0.4 -	:	-
0.3 -	，	-
0.2 -	j	-
0.1 -	?	■
n	I	i	I		1	1	i	1	i
0	1	23456789	10
頻率舟
图2-8多普勒效应造成的频率搬移
由于多普勒效应频移的大小和相对移动速度正相关，所以移动速度较高的高 铁环境中多普勒拓展的范围会较大，这会引发更严重的载波间干扰。除去较大的 多普勒频移外，由于基站是在高铁两边，用户在穿过基站的一瞬间，多普勒频移 会发生跳变，由蓝移转为红移，直到进入下一个基站的小区范围。我们可以通过 以下两点准确的概括高铁环境频移特点：1.多普勒频移较大；2.在穿越基站时会 发生跳变，变化剧烈。
在此我们通过图2-9来分析高铁信道环境中的多普勒效应。图中基站架设在
点S处，用户从X点开始沿着铁路以速度v移动，在移动过程中，电波从基站S
处发射。用户相对于基站的移动速度可以写成vs = VCOS0o


UE
图2-9用户和基站间的相对移动
在上图中，。表示用户实际运动方向和基站方向之间的夹角，d表示X、Y
两点之间距离，K点是多普勒频偏发生跳变的点。在Y点出，由多普勒频偏公
17 式可以求出频偏值为松=fcvs/c = fcvcose/c.用户在穿越K点之前，和基站之 间是相向运动，所以实际产生的多普勒频率偏移应该是蓝移，即频率增加。用户 在穿越K点之后，是背离基站而行，所以是发生的是多普勒红移，电波的频率 应该减小，波长增加。由于用户的移动速度较快，穿越K点经历的时间较短， 频率偏移会发生跳变，从正的频偏乌跳变到负的频偏七，这对频偏估计系统的响 应速度提出了很高的要求。然而，用户在从X点移动到K点的过程中，相位角 。并非保持不变，而是在［0,71/2］之间变化，所以即使是在穿越K点之前，系统 中的频偏也并非是一个固定值，而多普勒效应也展现出之前讨论的多普勒拓展。 根据上面公式，我们可以得到最大多普勒频移为fdmax = fcv/c,相反的我们可以 得到的最小多普勒频移应为fdmin = -fev/c.那么在实际通信系统中，传输信号 的功率谱应该分布在［fc-fcv/cffc+fcv/c］±.,其实际功率谱密度应该是： s(n = -^- ［1-厂与〃
^Jdmax Jdmax
根据上述分析我们可以看出，在无线通信系统中，由于用户和基站之间的相 对移动的存在，多普勒效应会对系统产生很大影响。所以，我们需要对多普勒频 率偏移不断的进行估计和补偿，这样才能提高通信系统的可靠性。在实际的通信 系统中，我们通常使用信道的相关时间这一重要参数来衡量信道的时变性，相关 时间的定义如下公式：
fdmax
可以看出，相关时间这一衡量信道时变性的参数是和多普勒频率偏移负相关 的。如果传输的信号的频率和多普勒频率偏移可比拟，那么相关时间和一个信号 传输的持续时间也就可比拟，那么就会产生较为严重的干扰。若相关时间远远大 于信号的传输时间，那在一个传输间隔内我们几乎可以不考虑相关时间带来的影 响。
结合上文中讨论的高速铁路通信环境特点，我们知道在高铁中的用户移动速 度可能高达400Km/h,根据中国移动LTE网络釆用的中间频段2320-2370MHZ, 其多普勒频率已经超过700Hzo若根据TDD-LTE传输标准中的子载波间隔为 15kHz,用该子载波间隔归一化后的多普勒频偏高达0.049o若再考虑系统中一 些其他的影响因素，归一化的多普勒频移最高可能达到0.1左右。如此大的多普 勒频移将引入时变的载波频率偏移(Carrier Frequency Offset, CFO),这会让釆 用多载波正交频分技术的OFDM系统上行链路的符号和下行链路的符号产生 (Inter Carrier Interference. ICI),从而是误码率急剧上升。实际情况如下图2-10 所示。所以，针对高铁信道环境，对于多普勒频移的研究十分重要，是迫在眉睫 的问题。
18

图2-10 OFDM系统中ICI干扰示意图

2.3.3快速移动无线信道参数
项目中我们使用的信道模型参数[34],主要考虑基站与乘坐高铁时的入网用 户之间的信道环境，即露天的信道环境。露天的信道环境相比于室内信道环境来 说，具有较为复杂的特点，空间中不同的传输介质会对信道产生不同的影响。在 实际的仿真应用中，COST207信道模型被采用的次数较多，它属于广义平稳不 相关散射类信道模型。其信道的冲击响应可以如下表示：
h（t,T）= y	— Tt）e 问 °）
上式中，N是采样点个数，a（t）是在实际应用中添加的幅度系数，，司表示的 是第I个釆样点的延迟，大多数情况下我们假设F是零。
在这种仿真模型中，一共有四种典型的环境，分别是：乡村地区（RA）、典 型城市地区（TU）、山地地区（HT）、恶劣城市地区（BU）。COST207中的TU 模型参数如下表2-3所示，在本文后续的仿真过程中，均是在该仿真模型的基础 上进行的变化模型。
表2-3 URBAN信道环境参数
URBAN	Pathl	Path2	Path3	Path4	Path5	Path6
Type	Rayleigh	Rayleigh	Rayleigh	Rayleigh	Rayleigh	Rayleigh
Fd(Hz)	100	100	100	100	100	100
Magnitude(dB)	-3	0	-2	-6	-8	-10
Delay(us)	0	0.2	0.5	1.6	2.3	5.0

19
2.3.4高速移动通信环境特点及本文中的解决方案
通过前面三个小节对高速铁路信道环境的研究，我们可以发现，高铁信道环 境中具有多径效应、多普勒效应、时变信道等特点。这些特点决定了高速铁路的 通信环境一定十分复杂，这将使得发出的信号在接收端存在很大的干扰。结合 OFDM系统对频率敏感的特点，子载波间的频移会破坏其正交性，最终引起子 载波间干扰(ICI),降低接收端解调性能。所以，解决频偏问题在实际应用中 具有很重要的意义。
为提高移动环境中OFDM系统的性能，我们要对频偏进行估计补偿。对于 频偏估计，先前已经有不少经典算法。在文献［5］中介绍了一种最大似然估计法， 这种方法利用了两个连续且相同的信号。这种方法的最大归一化频偏估计范围是 ±「倍子载波间隔。在文献［6］中介绍了一种ML算法，这种算法通过在符号中插 入导频来进行频偏估计和同步，这种算法在SNR较大的情况下有很好的表现， 可以十分准确的估计出频偏的实际值。.在文献［7］中，介绍了一种名为S&C的算 法，这种算法是利用插入训练符号来进行频偏估计，其训练序列帧结构比较特殊， 除去CP后,前半段和后半段相等，这是通过OFDM符号在进过IFFT变化之前， 在每个数据帧之间分辨插入。来实现的。本文中针对S&C算法进行了改进，分 别阐述了两种改进算法。其中一种基于S&C算法的改进型算法，是针对特殊信 道环境下的OFDM频偏估计来设计的，该算法在原有S&C算法基础上，将相关 的码长度变短。这样创造性的改变训练序列的结构，使得在信道环境较差，传递 的信号存在符号间干扰(ISI)时，具有更加准确的频偏估计。另外一种基于S&C 算法的改进算法适用于SNR较差的环境，该算法不加入训练符号，每个传输的 数据符号就是训练符号，进行频偏估计后，用自身估计的频偏估计来补偿自己， 得到的数据更为精准，唯一的缺点是损失一半数据的传输速率。上述方法将在第 四章中具体分析和仿真。
2.4本章小结
在本章中，我们首先介绍了 ETE系统的一些特点和原理，然后介绍了 OFDM 技术的基本原理和传输过程，最终讨论了高速铁路信道环境并给出了本文的仿真 模型参数。该高铁环境模型中，主要包括多径信道、多普勒频移、和时变信道等 特点，在仿真中使用6条传播路径来表示信道的变化状况，加入高斯白噪声，使 用信噪比控制高斯白噪声强度，并在传输过程中插入频偏。
20
第三章OFDM系统中频偏估计算法分析
本章中，总结归纳了四种经典的频偏估计算法，包括Moose频率同步算法、 S&C频偏估计算法、插入导频序列的频偏估计算法和基于循环前缀的频偏估计 算法。在分析原理的基础上，还对算法的发展方向和实际应用情况做出了阐述。 最终选取了 S&C算法和插入导频的算法分别进行深入研究，为第四章提出改进 算法打下了基础。
3.1 Moose频率同步算法
3.1.1算法介绍
/		N		、	.1 N		K
M				/	1	V
CP	A	　　　　A	'	CP	OFDM符号
Moose算法是在1994年被首度提出的，它是一种基于最大似然估计来进行频, 偏估计的算法。在该算法中，我们默认系统已经完成了精准的符号定时同步。在 该算法中，需要使用两个完全相同的OFDM符号来进行估计，其符号结构图如下 图3-1所示：	―	,—
如上图3-1所示，在一个循环前缀CP后面跟着两个完全相同的符号序列A, 这两个序列就是Moose算法中用来估计频偏的序列。可以看出，两个相同的序列 A之间没有插入循环前缀。若假设系统已经完成了符号定时同步，那么在接收机 处接收到的信号可以写为：
1 v1	、 \2njn(k + £)1
r(n)=万［〉X(心H(士)exp 			 3 - 1
k=-K
上式中，X(k)表示发射的符号序列，H(k)表示无线信道响应函数，£为归一 化载波频偏。在接收端经过FFT变换以后，信号从时域转换到了频域，此时两个 连续的OFDM符号可表示为：
21


N-1
R】(k) = £
n=0
r(7i) exp (— 2njnk/N)
2N-1
&2(*) =
n=N
r(n) exp(—27tjnk/N)






上式中Ri和R2分别表示第一个和第二个OFDM符号信息。由式3-1可以得到:
/?2(fc) = T?i(fc)exp(/27T£)
再引入AWGN信道带来的高斯白噪声，信号可以表示为:
(	*Q) = &(k)+W(k)
= Ri(k) exp(/27TE)+ W(fc)
其中W(k)是噪声信号，Y,和Y2分别表示两个接收信号。由于高斯白噪声普 遍存在，在这里我们忽略掉高斯白噪声带来的影响，那么两个接收信号做如下运 算后可得:
蛉(幻*侬)* = Ri(/c)exp(/27T£)/?i(k)*
=|Ri(k)|2exp(/27T£)
不难看出，我们只要计算出上式中的角度就可以得到频率偏移。所以有：
_]退竺些些也.
s况皿的Re阿)％(幻*]
通过以上分析我们可以知道，在Moose算法估计系统频偏的过程中包含了如 下几步：首先，要发送两个完全相同的OFDM符号；然后，要在接收端将这两个 符号变换到频域上；最终，还要对两个信号进行取实部、虚部和反正切运算。该 过程过在运算量上十分庞大，且过程复杂，实际应用需要简化。
3.1.2算法优缺点分析
Moose算法优点十分明显，即算法的推导过程简单易懂。但是，其缺点也较 多，首先该算法需要使用两个OFDM符号来进行频偏估计。其次，该算法对符号 的定时同步精确性要求很高，若是定时同步失败，那么估计出来的频偏值就会有 较大偏差。而且，这种算法虽然推导过程简单，但是实际应用中的计算量很大， 会给终端带来极大的负担。最后，由于反正切函数会产生极性跳变，导致了Moose 算法的频偏估计范围较小，只能保证在半个子载波以内。综上所述，本文并未选 取该算法作为基础算法来进行改进。
22
3.2 T. Schmidl&D.Cox频偏估计算法
3.2.1 S&C算法原理简介
T.Schmidl&D.Cox提出了一种基于时域的最大似然估计算法卩］,该算法使 用特殊的序列结构，利用完全相同的半个符号长度的训练序列，来进行相关运算 估计频偏，该算法命名为S&C算法。该算法中，在发送端发送间隔插入零的PN 序列，通过IFFT变换后，符号前半段和后半段完全相同。这样，在接收端通过相 关运算就可以求得频率偏移，算法的训练序列结构如图3-2所示：


图3-2 S&C算法结构示意图
其中，第一个训练符号用来进行小数倍频偏估计，第二个训练符号用来进行 整数倍频偏估计。整数倍频偏估计已较为成熟，本文中仅讨论如何进行小数倍频 偏估计。S&C算法中，第一个训练序列频域上只在偶数倍的频率子载波上传输伪 噪声序列(Pseudo-Noise Sequence, PNS),在经过IFFT变换后，时域上就可以得 到一个前后半个序列完全相同的符号。在这里，发送的PN序列并没有实际意义， 主要因为其易于实现并且具有较低峰均功率比。
令第一个训练符号的前半部除循环前缀以外有N/2个复数样值，那么该序列 的相关函数P(d)可以表示为：
L-1
P(d) = £ r*(d + k)r(d + fc + L)
fc=0
上式中r(k)表示釆样信号，L是半个训练序列长度，也就是L=N/2,在该算法 中，我们釆用长度为L的相关窗运算。则载波频率偏差△捆估计值为：
23
arg(P(d))
荷=-^~
Af是估计的载波频率偏移，T是OFDM有用符号持续时间。上式的相关结 果产生了前后子载波的相位差应为exp(2njAfL/N)o
3.2.2 S&C算法特点和本文提出的两种改进算法
S&C算法利用IFFT变化的特性，通过间隔插入PN序列来实现前后完全对等 的训练符号，在通过相关运算和取角运算得到频率偏移。该算法运算量相比 Moose算法较小，估计范围是其的二倍，所以在实际应用中S&C算法表现更佳。 本文选用了该算法作为基础算法进行改进算法设计。
本文中，围绕S&C算法设计了两种改进型的频偏估计算法。第一种是针对具 有ISI干扰的信道环境，设计的改进算法。该算法使用部分相关法，减少了ISI干 扰带来的干扰。相比于经典算法，该算法的缺点也较为明显，由于降低了进行相 关运算的釆样点个数，在无ISI干扰的信道条件下频偏估计的准确性弱于经典算 法。第二种是针对特殊的信道环境进行自补偿的方法，该方法将数据信号按照 S&C算法中的训练符号生成方式发送，这样通过信号自估计来补偿频偏，缺点是 浪费了一半的带宽，可以在某些特定场景下应用。
3.3利用导频序列的频偏估计算法
3.3.1算法简介
导频算法是Classen和Meyr提出的一种基于插入导频序列来进行频偏估计的 算法。该算法中，频偏估计的过程分为两步，第一步是在发送符号端插入导频序 列，用来在接收端进行频偏估计。第二步是在接收端通过导频序列来进行频偏估 计。一般情况下，我们插入导频是插入等间隔的PN序列。导频序列的示意图如 下图3-4所示：

图3-4导频子载波分布

24
在此我们令多普勒效应带来的频移是电OFDM符号的长度是N,信道在一 个符号传输时间内不发生剧烈变化。那么FFT变换后得到的接收信号可以用下式 表示出来：
Zn,l = ejWdnT SisSfdTiH 侦1） + 侦
上式中前一项为有用信息，a是受到频偏乌带来的幅度影响，e是其带来的相 位影响，s是传输的信号数值，fi是信道中其他因素带来的频率搬移。后一项是高 斯白噪声，由于其本身就是无规律信号，所以并不会受到乌的影响。
由于导频符号在接收端属于已知数据，我们通过捕获器得到的接收信号中的 导频后，将其与原导频信号信号做相关运算，取得相位差后即可用其计算出频偏。 由于在一个OFDM符号中等间隔的插入了四个导频序列，最后频偏估得到的结果 应是四个结果的平均值。计算过程如下式所示：
& =：2皿9弛（如*2，）
3.3.2导频算法特点分析
在导频算法中，频率的补偿过程是通过信道矩阵来进行的。我们估计出频偏 的具体数值后，将频偏矩阵和信道矩阵结合在一起，直接利用结合后的信道矩阵 来调整频偏数值。在接收端，我们去掉循环前缀CP后可以得到下面这个公式：
ym = Hmxm + w = DmHmxm + w
其中，ym是还原信号，Hm是信道矩阵，Dm是估计出来的频偏矩阵，W是高 斯白噪声。
该算法的缺点是计算量较大，这是由于在捕获导频的阶段，每尝试一个频率 值，就要进行一次FFT计算，但目前硬件设备运行能力的发展给这一算法提供了 实际应用的可能。
3.4基于循环前缀CP的频偏估计算法
3.4.1基于CP的频偏估计算法原理
在OFDM系统中，为了实现局部周期性和克服多径信道带来的音响，引入了 循环前缀CP作为保护间隔。循环前缀是在原信号经过IFFT变换后，将信号末尾 的一段序列复制，插入到信号前端，实现传输信号部分重复。由于码元符号是周 期的，保持了子载波间的正交性，减小了载波间的干扰（ICD的影响。只要选
25

取的保护间隔大于信道的最大时延扩展，就会完全消除ISI和ICI的影响。CP在实 际传输信号中如下图3-5所示：

图3-50FDM系统中CP示意图

本节介绍了基于循环前缀的最大似然频偏估计算法，Jan-Jaap van de Beek提 出利用最大似然算法进行定时和频偏的联合估计，这种算法利用了CP和信号末 尾数据的重复信息，属于盲同步估计算法。
在该算法中，我们利用CP序列与信息符号末尾的序列完全相同这一特性， 通过这两段完全相同的序列的相关性来进行频偏估计。在实际的通信系统中，我 们是通过一个OFDM符号的循环前缀和其对应的符号结尾数据做相关运算，来计 算出信道中的频率偏移数值。如下图3-6所示，我们假设一个传输符号中包含N 个子载波和长度为L的循环前缀，其中N和L的单位都是抽样间隔。在输出端，观
察(2N+L)个单位样值，在这(2N+L)个样值中一定包含一个完整的长度为(N+L)


图3-6基于CP的频偏估计方法
假设在(2N+L)的序列中从m个采样点开始是第i个信号的数据，那么从m 到(m+N+L-l)这一集合包含了第i个传输信号的所有数据。发送符号数据时， 在信号经过IFFT变换后，还需要插入CP这一步，即将OFDM符号末尾的一串数
26
据复制到符号前段，并组成一个新的符号序列：
Scp(t) = Si(k), t = (1 ...L),fc = (N — L ...N)
在接收端接收到的数据表示为：
将接收到的循环前缀数据与OFDM抽样数据相关求和得:
Rxx = £ r*(t)r(t — N) = ae~^Aa>t+8^s*(t')ae~^Aa>^t~N^+e^s(t — N) m=l
由上式的相关值计算可得到频偏估计值:
4 = 一况5商伊
3.4.2基于CP的频偏估计算法分析
根据上一节的介绍，我们可以看出，这种基于循环前缀CP的频偏估计经典 算法需要有两个前提：第一，频偏在估计的时间范围内是保持不变的，即多普勒 频移不变；第二，无线通信系统的信道环境也是保持不变的，不存在严重的信道 衰落和多径，也不存在信号间干扰。这对实际应用来说是很苛刻的条件。
在该经典算法基础上，前人已经提出了一种改进的频偏估计算法来提高估计 性能。由于在经典的基于CP的ML算法中，是利用完整的循环前缀CP来进行 频偏估计，这样在信道中加入多径时，产生的信号间干扰ISI会使得CP与复制 数据相关性变差，进而影响到频偏估计的准确性。为了避免这一缺陷，可以只使 用CP中没有收到ISI干扰的部分进行频偏估计，即部分相关，那么这样就可以 有效的降低多径干扰带来的性能损失。实现的符号序列结构如下图3-7所示：
•相关运算
CP
未受干
扰部分
图3-7基于部分CP相关的频偏估计方法
27
在部分相关法的基础上，结合多OFDM符号估计取平均的方法，可以更加 准确的估计频偏。该方法主要是应用多次估计取平均，在相关函数的计算时，通 过几次计算取得平均值，在进行取角运算。其中相关函数Rk的均值计算可以表 示为：
]711
Rfck(k)=具〉：+ 7 (Nep + Nfft))
'i=0
上式中,Nep是CP的抽样点数, Nm是FFT长度。再通过这样计算得到的服来 计算频偏Af,得到的数值更为准确。该方法虽然有效的解决了 ISI带来的干扰, 但并不能应对随时间变化较快的多普勒频偏。所以，本文中没有釆用这种方法进 行频偏估计。
28
第四章 基于导频序列和S&C算法的改进
4.1基于导频序列进行迭代的算法
通过对第三章的经典算法的研究，我们提出了一种在传输符号插入导频的算 法基础上，加入迭代过程的算法。该算法在原有导频的频偏估计并补偿后，在进 行一次导频的频偏估计，这样完成一个迭代的过程，让频偏估计更加准确，增强 了系统在较低信噪比(Signal to Noise Ratio, SNR)的信道环境下的频偏估计准 确性，降低了从发送端到接收端传输过程中产生的误比特率。
4.1.1迭代算法系统模型和原理分析
在迭代算法中，系统的输入数据是经过QAM调制所得到的数据。该数据链 先经过串/并转换，由一行数据变换成多行数据，之后分别对每行数据进行不同 载波的调制，即IFFT调制，得到经过IFFT变换后的多载波调制信号。此时再 将所得信号经过并/串转换，再次得到单行数据链，在符号的前部插入循环前缀 (CP),进过A/D转换后进入信道传输。在接收端，接收到经过信道的信号后， 先进行D/A转换，然后去掉循环前缀CP、进行FFT变换后得到数据之后，再对 导频序列进行提取，完成频偏估计与补偿，在本文提出的迭代算法中，使用导频 进行频偏估计和补偿的这一步骤要进行两次，最后解调、解码等过程恢复原始数 据。具体传输流程如下图4-1所示：

图4-1插入导频序列的迭代算法流程图
假设第m个符号经过IFFT之前的数据为Xm(k)，第m个符号经过IFFT之

29 后的数据为Xm(")，加(")是信道响应，那么发送信号经过信道后数据为
ym(n) = exp {j{2n -Af-\n + Ng + m(N + Ng)] - T}} g(n, I) * xm(n)] + wm(n) 上述公式中，VmS)表示在第m个符号上的第n个釆样点，hjjn)表示相应 的信道响应，XmS)表示发送信号如下式所示
v /V-1	.
Xm(n)=話2 xm(k) exp (";捋),k = 0,1,2,,N
/C=O
表示多普勒现象带来的频率偏移，％表示符号结构中前段的循环前缀CP 的长度，N表示一个LTE符号的长度，WmS)则表示由加性高斯白噪声信道 (Additive White Gaussian Noise, AWGN)带来的高斯白噪声。
假设在一个OFDM符号持续的时间内，多普勒频移Af数值保持不变，那么 em(n) = exp(/(2n 'Af-\n + Ng+ m(N + %)] . T))
上式表示出了第m个OFDM符号序列经过子载波频率偏移后得到的符号序 列，也就是信号经过多普勒效应后的输出结果。那么信号在去除循环前缀CP前 就可以表示为：
L—1.
〉 hmS; 1)%-仆-1 - 0 + w(n),n = 一Ng,
紅
〉 hm(n; 0xm-i(n - 0 + w(n),n = 0,1,2,	- 1
上面式子中，L表示多径时变信道的多径数量，相邻路径之间符号接收相差
J帧，房n(m 0 = em(n) • hmS I)这里表示OFDM信号经过多径时变信道并且加 入多普勒频率偏移后，得到的接收信号。其中w(n)是AWGN信道带来的高斯白 噪声。
在接收端，我们去掉循环前缀CP后可以得到下面这个公式：
ym = Hmxm + w = DmHmxm + w
其中Dm是多普勒频偏带来的频偏矩阵，Hm是信道矩阵，分别如下：
em(0) ...	0	-
Dm =	：	••
-。-em(N ~ 1)-
和
九(0;0) ...	h(0; 1)-
: • •••
0	... h(N—l;0).
通过插入导频的经典频偏估计算法，我们可以计算出Dm，檢通过信道参数
可以求出。有了这两个矩阵，就可以通过下式来求出
30
Xjn = Hm Dm ym + W
上述过程中，通过经典的插入导频序列的方法还原出了发送信号。迭代算法 中，我们通过将此信号当作接收信号，再一次进行频偏估计与补偿，这样得 到更加准确的还原信号。
4.1.2基于插入导频的迭代算法仿真结果分析
OFDM系统中，经典的基于导频的频偏估计算法是一种在频域进行估计的 算法，也就是说这种算法是在信号去掉循环前缀CP,进行FFT变换之后才进行 频偏估计与补偿。这种算法的基础原理是在频域上插入导频序列，用来在接收端 估计频率偏移。迭代算法是在这种算法的基础之上再进行一次频偏估计与补偿, 改善了所得结果。


图4-2 OFDM信号时域模型
在上--节中，我们可以知道接收端接收到的信号是：
*(n) = exp [/(2n -Af -[n +Ng +	+ Ng)] • ?)] [hm(n) * xm(n)] + wm(n)
所以，我们可以得到
ym-M = exp ｛丿｛2n -Af-[n + Ng + (m- 1)(/V + %)] . T)] [hm^n)
* xm_i(n)] + Wm_i(n)
在此，我们暂时不考虑高斯白噪声，那么可以用第m个符号和第m-l个符 号的导频推出频偏的数值应该是：
(P = 2nA/T[n + N_g + m(N + N丿)]—2nA/T[n + N_g + (m- 1)(N + N_g )]
=2efT(N + N _g)
=arctan (I m[Y_(m - 1)A * (k) Y_m (k)])/Re[Y_(m - 1)A * (k) Y_m (k)]
31
上式中，由于发送信号中插入了导频序列，而导频序列原本在各个符号中的 相应位置处是完全相同的复数值，但是由于信道带来的频率偏移，在接收到的信 号处，这一本应该同值同相的导频序列发生了变化。我们则可以利用这一特性对 两个导频序列进行共辗相成，这样就得到了相移。
在此，我们假设频偏数值为0,那么有：
“ _ <P N
J1~2nN + Ng
为了提高对频偏估计值得准确性，我们在信号频域对每个符号都插入多个导 频，形成导频序列。这样通过多次计算取平均的方法，降低估计值与实际值的偏 移。若使用四组导频来计算频偏值，那么估算结果可以如下表示：
Af =(妨 + Af2 + Af3+ #)/4
这样可以大大降低频偏估计值和实际数值的方差，但是估计结果在仿真过程 中依旧不太理想，还有可提升空间。为此我们提出了在插入导频序列算法的前提 下，通过多次迭代来提高算法的准确性。
这里我们通过仿真平台，在信道的多径路数相同、频偏数值相同、CP长度 相同、高斯白噪声相同的情况下，对经典的利用插入导频的方法进行的频偏估计 和本文提出的迭代算法进行了比较。仿真平台中，OFDM符号的子载波一共有 512个，DFT长度是512, 一共设置了 6条多径，高斯白噪声通过信噪比来调节 强弱。每个OFDM符号长度是2000,其中中插入了 4个导频，循环前缀的长度 是8o
这里我们将迭代算法和经典的插入导频进行频偏估计的算法，在相同的仿真 平台下进行了仿真。接收信号在去掉CP后的星座图结果如下图4>3、4V所示, 在相同的SNR=40的条件下，分别在不同的归一化频偏条件下进行了仿真。图 4-3中，归一化的频率偏W = 0.1,偏移量在0.01以内。而在图4-4中归一化 的频偏0 = 0.01,偏移量也是0.01以内。对比图4-3和图4-4中采用相同算法 的仿真图可以看出，较大的多普勒频率偏移会引起更大的误码率，即星座图中点 分布较散。由于星座图内星座点之前的分区相对来说较为明确，我们可以判断, 经典导频算法和迭代算法基本都可以正常的恢复岀原始数据，只是在误比特率上 可能有所不同。
32
图a经典算法星座图
图4-3经典算法和迭代算法仿真结果星座图对比f«FO. 1, SNR=40dB
通过观察4-3中a、b两幅图可以看出，经典算法的星座点比较散，更加偏 离理想的星座点，而迭代算法的星座图点比较密集，这说明通过迭代算法恢复出 来的数据比经典算法恢复岀来的数据偏离量更小，还原的更加准确，误码率更低o 该方针平台中，信道环境是多径信道，模拟了六条路径的情况，加入了 AWGN 信道，即高斯白噪声，信噪比SNR=40dB,此信噪比条件下信号属于高信噪比条 件，实际的还原效果较好。引入了多普勒频偏，归一化后的频偏琨在0.1左右 变化，偏移量在0.01以内。图a、b分别使用经典的插入导频的方法和迭代一次 的方法进行频偏估计，估计出来的频偏值和原始频偏值进行方差计算后，再通过 频偏矩阵补偿到接收信号中。
j♦ 接收僧号
'1^*- JEf *	-
9 W W 整♦•曩獄 » 归 m n “
图a经典算法星座图图
图4-4经典算法和迭代算法仿真结果对比f™<=0. 01, SNR=40dB
上图4-4是在归一化多普勒频偏fnd在0.01左右变化，偏移量小于0.01时仿
33
真所得到的结果。对比图4-4的图a和4-3的图a可以看出，在多普勒整体频偏 数值偏小的结果下，星座图的散点更加集中，还原出的数据更加接近发送数据。 对比图4-3中的a、b我们可以看出，迭代一次的算法得到的信号还原的更加准 确。这一结果和图4-4中得到的结论相符，即使用迭代算法还原的信号更加准确。
在图4-5中，我们仿真了随着归一化频偏琨的变化（0.01-0.1）,直接插入 导频进行频偏估计与补偿的算法和迭代一次进行频偏估计与补偿的算法的误比 特率BER （图a）,和频偏估计值和实际值的方差CFO （图b）。在此之后，我们 又希望得到随着不同信噪比SNR变化，两种算法的实际频偏估计情况，于是仿 真了在SNR由弱到强变化过程中（4dB〜40dB）,两种算法的误比特率BER变化 曲线和频偏方差CFO变化曲线。这两种性能指标可以形象的表达出频偏估计算 法的实际估计性能，作为算法优劣判断的标准。

仿真中我们要把迭代算法和经典的插入频偏的频偏估计算法经行比较。上图
4-5中，我们分别从几个不同角度来判别算法的优劣性，除图中标识出来的变量
外，其他信道环境参数保持一致。仿真平台中，OFDM信号有512个子载波,
34 多径信道的多径路数是6,循环前缀CP的长度是8,插入了 4个导频序列，并 且引入了 AWGN信道高斯白噪声。其中，图4-5 a、b两幅图的横坐标是插入的 频偏环c、d两幅图的横坐标是信噪比SNR。比较的两个参数分别是误比特率 BER和频偏估计均方误差CFO_MSE。其中BER使用下面公式计算得出：
ErrorBit
BER = -_—
TotalBit
上式中，ErrorBit表示发送信号通过信道后，在接收端经过处理后得到的还 原信号和发送信号不同的比特数量0 TotalBit表示所有发送信号的比特数量o BER 用来评价信号还原的准确度，该参数数值越小说明信号还原度越强，效果越好。 与此同时，图中的CFO用下式计算得出：
*=1方。2(。- C/O2(i)]
"MS"—切丽_
其中1=10,传输了 10个OFDM信号做参考，所以有10个估计出来的频偏 量cf。，eft)表示在信道中实际插入的频偏数值。CFO_MSE即频偏估计值和实际 值频偏值的方差，用来衡量频偏估计的准确性。该参数值越小，说明频偏估计值 越准确。
图4-5a中，是在固定SNR=40dB的条件下，通过改变均的大小来比较迭代 算法和经典插入导频的频偏估计算法的BER,其中归一化的频偏4变化范围在 0.01-0.1之间。由于此时信噪比较高，循环前缀CP的长度也足够覆盖掉多径信 道带来的符号间干扰，所以此时频率偏移成为了误比特率上升的主要因素。可以 看出，随着频偏的加大，两种算法得到的误比特率曲线都有所上升，即频偏増大 会引起更高的误比特率。图4-5 a中，实线表示的是迭代算法，虚线是经典算法， 可以看出，虚线在整个曲线周期里都高于实线，也就是迭代算法的误比特率低于 经典的插入导频的算法。所以，信号经过迭代算法补偿还原后得到的序列和发送 序列匹配更加理想。图4-5 b中，是在固定SNR=40dB,频率偏移均不断变化 (0.01-0.1),最终得出的频偏估计方差CFO_MSE的仿真曲线。图中实线表示迭 代算法，曲线表示经典算法。可以看出，迭代算法的频偏估计的方差大多数情况 小于经典算法，也就是说迭代算法一般情况下，频偏估计的表现优于经典的插入 导频的算法。这也从另一方面印证了迭代算法在高信噪比条件下，性能表现是由 于经典算法的。
图4-5c是在固定均后,SNR逐渐变化得到的两种算法的仿真曲线，其中SNR 变化范围是4-40dBo实线表示迭代算法随着SNR变化的BER变化曲线，而虚 线表示的是经典的插入4个导频的算法的BER变化曲线。如图所示，我们可以 看出在SNR较低的情况下，两种算法的BER接近于0.5,即还原得出的序列和
35
发送序列基本没有什么关系，完全是随机信号。随着SNR的增加，传输符号受 到高斯白噪声的影响越来越小，我们可以看出信号的BER在逐渐变小，也就是 说还原得到的接收信号越来越准确，最终在SNR=40dB的时候达到最小值在3.4% 左右。观察两条曲线，可以看出在SNR较低的时候（SNR在4~20dB区间），两 种算法的区分度并不大，分析其原因，可能因为此时高斯白噪声的干扰起到了主 要作用，低信噪比使得频偏估计得出的结果并不重要。与此相反，在SNR较高 的情况下（SNR在25-WdB区间），这时候由于信噪比较高，AWGN信道带来 的高斯白噪声已经不能起到主要作用，频率偏移在信号还原过程中成为了第一阻 碍因素。此时可以明显看出，频偏估计更加准确的迭代算法比经典的插入导频的 算法可以得到更加精准的数据。即在SNR足够高的情况下，迭代的算法比经典 的插入导频的频偏估计算法表现更加岀色。图4-5d中，是在固定均条件下，SNR 有4dB逐渐增加到40dB的CFO_MSE仿真结果。该曲线表示出两种算法在不同 的SNR条件下，频偏估计准确性的表现。其中实现表示迭代算法，虚线表示经 典算法。如图所示，在SNR较小的情况下，此时由于高斯白噪声引起的干扰是 主要影响因素，两种算法基本上无法正确估计出频偏值，此时频偏估计方差接近 于无穷大。然而随着SNR的增大，我们可以看出两种算法的频偏估计方差都有 了不同程度的下降。其中，迭代算法下降曲线的斜率更大速度更快，而虚线代表 的经典算法明显慢于迭代算法。可以看出，伴随着SNR的增大，迭代算法的性 能表现更好。
通过以上仿真分析，我们可以看出：无论是用信号还原的准确度来衡量算法 的优劣，还是用频偏估计的准确度来衡量算法的优劣，迭代算法的性能指标和表 现都优于经典的插入导频的算法。在此由于时间原因，尚未对迭代两次以上的方 法进行公式推导和仿真分析。
4.2时域上一种基于S&C算法的改进算法
4.2.1 S&C算法原理及其帧结构
S&C算法的系统流程图如下图4-6所示：
36


图4-6经典S&C算法流程图
图4-6中Ci是S&C算法中需要插入的训练序列，它是由一组随机的PN序列 通过QAM来产生的，其中Ci=O,当i=—5,-3,-1,0,1,3,5…;Un为训练符号，是将 训练序列通过IFFT变换后得到的，是OFDM信号从时域搬移到频域上之后得到 的传输信号；H(t)为不随时间变化的多径信道冲击相应；s(t)经过信道后得到的理 想的训练符号；Af是高速移动信道环境引入的载波频偏；N(t)是AWGN信道带来 的加性高斯白噪声；R(t)是接收机接收到的信号，该信号是经过了无线信道引入 的频偏、时延、高斯白噪声后得到的训练序列符号；Ts = T/N,其中T为有效符 号周期，N为IFFFT长度。s(k),x(k),n(k),r(k)分别为s(t),x(t),n(t),r(t)釆样后的符号序 列。则有：
r(k) = s(fc) exp 件籍竽)+ n(k).
上式可以用于估计高速移动信道环境带来的多普勒频偏Afo我们设L=N/2, 在S&C算法中，我们通过在一组长度为N的PN序列中，间隔插入0,这样总长 度就变成2N,之后再进行IFFT变换，我们可以得到长度为N的两个序列符号。 根据IFFT特性，这两个符号由于进行变换前进行了差零，所以前半段长度为L 的序列和后半段长度为L的序列完全相同，这样就可以通过相关运算来进行频偏 估计。下图4-7表示训练序列符号插入循环前缀后的帧结构：

图4-7经典S&C算法的帧结构

4.2.2 S&C算法的频偏计算
在上一节中，我们讨论了 S&C频偏估计算法训练序列的帧结构。根据IFFT 的特性，我们知道训练序列符号在时域上前半部分和后半部分完全相同。这个训 练序列符号可以用来估计载波间的频率偏移，根据其特性，我们可以知道，若不 引入频偏，那么前后半个符号序列进行相关运算得到的结果应该是一个实数。若 有频偏的引入，那么两个序列的相关结果中就会存在相位，这时我们可以用该相 位来计算频偏数值。在此，我们假设符号已经通过循环前缀去掉多径干扰，则相 关运算可以用下式来表示：
L-1
P(d) = £ r*(d + m)r(d + m + L) = \P(d)\ej2<p
m=0
在高速移动的信道环境下OFDM信号的训练序列由于多普勒效应，它的前后 半段会产生明显的频率偏移，这个频率偏移可以用角度。=武贤来表示。该算 法中，由于训练序列具有特殊的帧结构，可以估计出这个角度。即
angle{P(d)) = angle(]p(d)\e|2<l,) = <p
我们是通过该训练序列前半段和后半段进行相关运算，之后通过计算 的角度来计算出叩。然后，将所得到的角度和后面的数据符号进行共辘相乘，这 样就抵消掉了多普勒效应带来的频偏影响。
具体计算中，我们假设整数倍频偏估计已经完成,只剩下残留的小数倍频偏,
38
即|甲|小于兀，那么估计出来的频偏就是街=景。否则，频偏可能是孑=专+苧, 其中是一个整数。
4.2.3改进算法原理
在移动信道环境下，OFDM系统会受到多种干扰，由于OFDM系统具有循 环前缀CP的保护措施，一般很难受到ISI干扰。但是在某些情况下，多径路数 较多导致CP长度不能将所有路径干扰完全屏蔽掉的时候，就会产生符号间干扰, 如下图所示：

图4-8符号间产生ISI干扰示意图
在这种条件下，经典的S&C算法所做的频偏估计会有较大偏差。为了改善 在这种条件下频偏估计的准确性，本文提出了一种将S&C训练符号改进的方法， 改变训练序列的帧结构。通过切掉两边冗余部分，使得训练序列更加精简，可以 有效的避免多径带来的信号间干扰。这种部分相关算法的信号帧结构如下图4-9。 该方法将训练序列作相关运算的序列长度减小，只用L/4长度的符号进行相关运 算。由于用作相关运算的序列长度变短了，在正常信道中这将使得信号频偏估计 的准确度降低，带来较差的BER.但是在受到ISI干扰时，该方法由于没有使用 两侧受到干扰的序列，所以在频偏估计上不会受到太大影响。
39


训练符号
图4-9改进的S&C算法训练序列的帧结构
这样的拓展算法帧结构只能应用于特定的信道环境，如果系统没有收到ISI 干扰的情况下，就会牺牲一些频偏估计的准确度，该算法的应用场景主要是CP 不能有效阻止ISI的时候。
4.2.4改进算法仿真结果分析
本文中，对于S&C算法和改进算法的仿真流程由下图4-10给出:

图4-10对S&C算法和改进算法对比仿真流程图
如图4-10所示，发送端发送的bit数据流经过QPSK调制、快速傅立叶反变 换后到时域上，此时再插入循环前缀CP和训练序列，然后进入时变多径高斯白 噪声信道。接收端，将接收信号去掉CP后，分别使用两种不同的算法对去掉 CP的接收信号进行频偏估计与补偿，此时将两种算法频偏估计得到的频偏值进
40
行存储，并且和信道中插入的频偏值进行比较，计算CFO—MSE。补偿后的信号 数据分别存储在两个不同的数组里。将两组数据分别进行快速傅立叶变换到频域, 解调后得到还原后的bit数据。此时，用还原后的bit数据和发送端的bit数据流 进行比较，计算误比特率BERo
该仿真中，使用的OFDM符号长度是1024bit,多径信道的多经路数是6, 每条路径的多径衰落分别是0、-6、-10、-14、-20、-26dB,多径延迟分别是0、 1、2、3、4、5,其中循环前缀CP的长度是可变量，范围是0:1:6,信噪比SNR 也是变量,其变化范围是0:5:80dBo该方针平台分别从两个方向来模拟信道环境， 分别是CP的长度和SNR的大小。其中CP的长度用来模拟信道中信号间干扰ISI, SNR用来模拟在相同ISI干扰条件下两种算法在不同信噪比条件下的性能表现。
同样的，两种算法的性能表现也使用两个重要参数来衡量，其一是信号经过 还原后得到的bit数据的误比特率BERo其二是在频偏估计与补偿阶段，得到的 频偏数值和信道中插入的频偏数值计算而出的频偏估计值方差CFO_MSE。其计 算方法已经在上述文字中给出。


图4-11不同cp长度下的BER
图4-11的仿真曲线的仿真环境是SNR=60dB,多径路数为6,循环前缀CP 长度在。到32之间变化，频偏4=0.01〜0.1之间随机变化。仿真思路是通过改变 CP的长度来引入符号间干扰ISI, CP长度越短信号间干扰越强。两条曲线是在 不同的CP长度下，计算得到的误比特率BER绘制而成，实线和虚线分别表示 经典S&C算法和改进算法得到的结果。如图所示，经典的S&C算法的BER随 着CP长度的增加而减小，最后在CP长度达到25左右时曲线趋于平滑，因此我 们可以看出，经典的S&C算法对于CP长度比较敏感，较长的循环前缀可以带 来更好的性能，最佳的CP长度是25。与之相反，改进算法对于CP长度并不敏 感，其仿真曲线在一定程度上趋于平稳,BER在ICT*附近变化，并无太大波动。 两曲线在CP=14的位置相交，这说明在CP长度小于14的时候，改进算法还原
41 得出的信号更加准确，CP大于14的时候经典的S&C算法能够得到更加准确的 还原信号。

图4-12与图4-11是在相同信道环境下进行的仿真。该图是从CFO_MSE角 度进行的分析，如图5-7所示，我们可以看出，在不同的CP长度条件下，经典 的S&C算法频偏估计的方差随着CP长度的增加而减小，改进算法却不如经典 算法那么敏感。分析其原因，是因为改进算法舍弃了训练序列的前四分之一和后 四分之一序列，这样就算在CP长度过短，引入符号间干扰的前提下，也不会对 频偏的估计产生太大影响。这在仿真曲线中表现出来，是对CP变化的不敏感性。
下图4-13和4-14是在CP=20,多经路数为6的条件下，SNR从0~50dB变 化的BER仿真曲线，其中实线表示S&C算法，虚线表示改进算法。可以看出， 在.SNR小于30dB时，误比特率接近50%,即还原信号基本等同于随机信号， 和发送信号相关度趋近于零。在SNR达到50dB的时候，经典S&C算法误比特 率低于0.01%,而改进算法误比特率在0.1%左右，明显高于经典算法。观察整 体曲线走势，可以看出随着SNR的增加，两种算法的误比特率都是下降趋势， 但是明显经典的S&C算法下降幅度更大。这说明在没有符号间干扰ISI的前提 下，只要SNR相同，改进算法性能就弱于经典的S&C算法。
42



图4-13 BER在不同SNR条件下的变化曲线
下图4-14与上图4-13仿真条件相同，两条曲线描述的是CFO MSE的走势， 可以看出，在SNR为0~80dB的条件下，改进算法的频偏估计准确度都弱于经 典S&C算法。这也印证了上述结论。

图4-14CF0_MSE在不同SNR条件下的变化曲线

除上述曲线外，我们还可以釆用信号星座图的方式来更加直观的展现算法在 还原信号方面的性能。下图4-15是接收信号去掉CP后进行DQPSK之前的仿真 结果：
43

图4-15在不同ISI干扰条件下经典S&C算法和改进算法的星座图
观察上图4-15 a、b,我们可以看出，星座图a的分离度更佳，接收信号点 紧密围绕着星座点周围，距离判决边界有一定距离，在判决过程中发生错误的概 率较低。与之相反，星座图b效果较差，可以看出在没有ISI干扰的条件下，改 进算法的还原信号距离星座点较远，有些点可能已经越过了判决边界，使得判决 结果出现错误。由此可以看出，在CP长度大于多径信道径数，即没有信号间干 扰(Inter-Symbol Interference, ISI)的前提下，经典的S&C算法在信号还原的过 程中，性能表现相比于本文中改进的算法要优秀许多。也就是说，本文改进的算 法不适用于没有ISI干扰的信道环境。然而，在图4-15 c、d中我们可以看出， 图c的星座图中信号点的分布更加不规则，图d的星座点反而要强于图c。不难 看出，虽然引入了较强的ISI干扰,但是图b和图d中星座点受到的影响并不大， 而图a和图c中星座点有了较强的变化。这是由于本文中提出的基于S&C算法
44
的改进频偏估计算法更加适用于具有较强ISI干扰条件的信道环境。这与上文中 推断出的结论相符合。
综上所述，通过对经典S&C算法和改进算法的仿真，我们可以看出改进的 算法更加适用于有符号间干扰ISI的信道环境。
45
第五章总结与展望
下一代移动无线通信系统是为了实现移动端的高质量数据传输服务。为了实 现这一目标目前尚存诸多技术难题。OFDM系统应用于ETE通信系统正是解决 这些难题的关键技术。然而OFDM系统对于频率的敏感性限制了其在实际信道 环境中的性能。所以，精准高效的频偏估计算法对于整个OFDM系统的顺利应 用起着至关重要的作用。本文中总结了一些经典的频偏估计算法，包括Moose 提出的频域连续发送两个导频符号的方法，Schmidl提出的频域插入PN序列的 2个前导符号的方法来估计载波频偏，S&C算法等等。这些现存的经典算法都有 各自的优缺点，特别在高速移动环境下，难以寻找出一种满足实际应用需要的方 法。本文中，围绕经典的OFDM频偏估计算法进行了深入研究，提出了三种改 进算法，并对其中两种进行了仿真分析、结果对比。这两种改进算法在特定的信 道环境下均优于经典算法。
由于时间和篇幅限制，本文并未对所有提到的算法进行仿真分析，即使进行 仿真分析后得到的研究成果在某种程度上来说也有待深入展开。综上所述，在高 速移动环境下实现对OFDM系统的频偏估计仍是一个亟待解决的难题，针对多 普勒效应引来的频偏的估计与补偿也将是未来研究的重要方向之一。
46
参考文献
[1]Stefania Sesia, Issam Toufik, Matthew Baker, LTE―The UMTS Long Term Evolution: from theory to practive(2nd ed), 2011. 89-111.
[2]B. Le Floch, R. Halbert-Lassalle, and D. Castelain, “Digital sound broadcasting to mobile receivers,59 IEEE Trans. Consumer Electron., vol. 35, pp. 493-503, Aug. 1989.
[3]Timothy M. Schmidl and Donald C. Cox, Fellow, Robust Frequency and Timing Synchronization for OFDM, IEEE VOL. 45, NO J 2, DECEMBER 1997.
[4]P.H. Moose. "A technique for orlhogonal frequency division multiplexing frequency offset correction," IEEE Trans. Commun. Vol. 42. No. IO, Oct. 1994. Pp. 2908-2914.
[5]Yi Sun and Yen, R.Y" An efficient iterative algorithm for joint frequency synchronization and channel estimation in OFDM systems," Microwave, Antenna, Propagation and EMC Technologies for Wireless Communications, 2009 3rd IEEE International Symposium on.
[6]Anastasios Stamoulis, Suhas N.Diggavi, and Naofal Al-Dhahir, Intercarrier Interference in MIMO OFDM, IEEE Transacions on signal processing, vol. 50, no. 10, October 2002, Pp. 2451-2464.
[7]Linglong Dai, Zhaocheng Wang, Time-Frequency Training OFDM with High Spectral Efficiency and Reliable Performance in High Speed Evironments, IEEE journal on selected areas in communications, vol. 30, NO. 4, May 2012.
[8]Shengping Qin, Peide Liu, Xin Zhang, Laibo Zheng, Deqiang Wang, Channel estimation with timing offset based on PSDXS estimation for wireless OFDM system, Intelligent Signal Processing and Communication Systems, 2007. ISPACS 2007. International Symposium on, Nov.20 2007-Dec, 1 2007, Pp. 248-251.
[9]Belrose John S, PhD Castab, Characterist ics of the Crossed Field Antenna Obtained By Numerical and Experimental Modeling, IEEE Antennas and Propagation Society International Symposium:2005.
[10]Yduping Zhao, Analysis of the impact of Doppler spread on OFDM-based next-generation high-speed rail broad-band mobile communications, Communication Technology and Application (ICCTA 2011), IET International Conference on, 14-16 Oct. 2011, pp.116 C 120.
47
[11]Wen-Long Chin. ML Estimation of Timing and Frequency Offsets Using Distinctive Correlation Characteristics of OFDM Signals Over Dispersive Fading Channels. IEEE Trans. VOL. 60. NO. 2 FEBRUARY 2011.
[12]Wen-Long Chin and Sau-Gee Chen. A Blind Synchronizer for OFDM Systems Based on SINR Maximization in Multipath Fading Channels. IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY； VOL. 58 NO.2. FEBRUARY 2009.
[13]Ch. Nanda Kishore and V Umapathi Reddy A Frame Synchronization and Frequency Offset Estimaion Algorithm for OFDM System and its Analysis. EURASIP Journal on Wireless Communications and Networking. Volume 2006, Article ID 57018, Pages 1-16.
[14]Peng Liu, Bing-bing Li, Zhao-yang Lu, Feng-kui Gong. A New Frequency Synchronization Scheme for OFDM. A New Frequency Synchronization Scheme for OFDM
[15]Qi Jiang, Joacliim Speidel and Chunming Zhao. A Novel Carrier Frequency Offset Estimaion for OFDM Systems Over Time-Varying Multipath Channels. Wireless Pers Comniun (2009) 49:587-596.
[16]Mingqi Li and Wenjun Zhang. A Nove Method of Carrier Frequency Offset Estimaion for OFDM Systems. IEEE TRANS. VOL. 59. NO.2. 2012
[17]Guo Yi, Liu Gang and Ge Jianhua. A Novel Time and Frequency Synchronization Scheme for OFDM Systems. IEEE TRANS. VOL.2. NO.5. JULY 2008.
[18]Yonghong Zeng, A. Rahim Leyman. A pilot-based fast algorithm for joint estimation of frequency offset and channel in OFDM. Signal Processing 86 (2006) 3076-3084.
[19]Hlaing Minn, Vijay K. Bhargava and Khaled Ben Letaief ARobust Timing and Frequency Synchronization for OFDM Systems. IEEE TRANS. VOL. 2. NO.4. JULY 2003.
[20]S.M. Sameer and Ratnam V Raja Kumar. An efficient technique for the integer frequency offset estimation in OFDM systems. Signal Processing 89 (2009) 252-256.
[21]Lin Bai and Qinye Yin. An Iterative Method for Carrier Frequency Offset Estimation in OFDM Systems via Scattered Pilots. Ministry of Education Key Lab for Intelligent Networks and Network Security.
[22]A.A1-Dweik, R. Hamila and M. Renfbrs. Blind Estimation of Large Carrier
48
Frequency Offset in Wireless OFDM Systems. IEEE TRANS. VOL.56, NO.2, MARCH 2007.
[23]Timo Roman, Samuli Vsuri and Visa Koivunen. Blind Frequency Synchronization in OFDM via Diagonality Criterion. IEEE TRANS. VOL. 54, NO.8, AUGUST 2006.
[24]Jie Zhu and Wookwon Lee. Carrier Frequency Offset Estimaion for OFDM Systems with Null Subcarriers. University of Arkansas, Fayetteville, AR 72701, USA.
[25]BO Al, JIAN-HUA GE, DIAN-FU ZHANG JUN LIU, YONG WANG and ZHEN LU. Carrier Frequency Recovery Technique in OFDM Systems. Wireless Personal Communications (2005) 32:177-188.
[26]Wei Zhang, Xiang-Gen Xia and P. C. Ching. Clustered Pilot Tones for Carrier Frequency Ofifeet Estimation in OFDM Systems. IEEE TRANS. VOL. 6, NO.l, JANUARY 2007.
[27]Yuh-Ren Tsai, Xiu-Sheng Li and Chih- YU Wei. Data-carrier Aided Carrier Frequency Offset Estimation for OFDM System. Institute of Communications Engineering, National Tsing Hua University.
[28]Kui Xu and Yiiehong Shen. Effects of Carrier Frequency Offset, Timing Offset, and Channel Speread Factor on the Performance of Hexagonal Multi carrier Modulation Systems. EURASIP Journal on Wireless Communications and Networking. Vblume 2009, Article ID 802425, 8 pages. Doi: 10.115/2009/802425.
[29]Richard van Nee and Ramjee Prasad. OFDM Wireless Multimedia Communications. Artech House, 2000.
[30]H. Minn, M. Zeng and V K. Bhargava. On timing offset estimation for OFDM systems. IEEE Communications Letters. No.7, pp. 242-244, July 2000.
[31]G. Levin and D. Wulich. Frequency offset estimation in OFDM using sample covariance. MILCOM 1998, No. 1, pp. 688-692, Oct 1998.
[32]POLLET T, VAN BLADER M, MOENECLAEY M. BER sensitivity of OFDM systems to carrier frequency ofifcet and Wiener phase noise. IEEE Trans Commun, 1995,43(2/3/4):191-193.
[33]Adrian Langowski. Time and Frequency Synchronisation in LTE OFDM Systems. EURASIP Journal on Wireless Communications and Networking. Vblume 2009, Article ID 641292, 9 pages.
49
[34]Fernando D. Nunes and Jose M, N. Leitao. STATE-SPACE ESTIMATION OF RAPIDLY-VARYING CARRIER FREQUENCY OFFSETS IN OFDM SYSTEMS, 2003 4th IEEE Workshop on Signal Provessing.
[35]Tilde Fusco, Ferdinando Marrone and Mario Tanda. Semiblind techniques for carrier frequency offset estimation in OFDM systems. Signal Processing 88 (2008) 704-718,
[36]Adegbenga B. Awoseyila, Christos Kasparis and Barry G. Evans. Robust Time-domain Timing and Frequency Synchronization for OFDM Systems. A.B. Awoseyila et al.
[37]Tilde Fusco, Angelo Petrella and Mario Tanda. Non-data-aided carrier-frequency offset estimation for pulse-shaping OFDM/OQAM systems. Signal Processing 88 (2008) 1958-1970.
[38]Taewon Hwang, Chenyang Yang, Gang Wu, Shaoqian Li and Geoffrey Ye Li. OFDM and Its Wireless Applications: A Survey. IEEE TRANS, VOL. 58, NO.4, MAY 2009.
[39]Jan-Jaap van de Beek, Magnus Sandell and Per Ola Boijesson. ML Estimation of Time and Frequency Offset in OFDM Systems. IEEE TRANS. VOL. 45, NO.7, JULY 1997.
[40]Zhongshan Zhang, Keping Long, Ming Zhao, and Yuanan Liu. Joint Frame Synchronization and Frequency Offset Estimation in OFDM Systems. IEEE TRANS. VOL. 51, NO. 3, SEPTEMBER 2005.
[41 ]D. Landstrom, S.K/ Wilson, J.J.Van de Beek, P/Odling and P.O.Boijesson. Symbol time offset estimation in coheren OFDM systems. In Proc, Int. Con£ On Communications. Vbl. 1, Vancouver, BC, Canada, June 1999, pp. 500-505.
[42]J.Chen, Y.C. Wu, S.Ma. ML joint CFO and channel estimation on OFDM systems with timing ambiguity[J]. IEEE Transactions on Wireless Communication, 2008, V61.7, No.7, pp:2436-2440.
[43]X. Feng, F. Shu. A low-complexity carrier frequency offset estimation fbr OFDM systems with virtual subcarriers. In Proc. IEEE ICC, May 2008, pp. 16-19.
[44]Minn H. M, Letaief K.B. A Robust Timing and Frequency Synchronization for OFDM Systems. IEEE Transactions on Communications, 2003, (04:) 822-839.
[45]Hyong-Goo Jeon, Kyoung-Soo Kim, Erichin Serpedin. An efficient Blind Deterministic frequency Offset Estimation fbr OFDM Systems. IEEE Transactions on Communications, 2011, Vbl.59, No.4, pp: 1133-114L
50
参考辨
[46]Rinne J, Refers M・ Pilot spacing in orthogonal frequency divisiton multiplexing systems on practical channels. IEEE Trans. 1996.40(4):959-962.
[47]H.Ydmo and E.de Carvalho. A CSI estimation method for wireless relay network. IEEE Communications Letters. 2007. 11(6):480-482.
[48]G.J.Foschini& MJ.Cans. On Limits of Wireless Communication in a Fading Environment when Using Multiple Antennas. Wireless Personal Communications. 1998.6:311-334.
51
