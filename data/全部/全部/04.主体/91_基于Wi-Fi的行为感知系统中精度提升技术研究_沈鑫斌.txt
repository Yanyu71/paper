第一章绪论
本章针对行为感知系统领域，介绍了商用Wi-Fi设备在行为感知中的应用、 商用Wi-Fi设备存在的局限性，并从国内外已有研究出发，分析了基于Wi-Fi的 行为感知系统中精度提升技术的必要性及现实意义，该技术的研究也是本文的核 心。
1.1研究背景与意义
1.1.1行为感知系统介绍
随着科学技术的飞速发展，人们不再满足于机器与机器之间的交互，转而将 目光聚焦到机器与环境中活动目标的自然交互中。在过去的几十年里，人们一直 在创造和尝试新的技术，以期更准确和高效地感知和分析环境中的目标行为。当 前，目标行为感知系统表现出了前所未有的巨大潜力，其涉及的领域涵盖了国防 安全山、智能家居［2】、体感游戏〔3】、老年人健康监控⑷、宠物行为监测⑸、运动分 析〔6〕、身份认证⑺、群体感知冈等。在这个充满了 “智能化”的社会，由机器代替 人工实现智能的感知与决策，将为人类带来极大的便利。由此可见，目标行为感 知技术在人机交互迅猛发展的当下就显得尤为重要。
目前，常见的行为感知系统主要包括以下几种感知方式：
(1) 基于计算机视觉技术。通过一组或者多组摄像头采集环境中的图像信息 或者视频信息，通过模式识别对环境中目标的活动序列进行提取，识别目标的动 态变化特征，如人体姿态、目标数量、活动和手势等［刃［⑼。计算机视觉技术使用 广泛、准确率高，且当下存在许多成熟的模型⑴］U2］［13］［14］。但是计算机视觉受光 线影响大，且无法穿过障碍物获取目标信息。
(2) 基于红外线技术。利用红外线可以在昏暗的室内环境下对目标进行感知 【EM］,已经被广泛利用到现实生活的各个领域中。但一方面，红外线的感知范围 有限，容易受到距离因素的制约，另一方面，需要大规模部署附加设备，不利于 日常生活中的大规模应用。因此，使用红外线技术用于感知存在着局限性。
(3) 基于毫米波技术。毫米波或者微波雷达可以穿过障碍物获取目标的状态， 如麻省理工学院的Dina Katabi教授团队所研发的设备，使用专用的雷达实现了 穿墙估计人体姿态［⑺［同。但考虑到该技术需要价格昂贵的专用设备，且设备体积 庞大，同样不适用于家庭环境或者工作环境的大规模部署。
(4) 基于专用传感器技术。将专用的传感器设备，如陀螺仪、加速器等安装 在活动目标的身上，采集活动目标的相关动作信息，从而实现目标的行为感知 [|91[20]=专用传感器设备在细粒度的目标行为感知中表现出色，但是不便于目标长 期携带，因此不利于日常生活中的长期使用。
1.1.2 Wi-Fi在行为感知中的应用
近年来，随着网络技术的高速发展，人们对于无线通信技术的依赖程度不断 增大，无线局域网(WLAN)也因此逐渐发展、日趋成熟。笔记本电脑、平板电 脑、智能手机和智能家居等的不断普及，更促进了 WLAN的发展，使得WLAN 无处不在。WLAN不仅可以作为通信的媒介，还可以提供无线信号用以感知周 围环境的变化。
利用普通Wi-Fi设备获取Wi-Fi多径叠加信号的信道状态信息(Channel State Information, CSI),捕捉和处理Wi-Fi信号经由环境中人或物体的活动引起的信 号多径变化，建立无线信号与目标状态(包括人或物体的姿态、活动、位置等) 的映射关系，能够有效地感知环境中人或物体的状态变化。这种基于Wi-Fi的行 为感知技术吸引了国内外专家和学者们的广泛关注Rig】，在目标活动识别
[23] [24][25][26][27][28]、目标追踪[30][31][32]、生理指标检测[33][34][35]、人体检测昭等应用 领域成为一项极具发展潜力的技术。
基于Wi-Fi的行为感知应用的繁荣发展，得益于Wi-Fi设备与Wi-Fi信号的 固有属性，包括Wi-Fi设备低成本、Wi-Fi设备使用广泛和Wi-Fi信号非视距感 知：
(1) Wi-Fi设备低成本：基于Wi-Fi的行为感知是利用环境中目标所反射的 Wi-Fi信号实现行为感知和行为分析的，因此，仅需利用现有的Wi-Fi设备和商 用的无线网卡，无需使用额外的附加设备，就可以提供低花费且可长期使用的行 为感知。
(2) Wi-Fi设备使用广泛：当下，为了满足人们的日常生活、学习、工作和娱 乐的需要，智能手机、笔记本电脑、平板电脑和智能家居等无线智能终端大量涌 现。住宅、学校以及商店等场所都部署了各类Wi-Fi设备，无线网络逐渐变得无 处不在。无线网络的广泛部署及应用，使得基于Wi-Fi的人机交互有了更好的发 展前景。
(3) Wi-Fi信号非视距感知：由于商用Wi-Fi设备是工作于Wi-Fi频段(2.4GHz 和5GHz),对于例如墙体等障碍物，Wi-Fi信号具有较好的穿透效果。因此在非 视距感知的场景中，基于Wi-Fi的行为感知技术更为适用，有更好的应用前景。
1.1.3商用Wi-Fi设备在行为感知中的局限性
虽然基于Wi-Fi的目标行为感知技术在很多应用领域都受到广泛关注，并显 示出非凡的发展前景，但是Wi-Fi协议本身是为无线通信所设计的，并没有针对 目标行为感知进行相应的优化，因此基于Wi-Fi的目标行为感知仍然受到以下因 素的制约：
(1) 信号带宽不足。Wi-Fi信号的多径到达时间分辨率由Wi-Fi信号带宽决 定。目前的商用Wi-Fi网卡提供的单个信道带宽为20MHz或者40MHz,其提供 的分辨率不足以区分细微的目标行为变化。因此，如何在商用设备基础上提高 Wi-Fi信号的多径分辨率，使其足以精确估计目标状态，是基于Wi-Fi的目标行 为感知技术需要解决的基本问题。
(2) 受限于多径效应。Wi-Fi信号从发射端到接收端经过多个路径传播，极易 受到空间环境的影响。基于Wi-Fi的目标行为感知的应用场景主要集中在室内， 但室内环境复杂多变，导致无线信号传播的多径效应异常明显，造成采集到的无 线信号信息受到严重影响，从而降低目标行为感知的精度。
(3) 子载波数目有限。目前商用Wi-Fi设备在通信时只能获取单个信道中30 个子载波的CSI,倘若不加筛选地指定单一收发链路的30个子载波，用以刻画 Wi-Fi信号在复杂空间中的多径传播能力，将极大程度地限制Wi-Fi行为感知技 术的感知精度。
1.2基于Wi-Fi的行为感知研究现状
目前基于Wi-Fi的行为感知技术已经有了相关研究。Wikey是一款基于WiFi 的按键识别系统，准确率为93.5%［2习。WiFall可以实现高精度的跌倒检测回】。 WiFinger通过检测细粒度的CSI中所显示的独特模式来感知和识别手指手势的 细微动作【26】。文献［30］将多普勒频移与运动方向联系起来，提出了一种不需要训 练就能检测、分割和识别运动的模型。文献［31］能够在分米级别同时估计一个人 的移动速度(速度和方向)和位置。IndoTrack通过时空多普勒和到达角(Angle- o&Arrival, AoA)信息估计目标速度和位置，从而判断目标的轨迹阳。MobileRF 提出了一种利用CSI相位差数据对多人进行呼吸速率估计的系统〔时。但上述研 究均基于一个信道的CSI数据，感知精度有限。
1.2.1提升基于Wi-Fi的行为感知分辨率
在提升基于Wi-Fi的行为感知系统的分辨率方面，目前的解决方案如下：文 献［37］提出构建一组从商用Wi-Fi设备延伸出来的缝合天线,提供了嵌入在Linux 内核中的易于使用的接口。该系统能够在拥有三个固定天线Wi-Fi AP上增加超
3
过30%的数据吞吐量，从而提高识别精度。文献［38］探索和利用描述多径效应严 重程度的新特征，提出了一种基于非视距识别的非线性回归传播模型，提高发射 端与接收端之间距离估计的精度。文献［39］探索了利用MIMO发射机和接收机中 的空间分集和频率分集来实现去相关的一种MIMO平滑新技术。作者通过对Wi- Fi链路的大量实验，验证了 MIMO平滑技术提高多径分辨率的可行性。由以上 分析可知，当前Wi-Fi感知领域中提高多径分辨率的主要方式是引入附加系统, 设备成本较高。
文献［40］使用多信道CFR拼接，利用信道稀疏性实现高分辨率CIR估计， 提升定位精度。ToneTrack是一种室内定位系统，利用最小的硬件和天线，通过 利用频率敏捷的无线网络来增加有效带宽，实现亚米精度⑷〕。以上研究都是利用 Wi-Fi多信道的拼接，提升Wi-Fi设备的定位精度。但若要将多信道扩展技术应 用于Wi-Fi行为感知领域，仍有待进一步研究。
1.2.2多Wi-Fi设备协同感知的场景研究
与此同时，对于多Wi-Fi设备协同感知的场景，目前相关研究较少。基于WiFi 的行为感知系统可以大致划分为基于模型的系统〔27］【28］［29］和基于学习的系统 ［23］［24］［25］。其中，基于模型的系统量化了目标行为变化引起的反射路径长度变化 与CSI序列的相关性，但由于环境目标行为的复杂性，这些模型适用于简单的 Wi-Fi行为感知场景。对于大量Wi-Fi设备协同感知的场景，Wi-Fi链路纵横交 错，各个链路同时包含了大量有用信息与冗余信息，无法简单建立起目标行为变 化与CSI变化的映射关系模型。基于学习的系统将无线信号利用特征提取技术 提取行为特征，随后利用监督学习和非监督学习等机器学习模型实现对特征的识 别，从而完成对目标行为的感知。但在复杂的环境下，如果依然致力于保持较高 的精确度，往往需要建立复杂的网络模型。因此在大量Wi-Fi设备协同感知的场 景，基于Wi-Fi的行为感知系统还需要设计更合理的机制来保障系统的精度。
因此，本文从上述两个方面入手，分别实现聚合额外带宽和多设备协同感知， 全面提升基于Wi-Fi的行为感知系统的精度。
1.3论文主要研究内容
本文主要针对商用Wi-Fi设备在行为感知中的局限性，分析了基于Wi-Fi的 行为感知系统中精度提升技术的必要性及现实意义：
在利用Wi-Fi信号分辨环境中复杂多变的目标行为变化时，一方面，行为感 知精度受限于Wi-Fi信号的多径分辨率，即Wi-Fi多径信号到达时间的区分度越 高，目标行为的微小变化越容易被辨别；另一方面，在Wi-Fi收发链路中，多个 子载波上的CSI具有刻画信号多径传播的能力，但由于单个链路的子载波数量 有限，要有效提升Wi-Fi行为感知技术的精度，就要求所选取的链路具备出色的 感知效果。现有Wi-Fi感知技术，都依赖于一个发送设备和若干个接收设备所建 立的通信链路来获取CSI,感知环境中的目标行为。但首先，该场景收发设备所 提供的信号带宽有限，链路涵盖范围同样有限；其次，该场景较为单一，在现实 世界Wi-Fi设备大规模部署的情况下并不适用；此外，活动目标在不同区域产生 的行为，受其物理空间的影响，可能在不同链路出现不同形式的感知效果。综上 所述，研究Wi-Fi信号分辨率和最佳感知链路对行为感知精度的影响机理，可以 为提升Wi-Fi信号分辨率的方法和寻找最佳感知链路的方法提供理论支撑，进一 步为构建高精度的行为感知模型奠定基础。
基于此，本文主要从基于Wi-Fi的行为感知分辨率提升机制和多Wi-Fi协作 下最佳感知链路选择机制两个方面展开。本文具体研究内容如下：
1.3.1基于Wi-Fi的行为感知分辨率提升机制
基于Wi-Fi信号的行为感知技术本质上是利用多径信号到达时间的差异，来 分辨目标行为变化的差异。要实现精确的目标行为感知，首先要提高Wi-Fi信号 的多径分辨率。CSI计算所得的多径到达时间分辨率由Wi-Fi信号带宽决定，所 以该时间分辨率下对应的Wi-Fi多径长度的差值受信号带宽的影响，从而得出活 动目标状态变化的分辨率也同样受到信号带宽影响。然而目前的商用Wi-Fi网卡 提供的单个信道带宽为20MHz或者40MHz,分辨率不足以区分细微的目标状态 变化。因此，本选题针对行为感知技术Wi-Fi信号多径分辨率不足的问题，研究 多信道快速切换及聚合机制，通过聚合的方式提高信号带宽，达到提升分辨率的 目的。具体研究内容如下：
本文提出了一种用于Wi-Fi行为感知技术的感知分辨率提升机制：提出多信 道快速切换及聚合算法，通过多Wi-Fi信道快速切换机制在极短的时间间隔内从 多个相邻Wi-Fi信道中采集CSI数据，同时使用确认和重传机制避免在高速的信 道切换中发生丢包的现象，然后通过相邻Wi-Fi信道聚合机制获得聚合信道的 CSI,把Wi-Fi信道的带宽扩展为可切换信道的全部带宽；提出一个''时域-频域 -空间域”的特征提取模块，对聚合信道的CSI幅度和相位分别进行特征提取， 获取与活动目标相关的特征值，生成包含丰富的时域特征、频域特征和空间域特 征的特征图像，作为后续神经网络的输入；提出一个神经网络模块，利用神经网 络构建高时间分辨率信号与目标行为的关系模型，感知目标行为。
1.3.2多Wi-Fi协作下最佳感知链路选择机制
收发链路中，多个子载波上的CSI具有刻画信号多径传播的能力，但由于单 个链路中子载波数量有限，要使得基于Wi-Fi目标行为感知技术的精度得到提升，
5
所选取的链路应达到最佳的感知效果。现有Wi-Fi感知技术，都依赖于一个发送 设备和若干个接收设备所建立的通信链路来获取CSI,感知环境中的目标行为。 首先，该场景收发设备所提供的链路涵盖范围有限；其次，该场景较为单一，在 现实世界Wi-Fi设备大规模部署的情况下并不适用；此外，活动目标在不同区域 产生的行为，受其物理空间的影响，可能在不同链路出现不同形式的感知效果。 因此，本选题针对多商用Wi-Fi设备协作下，众多链路不足以完全表征活动目标 状态的问题，研究多Wi-Fi协作下最佳感知链路选择机制，智能地选取最能表征 该区域中目标姿态、活动和位置等情景信息的链路，达到提升Wi-Fi感知技术的 感知精度的目的。具体研究内容如下：
本文提出了一种多Wi-Fi协作下最佳感知链路选择机制：构建深度强化学习 智能体，当目标位于不同的区域时，将多条链路作为系统在智能体的状态，利用 目标状态的真实标签作为智能体的奖励值，智能化地对多条链路进行权重排序， 该排序过程作为智能体的动作，并由智能体选取一条最能表征该区域中目标姿态、 活动和位置等情景信息的链路；提出一个“时域-频域-空间域”的特征提取模块， 利用该链路的CSI幅度和相位分别进行特征提取，获取与活动目标相关的特征 值，生成包含丰富的时域特征、频域特征和空间域特征的特征图像，作为后续神 经网络的输入；提出一个神经网络模块，利用神经网络构建信号与目标状态的关 系模型，感知该区域的目标行为。
1.4论文结构安排
本文的主要结构如下：
第一章主要分析了本论文的研究背景与意义,包括行为感知系统的介绍、WiFi 在行为感知中的应用与局限性，随后分析了基于Wi-Fi的行为感知研究现状， 并简要介绍了本文的研究内容和文章结构。
第二章阐述了基于Wi-Fi行为感知的理论基础，介绍了无线信道状态信息， 并分析了基于神经网络的活动识别方法和强化学习(Reinforcement Learning, RL) 技术，为后续研究奠定理论基础。
第三章深入研究Wi-Fi信号分辨率提升的意义，并提出基于Wi-Fi的行为感 知分辨率提升机制，通过信道切换和聚合算法建立了一个系统模型，把多个信道 的带宽聚合为可切换信道的全部带宽。同时通过构建跨位置活动识别场景，验证 了本文所提出的行为感知分辨率提升机制的可行性。
第四章深入研究密集Wi-Fi场景下链路选择的意义，分析了多Wi-Fi协作下 最佳感知链路选择的研究价值，并提出一种高效的基于强化学习的智能链路选择
6 策略，通过判别空间任一区域的目标行为对各个链路的影响，智能地对各链路进 行排序，选取影响最大的链路的CSI进行特征提取。之后通过构建空间多区域活 动识别场景，验证多Wi-Fi协作下最佳感知链路选择机制的可行性。
第五章首先对论文工作成果完成总结，并通过对现有研究进展的概括，展望 了未来的研究工作。
第二章基于Wi-Fi行为感知的理论基础
在基于Wi-Fi行为感知领域，许多研究学者通过不懈努力做出了巨大的贡献。 本章针对一些与本文相关的理论基础展开分析。首先，简单介绍了无线信道状态 信息的一些基本概念，包括信道状态信息和功率时延分布(Power Delay Profile, PDP)o接着，引入基于Wi-Fi的目标行为感知，介绍了幅度和相位差与目标行为 的映射关系。最后分析了基于神经网络的活动识别方法和强化学习技术，为后续 章节的精度提升技术的提出奠定理论基础。
2.1无线信道状态信息简介
2.1.1信道状态信息基本概念
无线信号在经过直射、反射和散射等方式传播后，在接收端会形成一个叠加 信号。信道频率响应(Channel Frequency Response, CFR)表征了频域角度的多 径效应。CSI是CFR的离散样本集：
日(门=爲=2滤£2耐％,	(2-1)
其中，N为路径总数，九为路径的序号，和q分别对应于第九条路径的幅度衰减 和传播时延。在频域内信道带宽为B,采样分辨率为可以推导出CFR样本的 数量为：
N = +	(2-2)
CSI描述了 Wi-Fi信号如何通过不同的子载波从发射端传播到接收端。WiFi 环境中目标微小的运动变化会影响Wi-Fi信号的多径效应，从而导致CSI的变 化。从CSI中能够得到各个子载波的频率响应，还能获取各个子载波的幅度和相 位，可以更全面地反映出该无线信号的传播信息。因此，借助数学建模或者机器 学习算法，可以通过探究活动目标在Wi-Fi环境下引起的CSI的变化来感知目标 行为。
另外,CSI Too『2］【4i］为每个天线对的56个子载波中的30个子载波提供CSI= 具体来说，一个样本中有N赵x NTX X 30个CSI值，其中N磁和Mrx分别为发射端 和接收端的天线数。然而，在一个Wi-Fi设备密集部署的Wi-Fi环境下，倘若存 在N个发射端和M个接收端，每次都会有N x M x NRX X NTX X 30个CSI值，这 将增大数据处理的难度和网络的复杂性。因此，基于当前环境状态，如何设计一 种有效的方法，从如此大量的原始数据中提取出对基于Wi-Fi的目标行为感知应 用最有代表性的信息是至关重要的。
2.1.2功率时延分布基本概念

CSI (channel state information)



PDP (power delay profile)

图2-1频域上的CSI可以通过IFFT转化为时域上的PDP
如图2-1所示，时域上的PDP由频域CSI通过逆傅里叶变换(Inverse Fast
Fourier Transform, IFFT)计算得到。CSI 对应的 PDP 为：
h(t) = Sn=l 一 Tn)，	(2-3)
其中，§(•)为狄克拉脉冲函数。由于无线信号的多径效应，Wi-Fi信号由发送端到 接收端会在时间域上产生色散，也就是Wi-Fi信号经过不同的路径传播后，到达 信号接收端所需要的时间会产生差异。PDP表征了无线信号在时间域上的色散， 使得我们能够使用PDP描述多径信道特征，因此PDP在基于Wi-Fi的行为感知 领域同样得到了广泛的应用⑷】。在室内多路径环境中，具有更高时间分辨率的 PDP可以更准确地检测到目标的行为变化。在IFFT中，时间分辨率定义为：
AT = ¥，	(2-4)
其中，公为时间序列的窗口长度，N为IFFT中使用的数据点数。AT值越小，时间 分辨率越高。样本频率可以表示为t43][44]：
=寻	(2-5)
通过公式(2-2)、(2-4)、(2-5),可以推出:
(2-6)





图2-2利用CSI得到的PDP的时间分辨率是由信号的带宽决定的
由公式(2-6)可以得到，由CSI计算得到的PDP的时间分辨率是由Wi-Fi信 号的带宽决定的。如图2-2所示，显而易见，更大的带宽带来更高的PDP分辨 率，这更容易消除由微小活动引起的细微的多径信道变化。因此，大信道带宽对 于细粒度Wi-Fi行为感知应用至关重要。然而，一方面，在Wi-Fi网络传输系统 中，单个信道的带宽只有20MHz或者40MHz,这限制了系统的感知性能；但另 一方面，Wi-Fi信号的总带宽是足够大的，因此可以通过快速切换多个信道，在 很短的时间间隔内从多个相邻的Wi-Fi信道获得CSI,然后通过汇聚这些信道的 CSI,将Wi-Fi信号带宽扩展为这些相邻信道的所有带宽。


图2-3利用信道切换和信道聚合，扩展Wi-Fi信号的有效带宽
如图2-3所示，随着信号带宽的扩大，Wi-Fi信号的分辨率也会相应地变高。 因此，本文设计了一个用于Wi-Fi行为感知技术的感知分辨率提升机制，通过多 信道快速切换及聚合算法，把Wi-Fi信道的带宽扩展为可切换信道的全部带宽, 提高Wi-Fi信号分辨率，提升行为感知系统的感知精度。
10

2.2基于Wi-Fi的目标行为感知
2.2.1幅度与目标行为的映射关系
由公式(2-1)所示，原始CSI数据包含幅度信息和相位信息。Wi-Fi环境中 目标的行为变化改变了无线信道的多径特性，这些变化能够体现在CSI的幅度 和相位上。因此，CSI幅度和相位可以用于提取与目标行为相关的特征。

图2-4 CSI幅度受目标行为的影响：(a)静态环境，(b)目标产生某种行为。可以使用
CSI幅度的方差来检测某个行为的开始和结束
如图2-4 (a)所示，当环境是静态时，CSI幅度接近于一条平稳的直线；如 同2-4 (b)所示，当Wi-Fi环境中，目标行为发生变化时，CSI幅度随着行为变 化产生相应的震荡曲线，能够根据曲线的波动过程推断某个行为的开始和结束。 正因CSI幅度曲线与Wi-Fi环境紧紧关联，常用CSI幅度来表征目标行为变化。 常见的方法是计算出CSI幅度的不同阈值，如方差、平均绝对偏差(MeanAbsolute Deviation,MAD).有限差分等，用来确定目标的状态。这种基于阈值的方法广泛 应用于基于Wi-Fi的行为感知【切〔46］。

如图2-5所示，与可以直接使用的CSI原始幅度数据不同，商用Wi-Fi设备 获得的原始相位分布随机。在真实的Wi-Fi系统中。接收的相位信息经常因为误 差源(如硬件和软件错误)产生一些噪音。
根据文献[47][48],计算出CSI第i个子载波的相位值&^为：
ZCSIt = ZCSk + 2nTs+ 27Tt + y + n, (2-7)
其中，NTS/j为第i个子载波的真实相位值，心和几分别是OFDM符号的总长度 的和数据符号的长度，△/■是载波频率偏移(Carrier Frequency Ofifset,CFO), «是 由公式(2-8)计算得到的采样频率偏移(Sampling Frequency Offset, SFO),『和 厂分别是发射端和接收端的采样时间，％是时域样本中的时间偏移，N为IFFT中 所使用的数据点个数，y为锁相环(Phase Locked Loops, PLL)中的振荡器相位偏 移，为接收端的加性高斯白噪声(Additive White Gaussian Noise, AWGN )。
2^1 (2-8)
s T
Wi-Fi网卡的三个天线具有相同的载波和采样时钟频率偏移、采样时钟时间 偏移[48〕。因此，第i个子载波的相位差可近似表示为：
LZCSI, = L^CSIt + Ay + An,	(2-9)
其中，3是常数相移的差，如是高斯噪声。根据文献[48], Ay是同一个网卡的天 线之间的时间常量，它不会因为目标行为改变CSI相位信息。与CSI相位相比， 去掉CFO、SFO和时间偏移后的相位差更加稳定。由图2-5 (a)可知，当空间环 境是静态时，相位差在静态环境中保持在一个稳定的水平；由图2-5 (b)可知， 当环境中有目标活动时，相位差就会出现波动。因此，可以通过相位差来校准原 始相位，验证了本文的推导。
Raw phases	Phase diHitetices

图2-6 极坐标中的CSI相位和相位差

12

图2-6在极坐标中绘制了原始CSI值，其中包含幅度，相位和相位差信息。 可以看出，相位分布在0。到360。之间，相位差分布在65。到90。之间。相比原始相 位，得到了校准后的相位差分布更为集中。

图2-7信号传播的额外距离可以由AoA计算得到
在本文的实验中，两个相邻天线之间的距离设为入/2,其中入是Wi-Fi信号波 长。令$为第i个子载波的AoA,表示第i个子载波信号到达天线时的角度。如图 2-7所示，到达第一个天线与到达第二个天线相比，Wi-Fi信号传播了额外的一 段距离，该距离差Ad：可以近似为：
入
Adf =		—
2 cos 0i
这段距离差Ad：会引起一个相位差：
— 2nAdi
A
可以计算出第i个子载波的AoA值：
Bi = cos-1
7T
多个子载波的AoA值包含了多径信道中信号的丰富信息，既包括环境中静 态路径的信息，也包括目标行为变化引起的信息。虽然CSI的相位受到多个误差 源的影响，但是相位差相对稳定，因此本文利用相位差得到的AoA值来准确区 分包括目标位置在内的相关信息。
2.3基于神经网络的活动识别方法
2.3.1卷积神经网络模型
作为深度学习技术的代表算法，卷积神经网络(Convolution N eural N etwork, CNN)在图像识别方面展示出了强大的图片处理和分析能力。CNN的主要思想 在于构建多层隐含层网络,通过对图像进行卷积运算，自主学习图像的信息特征, 从而获取图像深层信息，完成最终的预测任务或者分类任务。与传统的学习方法
13
相比，CNN能真正反映数据的内在特征。除了计算机视觉领域，CNN还可用于 自然语言处理和语音信号处理等领域。
将CNN模型用于基于神经网络的活动识别，本质上是学习和分析了基于活 动特征的图像像素值，生成图像数据与目标活动的映射模型。由于可以直接将多 维图像输入到CNN,因此省略了传统的特征提取过程。越深的网络结构，学习 到的活动特征越全面，模型也将更准确地识别活动类别。
CNN作为一种多层感知机，能够识别多维数据。其模型包含输入层、多个隐 藏层结构和输出层。其中，输入层用于输入多维的图像数据，隐藏层结构包含了 卷积层、池化层和全连接层等，输出层用于输出识别结果。CNN在基于神经网 络的活动识别中表现出色源于其三大核心思想：权值共享、局部感知和池化。权 重共享即模型使用同一个卷积核，从而减少卷积核数目，提高网络的计算速度; 局部感知使得原本对于图像的全连接变成局部连接，减少计算的数量级；池化通 过缩小图像规模，减少计算量。这些特性使得CNN对图像的缩放、平移或者其 他形式的变形保持不变性。
Wi-Fi信号本身是复杂抽象的无线信号，要想将其用于行为感知中，需要先 利用特征提取的方法，从无线信号中提取出与行为相关的特征。常用的特征提取 方法是通过时频变换将无线信号转换为特征图像，此时的特征图像中包含了关于 目标状态的时频信息。得益于CNN在图像处理方面的杰出性能，我们可以使用 CNN对特征图像进行学习，构建目标行为模型。因此，CNN有助于实现“无线 信号-目标行为”的建模过程，在基于Wi-Fi的行为感知中得到了广泛的使用。故 本文选取CNN用于学习和识别Wi-Fi信号生成的特征图像。
2.3.2长短期记忆网络模型
循环神经网络(RecurrentNeural Network, RNN)是一种擅长学习序列隐藏 特征的递归神经网络。与CNN相比，RNN的隐藏层的神经元之间存在权值，从 而建立了一种关联，即当图像序列在输入网络时，隐藏层神经元的计算不仅依赖 于输入层当前的输入数据，同时还依赖于上一时刻隐藏层各神经元的数据。
但RNN中缺少了用于存储及输出帧信息的存储单元，因此对于序列中较长 时间间隔的图像帧，RNN的学习能力将会受到制约。与标准RNN不同的是，长 短期记忆网络(Long Short-Term Memory, LSTM)使用了能够存储及输出帧信息 的存储单元，因此对于较长时间前的输入数据，LSTM拥有RNN所缺少的记忆 能力。
14


X,

图2-8 LSTM模型示意图阙
LSTM模型包含了输入层恐、隐藏层结构和输出层饥。其中，隐藏层结构存 在着输入门0、遗忘门齐、存储单元耳和输出门0-这样的门结构确保了 LSTM模 型能够实现保留更有效的信息和遗忘无效的信息，以更新LSTM单元的状态，解 决了传统RNN存在的问题。具体结构如图2-8所示，各部分的更新情况如下所 示［49】：
it = ^(WxiXt +	+ bi)
(2-13)
ft = ^(WxfXt + Uhfht-! + bf}
(2-14)
往=tanh(Wxcxt + Uhcht_r + bc)
(2-15)
5 = ft O Si + it O Q
(2-16)
0上=+ U/ioht—i + b。)
(2-17)
ht = ottanh(ct)
(2-18)

其中，％、Wxf. %、必。是吐到4、齐、頁和5的权重，%、%、%、%是 隐藏层到4、ft、往和5的权重，$、bf、亠、bo是耳、ft、往和4的偏置，o■是sigmoid 激活函数，血加是将输入值规范到［-1,1］的激活函数。因此，可以看出，⑴、/t和 Ot是由拼接向量乘以相应的权重并加上偏置后，再通过sigmoid激活函数将其转 化为［0,1］之间的值，进而产生的门控状态。
LSTM存在三个重要的阶段：
15
(1) 选择记忆阶段。这一阶段主要是关于选择性记忆当前节点的输入，即“记 住重要的信息”。其主要依靠门控S，用于控制存储单元耳中哪些需要着重记录保 留下来。
(2) 遗忘阶段。这一阶段主要是关于选择性遗忘来自前一个节点的输入，即 “遗忘不重要的信息”。其主要依靠门控心，用于控制上一个节点的输入中，
哪些需要遗忘和不需要遗忘。
(3) 输出阶段。这一阶段主要是关于决定当前状态的输出。首先由上述两个 阶段的结果相加即可得到下一个状态5,随后依靠门控5进行控制，并通过tcm/i 激活函数完成放缩，得到短。
最终，和RNN—样，通过饥变化得到输出％。
在基于Wi-Fi的行为感知系统中，目标行为随着时间推移发生持续性变化。 由于从商用Wi-Fi网卡获取到的CSI序列是时间序列，因此该序列中蕴含着关于 目标行为的上下文信息。得益于LSTM在处理时间序列的极佳表现，选择LSTM 处理CSI序列能够实现对目标状态信息的长期记忆，从而完成对CSI序列的时 间特征的提取。这将更有利于模型对于目标行为的深层次学习。
2.4强化学习技术
2.4.1强化学习基本概念
作为机器学习中的分支之一，强化学习任务可以通过不断地与环境进行交互, 完成对当前环境信息的学习与探索，从而形成某种策略，获取到最优的结果。强 化学习是一种经典的奖励指导行为的方法，目标在于使强化学习智能体在不断学 习的过程中获取到最大奖励。
► Agent
state reward	action
Environment
图2-9强化学习任务中智能体与环境交互示意图
强化学习主要包含状态、动作、转移概率、策略和奖励等五个要素。如图2- 9所示，用马尔可夫决策过程(Markov Decision Process, MDP)阐述强化学习中 智能体与环境的交互示意图。具体来说，该过程会创建一个处于某个特定环境的 智能体。一方面，这个智能体会通过与环境进行交互，感知当前环境从而获取当
16 前状态，将状态映射后生成与之对应的决策；另一方面，智能体能通过完成某个 动作从而对环境产生新的影响，即当智能体完成某个动作后，环境会根据一定的 概率转移到下一个状态中。与此同时，根据奖励函数的激励，环境能够向智能体 反馈奖励。
可以看出，强化学习的主要思想就是使得智能体与环境不断交互、不断学习， 根据策略得到相应的动作和奖励，并随之更新环境并调整其策略，最终智能体会 生成一个最优策略。此时便可以按照这个策略，感知智能体在何种状态下应该执 行何种动作。
因此，在设计强化学习模型时，需要考虑以下几个方面：
(1) 如何定义状态空间和设计相应的动作空间。合适的状态空间能够更好地 帮助智能体完成与所处环境的交互，从而在不断学习中形成合适的策略。相应的 动作空间包含了智能体可能做出的一系列决策。
(2) 如何定义合适的决策方法。正确的决策方法关系到了智能体能否有效完 成决策任务，以达到所预期的提升系统性能的效果。
(3) 如何设计有效的奖励。智能体在完成由当前环境状态到具体动作的映射 过程中，智能体选择的动作是为了保证当前环境下获取到最大奖励，使系统达到 最佳性能。奖励越高，智能体选择相应动作的概率越大；奖励越少，智能体选择 相应动作的概率将会产生削弱。
本文在多Wi-Fi协作下最佳感知链路选择机制的研究中，将多Wi-Fi链路选 择问题转化为顺序决策问题，并选择采用强化学习模型求解该问题。通过建立一 个强化学习智能体，使得智能体与Wi-Fi环境发生持续性交互，不断学习Wi-Fi 信号状态，根据策略得到相应的动作和奖励，并通过更新选择的链路和调整其策 略，最终使得智能体生成一个最优策略。通过这个最优策略在多Wi-Fi协作场景 中完成对最佳感知链路的选择，提升基于Wi-Fi感知系统的精度。
2.4.2 REINFORCE 算法
在强化学习环境MDP〈S, A, R, P,兀〉下，智能体与环境发生交互，从感知到 状态s后根据策略兀执行动作a开始，持续完成与环境的交互，最终计算最大的累 积奖励值。这个累积奖励的期望被称为动作价值函数，又称为Q函数(Q-value function) Qn(s, a)[50h
Qn(s, a) = E[rt+1 + yrt+2 + Y2rt+s + - \st = s,at = a],	(2-19)
其中，y是折扣因子，r是基于状态s完成动作a得到的奖励值。按照贝尔曼方程,
公式(2-19)可以被分解为[呵：
Qn(s,a) = Es，,j[R(s,a) + YQAS', a],	(2-20)
17
其中，S，和出分别为下一个状态和动作。
令T = So，ao，Si，ai，	,s“az为一组"状态-动作"序列，尺（丫） =	at）
为T的累积回报，P（T；0）为T的概率，因此，梯度的目标函数a〕：
丿（0） = E（旻=oR（St，at）；7Te） = ETP（T；0）R（T）。	（2-21）
其中，策略梯度作为一个优化问题，需要通过寻找到最优的0,使得/（&）最大。
常用梯度上升求解该问题：
6 = 0 + aV0/（0）o	（2-22）
在求解该问题时，计算出丿（0）的导数为：
=XTP（T； 0）VelogP（T；0）/?（r）o	（2-23）
将（2-23）的公式转化为m条序列，可以得到bo〕：
=汨陰％ 10gP（T； 0） R（T）。	（2-24）
对于m条序列中的一条，T的概率p（T；e）为：
P（Ti;0）= H£=oP（sf+i|sf,a；）7r8（a；|sf）。	（2-25）
由（2-24）、（2-25）得到目标函数的梯度如下：
如⑹=号器iCXo^log眄何应）尺（刃）。	（2-26）
将（2-20）引入（2-26）,求解得目标函数的梯度为：
W 丿⑹=E问［yelog7r8（s,a）Q”（s,a）］。	（2-27）
在蒙特卡洛（Monte-Carlo）策略梯度REINFORCE算法冋中，可以用价值函 数对“状态-动作对”的Q函数进行无偏估计。REINFORCE算法如下：
算法1： REINFORCE算法
1：输入：MDP〈S, A, R, P}, y, 7ig ,迭代次数N
2：初始化：e
3： for episode = 1,... ...,N do
4：	初始化状态S］；
5：	将状态Si输入到策略yr。中，最终得到{sn a1（ r2,..., sT, aT, rT+1）；
6： for t = 1,... ...,N do
7： vt <- rt+1 + yrt+2 + …+ yT_trr+i；
8：	0 <- 0 + V0 log7r0（st,at）vt
9： end
10： end
11： 0*8
18
基于此，我们通过REINFORCE算法得到了智能体的最大累积奖励，也就是Q值 最大时的参数0。
2.5本章小结
本章主要在已有的关于Wi-Fi行为感知的研究基础上，介绍一些相关的理论 基础。在本章的开始，先介绍了无线信道状态信息的一些基本概念，包括信道状 态信息和功率时延分布。随后，引入基于Wi-Fi的目标行为感知技术，介绍了 CSI 的幅度和相位差与目标行为的映射关系。最后分析了基于神经网络的活动识别方 法和强化学习技术，为后续章节研究精度提升技术奠定理论基础。
19
第三章 基于Wi-Fi的行为感知分辨率提升机制
3.1分辨率提升机制的意义
基于Wi-Fi信号的行为感知本质上是利用多径信号到达时间的差异，来分辨 Wi-Fi环境中目标行为变化的差异。要实现精确的目标行为感知，首先要提高WiFi 信号的多径分辨率。由于Wi-Fi多径信号的到达时间分辨率受限于传输信号的 带宽，所以Wi-Fi多径长度的差值受限于信号的带宽，从而可知目标行为变化的 分辨率也同样受到信号带宽影响。要实现细粒度的目标行为感知，需要达到分米 级的多径长度分辨率以区分细微的目标行为变化，这需要上百兆赫兹的信号带宽, 然而目前的商用Wi-Fi网卡提供的单个信道带宽为20MHz或者40MHz,不足以 区分细微的目标行为变化。因此，针对目标行为感知中Wi-Fi信号多径分辨率不 足的问题，亟需研究一种基于W-Fi的行为感知分辨率提升机制，达到提升分辨 率的目的。
由于商用Wi-Fi网卡只能工作于一个Wi-Fi信道上，且单个Wi-Fi信道的带 宽有限，但所有Wi-Fi信道的总带宽是足够大的。因此考虑在极短的时间内，通 过快速切换多个相邻Wi-Fi信道，采集并聚合相邻信道上的CSI,从而达到扩展 Wi-Fi信道带宽，提升Wi-Fi信号分辨率的目的。基于此，本章具体研究内容如 下：
为了解决上述问题，本章提出了一种用于Wi-Fi行为感知技术的感知分辨率 提升机制：提出多信道快速切换及聚合算法，通过多Wi-Fi信道快速切换机制修 改Wi-Fi网卡驱动，完成在极短的时间间隔内从多个相邻Wi-Fi信道中采集CSI 数据，同时使用确认和重传机制避免在高速的信道切换中发生丢包的现象，然后 通过相邻Wi-Fi信道聚合机制获得聚合信道的CSI,把Wi-Fi信道的带宽扩展为 可切换信道的全部带宽；提出一个“时域-频域-空间域”的特征提取模块，对聚 合信道的CSI幅度和相位分别进行特征提取，获取与活动目标相关的目标行为 特征值，生成包含丰富的时域特征、频域特征和空间域特征的特征图像，作为后 续神经网络的输入；提出一个神经网络模块，利用神经网络构建高时间分辨率信 号与目标行为的关系模型，感知目标行为。
20
3.2机制设计

图3-1基于Wi-Fi的行为感知分辨率提升机制
如图3-1所示，基于Wi-Fi的行为感知分辨率提升机制主要由以下模块组成: 一个获取高分辨率CSI的信道切换和聚合算法，一个特征提取模块和一个深度 学习模块。
3.2.1信道切换和聚合算法
首先是信道切换和聚合算法。正如2.1.2所述，来自于一个有限带宽的WiFi 信道的 CSI,不足以区分细微的目标行为变化。虽然Wi-Fi通信信号单个信道 所提供的带宽有限，但信号的总带宽是足够大的，因此可以通过信道快速切换， 从多个相邻Wi-Fi信道中采集CSI数据(在极短的时间间隔中，信道的状态可以 认为是平稳的)。
通过修改Intel 5300网卡的驱动程序和固件，可以从接收端的Wi-Fi数据包 中提取CSIo随后，本文通过修改iwlwifi驱动程序和开源的IEEE802.il包注入 库——LORCON (Loss Of Radio CONnectivity)[52],设计了一种多信道切换方法， 最终实现了毫秒粒度下的多信道切换和包处理。然后将相邻信道的CSI通过聚 合算法，把单个信道的带宽扩展为可切换信道的全部带宽。
因此，针对信号带宽不足导致的分辨率低的问题，本文选取多条相邻信道， 在普通商用Wi-Fi设备上实现多信道的快速切换，从多个相邻信道采集数据，获 得更大信号带宽的聚合CSI,提升信号带宽进而提升信号的分辨率。
3.2.2特征提取模块
随后是特征提取模块。如2.2.2节所述，由于相位差具有稳定性，因此即使 在复杂的室内环境中，由相位差计算得到的AoA值也具有鲁棒性。所以，可以 使用AoA值来准确估计一个给定环境中目标的位置。在得到了聚合CSI后，通 过计算相邻天线之间的CSI相位差，得到公式(2-12)计算出的AoA值。以时
21
间为X轴，子载波为y轴，将多个子载波上的AoA值转换为AoA谱图。得到了 AoA谱图后，本文将其作为行为特征的一部分。
为了利用CSI幅度对不同的目标行为进行感知，应该先从CSI幅度中提取 不同活动的代表性特征，将其用于后续的处理。首先对CSI数据流使用主成分分 析法(Principal Component Analysis, PCA ),这样便可以捕获相关的目标行为, 并大大减少数据维度。本文使用第一主成分的数据进行进一步处理，因为它清楚 地捕捉了目标行为。考虑到目标行为引起的路径长度变化频率与反射路径长度变 化率之间的相关性，可以利用短时傅里叶变换(Short-Time Fourier Transform, STFT)从第一主成分中提取时间-频率特征。基于此，可以提取常见行为的STFT 谱图。
AoA值对于给定位置的判断足够稳定，STFT能够很好地区分不同行为的时 频特征。通过构造AoA谱图和STFT谱图，得到聚合CSI带来的丰富的时间-空 间-频率特征。
3.2.3深度学习模块
本文使用CNN从3.2.2中构造的图像中学习识别特征。提出的深度学习模 型包括若干个交替的卷积层和最大池化层，以及若干个全连接层。
在卷积层，可以从STFT谱图中提取时频特征，从AoA谱图中提取时空特 征。每个卷积层由多个具有不同权重和偏置的卷积滤波器组成。其中，卷积层的 滤波权重与上一层特征映射中的局部区域相关联。本文使用的卷积层函数可以表 示为：
4 = /(E址!叽x-~r * w-j + b[),	(3-1)
其中，玮为第/层生成的第i幅特征图，包含了层的所有特征图，叱；和H为 生成玮的滤波器权重和偏置，/'(•)为线性整流函数(Rectified Linear Unit, ReLU)。 由公式(3-1)可以推断，特征图在卷积层中的运算过程为一个离散卷积运算。在卷 积层，可以通过在前一层的特征图的不同位置共享相同的权重来获得局部特征。
从公式(3-1)获得局部特征后，本文使用最大池化层将相似的特征合并为一个 特征。最大池化层函数可以写成：
x- = maxx--1u(n,n),	(3-2)
其中，時为第2层生成的第i幅特征图，u(n,n)为窗函数。可以看出，公式(3-2)通 过滑动的池化窗口，计算了特征图在各个窗口内的最大值，并将其保留。在减小 特征图分辨率的同时，依然能够传递出一致的表达，从而实现空间不变性。因此， 可以使用最大池化函数，有效优化内存使用，减少训练时间。
22
在深度学习模块的末尾，有两个全连接层。第一个全连接层完成数据降维, 第二个全连接层执行分类任务。全连通层由多个感知机组成，感知机表示输入和 输出的加权和之间的非线性关系。第一个全连接层的函数可以表示为：
Xi = f (Dense(X—2)“ 厶-1 + B1"1),	(3-3)
其中，厶为深度学习模块中CNN的层数，X—i是厶一 1层的特征图，Dense(・)将 前一层的输出压缩为全连接层的输入，W-1和B-i分别为厶- 1层感知器的权重 和偏置。最后一个全连接层对于每个分类都有一个节点，节点的输出可以表示为:
ZL	+	(3-4)
如公式(3-5),全连接层包含一个softmax激活函数，其输出代表了各个分 类标签对应的概率值。概率最高的类别被预估为正确的类别。
(3-5)
其中，％是第i类的概率，也是深度学习模块的输出，Zk是输入到输出层的第k个 单元的加权和。模块随后使用交叉癇损失函数：
C = 一半器1[兌log% + (1 -究)log(l -力)],	(3-6)
其中，究是第i类的真值，只能是0或1。模型的精度越高，损失函数越小。本文 通过使用误差反向传播算法(error Back Propagation, BP)最小化损失函数，通 过Adam (Adaptive Moment Estimation)算法优化权重和偏置。此外，模块还引 入dropout机制，以降低过拟合的风险。dropout可以防止训练过程中出现复杂的 协同适应，已经被证明是一种非常有效的减少过拟合的方法。
3.3信道切换和聚合算法
为了保证信道切换过程不影响与目标行为相关特征的提取，切换信道的时间 不应大于采样时间。此外，还必须保证发送端和接收端始终在同一信道内同步工 作。但在不稳定的无线环境中，可能会出现丢包的情况。一旦报文丢失，CSI聚 合就会产生一系列问题。
为了解决上述问题，本项目先进行了大量的验证实验，并最终在同步传输中 采用确认和重传机制，避免快速信道切换过程中的丢包现象。如算法2所示，在 每一轮数据传输之前，发射端TX和接收端RX都在同一信道。首先，TX发送一个 数据包(步骤7)。在接收到这个包后，RX发送一个4CK确认答复，然后切换 到下一个信道(步骤9-13 )o当TX接收到这个4CK时，它也切换到下一个信道(步 骤18)。然而，一旦数据包在给定的超时时间内丢失，7*将重新发送数据包，以
23
确保RX在每个信道中接收到唯一数据包（步骤14-16）。在一个周期的所有信道 完成切换后，聚合这些信道中的CSI （步骤19-21）。
基于此，本文实现了发射端和接收端之间的快速信道切换和聚合，从扩展信
道
算法2：信道切换和聚合算法
1：输入：包的个数/en,信道的个数
2：选择n个相邻的信道俎,/12,••••••，鶴；
3：将血上2，..•，鬲添加到待选信道列表中；
4：发送端TX和接收端RX切换到第一个信道徧；
5： for i = 1,... ...,len do
6： j = i % n + 1；
7：	TX发送一个数据包血；
8： while TX和RX都在监听套接字do
9：	if RX接收到了处then
10：	RX 响应一个 ACK；
11：	RX切换到下一个信道街；
12：	跳出；
13：	end if
14：	if TX在给定的超时时间1ms内没有接收到ACK then
15：	TX 重发 s；
16：	end if
17： end while
18：	TX切换到下一个信道妇
19： if i % n == 0 then；
20： 从聚合 CSI C“C2—cn,获得聚合 CSI Ci/n；
21： end if；
22： end for；
23：输出：所有聚合CSI Cj,C2,
，Gen/n ；
3.4场景设置
当一个人位于不同的位置或执行不同的活动，人对Wi-Fi信号的影响会有所 不同。由于本章是研究基于Wi-Fi的行为感知分辨率提升机制，因此使用该机制 是否能准确估计人类活动和位置是非常重要的，即使这些选定的位置之间的距离
24

很小（0.6米）。本章提出了一个特殊的场景：跨位置的人类活动识别场景（CrossLocation Human Activity Recognition Scenario, CLHAR）。因为在这种场景下，这 些位置之间的距离很小，所以需要更高的Wi-Fi信号分辨率。否则，低分辨率使 得分类器无法提取完整的活动相关的信号特征。因此，该方案对人类活动识别更 具挑战性，具有重大的现实意义。本章进行了两个对照实验。首先，分别在聚合 信道和单信道中的CSI数据集验证人类活动和位置估计的准确性。其次，当人类 所处的位置稍有不同时，利用CSI来识别人类活动。本节还将基于Wi-Fi的行为 感知分辨率提升机制和基于Wi-Fi的人类活动识别的基准方法⑴］进行了比较。
3.4.1实验设置
在本章的实验中，使用两台小主机作为发射端和接收端，都配备了 Intel 5300 无线网卡。发射端使用一根天线，接收端配备三根天线。5300网卡驱动所能获取 的子载波数为30,那么在一个信道中就能获取3 * 1 * 30的CSI数据流。正如3.3 提及，本章的实验实现了基于LORCON的信道切换和聚合算法，故选择使用三 个5GHz Wi-Fi信道（信道132,信道136,信道140）,带宽为20MHz。在信道 切换和聚合之后，获取到有3*1*90的聚合CSL从一个信道到另一个信道的切 换时间大约是20ms。考虑到信道切换开销，系统将采样率设为200Hz。
—qi	y也n IPqi	lb―flZ
Window	Window	Window

Location i

RX	Receiver

TX Transmitter

图3-2 一个跨位置的人类活动识别场景，包含四个相邻的有代表性的位置
在这个特定的CLHAR场景中，我在大小为8m* 5m的房间中收集了 8405个 日常活动的样本。如图3-2所示，本文选择四个相邻的有代表性的位置（标记为 图3-2中的星形）进行实验。实验者在一个小时内在每个位置连续采集某个日常 活动的数据，所采集的五种日常活动涵盖“行走”、“跑步”、“站立”、“坐下”和 “拾取”。因为“行走”、“跑步”和“站立”三种活动是连续性的，所以可以把 一个小时的时间序列数据包分成多个序列。对于“坐下”和“拾取”活动，首先 需要使用CSI幅度的方差来检测每个活动的开始和结束。表3-1列举了不同位置
25
不同活动的样本数量。本文将四个位置的五种活动标记为20个标签，从每个标 签上随机挑选100个样本，将这2000个样本作为测试集，剩下的6405个样本作 为训练集。
为了验证信道切换和聚合算法的有效性，本文还保持实验环境不变，然后像 大多数现有的研究一样，只从一个信道收集CSI,并进行相同的数据处理和模型 训练，表3-2描述了单信道中采集的样本数量。
表3-1使用分辨率提升机制的系统所采集的活动样本数量

行走
跑步
站立
坐下
拾取
位置1
500
500
500
300
302
位置2
500
499
500
300
302
位置3
499
498
500
300
302
位置4
500
500
500
300
303


表3-2使用单个信道的系统所采集的活动样本数量

行走
跑步
站立
坐下
拾取
位置1
499
499
499
301
301
位置2
499
499
500
301
301
位置3
499
500
500
301
301
位置4
500
500
500
301
301
从单个聚合CSI,可以计算得到90个天线1和天线2之间的相位差，以及 90个天线2和天线3之间的相位差。因此，在每个数据包中可以获得180个AoA 值。当连续取180个样本数据，可以构造一个180 * 180的AoA谱图。在200Hz 的采样率下，可以提取高达100Hz的频率范围。在利用STFT提取128个频率分 量时，对应的频率粒度为0.78Hzo这样的频率范围和频率粒度足以涵盖常见的人 类活动。基于此，本文构建了 AoA谱图和STFT谱图来训练模型。
3.4.2训练设置
本文使用tensorflow实现深度学习模块，实验使用的服务器配备了 Intel Xeon(R) @2.50GHz48 核 CPU 处理器、4 个 NVIDIA GeForce GTX1080Ti 的 GPU 和48GB内存。构造好的图像作为CNN的输入数据，首先在卷积层和最大池化 层中进行处理。第一个卷积层存在16个大小为5 *5的卷积滤波器，随后使用大 小为2 * 2的最大池化层，生成16个大小为88 * 88的特征图。然后如表3-3所示， 依次实现其他两个卷积层和两个最大池化层，生成64个大小为19 * 19的特征图。 最后通过两个全连接层，计算每个位置上每个活动的交叉爛，并选择可能性最大 的标签作为人的状态。所使用的其它CNN参数如表3-4所示。
26

表3-3使用的CNN结构
层数
名称
大小
激活函数
1
卷积层
5*5 (16)
ReLU
2
最大池化层
2*2
None
3
卷积层
5*5 (32)
ReLU
4
最大池化层
2*2
None
5
卷积层
5*5 (64)
ReLU
6
最大池化层
2*2
None
7
全连接层
400 (1)
ReLU
8
全连接层
20 (1)
Softmax


表3-4使用的CNN参数
参数
数值
Dropout 率（耳）
50%
学习率（a）
0.05
Batch 大小(n)
128
Epoch 大小（0）
200
指数衰减率（仇）
0.9
指数衰减率（％）
0.999
无穷小参数（£）
IO-*
为了验证特征提取模块所生成的谱图不仅适用于所设计的CNN中，利用其 他常见的深度学习方法（如LSTM）同样可以提取出与活动相关的特征并对其进 行准确分类，本节还比较了 CNN和LSTM的性能。此外，通过本节的比较，同 样可以验证所设计的深度学习模块是否合适。表3-5给出了使用的LSTM参数。
表3-5使用的LSTM参数
参数
数值
隐藏层单元个数
600
学习率（a）
0.05
Batch 大小（H）
128
Epoch 大小（0）
200
指数衰减率（仇）
0.9
指数衰减率（俊）
0.999
无穷小参数（£）
10-8
27

为了验证所提出的基于Wi-Fi的行为感知机制的可行性和通用性，本文将其 它基于Wi-Fi的人类活动感知作为对照实验，与之进行了比较。如341所述， 在本实验所设立的CLHAR场景中，每个位置之间的距离很小，不仅仅是活动上 的微小变化，个人位置的微小变化也会对Wi-Fi信号产生影响。这种场景在现实 世界中很常见，但在基于Wi-Fi的活动识别中经常被忽视，因此近距离的Wi-Fi 人体活动识别技术是一个亟待解决的难题。为了解决上述问题，系统的分辨率必 须足够高，以便在位置影响下准确区分不同的活动。由于文献［53］中提出的 ABLSTM已在人类活动感知领域中得到了有效的验证，因此本文使用ABLSTM 作为基于Wi-Fi的人类活动识别的基准方法，并将其与分辨率提升机制进行比较。
3.5结果分析



0 60 120 180
Number of Packets
(e)拾取
图3・4 采用分辨率改进机制构建出在位置2做不同活动的STFT谱图。由于提供了高分辨
率，不同活动具有较大区分度
本文首先评估分辨率提升机制的性能。在获取到聚合CSI后，分别利用CSI 相位和幅度构造AoA谱图和STFT谱图。图3-3展示了四个不同位置的AoA谱 图。可见相邻4个位置的AoA谱图分布存在明显差异，可以将其作为Wi-Fi 内定位的指纹信息。图3・4为所提取的典型活动的STFT谱图，高能量集中的频 带(暖色调)代表活动所对应的频带。显然，STFT谱图能够表征人类活动对Wi-
29

Fi信号的影响。从图3-3和图3-4可以看出，分辨率提升机制对于不同地点、不 同活动所构建的特征图像直观上易于分类，这是因为所设计的机制提供了较高的 分辨率。

图3-5使用分辨率提升机制时，不同位置的准确率混淆矩阵
随后，为了探索更细粒度性能，图3-5中展示了四个位置的准确率混淆矩阵。
可以看出，第一个位置的准确率在91%到100%之间，第二个位置的准确率在93% 到100%之间，第三个位置的准确率在87%到100%之间，第四个位置的准确率 在92%到99%之间。在每个位置，每个活动的识别正确率在87%〜100%之间。 具体而言，四个位置的整体准确率分别为97.8%、97%、94.6%和96.2%。因此, 即使所选取的四个地点相距很近，分辨率提升机制仍然可以在任何位置都展现良 好的识别性能，而不会被不同位置的不同活动等多重因素干扰，展现了更高的分 辨率。
30

图3-6使用了分辨率提升机制后，系统在各个活动和位置上对应的PR, RE, Fl和
FPR0各项统计指标体现出系统的优异性和稳定性
此外，为实现一个全面的分析，本文采用以下应用广泛的统计指标：1)精确 率(Precision, PR)为TP/(TP +FP),真阳率(True Positive, TP)意味着将正 样本估计为正的个数，假阳率(False Positive, FP)指将负样本估计为正的个数， 2)召回率(Recall, RE)为TP/(TP + FN},假阳率(felse positive, FP)指将正 样本估计为负的个数，3)F1值(Fl-score)为2 * PR * RE/(PR + RE),是PR和 RE 结合的度量，4)假反例率(False Positive Rate, FPR)为FP/(FP + TN),真 阴率(True Negative, TN)指将负样本估计为负的个数。图3-6展示了上述四 个指标的统计结果，以此作为对人类活动和位置识别性能的评价。x轴上的20个 标签对应于四个位置上的五种活动。在图3-6中可以观到所有的PR、RE和Fl值 都在87%以上，平均精度为95.4%,且所有的FPR都低于0.6%,表明聚合CSI 所提供的信息能够对大部分活动和位置做出准确而全面的识别。
在目标位置估计中，常将位置标签转化为距离，计算平均定位误差(Average Localization Error, ALE),以评估位置估计的精确性。ALE的定义如下，其单位 为米：
ALE = ^Jg(li)~g(l；)^	(3-7)
其中N为测试集个数(N = 2000), |卜|孩为计算距离，乙和耳分别为预测的位置标 号和真实的位置标号，p(・)是根据图3-2将位置标签转换为空间坐标轴。根据式 (3-7),可计算出使用了分辨率提升机制的系统的ALE为0.043m,该系统足够精 确。
31

3.5.2聚合信道与单一信道对比
现有的Wi-Fi行为感知研究中往往只考虑单个信道，而本文使用了来自多个 相邻信道的聚合CSIo为了验证聚合CSI的有效性，如3.4.1所述，在不改变环 境的情况下，本节还进行了单个信道的对照实验，比较聚合信道和单个信道对实 验的影响。

图3-7使用单个信道时，不同位置的准确率混淆矩阵
图3-7展示了仅使用单个信道的系统在四个位置的准确率混淆矩阵。第一个 位置的准确率在79%到100%之间，第二个位置的准确率在68%到99%之间，第 三个位置的准确率在94%到100%之间，第四个位置的准确率在78%到98%之 间。可以看出，除了第三个位置，其他三个位置的准确率都比较低，而且稳定性 极差。这是因为所选的位置彼此相对较近，所以分辨率有限的系统容易因为位置 差异和活动频率差异，无法准确分辨各个活动之间的区别，出现对于某些活动的 识别错误的情况。
此外，在某些位置，“行走”和“跑步”是不容易区分的，这可能是因为它 们都是高频率的连续活动，导致单个信道的CSI所生成的特征谱图也较为近似。 由于单个Wi-Fi信道所提供的信道带宽有限，限制了其PDP的时间分辨率，从
32

而影响基于Wi-Fi的行为感知分辨率。当相邻位置之间的距离很小或几个活动相 似时，分辨率有限的系统将很难区分这些差异，因此仅提供单个信道将极大限制 系统的性能提升。然而，本文提出的分辨率提升机制并没有受到这些差异的影响, 证明了聚合信道的有效性。

Label
图3-8使用单个信道采集CSI,系统在各个活动和位置上对应的PR, RE, Fl和FPRo各
项统计指标体现出系统的不稳定性
此外，图3-8同样使用PR, RE, Fl和FPR衡量单个信道对系统的分类性能 产生的影响。其中，有些标签的PR, RE和Fl可以达到100%,而在其他一些位 置的活动只能达到近60%的精度。与图3-6相比，图3-8展示的系统性能波动很 大，也就是说，当同时获取人类活动和位置信息时，仅使用单一信道的系统性能 是不稳定的。
因此，结果表明，仅使用单信道时，系统精度明显降低。其中，使用聚合信 道的系统整体精度高达95.4%,而使用单一信道的系统的整体精度仅为86.5%o 由式(3-7)可知，单信道系统的平均定位误差为0.069m,同样比采用聚合信道的 系统粗糙。
3.5.3 CNN 与 LSTM 对比
表3-6两种方法对系统的训练时间和准确率的影响

训练时间
准确率
CNN
8834(s)
95.4%
LSTM
40216(s)
95.1%
33

本节设计了不同深度学习方法来评估它们对系统性能的不同影响，结果如表 3-6所示。使用CNN和LSTM的系统总体准确率分别为95.4%和95.1%,表明 CNN和LSTM都能成功地从图像中学习了关于目标行为的深度特征。得益于所 提出的系统采用聚合CSI的幅度和相位构造特征谱图，因此CNN和LSTM都可 以从谱图获取充足的特征信息，验证了系统的性能。这进一步表明了所提出的分 辨率提升机制对基于Wi-Fi的行为感知的有效性。
此外，深度学习方法的计算成本是一个普遍关注的问题。为了评估这两种方 法的时间复杂性，本节测量了实现人类状态估计所需的训练时间。如表3-6所示， LSTM的训练时间远远大于CNNo这是因为LSTM可以保存和编码活动的时间 状态信息，这需要花费更多的训练时间。一方面，LSTM的主要缺点是计算成本 非常高，另一方面分辨率提升机制将原始时变信号转换为特征谱图，最大限度地 提高CNN从特征谱图中学习特征的能力。因此，考虑到这两种方法准确率较为 近似，本文最终选择训练速度较快的CNN用于训练所构建的图像。
3.5.4分辨率提升机制与现有基准方法对比

图3-9两种方案下所有活动的准确率
为了演示本文提出的机制的有效性，将比较分辨率提升机制与Wi-Fi人体活 动识别的最新方法进行比较，验证二者的活动识别准确性。图3-9展示了使用分 辨率提升机制和基准方法ABLSTM下所有活动的准确率。采用ABLSTM的系
34
统总体准确率为88.6%,而采用分辨率提升机制的系统总体准确率为96.4%o可 以看到，所提出的机制在各个方面都优于ABLSTMo因为所提出的跨位置人类 活动识别场景要求高分辨率，在这种情况下，ABLSTM的性能无法充分满足场 景需求。特别是有些“跑步”的活动被识别为“行走”，而“站立”和“坐下”也 不易区分。这就是为什么ABLSTM在大多数活动中的准确性略逊一筹。
对比实验表明，分辨率提升机制能够更好地区分不同位置的不同活动，能够 更有效地消除这种位置影响。这是由于该机制使用聚合信道提高Wi-Fi信号带宽， 提升信号分辨率，便于分类器学习更丰富和完整的特征。
3.6本章小结
在本章中，提出了一种普遍适用于Wi-Fi目标行为感知的分辨率提升机制。 由于大多数基于Wi-Fi的目标行为感知技术旨在从根本上理解人类活动和人类 位置两个方面对接收信号的影响规律，因此本章使用一个跨位置的人体活动识别 系统作为研究案例。本章进行了两个对照实验。第一个实验进行了人类活动和位 置信息估计。实验结果表明，信道切换和聚合模块、特征提取模块和深度学习模 块都能提高系统性能，三者的结合能获得最大的性能增益。第二个实验则是当人 类所处的位置稍有不同时，对人类活动进行识别。在人类活动识别实验中，将最 先进的基于Wi-Fi人类活动识别方法作为对照实验，进行比较。使用分辨率提升 机制的系统可以达到96.4%的活动识别准确率，相比之下，使用最先进的方法而 没有分辨率改进机制的系统可以达到88.6%。实验结果表明，分辨率提升机制可 以适用于行为感知领域。
第四章多Wi-Fi协作下最佳感知链路选择机制
4.1密集Wi-Fi场景下最佳感知链路选择的意义
当下，为了满足日常工作、学习和生活的需求，Wi-Fi信号变得无处不在。在 家中、学校和购物中心等Wi-Fi的现实应用场景中，部署着大量Wi-Fi设备以保 证信号覆盖和通信质量。这些Wi-Fi设备之间形成的通信链路构成了复杂而又密 集的Wi-Fi环境。正因如此，一个真正的Wi-Fi环境会包含大量的Wi-Fi链路。 在这种有多个Wi-Fi设备的环境中，能够获取到的数据规模较大。一方面，这些 链路为基于Wi-Fi的行为感知提供了更多的信息量；另一方面，由于部分无线链 路的质量较差，且周围可能存在干扰，因此这些链路也夹杂了更多的环境噪声； 此外，有些Wi-Fi链路存在重复覆盖的区域，这些重复的链路只会提供相似的信 息，无需全部选择。
此时，如果要使用传统的机器学习方法用于感知目标行为，需要建立一个非 常复杂的神经网络以保证网络具有较强的学习能力。然而，训练这样一个网络需 耗费较长时间。如果在使用神经网络学习Wi-Fi环境信息之前，先人为挑选出合 适的链路则需要花费较多的精力，且效果可能不尽人意。这些问题限制了基于 Wi-Fi的行为感知技术在现实场景中的使用。因此，亟需设计出一种学习决策算 法，能够在当前时刻选择一个最优的Wi-Fi链路，使其具有感知复杂Wi-Fi环境 中目标行为的能力。
本章针对多商用Wi-Fi设备协作下，大量链路不足以完全表征活动目标状态 的问题，研究多Wi-Fi协作下最佳感知链路选择机制，通过智能决策，选择出最 能表征该Wi-Fi覆盖区域中目标行为、位置等情景信息的链路，提升基于Wi-Fi 的行为感知技术的感知精度。本章的具体研究内容如下：
本章提出了一种多Wi-Fi协作下最佳感知链路选择机制：首先构建一个深度 强化学习智能体，当目标位于不同的Wi-Fi信号覆盖区域时，将多条链路的CSI 作为智能体此刻的状态值，选取当前目标状态的标签作为智能体的奖励值，智能 地完成对当前的Wi-Fi链路的权重排序，并将该决策过程的输出值作为智能体的 动作值，从而由智能体选取最能表征该Wi-Fi覆盖区域中目标行为、位置等情景 信息的链路；提出一个“时域-频域-空间域”的特征提取模块，利用该链路的CSI 幅度和相位分别进行特征提取，获取与活动目标相关的特征值，生成包含丰富的 时域特征、频域特征和空间域特征的特征图像，作为后续神经网络的输入；提出
36
一个基于CNN的分类网络，利用神经网络构建Wi-Fi信号与目标状态的关系模 型，感知该区域的目标行为。
4.2机制设计

如图4-1所示，多Wi-Fi协作下最佳感知链路选择机制主要由以下模块组成: 一个数据处理模块，一个强化学习智能体和一个基于CNN的分类网络。
4.2.1数据处理模块
原始的CSI数据包含了幅度数据||H川和相位数据厶川。如2.2所述，由于不 同频率的目标行为对CSI幅度||H川和相位差△厶厲在时域的变化会产生不同的模 式，可用于捕捉相关的目标行为。首先利用相邻天线的CSI相位数据厶血计算相 位差AzHp得到多个子载波的CSI数据流［||^||,AzHz］=本章的数据处理模块包 括以下步骤：
(1)去噪：如3.2.2所述，PCA能够通过计算多个数据维度之间的相关性来 消除冗余噪声并保留相关成分，因此本章首先对多个子载波的CSI数据流
［||HZ||,AZHJ使用PCA,并保留第二个主成分的数据，得到基于PCA的去噪CSI 数据流在=［齢,环］,其中好和环分别是在时间步长为t时CSI幅度||H川和相位差 2Hi的第二个主成分。基于此，每个Wi-Fi链路的CSI都能够初步提取目标行 为相关的特征并去除无关的信息。
37
（2）归一化：为了减少计算成本，提高分类性能，本章还对数据集采用零均 值归一化法。具体来说，所提出的数据处理模块使用零均值和单位方差对CSI流 込进行归一化，得到0；:
0：=詈（；=1,2）,	（4-1）
其中，玮和卅分别表示专的均值和标准差。
422强化学习智能体
由于本章将Wi-Fi链路选择制定为一个顺序决策问题，因此相应的解决方案 可以通过强化学习来解决。基于此，本章设计了一个强化学习智能体。对于智能 体的设计需要考虑两方面因素。第一个因素在于Wi-Fi环境复杂多变，环境中目 标发生的微小位移都将对Wi-Fi信号产生巨大影响。因此，智能体需要敏锐感知 Wi-Fi环境中的情景信息。第二个在于因素在于Wi-Fi环境中包含大量的链路。 使用过多的链路不仅会引进过多的冗余信息，还可能包含环境噪音；使用过少的 链路则无法确定该链路是否能为Wi-Fi感知应用提供充足的目标行为信息。因此, 智能体需要一个适当的决策方式，筛选出最优的感知链路用于行为感知。
基于上述两个因素的综合考虑，所设计的智能体包括两个网络：一个是基于 LSTM的情景感知网络，包含一个观察网络和情景感知网络，用于观察当前环境 状态，将智能体的情景信息和历史状态编码成特征向量，帮助智能体从复杂的 Wi-Fi环境信息提取出有效的目标行为特征；一个是策略网络，它在每一步都从 预设的动作空间中生成合适的动作，该动作用于根据当前环境状态选择出一个最 优的链路用于后续的目标行为感知。具体设计如下：
首先使用神经网络将所探索的Wi-Fi环境信息©编码成特征向量。具体地说， 智能体始于一个基于LSTM的情景感知网络，该网络包含一个观测网络人和一个 情景感知网络兀，参数分别为0。和為。为了有效降低数据维度并简化训练过程， 智能体在基于LSTM的情景感知网络的开始阶段使用一组权重和偏置作为观测 网络九。在t时刻，智能体观察到状态：
= fo（.ot；6o'） = Wx + b,	（4-2）
其中兀为线性加权和函数，权重W和偏置0构成参数0。。
考虑到目标行为感知对Wi-Fi环境变化极为敏感，而多层LSTM模型能够学 习和识别其中的关键隐藏信息。因此，智能体还包含一个情景感知网络即在 观测网络之后使用三个LSTM层用于处理序列信息。智能体同时观察当前状态 “和之前的隐藏状态入_1，将其作为情景感知网络的输入，随后生成当前的隐藏 状态心：
38
ht = fh(ht> St； 8(1)。	(4-3)
随后，智能体将t时刻的特征向量输入到策略网络中，利用策略从动作空间 中产生一个合适的动作。此动作能够决定智能体在t + 1时刻的选择的链路。策略 网络由参数血构成的一个全连接层组成，并使用softmax激活函数输出每个动作 的概率值。动作空间〃覆盖所有Wi-Fi链路集合，即动作兔的生成表明智能体在 t时刻选择了与该动作相对应的链路。策略如下：
n(ut\ht; 0U) = softmax(Wht + b),	(4-4)
其中，n(ut\ht; 0u)为动作概率分布，softmaxQ)为softmax激活函数，"和b为 权重和偏置，共同构成参数盅。概率最大的动作Wt = argmaxuji(ut\ht-,9u)则视 为最优的动作。
4.2.3基于CNN的分类网络
所设计的基于CNN的分类网络沧的参数为為。当智能体执行了一系列相同 动作，即选择出一个恒定的链路后，分类网络会根据所选择的链路做出预测。当 从选择的链路2中得到两个CSI流0上丿后，利用离散小波变换(Discrete Wavelet Transform, DWT)从CSI的相位差和幅度中提取出时间频率特征y^，即智能体 利用选择的链路Z绘制t时刻的DWT谱图：
ytil =DWT^otl).	(4-5)
DWT谱图包含了丰富的与目标行为相关的时频信息。得益于DWT谱图，我们 可以将CSI的时序数据转化为时频图，并利用神经网络强大的处理图片信息的 能力，对时频图进行学习，以分析当前的目标行为。
随后，DWT谱图作为CNN分类网络的输入数据。设C(nc,sJ为特征映射个 数为检和核大小为Sk的卷积层，D为dropout层，P为最大池化层，则所设计的基 于CNN的分类网络可表示为：C(16,5) t D t P t C(32,5) t D t p t C(64,5) t D t P,即输入的DWT谱图依次进入多个C(nc,sk). D和P的处理。 其中，C(“c，sQ使用ReLU函数。
为了避免过拟合，在得到这些层所提取的特征图后，将其输入到一个全连接 层和一个dropout层。最后一层同样是一个全连接层，它使用softmax函数生成 各个分类标签的概率值，其预测分布为：
Pt=	^p)°	(4-6)
通过(4-6),得到了用户行为样本对应各个行为类别的概率分布。
39
4.3基于强化学习的智能链路选择策略
本章所提出的智能链路选择策略不仅需要使得强化学习智能体的奖励最大 化，同时应该尽量减少分类网络的损失。基于此，我利用REINFORCE算法更新 智能体的参数％ = {&。,為,九}，并使用误差反向传播算法对分类网络的参数為进 行优化。
由于奖励函数的目标是增加神经网络的置信度，也就是激励智能体寻找出信 息更丰富的链路，从而逐步提高模型的准确性。考虑到预测分布S与链路选择的 趋势相关联，因此选择利用s计算智能体的奖励。基于此，令智能体在上时刻收到 的奖励为：
Rt = Pt,gt —	>	（4-7 ）
其中，Pt,cZ为类别C?在t时刻的概率值，以为行为的真实值标签。
受本文第2.4.2节中，策略梯度的REINFORCE算法启发，我将智能体的目 标设为：
丿（％） = lueu 兀（"Is；盅）G,	（4-8 ）
其中，G是长期的折扣回报。对于第t时刻，该长期折扣回报的累积值可以表示 为：
Gt = Hk=oYk^t-k,	（4-9）
其中，y是折扣因子。由式（4-9）可以看出，参数在更新方向上的位移最大，因 此有利的行为可以获得最高的回报。
目标函数/（%）的梯度为：
刃（％） = Xueu 兀（u|s;%）%2o9 7i（u|s;%）G。	（4-10）
若采用蒙特卡罗采样法估计所求梯度，则式（4-10）可以转化为：
St=o log n（utik\stik; B^Gt，	（4-11）
其中，K为样本数，T是最后一个时刻。通过蒙特卡罗随机梯度下降，可以最小化 损失函数，即式（4-12）,用于更新参数％。
厶丿（％） ~ —^°9 7l（y-t,k\st,k>	（4-12）
我将损失定义为动作空间中每个动作（即对各个链路的选择）的二元交叉爛 损失的均值：
5（%）= -扭 f=Q£=o 碗血9兀（如），	（4-13）
40

其中，兔,i是第：条链路在上时刻的概率，碣是第i条链路在上时刻的真实值，只能为 0或者1。因此，智能体的损失为两种损失的加权总和：
Lagent (気)=血厶丿(％) +厶［/(%)，	(4-14)
其中，血是一个常数。
由于本章的出发点是基于Wi-Fi的目标行为感知，故除了智能体的损失，还 应考虑到行为标签对于损失函数的影响。因此，将CNN分类网络的损失定义为 每个行为的二进制交叉矯损失的平均值：

其中，n为行为的类别个数，円为第j类的概率，丙是丿•类的真实值，只能为0或者 lo
综上，模型的总目标是使包括智能体和CNN分类网络二者的损失函数最小 化：
LOSS=久2 厶agent(°7t) + 厶戸(％)，	(4-16)
其中，忑是一个常数。
4.4场景设置
4.4.1实验设置

图4-2 部署了多个Wi・Fi发射端的创新性场景
41
在本章的实验中，我使用两台小主机作为发射端，两台小主机作为接收端。 小主机均配备Intel 5300网卡，使用CSI Tool测量CSI。为了实现Wi-Fi多设备 协作，两个接收端创新性地实现同时接收两个发射端的数据包，从而形成四条 Wi-Fi链路。如图4-2所示，我将这些Wi-Fi链路包围的区域划分为16个位置, 目标在测试区域内进行“行走”、“跑步”、“站立”、“坐下”和“弯腰”等5项日 常活动。我在8m * 7m的房间里采集了 2749个CSI真实样本。以1949个样本作 为训练集，800个样本作为测试集。在测试集中，每个位置各有50个样本。归一 化后的CSI流作为强化学习智能体的输入数据，在基于LSTM的情景感知网络 中进行处理。
表4-1展示了基于LSTM的情境感知网络的结构。在从所选链路2中获得CSI 流of后，使用DWT图像作为基于CNN的分类网络的输入数据。基于CNN的分 类网络的结构如表4-2所示，多Wi-Fi协作下最佳感知链路选择机制的其他参数 见表4-3 o
表4-1基于LSTM的情境感知网络的结构
层数
名称
大小
步长
激活函数
1
LSTM
128
无
Tanh
2
LSTM
128
无
Tanh
3
LSTM
128
无
Tanh


表4-2基于CNN £
勺分类网络
层数
名称
大小
参数
激活函数
1
卷积层
5*5 (16)
步长=2
ReLU
2
最大池化层
2*2
步长=2
无
3
卷积层
5*5 (32)
步长=2
ReLU
4
Dropout 层
无
比例=0.3
无
5
最大池化层
2*2
步长=2
无
6
卷积层
5*5 (64)
步长=2
ReLU
7
Dropout 层
无
比例=0.3
无
8
最大池化层
2*2
步长=2
无
9
Dropout 层
无
比例=0.5
ReLU
10
全连接层
5
无
Softmax

42
表4-3多Wi-Fi协作下最佳感知链路选择机制的其他参数
参数
数值

0.1
久2
0.1
Dropout 率(y)
0.9
学习率（a）
0.0001
指数衰减率（仇）
0.9
指数衰减率（伤）
0.999
无穷小参数（w）
KT*
4.4.2案例设置
为了证明多Wi-Fi协作下最佳感知链路选择机制的可行性，本章对使用WiFi 链路的几种常见策略进行了比较。本章提出的策略和另外三种比较策略对应 以下四种情况：
案例1：使用多Wi-Fi协作下最佳感知链路选择机制选择的Wi-Fi链路。
案例2：使用两条正交的Wi-Fi链路。
案例3：使用所有的Wi-Fi链路。
案例4：使用随机一条链路。
在以上四种情况中，我选择不同的Wi-Fi链路作为活动识别的数据集。具体 来说，案例1利用多Wi-Fi协作下最佳感知链路选择机制分别智能地选择最优的 一条链路。案例2采用Wi-Fi感知技术中经典的“一发两收”，这在许多最新的 研究中得到了广泛的应用。案例3利用了所有的数据集。案例4则随机选择一条 链路。设计了上述四个案例后，我对每个案例都使用基于Wi-Fi的活动识别，进 行了相应的实验验证。
4.5结果分析
4.5.1数据可视化
接下来，本节将研究多Wi-Fi协作下有效链路选择机制所提取的人类活动关 联特性，这些特性支撑了该机制在基于Wi-Fi的活动识别中的表现。t-SNE算法 是为实现高维数据的可视化而开发的一种技术［旳。如图4-3所示，我绘制了不同 案例下，CNN最后一层特征生成的t-SNE嵌入。t-SNE嵌入倾向于将高度相似的 活动特征映射到相近区域，因此可以利用t-SNE嵌入来判断各个活动的相似情 况，通过图形可视化估计活动识别的性能。
43



t-SNE embeddings of the outputs
(b) 案例2
44
1.0
0.8
0.6
0.4
0.2
0.0
1.0
0.8
0.6
0.4
0.2
0.0






































1.0
0.8
0.6
0.4
0.2
0.0
1.0
0.8
0.6
0.4
0.2
0.0
t-SNE embeddings of the outputs
0.0	0.2	0.4	0.6	0.8	1.0

















(c) 案例3
t-SNE embeddings of the outputs












Walk
Run
Stand
Sit
Bend
(d) 案例4
图4-3不同案例下，CNN最后一层特征生成的t-SNE嵌入
45

图4-3(a)给出了案例1中CNN的特征，正如所预期的，在多Wi-Fi协作下 最佳感知链路选择机制的帮助下，图4-3(a)中五个活动类别的区分度都是显著的。 通过数据可视化，可以看到t-SNE算法对这些状态产生了类似的嵌入，这很好地 验证了机制的性能。所提出的机制能够为每个活动选择最佳Wi-Fi链路的原因在 于，所选链路对相似的用户行为能够获得的期望回报非常接近。得益于多Wi-Fi 协作下最佳感知链路选择机制对场景中的Wi-Fi链路完成智能决策，获取到最能 表征用户行为的Wi-Fi链路，从而正确提取用户行为特征，为基于Wi-Fi的行为 感知带来精度的提升。
图4-3(b)显示了案例2中CNN的特征。在现有的基于Wi-Fi的人体感知技 术中，使用“一发两收”来获取CSI并感知目标行为已经被证明是有效的。因此， 可以看到大多数类别的特征是相当明显的。但在现实中，这样的链路并非最优选 择，且极大地受到了 Wi-Fi设备摆放位置的束缚。同时，这样的Wi-Fi链路也并 不能适用于所有样本。可以看出，案例2并不擅长区分类似的活动，如“行走” 和“跑步”，“坐下”和“弯腰”。因此，多Wi-Fi设备协作的作用与单一的“一发 两收”设备相比，更能为Wi-Fi行为感知提供更高的精度。而在这种多Wi-Fi协 作场景下，智能地选择最佳感知链路更为合理。
图4-3(c)显示了案例3中CNN的特征。可以发现使用所有的Wi-Fi链路表 现优于案例17。使用所有的Wi-Fi链路能够帮助系统获取到最全面的关于目标 行为特征的信息，因此，能够为基于Wi-Fi的行为感知带来更丰富的信息量。但 从深度学习的角度来看，使用过多的特征会增加计算复杂度和时间复杂度。此外， 冗余的信息和噪音也会降低感知精度。因此，如何进行链路选择，取其精华，弃 其糟粕，则至关重要。
图4-3(d)显示了案例4中CNN的特征。相比其它案例而言，案例4的表现 是最糟糕的，原因在于其随机选择了任意一条链路，而未考虑该活动在当前状态 下对该链路的CSI的影响。由于目标在Wi-Fi环境中对Wi-Fi链路会产生较大影 响，不同位置和状态的目标对不同链路的影响不一致，无法简单固定或者任意使 用一条链路完成对目标行为的感知。因此，对于多条Wi-Fi链路场景，选取合适 的决策手段尤为关键。
46
4.5.2性能分析



图4・4不同案例下，四个区域的准确率
在图4-2中，为了比较智能选择链路与传统的人工选择链路的区别，我按照 案例2的传统方法将16个位置划分为4个区域。这种位置划分方法是基于每个 位置都可以被人为地分配到两个最近的正交Wi-Fi链路，这是案例2的典型场 景。图4-4显示四个区域中不同案例的准确率。
通过四种案例的比较，可以看出案例1在使用了多Wi-Fi协作下最佳感知 链路选择机制后，取得了较好的性能，也充分验证了该机制为基于Wi-Fi行为感 知技术带来了精度上的提升。不同区域下的Wi-Fi情景信息不同，环境中的WiFi 信号也随着目标行为的改变不停地变换着，所提出的强化学习智能体能够在 与Wi-Fi环境的交互中不断学习，得到一个最大化的长期收益。这个学习策略实 现了对Wi-Fi状态进行自适应的判别，并基于此做出对于链路选择的决策，智能 化地完成对有效信息的筛选和无效信息的过滤，从而有效地完成链路管理，保证 了在各个区域都得到最佳精度。
案例2需要进行基于位置的人工链路选择，这消耗了大量人为的标注时间。 此外，传统的“一发两收”在过往的基于Wi-Fi感知应用中表现良好，但由图4- 4可知，其仍非最佳策略，在某些场景下依然可以通过多Wi-Fi协作实现感知精 度的提升。尤其是在与案例1进行比较，说明利用所提出的机制智能地选择一最 佳条Wi-Fi链路，将优于使用传统的两条正交链路。对于某些位置的某些活动的 样本，其对Wi-Fi信号的影响可能需要多个设备协作实现，而选择固定的“一发
47

两收”设备用于行为感知会存在较大的偶然性。因此，多Wi-Fi设备协作的作用 与使用单一的“一发两收” Wi-Fi设备相比，更能为基于Wi-Fi的行为感知带来 精度的提升。对于这种多Wi-Fi协作场景，灵活地选择最佳感知链路更为合理。
案例3使用了所有的Wi-Fi链路，这种方式在各个位置都能够实现较好的 分类效果，但不利于分类器处理Wi-Fi环境非常复杂的情况。在复杂Wi-Fi环境 下，大量Wi-Fi设备构成的Wi-Fi链路纵横交错，包含了大量的冗余信息和环境 噪声。这种情况下，倘若直接使用所有链路信息，将影响分类器性能。常见的处 理方式是在原始数据输入分类器前先进行特征提取和去噪环节，但所使用的特征 提取方法和去噪方法无法适用于每一种场景。因此，更优的策略是根据Wi-Fi环 境信息，将当前状态映射成相应的决策，实现智能体对链路的动态筛选。
案例4效果最差，说明链路中存在一定的无用链路。由于目标在Wi-Fi环境 中的变化会对Wi-Fi信号产生较大影响，处于不同位置和保持不同状态的目标对 不同链路的影响不一致，故无法简单地固定或者任意地使用一条链路完成对目标 行为的感知。因此，选取合适的链路决策方法对于感知精度的提升显得尤为重要。

图4-5 不同案例下，总体准确率以及这些案例使用的Wi-Fi链路数量
图4-5描述了四种案例的总体准确率以及这些案例使用的Wi-Fi链路数量。 如图4-5所示。四种案例的总准确率分别为90.50%、87.75%、91.25%和81|.00%。 显而易见，案例1和案例3的性能都很出色。而在进行链路选择后，案例1在平 均每个样本只需要依赖一条Wi-Fi链路，就可以获得优异的性能。而其他四个案
48

例分别需要两条、四条和一条链路完成感知。因此，使用不合适的链路无法为基 于Wi-Fi感知的应用提供充足的目标行为信息；使用过多的链路也可能会引进过 多的冗余信息，还可能包含环境噪音，也无法达到最优性能。综上，智能体需要 一个适当的决策方式，筛选出真正适用的链路用于行为感知。
实验结果证明了所提出机制的有效性。通过该策略，即使在大规模部署WiFi 设备的情况下， 我们也可以有效地选择最优链路，从而降低计算复杂度，提高 性能。因此，多Wi-Fi协作下最佳感知链路选择机制具有重要的研究意义。
4.5.3网络参数选择分析

图4-6 不同网络参数应用于各个案例后的活动识别准确率
图4・6展示了三种不同网络参数应用于各个案例后的活动识别准确率。其中, “3+1”表示CNN分类网络中使用三个卷积层和一个全连接层，“2+1”表示CNN 分类网络中使用两个卷积层和一个全连接层，“1+1”表示CNN分类网络中使用 一个卷积层和一个全连接层。
(1) 对于不同案例的比较。
从图中可见，案例3在使用了不同网络参数后，效果都是最佳的。原因在于 该案例使用的链路数最多，充分利用所有的CSI数据。
49
案例1仅使用一条链路，便可达到案例3的近似效果；且在CNN使用三个 卷积层和CNN使用一个卷积层时，案例1与案例3的效果差距极小。因此，在 环境条件变化的影响下，案例1使用的最佳感知链路动态智能选择机制依然能够 依靠一条链路有效保障系统的感知精度。
使用两条正交链路的案例2能够有效感知链路涵盖区域内的用户行为信息， 但未达到最佳性能。原因在于这种方式人为固定了两条正交链路，但这两条链路 中可能存在噪声干扰，且在Wi-Fi环境不断变化的场景中该正交链路无法保障在 任意时刻都能最好地映射用户行为特征。此外，这种人为固定链路的方式需要进 行手动标注链路，人效较低，不利于Wi-Fi设备大规模部署的场景。
在三种网络参数搭建的模型中，案例4效果皆为最差。可见受Wi-Fi环境影 响，随机选取链路会使系统精度下降。
(2) 对于不同网络参数的比较。
使用了三个卷积层和一个全连接层的CNN在四个案例均达到最优感知性能。 在卷积层个数小于3时，随着卷积层数目的减小，系统精度逐渐下降。在卷积层 个数大于3后，由于网络层数过深，模型训练过程艰难：一方面是由于网络参数 的增加导致反向传播梯度消失；另一方面是因为信息出现“瓶颈”，所提取出的 信息有限，引发性能倒退。因此，本文在CNN分类网络中选择使用三个卷积层 和一个全连接层，用于行为感知，提升感知精度。
4.6本章小结
针对Wi-Fi设备密集部署的环境，本章提出了一种多Wi-Fi协作下最佳感知 链路选择机制，用于从多个Wi-Fi链路中选择出最佳Wi-Fi链路的CSI,感知环 境中的目标行为信息。所提出的机制具有以下优点：无需手动选择Wi-Fi链路； 利用即时奖励和长期回报作为训练过程的监督数据，识别准确率更高；CNN使 用的数据集维度更少，识别过程更高效。行为识别实验结果表明，在Wi-Fi设备 密集部署的环境中，我的解决方案是准确和有效的。未来，可以将该机制用于更 多基于Wi-Fi的目标行为感知应用中。
50
第五章总结和展望
5.1论文工作成果总结
随着越来越多无线智能终端的涌现，Wi-Fi逐渐变得无处不在，基于Wi-Fi 的行为感知技术也得到了众多学者的关注。利用普通Wi-Fi设备获取Wi-Fi多径 叠加信号的CSI,捕捉和处理Wi-Fi信号经由环境中人或物体的活动引起的信号 多径变化，建立无线信号与目标状态(包括人或物体的活动、位置等)的映射关 系，能够有效地感知环境中人或物体的状态变化。但受限于Wi-Fi的单个信道带 宽有限、多径效应和子载波数量有限等局限性，基于Wi-Fi的行为感知精度有待 提升。
基于此，本文围绕基于Wi-Fi的行为感知系统中精度提升技术研究展开，所 研究内容包含基于Wi-Fi行为感知分辨率问题、密集Wi-Fi场景下链路选择问题。 本文的主要工作内容包含以下方面：
(1) 研究了基于Wi-Fi的行为感知分辨率提升机制。
要实现精确的Wi-Fi目标行为感知，首先要提高Wi-Fi信号的多径分辨率。 CSI计算所得的多径到达时间分辨率由Wi-Fi信号带宽决定，所以该时间分辨率 下对应的Wi-Fi多径长度的差值受信号带宽的影响，从而活动目标状态变化的分 辨率也同样受到信号带宽影响。然而目前的商用Wi-Fi网卡提供的单个信道带宽 有限，分辨率不足以区分细微的目标状态变化。因此，本文针对行为感知技术Wi- Fi信号多径分辨率不足的问题，研究多信道快速切换及聚合机制，通过聚合的方 式提高信号带宽，达到提升分辨率的目的。具体研究内容如下：
提出多信道快速切换及聚合算法，通过多Wi-Fi信道快速切换机制在极短的 时间间隔内从多个相邻Wi-Fi信道中采集CSI数据，同时使用确认和重传机制避 免在高速的信道切换中发生丢包的现象，然后通过相邻Wi-Fi信道聚合机制获得 聚合信道的CSI,把Wi-Fi信道的带宽扩展为可切换信道的全部带宽；提出一个 “时域-频域-空间域”的特征提取模块，对聚合信道的CSI幅度和相位分别进行 特征提取，获取与活动目标相关的特征值，生成包含丰富的时域特征、频域特征 和空间域特征的特征图像，作为后续神经网络的输入；提出一个神经网络模块， 利用神经网络构建高时间分辨率信号与目标行为的关系模型，感知目标行为。
为了验证所提出机制，本文构建了一个CLHAR场景。实验结果证明，即使 所选取的四个位置相距很近，分辨率提升机制仍然可以在任何位置都展现良好的 识别性能，而不会被不同位置的不同活动等多重因素干扰，展现了更高的分辨率。
51
(2) 研究了多Wi-Fi协作下最佳感知链路选择机制。
收发链路中，多个子载波上的CSI能够刻画信号的多径传播效果，但由于单 个链路中子载波数量有限，要使得基于Wi-Fi目标行为感知技术的精度得到提升, 链路覆盖的范围应足够全面。现有Wi-Fi感知技术，都依赖于一个发送设备和若 干个接收设备所建立的通信链路来获取CSI,忽略了现实世界Wi-Fi设备大规模 部署的场景。因此，本文针对多商用Wi-Fi设备协作下，众多链路不足以完全表 征活动目标状态的问题，研究多Wi-Fi协作下最佳感知链路选择机制，智能地选 取最能表征该区域中目标姿态、活动和位置等情景信息的链路，达到提升Wi-Fi 感知技术的感知精度的目的。具体研究内容如下：
构建深度强化学习智能体，当目标位于不同的区域时，将多条链路作为系统 在智能体的状态，利用目标状态标签作为智能体的奖励值，智能化地对多条链路 进行权重排序，该排序过程作为智能体的动作，并通过智能选取最能表征该区 域中目标姿态、活动和位置等情景信息的链路；提出一个“时域-频域-空间域” 的特征提取模块，利用该链路的CSI幅度和相位分别进行特征提取，获取与活动 目标相关的特征值，生成包含丰富的时域特征、频域特征和空间域特征的特征图 像，作为后续神经网络的输入；提出一个神经网络模块，利用神经网络构建信号 与目标状态的关系模型，感知该区域的目标行为。
为了验证所提出机制，本文部署了一个包含多Wi-Fi发射端的创新性场景。 实验结果表明，在进行智能链路选择后，所提出的机制在平均每个样本只需要依 赖一条Wi-Fi链路的情况下，就可以获得优异的性能。
5.2未来工作展望
虽然基于Wi-Fi的行为感知技术发展迅猛，本文也在基于Wi-Fi的行为感知 精度研究方面取得了一些研究成果，但作者的研究时间有限，一系列研究工作仍 有提升的空间。在此进一步提出一些未来可进行的研究工作：
(1) 本文为了验证所提出的感知精度提升机制的有效性，选择了在同一个实 验环境中完成对实验组和对照组的比较验证。由于迁移学习已被证明能够在基于 Wi-Fi行为感知中解决多环境学习的问题，因此后续可以将迁移学习与所提出机 制结合，完成对不同实验场景中精度提升机制的探索。
(2) 本文所提出的实验是针对单人进行验证的，未来还可以对基于Wi-Fi行 为感知中多人感知进行探索。由于Wi-Fi信号存在多径效应，环境中移动目标越 多，信号特征越复杂。因此，想要有效完成多人感知还需要做更深入的研究，提 取出不同的人对于信号的不同影响，从而实现特征分离。
52
(3) 对于本文所提出的最佳感知链路选择机制，未来还可以在更多Wi-Fi设 备协作的场景下进行验证，并进一步完善智能体的链路选择结果以更好地提升系 统性能，例如，根据实际状态智能地选择若干条最优的链路簇，进一步提升密集 Wi-Fi场景的行为感知精度。
53
参考文献
[1] 薄涛.格斗空战行为建模技术研究[D],湖南：国防科学技术大学,2002.
[2] 靳梦茜.基于WoT的智能家居系统的研究与优化[D],北京：北京邮电大学, 2016.
[3] Qian K，Wu C5 et al. Inferring Motion Direction using Commodity Wi・Fi for Interactive Exergames [A]. // Proceedings of the 2017 {CHI} Conference on Human Factors in Computing Systems [C], New York: ACM Press, 2017: 1961— 1972.
[4] Alemdar H, Ersoy C. Wireless sensor networks for healthcare: A survey [J]. Computer Networks, 2010, 54 (15): 2688-2710.
[5] 刘倩茹.基于多传感器的智能全自动宠物排便清理装置[J].河南科技,2020, 000 (004): 51-53・
[6] Chen L, Hoey J，Nugent C D, et al. Sensor-Based Activity Recognition [J]. IEEE Transactions on Systems Man & Cybernetics Part C, 2012, 42 (6): 790-808.
[7] Korany B? Cai H9 Mostofi Y. Multiple People Identification Through Walls Using O隹The-Shelf WiFi [J]. IEEE Internet of Things Journal, 2020, PP (99): 1-1.
[8] Fleuret F, Berclaz J, Lengagne R, et al. Multicamera people tracking with a probabilistic occupancy map [J]・ IEEE Transactions on Pattern Analysis & Machine Intelligence, 2008, 30 (2): 267.
[9] Ying W Huang T S, Mathews N. Vision-Based Gesture Recognition: A Review [A], // Proceedings of the International Gesture Workshop on Gesture-Based Communication in Human-Computer Interaction [C]3 Springer Berlin Heidelberg: Springer, 1999: 103-115.
[10] Herath S, Harandi M, Porikli F. Going deeper into action recognition: A survey [J], Image and Vision Computing, 2017, 60: 4-21.
[11] Wang L, Chen X Guo Z? et at Generalizing Monocular 3D Human Pose Estimation in the Wild [A]. // 2019 IEEE/CVF International Conference on Computer Vision Workshops [C], Piscataway: IEEE, 2019: 4024-4033.
[12] Guler R A, Neverova N, Kokkinos L, et al. DensePose: Dense Human Pose Estimation in The Wild [A]. // 2018 IEEE/CVF Conference on Computer Vision and Pattern Recognition [C], Piscataway: IEEE, 201 & 7297-7306.
54
[13] Cao Z, Simon T, Wei S-E, et al. Realtime Multi-Person 2D Pose Estimation using Part Affinity Fields [A]. // 30th IEEE Conference on Computer Vision And Pattern Recognition [C]3 Piscataway: IEEE, 2017: 1302-1310.
[14] Yan S, Xiong Y, Lin D. Spatial Temporal Graph Convolutional Networks for Skeleton-Based Action Recognition [A]. // Proceedings of the Thirty-Second {AAAI} Conference on Artificial Intelligence [C]5 Palo Alto: AAAI Press, 2018: 7444-7452.
[15] Weichert F, Bachmann D, Rudak B? et al. Analysis of the Accuracy and Robustness of the Leap Motion Controller [J]. Sensors, 2013, 13 (5): 6380-6393.
[16] Zhang 乙 Microsoft Kinect Sensor and Its Effect [J]. IEEE Multimedia, 2012, 19 (2): 4-10.
[17] Zhao M, Li T? Abu Alsheikh M，etal. Through-Wall Human Pose Estimation Using Radio Signals [A]. // 2018 IEEE/CVF Conference on Computer Vision and Pattern Recognition [C]5 Piscataway: IEEE, 2018: 7356-7365.
[18] Zhao M, Tian y Zhao H, et al. RF-Based 3D Skeletons [A]. // Proceedings of the 2018 Conference of the {ACM} Special Interest Group on Data Communication [C], New York: ACM Press, 2018: 267-281.
[19] Bo C, Jian X, Li X 乂 et al. You're driving and texting: detecting drivers using personal smart phones by leveraging inertial sensors [A]. // International Conference on Mobile Computing & Networking [C]： New York: ACM Press, 2013:199-202.
[20] Harrison C, Tan D S, Morris D. Skinput: Appropriating the Body as an Input Surface [A]. // Proceedings of the 28th International Conference on Human Factors in Computing Systems [C], New York: ACM Press, 2010: 453-462.
[21] Liu J, Liu H, Chen Y et al・ Wireless Sensing for Human Activity: A Survey 卩]. IEEE Communications Surveys & Tutorials, 2020, 22 (3): 1629-1645.
[22] A1-Qaness M, Aziz M, Kim S, et al. Channel State Information from Pure Communication to Sense and Track Human Motion: A Survey [J]. Sensors, 2019, 19(15):3329=
[23] Ali K, Liu AX, Wang W, et al. Keystroke Recognition Using WiFi Signals [A]. // International Conference on Mobile Computing & Networking [C], New York: ACM Press, 2015: 90-102.
55
[24] Han C, Wu K, Wang 乂 et al. WiFall: Device-free fall detection by wireless networks [A]. // 2014 {IEEE} Conference on Computer Communications [C], Piscataway: IEEE, 2014: 271-279.
[25] Zou % Liu W, Wu K, et al. M-Fi Radar: Recognizing Human Behavior with Commodity Wi-Fi [J]. IEEE Communications Magazine, 2017, 55 (10): 105-111.
[26] Tan S, Yang J. WiFinger: leveraging commodity WiFi for fine-grained finger gesture recognition [A]. // Proceedings of the 17th {ACM} International Symposium on Mobile Ad Hoc Networking and Computing [C]5 New York: ACM Press, 2016: 201-210.
[27] Zhang F, Niu K, Xiong J9 et dl・ Towards a Diffraction-based Sensing Approach on Human Activity Recognition [J]. Proceedings of the ACM on Interactive, Mobile》 Wearable and Ubiquitous Technologies, 2019, 3 (1): 1-25；
[28] Wu C, Zhang F, Hu Y, et al. GaitWay: Monitoring and Recognizing Gait Speed Through the Walls [J]. IEEE Transactions on Mobile Computing, 2020, PP (99): 1
1.
[29] Arshad S, Feng C, Liu Y, et al. Wi-chase: A WiFi based human activity recognition system for sensorless environments [A]. // 2017 IEEE 18th International Symposium on 11 World of Wireless, Mobile and Multimedia Networks [C], Piscataway: IEEE, 2017: 1-6.
[30] Qian K? Wu C, Yang Z5 et al. Decimeter level passive fracking with wifi [A]. // Proceedings of the 3rd Workshop on Hot Topics in Wireless [C], New York: ACM Press, 2016: 44-48.
[31 ] Qian K, Wu C, Yang Z, et al. Widar: Decimeter-Level Passive Tracking via Velocity Monitoring with Commodity Wi-Fi [A]. // Proceedings of the 18th {ACM} International Symposium on Mobile Ad Hoc Networking and Computing [C], New York: ACM Press, 2017: 6:1-6:10.
[32] Li X, Zhang D, Lv Q, et al. Indo Track: Device-Free Indoor Human Tracking with Commodity Wi-Fi [J]・ Proceedings of the ACM on Interactive Mobile Wearable and Ubiquitous Technologies, 2017, 1 (3): 1-22.
卩3] Zhang F, Zhang D, Xiong J, et al. From Fresnel Diffraction Model to Fine-grained Human Respiration Sensing with Commodity Wi-Fi Devices [J]. Proceedings of the Acm on Interactive Mobile Wearable & Ubiquitous Technologies, 2018, 2 (1): 1-23.
56
[34] He Z5 Guo L, Lu Z, et al. Contact-Free In-Home Health Monitoring System with Commodity Wi-Fi [A]. // 2019 IEEE International Conference on Communications Workshops [C], Piscataway: IEEE, 2019: 1-6.
[35] Wang X5 Yanc C, Mao S. TensorBeat: Tensor Decomposition for Monitoring MultiPerson Breathing Beats with Commodity WiFi [J], Acm Transactions on Intelligent Systems & Technology, 2017, 9 (1): 8.1-8.27.
[36] Wu Z3 Wang Z，Lam J, et al. FreeSense: A Robust Approach for Indoor Human Detection Using Wi-Fi Signals [J]. Proceedings of the ACM on Interactive, Mobile, Wearable and Ubiquitous Technologies, 201 & 2 (3): 143:1-143:23.
[37] Xie X Zhang Y, Liando J C? et al. SWAN: Stitched Wi-Fi Antennas [A], // Proceedings of the 24th Annual International Conference on Mobile Computing and Networking [C]5 New York: ACM Press, 2018: 51-66.
[38] Hei	Yuan R, Li X, et al. NLOS Identification and Mitigation Based on Channel
State Information for Indoor WiFi Localization [J]. IET Communications, 2016,11
(4) : 531-537.
[39] Soltanaghaei E, Kalyanaraman A, Whitehouse K. Poster: Improving Multipath Resolution with MIMO Smoothing [A]. // Proceedings of the 23rd ACM Annual International Conference on Mobile Computing and Networking [C], New York: ACM Press, 2017:585-587.
[40] Khalilsarai M B? Gross B, Stefanatos S, et al. WiFi-Based Channel Impulse Response Estimation and Localization via Multi-Band Splicing [A], // 2020 IEEE Global Communications Conference [C], Piscataway: IEEE, 2020: 1-6.
[41] Xiong J, Sundaresan K, Jamieson K. ToneTrack: Leveraging Frequency-Agile Radios for Time-Based Indoor Wireless Localization [A]. // Proceedings of the 21st Annual International Conference on Mobile Computing and Networking [C]? New York: ACM Press, 2015: 537-549.
[42] Halperirr D, Hu W, Sheth A, et al. Tool release: gatiiering 802J In traces with channel state information [J]. Acm Sigcomm Computer Communication Review, 2011,41 (1): 53-53.
[43] Goldsmith A. Wireless Communications [M]・人民邮电出版社，2007.
[44] Tan J K. An adaptive Orthogonaly Division Multiplexing baseband modem for wideband wireless communication [J]. Massachusetts Institute of Technology, 2007.
57
[45] Ni L, WU K, Zhou Z, et al. We can hear you with Wi-Fi! [A]. // Proceedings of the 20th ACM Annual International Conference on Mobile Computing and Networking [C]9 New York: ACM Press, 2014: 593-604.
[46] Wu X, Chu Z9 Yang P, et al.TW-See: Human Activity Recognition Through the Wall with Commodity Wi-Fi Devices [J]・ IEEE Transactions on Vehicular Technology, 201& PP (1): 1-1.
[47] Speth Ma Fechtel S A, Fock G, et al. Optimum receiver design for wireless broadband systems using OFDM. I [J]. IEEE Transactions on Communications, 1999, 47(11): 16684677.
[48] Gjengset J, Xiong J, Mcphillips G, et al. Phaser: Enabling phased array signal processing on commodity WiFi access points [A]. // Proceedings of the 20th ACM Annual International Conference on Mobile Computing and Networking [C], New York: ACM Press, 2014: 153-164.
[49] Christopher	Olah. Understanding LSTM Networks [EB/OL].
https://colah.github.io/posts/2015-08-Understanding-LSTMs/, 2015-08-27.
[50] Sutton R? Barto A. Reinforcement Learning: An Introduction [M]. MIT Press, 199&
[51] Williams, Ronald J. Simple Statistical Gradient-Following Algorithms for Connectionist Reinforcement Learning [J]. Machine Learning, 1992, 8(3-4):229- 256.
[52] Foudnstone・ Getting Started with LORCON [EB/OL]. http://blog.opensecurityresearch.com /2012/09/getting-started-with-lorcon.html/, 2012-09.
[53] Chen Z, Zhang L, Jiang C, et al. WiFi CSI based passive human activity recognition using attention based BLSTM 卩].IEEE Transactions on Mobile Computing, 2018: 18(11): 2714-2724.
[54] Volodymyr, Mnih, Koray, et al. Human-level control through deep reinforcement learning [J]. Nature, 2015: 518(7540): 529-533.
58
