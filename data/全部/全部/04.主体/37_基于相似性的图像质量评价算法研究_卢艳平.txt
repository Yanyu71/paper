

第一章绪论
本章主要针对本文所研究的图像质量评价领域和这个领域的研究现状做简单的背景 介绍，并逐步的引入本文的研究内容和意义，最后简述本文的组织结构。
1.1课题背景和意义
网络的发展越来越迅速，随之而来的多媒体方面的需求也在飞快的增长。现在的人类 时刻都接触作为多媒体信息重要组成部分的图像和视频，而视频可以看成是一帧一帧的图 像。所以对于图像的研究也是对于视频研究的基础。在FI益数字化的今天，数字图像从它 诞生的那一刻起到现在发挥着越来越来越重要的作用⑴。如伽马射线成像图像经常被用在 核医学和天文观测领域上，帮助人们诊断一些难以人眼去感知的疾病或者探测宇宙星空的 奥秘。X射线成像图像也常用在医学和工业上，帮助人们诊断身体内部疾病和检测短路缺 陷。可见光和红外波段成像，由于其能够感受或者见到更是人们最熟悉的，在电子监控、 车牌识别、工业生产方面，日常生活方面发挥着重要的作用。这些都是直接获得的图像， 为了达到一定的目的我们还需要对图像进行处理，来得到我们想要的信息。数字图像处理 包含很多方面，如图像增强、滤波、釆样、编码等。像获取数字图像的采样、编码，减少 图像体积的压缩，传输和图像的存储以及在数字图像的展示过程中，由于相关处理办法以 及设备的局限性，这些措施必然会带来图像的失真现象，从而造成图像质量的下降闵。可 察觉的图像失真不仅会影响人眼视觉系统的观看感受，在专业领域，如气象、医学、军事 等，图像质量的失真对判定结果的精确性影响极为重大且可能引起较大的失误和损失。所 以，如何准确地评价图像质量显得很重要。图像质量的评价结果也可以作为一个指标来评 判压缩算法和增强算法等的好坏，而且也是改进某些图像算法的一个指标〔2］。
人眼是图像的最终接收者，因此主观的图像质量评价（通过人眼观看图像，并对图像 根据自己的主观感受进行打分）方法更加符合图像真实的质量。对于图像的主观质量评价, 一开始各个研究者都根据自己的情况，选择格式各样的图片以及各种环境，进行评价的实 施。没有统一标准的结果，往往不使人信服。后来，ITU-R标准组织规定了主观质量评价 的一系列的方法，包括要求人要在特定的环境下，测试采用标准的图像库，以及采用同一 打分规范等［3】。虽然图像的主观质量评价方法被认为是准确和可靠地，但是主观质量质量 评价方法费时，费力，并且评价者也很容易受到周围环境和其自身情绪的影响，使得评价 的结果不稳定，而且主观评价的方式无法应用的实际的实时系统中囹。近年来，很多的图 像的客观质量评价这种能够通过提取图像中的一些特征来自动的对图像进行评价的方法 不断的涌现。
图像的客观质量评价是指对图像的亮度色度特征等进行分析和建模并结合人类视觉
北京邮电大学工程硕I:学位论文 系统对图像的感知特性，通过一定的数学方法和信号处理方法或者机器学习进行样本训练 等来实现对图像的质量进行自动的打分。王周等人按照能够获得原始参考图像的信息多少 把图像的客观质量评价分为三种，分别为全参考(Full Reference, FR)、半参考(Reduce Reference, RR)和无参考(No Reference, NR)图像质量评价方法⑸。
全参考图像质量评价方法依照完整的原始参考图像，使用的较多的方法是分别计算原 始图像与失真图像之间某个特征或者某些特征或者直接采用两幅图像素域的亮度或者对 比度，通过比较这些特征之间的差别或者联合差别，来得到失真图像的最终质量分值。由 于只能获得原始图像的部分信息，如原始图像的傅立叶变换或DCT变换小波变换之后的 结果等，部分参考图像就是利用参考图像的所能获得的部分信息(小波变换、傅里叶变换 等)和提取失真图像的相对应信息对失真图像进行最终质量评分。在实际很多情况下，往 往很难获得失真之前的图像，无参考图像质量评价方法就是完全不利用原始图像中的任何 信息对图像进行评价的方法。虽然图像质量评价领域，已经有了飞速的发展，有了一些非 常成熟的算法，但是这些算法大都是在某一些失真类型或者某一个图像标准数据库上有较 好的效果，并且有的方法虽然评价的结果非常接近人眼的特性但时间消耗很大，完全没有 办法应用要求实时的系统中。总之，已有图像质量评价方法在整体的评估上离人眼的视觉 感知特性和图像的主观质量评价也有很大的差距，这就激励我们进一步的去探讨更加有效 的图像质量评价方法。而且随着人对色彩和亮度的要求越来越高，能够反映大自然真实色 彩的高动态图像也逐渐的广泛的应用，为了能在正常设备上显示，高动态图像必须经过色 调映射器进行转换，转换后的图像由于动态范围的变化，必然会带来一定的失真回。对转 换后的图像的质量进行准确的评价，也显得尤其的重要。本文基于以上，对图像的质量评 价算法进行研究。
1.2图像质量评价研究现状
网络的发展越来越迅速，紧跟着多媒体方面应也越来越广泛，由于相关处理办法以及 设备的局限性，必然会带来图像的失真现象，从而造成图像质量的下降。图像质量的评价 也显得越来越重要。图像评价方法有客观质量评价与主观质量评价两大类。
主观评价方法是通过人眼观看图像，并对图像根据评价人员自己的主观感受进行打分。 2002年，国际电信联盟无线电通信组ITU-R公布了标准BT.500-H,对主观评价方法进 行了分类并做了相应方法实施方法的标准化规定⑺。根据国际标准BT.500-11的建议，主 观评价的方法分为：双刺激损伤测量法(Double Stimulus Impairment Scale, DSIS)、双刺 激连续质量测量法(Double Stimulus Continuous Quality Scale, DSCQS)、单刺激测量法 (Single Stimulus, SS)、刺激连续质量测量法(Single Stimulus Continuous Quality Scale, SSCQS) [8]
通过在一定的环境下，组织一定符合规定的人员对每张图像进行打分，这样每张图像
都会对应一系列的分值。每张图片最后的主观质量值是对每个评分人的主观评价分进行加 权平均即主要采用平均主观意见分(Mean Opinion Score, MOS)和差异平均主观意见分 (difference of MOS, DMOS)。
图像的客观质量评价是指对图像的亮度色度特征等进行分析和建模并结合人类视觉 系统对图像的感知特性，通过一定的数学方法和信号处理方法或者机器学习进行样本训练 等来实现对图像的质量进行自动的评价。因此客观质量评价可以在实际中广泛的应用。根 据利用原始图像信息的多少图像质量评价又分为全参考(Full Reference, FR)、半参考 (Reduce Reference, RR)和无参考(No Reference, NR)⑶。全参考图像质量评价方法依 照完整的原始参考图像，使用的较多的方法是分别计算原始图像与失真图像之间某个特征 或者某些特征或者直接采用两幅图像素域的亮度或者对比度，通过比较这些特征之间的差 别或者联合差别，来得到失真图像的最终质量分值。由于只能获得原始图像的部分信息， 如原始图像的傅立叶变换或者DCT变换小波变换之后的结果等，部分参考图像就是利用 参考图像的所能获得的部分信息(小波变换、傅里叶变换等)和提取失真图像的相对应信 息对失真图像进行最终质量评分。在实际很多情况下，往往很难获得失真之前的图像，无 参考图像质量评价方法就是完全不利用原始图像中的任何信息对图像进行评价的方法。
基于人眼对误差的敏感性理论，均方误差(Mean Square Error, MSE)和峰值信噪比(Peak Signal to Noise Ratio, PSNR)是最直观的方法。作为全参考图像质量评价具有代表性的方 法之一，MSE和PSNR首先比较参考图像与失真图像之间每个像素点之间的误差，然后再 综合加权这些误差值确定质量评分。MSE或者PSNR计算比较的简单，在过去的几年里得 到了广泛的应用，但是基于误差敏感性的方法，仅仅是硬性的计算像素点的差值，并没有 没有考虑到人类视觉系统的特性，比如人眼往往会对图像的中心和严重的失真区域给与更 多的关注，所求MSE和PSNR评价的结果常常与人们主观感受相差很多図。随着研究者对人 类视觉系统(Human Vision System, HVS)的逐步认识，结合HVS感知特性对HVS进行建 模和对一些有关HVS感知特性图像特征的建模的全参考图像质量评价方法会更加的符合 人眼的主观感受。首先把半参考图像质量评价的想法用在一个网络多媒体系统上面的视频 监控中是在20世纪90年代卩七一个有效的半参考图像质量评价方法必须兼顾时间和效率卩°】。 2012年王周等提出了一种基于结构相似性估计的半参考图像质量评价方法 (Reduced-Reference Structure Similarity, RR-SSIM)卩"。由于以全参考结构相似性进行标 准来设计RR-SSIM, RR-SSIM和全参考结构相似性算法还有一定的差距図。由于一点原始 图像的信息都无法获得，无参考图像质量评价方法只能通过提取失真图像的特征对图像进 行评价。无参考图像空域质量评价方法(blind/referenceless image spatial quality evaluator, BRISQUE)利用场景统计信息对图像进行评价〔⑵，是目前评价结果最好的无参考图像质量 评价算法。
1.3色调映射图像质量评价
由于色调映射图像评价时参考图像和待评价图像之间的动态范围不同，所采用的评价 方法也不同，色调映射图像在这里作为一个单独分支列在这里。
近年来随着利用电脑合成渲染游戏方面图像处理技术的不断发展，高动态范围图像 (High dynamic range, HDR)技术也在不断发展与广泛应用。因为HDR图像的动态范围 特别广，所以不管是阳光直射还是微弱的星光等各种条件，HDR都能获得较好的表现。
一般的显示设备在表示图像的亮度或者色度信息的时候是用8bit或16bit来区分的， 这实际上是不够的。首先人眼能感受到的亮度信息的范围远远超过了这个范围，其次由于 太阳的发光的强度一般在很大的范围，具有更高动态亮度的图像也更加接近大自然真实的 亮度动态区间。能够更加逼真的反映真实世界和具有更高亮度范围的高动态范围图像的出 现成为了必然。高动态图像目前在游戏手机相机等领域正逐步的发展。高动态范围图像可 以使用每个曝光程度相对应最佳细节的LDR图像来合成最终HDR,能够更好的反映出真 实场景中的视觉效果。
但是一个通常的问题是用一般的显示低动态范围图像(LowDynamic Image, LDR)的 设备来使高动态图可视化。为了这个目的，很多的色调映射转换算法被提岀［13H16］o目前的 色调映射器(Tone-mapped Operator)可以分为两类：基于全局的色调映射器和基于局部的色 调映射器卩七全局色调映射器对高动态图像中的所有像素运用相同的变换方程进行映射, 而局部色调映射器对图像中的不同部分应用不同的映射算法。用色调映射进行动态范围压 缩以后，所合成的HDR影像就能很好的在显示器上显示了。问题是哪一个色调映射器产 生的图片的质量较好，是一个需要解决的问题。并且由于动态范围的减少，色调映射转换 器所进行的转换必然会造成图像质量的损失。色调映射图像的质量好坏直接影响人的观看 的感受。因此对对色调映射图像质量的评价也显得很重要。同时图像进行质量评价的结果， 也可以用到对色调映射转换器的改善上〔岡。在过去的几年最常用的色调映射图像质量评价 方法主要是主观质量评价。文献［19］中一共有7个色调映射转换器被评价。40个评价人员 被要求就图像的基本属性(亮度、对比度、色度)和图像的自然性来对图像进行打分。文 献［20］中10名观察者被要求就图像的亮度细节颜色，以及整体的印象对图像进行评分，被 评价的图像来自14个色调映射器。这些主观评价的结果对研究色调映射器的性能上提供 了很重要的参考。但是这种方法也有限制。首先该方法是昂贵的和消耗时间的；其次这种 方法很难被用到设计和优化色调映射算法中；再次，把主观质量评价的结果作为像黄金基 石一样的标准是不合适的，因为一些细节特性在高动态图像中可能被映射为了平坦区域, 但是这种情况下，人眼是很难察觉到的〔2丄因此使用客观的方法评价色调映射图像的质量 显得尤为重要。
目前，对客观色调映射图像质量评价算法的研究还很少。由于待评价图像和原始高动 态图像的动态范围不同，也不能直接的将已出现的图像质量评价算法应用到色调图像质量
评价方面上来。
1.4相似性策略
相似性，亦即通过提取原始图像和失真图像相同的特征，来计算两幅特征图之间的近 似算数平均和几何平均之间的比值。基于相似性策略的全参考图像质量评价算法由于其对 图像评价的有效性，-直是图像质量评价领域人员普遍采用的策略。从王周的结构相似性 提出[23〕和采用相似性计算的策略之后，陆续出现了基于梯度相似性〔28],基于相位一致性相 似性四】，基于显著性图像相似性的算法〔29】，以及各种在已有基于相似性算法的基础上进行 些许改进的算法〔2425】。可以说基于相似性的全参考图像质量评价算法一直是全参考图像质 量评价领域的热点。
1.5本文主要研究内容和结构
由于基于相似性的图像质量评价算法一直在图像质量评价的领域取得很好的效果，本 文在相似性的基础上围绕以下三个方面对图像质量评价的方法的研究进行展开。
1.提出了一种基于区域的新的加权方法对已有的某些基于相似性的图像质量评价算 法进行改进
图像质量评价的方法可以概括为两步，首先通过评估局部的质量得到一个质量图，其 次是使用适当的方法产生一个加权图，来对局部质量进行合并得到整个图像的质量值。目 前采用的加权方法有闵可夫斯基加权策略，基于局部质量值的加权策略，基于内容信息的 加权策略等。但是这些加权策略都是集中在像素级的加权上，而人眼感兴趣的往往是某一 块区域，而不是某一个像素点，如下图所示。在这些加权策略的基础上本文提出了一种基 于区域的加权策略。区域内在像素的级别对局部质量值进行加权得到各个区域的质量值， 而区域间通过各个区域的权重对区域间的质量值进行加权。
2.提出了一种基于内容信息相似性的图像质量评价算法
人眼是一个很好的信息提取者。但图像有失真的时候，人眼从图像中感受的内容信息 就会改变。很早，图像内容信息在图像质量评价就有应用。视觉信息保真度(visual information fidelity, VIF)模型四，就直接利用待评价图像和原参考图像之间的互信息对 图像进行评价。2011年王周等对图像内容信息进行详细的建模，使其成为图像质量评价领 域很好的一个加权策略。本文基于人眼的信息提取特征提出了一种结合内容信息相似性和 梯度相似性的新的评价算法。
3.提出了一种基于修正的梯度相似性的色调映射(tone-mapped)图像质量评价算法 梯度幅度相似性特征一直以来受到图像质量评价研究人员的青睐。梯度也是物体边
缘特征的一个很好的描述。而一副由色调转换器转换过来的低动态图也要看起来更加的自 然。本文融合修正的梯度相似性和图像的自然性构建了一个新的评价算法。
本文的结构为：第一章首先阐述了选择本题目的原因和本领域的背景，随后对图像质 量评价研究现状做了简短的说明，最后介绍了本文的主要创新点和论文结构。第二章详 细介绍了图像质量评价领域的一些经典方法和算法的评价指标常用的数据库。第三章在对 已有加权算法进行研究的基础上提出了基于区域的图像质量评价加权策略。第四章介绍基 于内容相似性的图像质量评价算法，并对该算法进行详细的阐述和试验总结。第五章提出 的新的色调映射图像质量评价算法做详细的阐述和试验总结。第六章总结本论文的创新点 和取得的成果，并阐述了本文接下来的研究方向。
第二章图像质量评价方法概述
在网络H益繁盛的今天，多媒体信息的需求急速增长。现在的人类时刻都接触作为多 媒体信息重要组成部分的图像和视频，视频可以看成是一帧一帧的图像。在H益数字化的 今天，数字图像从它诞生的那一刻起到现在发挥着越来越来越重要的作用。这种失真不仅 会影响观看感受，在专业领域，如气象、医学、军事等专业领域，这些图像质量失真对精 确性的影响极为重大且可能引起较大损失。所以，如何准确地评价图像质量显得很重要。 图像质量的评价结果也可以作为一■个指标来评判压缩算法和增强算法等的好坏。
2.1图像的主观质量评价方法
随着多媒体应用的越来越广泛，图像质量的评价也显得越来越重要。图像评价方法分 为主观质量评价与和客观质量评价两大类冏。
主观质量评价方法是通过组织一些人去观看图像，观看的人根据自己的主观感受对图 像进行打分。客观质量评价模型的好坏一般要和主观质量评价的打分进行相性比较。图 像的主观质量评价国际组织给出了系列的标准。具体标准为ITU-T BT.500-11和ITU-R Rec.P.910[8]o标准评价的环境、参与评价的人员和过程都给出了建议。根据国际标准 BT.500-11的建议，主观评价的方法分为：双刺激损伤测量法(Double Stimulus Impairment Scale, DSIS)、双刺激连续质量测量法(Double Stimulus Continuous Quality Scale, DSCQS)、 单刺激测量法(Single Stimulus, SS)、单刺激连续质量测量法(Single Stimulus Continuous Quality Scale, SSCQS) t8]0
2.1.1评价方法环境
下面给出建议的主观质量评价的条件和环境。观察员：非专家人员必须大于15人, 连续观看图像的时间为30分钟左右。待评价图像需要从标准图像库中选择。具体的实施 方法从建议的四种方法中选择一种。而且评价人员也需要按照建议的评分规则对图像进行 评分。试验所用的实验室的环境应尽量的暗。并且对实验室的对比度等信息也做了详细的 规范。
2.1.2图像主观质量评价方法
(1)双刺激损伤测量法
这种方法每次一张一张的播放图像，而且评价人员知道哪张是参考图像，哪张是失真 图像。并且先播放参考图像后播放失真图像。评价人员采用下图所示的五分制对图像进行 打分。1分代表能察觉的损伤，且非常令人讨厌，5分代表观看舒服，损伤一点都察觉不 到。主观打分的区间采用的五分制。
表2-1主观质量评价五分制表
分制	损伤程度
5	完全感受不到没有
4	能感受到一点，可以接受
3	令人讨厌的损伤
2	非常令人讨厌
1	完全无法忍受

(2)双刺激连续质量测量法
这种方法中，参考图像和待评价图像先后一共显示两次，但是顺序是随机的如参考图 像，失真图像，参考图像，失真图像这个的组合或者其他。在屏幕的终端，评价人员被要 求以I?100的连续分值之间进行打分，其中1代表最差完全无法观看，100代表最好，人 眼看着最舒服。很多的参考图像和失真图像对被观看，观看两张图片之间的时间间隔为lSo 并且哪个是参考图像，哪个是失真图像并不会告诉评价人员。
(3)单刺激测量法
该方法只间断的播放待评价的图像，评价人员根据自己的观看感受对进行打分。打分 分为5个区间，1代表最差，5代表最好。
(4)单刺激连续质量测量法
该方法的待评价人员有比较长的时间来观看一副待评价的图像，然后对图像进行打分, 该方法更加接近人眼的主观感受。
每张图片最后的主观质量值是对每个评分人的主观评价分进行加权平均即主要采用 平均主观意见分(Mean Opinion Score, MOS)和差异平均主观意见分(difference of MOS) □ 这种方法能较好反映图像的直观质量。
图像的受体是人，由人来评价图像的质量应该是最准确的，但人又是主观的，所以由 人来进行的主观图像质量评价也存在一些问题：主观打分偏差：每个人在观测时都会有自 己的主观倾向，对不同的图像内容可能有不同的好恶，以及可能会受到情绪以及环境的影 响，所以可能会产生一定的主观偏差；主观评价方法费时费力，成本较高，如果想获得一 个较准确的评价结果，需要召集一个群体作为图像的观察者，同时希望这些观察者是经过 图像质量评价培训的人员，以使评价更为准确，此外，配置符合测试要求的环境也比较复 杂；主观评价无法实时进行，多人的打分结果需要后续统计分析才能得到评价结果。即便 存在上述缺点，主观评价方法仍是评价图像质量的最重要的手段之一。同时，为在一定程 度上克服上述缺点，需要用客观图像质量评价方法来进行辅助评价，这也促使人们更多地 对客观评价方法进行研究。
2.2图像客观质量评价
图像的客观质量评价是指对图像的亮度色度特征等进行分析和建模并结合人类视觉 系统对图像的感知特性，通过一定的数学方法和信号处理方法或者机器学习进行样本训练 等来实现对图像的质量进行自动的评价。图像质量评价分为全参考(Full Reference, FR)、 半参考(Reduce Reference, RR)和无参考(No Reference, NR)性 全参考图像质量评价 方法依照完整的原始参考图像，使用的较多的方法是分别计算原始图像与失真图像之间某 个特征或者某些特征或者直接采用两幅图像素域的亮度或者对比度，通过比较这些特征之 间的差别或者联合差别，来得到失真图像的最终质量分值。由于只能获得原始图像的部分 信息，如原始图像的傅立叶变换或者DCT变换小波变换之后的结果等，部分参考图像就 是利用参考图像的所能获得的部分信息(小波变换、傅里叶变换等)和提取失真图像的相 对应信息对失真图像进行最终质量评分。在实际很多情况下，往往很难获得失真之前的图 像，无参考图像质量评价方法就是完全不利用原始图像中的任何信息对图像进行评价的方 法。本文主要研究全参考图像质量评价。下面对于已经存在的一些全参考客观质量评价方 法做详细介绍。
2.2.1峰值信噪比PSNR和均方误差MSE
基于人眼对误差的敏感性理论，均方误差(Mean Square Error, MSE)和峰值信噪比(Peak Signal to Noise Ratio, PSNR)是最直观的方法⑸。作为全参考图像质量评价具有代表性的 方法之一，MSE和PSNR首先比较参考图像与失真图像之间每个像素点之间的误差，然后 再综合加权这些误差值确定质量评分。下面给出具体定义：
MSE指参数估计值与参数真值之差平方的期望值，PSNR表示信号最大可能功率和影 响它的表示精度的噪声功率的比值。峰值信噪比与均方误差都是基于像素的图像质量评价 方法。对于大小为MXN参考图像与失真图像，MSE和PSNR分别定义为
=	(2-1)
PSNR=101ogio(^).	(2-2)
其中％订和北丿分别表示参考图像与失真图像的每一个对应像素的灰度值，其中的i与丿分 别表示图像中每个像素点对应的行与列，其取值范围为
i = 1,2,3, ...M, j = 1,2,3,... N,入是图像灰度值可能达到的最大范围，以8位的灰度 图像为例，L = 28 -1 = 255 0
这种办法的特点是数学意义明显，处理步骤比较简单，所以这种方法广泛地被运用在 各种数字图像处理与图像质量评价过程中。但是这种方法仅仅是硬性的计算像素点的差值, 并没有没有考虑到人类视觉系统的特性，比如人眼往往会对图像的中心和严重的失真区域 给与更多的关注。MSE对某些图像的评价结果如下图所示。


(b) MSE=144的两幅参考图像A (左)与B (右)
图2-1 —副参考图像和其对应的两张失真图像

从图中可以看出，(b)中的A和B两张图的视觉效果明显不同，但MSE的值却相同。 所以MSE或者PSNR无法很好的反应人的主观感受囹。
随着对人类视觉系统(Human Vision System, HVS)的认识深入，综合HVS的评价方 式能够获得更加准确的结果。基于视觉特性的信噪比方法(visual SNR, VSNR)重点考虑 人眼对不同视觉信号的敏感度，如亮度信号，对比度信号和频率信息等［23］。结构相似性 (Structure Similarity Index, SSIM)算法假设人眼更适合提取场景中的结构信息，该方法 结合参考图像和失真图像的亮度，对比度和结构相似性对图像进行评价図。
由于SSIM考虑了人眼的视觉特性，其评价的结果，更加的符合人眼的特性。Wang 等人提出了多尺度结构相似性(Multi-scale Structure Similarity Index, MS-SSIM),通过抽样 得到图像的五个尺度，按照一定的比重对五个尺度进行加权ML MS-SSIM得到了比单一尺 度更好的结果；Chen等人四提岀了基于梯度图的结构相似性(Gradient-based Structure Similarity Index, GSSIM)算法，先计算图像的梯度幅度图，在这个基础性上再计算结构相似 性。
视觉信息保真度模型(Visual information fidelity, VIF)算法㈣把对全参考图像质量评 价问题作为信息保真度问题，并把信息保真度量化为参考图像和失真图像之间的互信息。
最明显失真(Most apparent distortion, MAD)算法㈣假设人眼对髙质量的图像和对低质量 的图像的处理采取的两个不同的策略。该方法在某些失真类型上取得很好的效果。张等提 出了一种基于相位一致性相似性和梯度的图像质量评价算法(feature similarity index, FSIM) EL并且该算法给出了两个版本(一种只利用图像的亮度特征，另一种利用了图像的亮度 和色度信息)，相比较而言，加上图像的彩色信息比只用亮度信息的结果要好，因为人眼 同时具有色度敏感性。刘等提出了一种基于梯度相似性(gradient similarity index, GSM) °】的图像质量评价算法。宙于人眼往往只对一幅图像中的一部分区域感兴趣，张等提出了 一种基于显著性图相似性(visual saliency-induced index, VSI)伝列的质量评价算法。VSI 通过比较失真前后两幅图像的显著性区域的变化，来对失真图像的质量值进行评价。该方 法受制于显著性检测算法的影响。下面详细介绍基于显著性图相似性的算法。
2.2.2基于显著性图相似性的VSI算法详细介绍
可以感受到的图像的失真可以导致图像可以感受的低级特征的改变，而图像的自底向 上的显著性检测算法模型的建立就是依据图像的低级特征，那么图像的显著性图像像素中 的值随着图像质量的变换也会改变。基于此，VSI方法探讨了失真图像和参考图像的经过 某种显著性算法得到的显著性图的差别与图像的失真程度之间的关系。经过试验得出，图 像的失真越大，失真图像的显著性图相对于原始参考图像的差别越大。于是张等提出了基 于图像显著性相似图的图像质量评价算法［29】。该算法有三部分组成，分别为显著性相似性, 梯度相似性和色调相似性。
假设I(x)为一副图像，VSr(x)为参考图像的显著性检测图，VSd(x)为失真图像的显 著性图，则显著性相似图&s(x)计算公式为：
2VSr(x)-VSd(x)+L1
vs(丿 VS；(x)+VS：(x)+L|
假设GM,」*)为参考图像的梯度幅度图，为失真图像的梯度幅度图，则梯度 相似性图Sw(x)计算公式为：
2GMr(x)-GMd(x)+L2
gmI* GM^(x)+GM|)(x)+L2
假设C、(x)为参考图像的色度图，为失真图像的色度图，则色度相似性&(X)计

其中，丄，丄，厶为常数，为了保持式子的稳定性。经过试验这三个常数对结果的影 响不大，所以设定为随机值。而式(2-3)中所采用的显著性检测算法为经过试验的对评价
11
结果较好的一种算法。具体见参考文献[29]?而式(2-4)中采用的梯度算子为
_ 3	0 -3 _		--3	-10	-3「
Gx =	10	0 -10	Gv =	0	0	0	(2-6)
3	0 -3		3	10	3

而式(2-5)所采用的RGB转亮度色度的转换公式为:
Y		「0.299	0.587	0.11"	-R-
I	=	0.596	-0.274	-0.322	G	(2-7)
Q.		0.211	-0.523	0.312	B

总的相似性图计算公式为:
S(x)=[Svs (x)『 *[Sgm (x)T * [Sc (x)]
其中，a=l, 0=0.4, y=0.02为经过与主观拟合迭代到得到的值。经过试验，VSI在 几个公认的图像数据库上面都表现出了很好的性能。
2.3色调映射图像质量评价
由于色调映射图像评价时参考图像和待评价图像之间的动态范围不同，色调映射图像 在这里作为一个单独分支列在这里。
2.3.1色调映射图像质量评价研究背景与意义
近年来随着利用电脑合成渲染游戏方面图像处理技术的不断发展，高动态范围图像 (High dynamic range, HDR)技术也在不断发展与广泛应用。但是一个通常的问题是用一 般的显示低动态范围图像(Low Dynamic Image, LDR)的设备来使高动态图可视化。这种 算法叫做色调映射(tone mapping)o用色调映射压缩以后，所合成的HDR影像就能很好 的在显示器上显示了，提升了观看体验。由于动态范围的减少，色调映射转换器所进行的 转换必然会造成图像质量的损失。色调映射图像的质量好坏直接影响的观看的感受EL
2.3.2色调映射图像质量评价研究现状
过去色调映射转换器(Tone-mapped Operator, TMO)转换质量的评估主要依赖于人们的 主观评价，由于主观质量评价所固有的特性，TMO的主观评价消耗大量人力与实践，得到 的结果也不能及时反馈进入色调映射图像转换系统用来调整优化参数设置，而且色调映射 转换器的转化会损失在图像构成中非常重要的结构信息，而人们的主观评价并不会注意到 这种结构信息的损失⑵】。
典型的客观图像质量评价方法假设参考和测试图像具有同样的动态范围，因此不能直 接用于评价色调映射的图像。目前只有少数的方法应用在色调映射转换的图像上。HDR可
见差异的预测器（HDR-VDP）⑶】是基于人类视觉系统（HVS）的保真度度量方法，目的 是为了区分可见失真与不可见失真。因为HDR可见差异预测是用来预测的能见度相同的 两HDR图像之间的差异范围，它并不适用于一个高动态范围图像与低动态范围图像质量 的对比。一种在HDR-VDP的基础上改进的动态范围独立的方法通过计算可视化特征的失 真、可视化特征的复制和对比度极性的反转来对图像进行评价D2],但是它并没有提供一个 单一的对于整个图像的质量评分，使它不能得到整体图像质量评价分并与主观评价进行验 证，而实际应用中尤其需要一个整体的评分与主观评价分进行验证来评价图像质量评价方 法的效果。Yeganeh等人建立一个客观的色调映射图像的评价标准，这个评价标准主要由 两部分构成El：第一个是结构相似性的多尺度推导，结构相似性认为的视觉的主要目的是 提取结构信息从视觉场景，因此结构保真度好感知质量的预测。二是自然场景统计的方法， 认为视觉系统具有很强的适应自然的视觉环境，采用自然图像统计学作为为评价品质的基 础。最后结合多尺度结构衡量和统计自然措施，得到最终的色调映射图像质量指数。 FSITM[34]方法利用修正的相位一致性特性，对色调映射图像质量方法进行评价。基于高动 态图像的细节特征色调映射图像质量评价算法于2014年被提出，该算法通过对图像中的 细节进行训练，来对色调映射图像进行评价a〕。目前色调映射图像质量评价算法还处于初 级阶段，客观评价的结构与主观评价的结果依然有很大的差距。本文在已有算法的基础上 对色调映射算法做进一步的研究。
2.3.3基于多尺度结构相似性的色调映射图像质量评价算法
由于动态范围的损失，色调映射转换器所进行的转换必然会造成图像质量的损失，色 调映射转换器不能保存高动态范围图像的所有信息，而人类视觉系统在观察这些经色调映 射转换器转换的这些图像的低动态范围的版本的时候也许并不会注意到这些信息的丢失。 然而结构的保真度在色调映射图像质量评价中占了很重要的位置口】。
2010年，Yeganeh等人提出来了基于结构相似性的色调映射图像质量评价方法⑵]。结 构相似性方法提供了一种有效实用的测量图像之间结构保真的思路。原始的结构相似性算 法是基于局部的亮度，对比度和结构三方面信息図。而色调映射图像势必会改变局部的强 度和对比度，所以直接对比局部以及对比度的方法变得不可取。分别令从高动态范围图像 与经色调映射转换的低动态范围图像提取得到的块分别用x和y表示。局部结构保真度测量
数学表达形式为：	耐（“）=爲?岩京終	C9）
其中（7乂，	，	分别是从高动态范围图像与低动态范围图像对应提取小块的局部标
准差和互相关系数。与结构相似性算法一样竜和％也是为了维持公式稳定的常量。与结构 相似性算法相比，舍弃了亮度的比较，而且结构的比较部分与结构相似性算法有一样的表 达形式。式中的第一部分比较的是从结构相似性转换而来的信号强度。进行变换的两个主要原因是：
第一，高动态范围图像与低动态范围图像块区的信号强度差异不应该受到它们的信 号强度的影响，比如会出现它们的信号显著性都超过了阈值或者它们的信号强食都没有达 到阈值。
第二，算法应该减小受到某张图像的信号强度尤其显著而另一张图像的强度尤其不 显著这种情况的影响

图2-2结构保真度插值

定为了符合上述的要求，定义。与/之间的映射为：
(	0, a<T±	、
b' = {	+ cos (b 一『2)]}，Tj < ct < T2 >	(2-10)
I	1, 丁2 < b	>
其中，T},弓是表示重要和不重要的两个阈值，一个升余弦函数提供HDR图像和色 调映射图像的动态范围的平滑变换。需要指出的是，当T2<a都非常的重要，当a<Tx都 不重要。
在Ssca心,V)中和％/分别是我与四的映射形式，它们的值都是0至1之间，0代表 完全即为微小，而1代表极为重要。局部结构保真度Sscai是使用一个滑动的窗来取整张图 像的。得到的结果就是一个反映整体图像结构保真度变换的图。图像细节的可见性取决于 对图像进行的采样密度，图像与观察者之间的距离，图像的分辨率以及观察者视觉系统的 感知能力。单维度的方法不能捕捉到这样的变化。而通过采用了一种多维度的方法：图像 迭代通过低通滤波器并下釆样来创造一个图像金字塔结构，如图2-2所示。局部的结构保 真度在每个维度都会生成。
在每一个维度中，结构保真度图的统筹信息由各个单独得分的平均值得到：
Si =^^ocaZ(%f,yi)	(2-H)
治代表被比较的高动态范围图像与低动态范围图像的第i个小块，M则表示这样的 块区的数目。总体的结构保真度可以通过这种方法得出：

S = Flf=i ^il	(2-12)
L表示维度的总数，而&表示各维度的权值。
结构保真度模型的实现仍需要几个参数：
第一，当计算S/ocaZ时，采用C1 = 0.01和0 = 10，结构保真度模型的整体表现就对这 些参数的具体设置值并不敏感。
第二，为了在各个维度得到保真度图，采用了和结构相似性算法中一样的设置：大小 为11x11标准差为1.5的高斯窗进行滑动取样⑼
第三，假设观察距离是32周每度，这样就能无损展示16周每度的信号，因此为了使 对比度敏感度函数获得最佳维度测量效果时使用16周每度作为空间频率参数。空间频率 参数应用在接下来更精细的维度分别就是8, 4, 2, 1周每度。
第四，平均亮度值设置为低动态范围图像的平均动态范围。
第五，取L = 5以及{&} = {0.0448.0.2856,0.3001,0.2363,0.1333}来结合我。这样的设 置符合心理学的测量结果図。
2.4算法评价指标
客观算法评价的结果可以通过一定的函数来拟合图像主观质量评价结果，通常各质量 点越集中，越接近拟合的曲线，说明图像的质量越好。拟合函数一般采用SheikhH.R.等人 提出的5参数的Logistic函数【36〕，如下面所示：
Quality(x) = ^logistic^^, (x — $)) + p4x + /?5	(2-13)
1 1
logistic^	(2-14)
利用上式进行拟合取得了比较好的效果，并在图像质量评价的主客观分数拟合中获得 了广泛应用。
本文采用4种评价指标来评价不同图像质量评价算法的性能，分别是：
1)皮尔逊线性相关系数(Pearson Linear Correlation Coefficient, PLCC)：
PMC =	= E W(F	(2-15)
在计算PLCC之前，需要先对客观质量值和质量值进行拟合。拟合后的曲线上的客观质 量值所对应的主观质量值与主观质量值之间按照计算式(2-11)计算相关性。
2)斯皮尔曼相关系数(Spearman Rank Order Correlation Coefficient, SROCC):
SROCC = 1 一 &平尸？	(2-16)
n(n2-l)	'	7
假设主观评价分数序列为X,客观评价分数为y, n为样本容量。将X和y按照从大到小 的顺序进行排列，记X/、力为原数组中豹、贝在排序之后的位置。
15
3) 坎德尔(Kendall Rank Order Correlation Coefficient, KROCC)相关系数：
KROCC = (P —Q)由 ,	(2-17)
其中P为和谐对的个数,Q为不和谐对的个数，n为样本容量。
4)均方根误差(Root Mean Squared Error, RMSE)x

RMSE = J 里皓宣	(2-18)
RMSE越接近0,图像质量评价算法的精度就越高。
一个好的图像质量评价算法，应该具有较高的SROCC,PLCC,KROCC和较低的RMSE 值。
2.5本章小结
本章首先介绍了当前图像质量评价方法的主要分类为主观质量评价方法和客观质量 评价方法。并对主观质量评价目前存在的方法进行详细的介绍，接下来是客观质量评价方 法的发展现状，并就某种算法进行了详细展示。最后对客观质量评价方法的评价指标进行 了详细的介绍。

第三章基于区域的全参考图像质量评价加权策略
图像质量评价的方法可以概括为两步，首先通过评估图像的局部质量得到一个包含局 部质量的图，其次是使用适当的方法产生一个加权图，来对局部质量进行加权合并得到整 个图像的质量值。本章首先介绍已有的图像质量评价加权策略，然后介绍本文所提出的加 权策略，接着把本文所提的基于区域的加权策略和已有的图像质量评价方法相结合，最后 给出实验结果。
3.1图像质量评价加权策略
图像质量评价的方法可以概括为两步，首先釆用某种策略对评估图像的局部质量进行 计算得到一个包含局部质量的图，其次是使用适当的方法产生一个加权图，来对局部质量 进行加权合并得到整个图像的质量值［36〕。具体流程如下图所示：

图3-1图像质量评价系统

在图3-1中，（a）和（b）分别为原始参考图和失真图，图（d）为质量图（SSIM）。
以结构相似性算法为例，图像局部质量值的计算过程如下：在基于对人类视觉系统做 了非常多的研究之后Zhou Wang等人提出了结构相似性（Structure Similarity, SSIM）图像质 量评价模型仞。算法包含三部分，用局部块灰度值均值表示图像的亮度信息，用局部块像 素灰度值的方差图像对比度信息。用参考图像和失真图像局部块的协方差表示结构信息。 结构信息仅代表了场景中物体的结构，与平均亮度和对比度信息都无关。假设x和y是分 别为参考图像和待评价图像中相对应的局部块。那么SSIM（x,y）的计算框图如下：以结构 相似性算法为例，图像局部质量值的计算过程如下：Wang等人基于一种新的假设，即人眼更容易提取图像中的结构信息，提岀了一种新的图像质量评价算法即结构相似性算法 (SSIM)o假设x和y是分别为参考图像和待评价图像中相对应的局部块。那么SSIM(x,y)的 计算框图如下：

3.1.1闵可夫斯基加权策略（Minkowski pooling）
假设勿是质量图中第i个空间位置的质量值，则闵可夫斯基策略可以描述如下：
Q = §q?	（3-6）
其中，1 = 1,2,3,.../V, 2是图像中的质量值的个数，p是闵可夫斯基宿级数，可以取 1,2,3,...显然当p等于1的时候相当总的质量值等于所以质量值的平均值，当p=2的时候就 是必的均方误差值。这种加权方式，当qi越小时所占的权重越小。例如SSIM就是采用p=l 的策略。
3.1.2基于局部质量值的加权策略
假设以是质量图中第i个空间位置的质量值，则基于局部质量值的加权策略可以描述
如下：
o_、S（q，）q
切侦冬）
其中W = 1,2,3, ...N, N是图像中的质量值的个数，3（q（）是qi所对应的权重,3（q。表 明权重是质量的函数。不如人眼更加注意到失真图像中特别严重的失真这时候我们构造一 个函数使得更低的质量值具有更大的权重。
3.1.3基于内容信息的加权策略
基于内容信息的加权策略，就是所构造的权值与块x或者y中的内容有关。具体表达 式为：

不过这里叫是图像中一部分图像块的像素的集合的函数0=g（x,，3）x,,y分别为 参考和待评价图像像素的集合。例如我们可以另

其中，虽和为块x和y的方差。
虽然已经有以上的加权策略，但是这些加权策略只是对相应的局部质量策略计算的结 果直接进行加权，以SSIM和MS-SSIM为例，SSIM得到的是在像素的级别，于是直接对像 素级别的质量值进行加权。然而人眼对图像的关注度并不是在像素的级别，人眼感兴趣的 往往是某一个区域。所以本文提出了一种两级加权策略。区域内在像素的级别对局部质量 值进行加权得到各个区域的质量值，而区域间通过各个区域的权重对区域间的质量值进行加权。下面进行具体的介绍。
3.2区域级的加权策略
下面先看两个例子，如图3-3所示。图中最左列的两张图为从图像质量评价库里面选 取的两张参考图，中间是以上面介绍过的基于内容信息加权策略得到的加权图。从图中我 们可以看出虽然我们的人眼很快能注意到的只是图中白色钉和图中帽子的信息。但是权值 图中（越亮表示权值越高）不仅这些地方的权值高，它周围的部分也有很多亮高的点。显 然这与我们的人眼有一些差距，这也是我们提出区域加权策略的原因。


区域加权策略框图如下:

图3-4基于区域加权的算法流程
3.2.1区域加权算法介绍
本文在学习已有基于相似性的图像质量算法的基础上，提出了一种基于区域加权的 图像质量评价策略，假设我们已经有了局部质量图，那么基于区域加权的策略算法表达式 如下：假设％，是图像中经过一定的方法所划分的第〃.个区域，外,,是区域〃?所对应的权值. 则图像的最终质量的分值用以下表达式来计算
Q=* 繹尝	(3-10)
Zii %
其中，NN是图像中…共有的区域的个数。
现在的重点是我们如何对区域进行划分，已经各个区域的权值又如何给定。通过大量 的阅读文献我们采用了文献"Fusing generic objectness an visual saliency for salient object detection；5显著性区域检测方法。该算法的结果是图像按照显著性度被划分成了若干个区 域，每个区域给出了显著性值。我们把每个区域的显著性值作为区域的权值，来对第一部 获得的区域的质量进行加权。
3.2.2显著性检测算法
人类视觉系统只详细处理图像的某些局部，而对图像的其余部分几乎视而不见［37'38］o 这种被视觉系统详细处理的局部区域通常被称为显著性区域(saliency region)、重要性区域 (important region)、感兴趣区域(region of interest)o从人类视觉认知的角度视觉注意机制分 为两个阶段：(1)快速的、下意识的、自底向上的、数据驱动的显著性提取；(2)以及慢 速的、任务相关的、自顶向下的、目标驱动的显著性提取目前显著性检测方面已经有 很多成熟的文章如Laurent Itti等人［39］提出了一种基于生物启发模型(biologically plausible architecture)和特征整合理论(feature integration theory)的视觉显著性计算方法。Achanta 等人性°］提岀的一种基于频率调整的算法来获取多个尺度的显著性区域检测结果。程明明等 人提出的基于区域的显著性检测策略。程明明等人提出了基于颜色直方图和全局对比度的 显著性检测算法囹1。显著性检测算法一般都会给出一副图像显著性图。由于显著性算法不 是本文研究的内容，而只是一个工具，下面本文只对本文所用到的算法做简单的介绍。
本文所用到的显著性算法简单介绍【42】。该算法釆用的是目标驱动的自顶向下的思想。 算法主要采用了候选物体框和图像中的超像素。通过结合二者并建立一根能量方程，来达 到显著性图像的生成。图像中的候选物体框是指图像中所有可能出现物体的地方，这些地 方以方框的形式表现岀来。图像中的候选的物体框表示图像中所有可能是物体的框。虽然 算法给出来的这种框的数目很多，但是可以把这种框最为分类器的输入来对图像进行提特 征训练，从而用于物体的识别与检测。超像素分割算法是按照文理颜色等特性把图像划分 为一个个很小的块又称超像素。文献［a算法的步骤为：

首先通过超像素分割算法〔43】把图像分割为一个一个的超像素如图3-5左图;
（1）	利用网算法找出图像中所有的proposal objectness如图3-5右图；
（2）	定义分割后的所有超像素曲能量；
（3 ）定义找出的所有proposal objectness的能量；
（4）建立一个能量方程，并使得能量达到最小，如图3-6。

图3-5取至TID2008库里面的图像对它进行超像素分割和objectness检测的结果（左为超像素分割的 结果，200,右为检测到的objectness检测的结果，矩形窗）



图3-6能量图
下面给出各部分的具体的定义：
假设一副图像被分割为P个超像素，一共有Q个可能的物体窗，那么我们估计每个超 像素的显著性琮，（m = 1,2,3，…,P）和每个物体窗的显著性球，（i = 1,2,3,为简单起 见，把XS和X。中的每个分量归一化到［0,1］的范围内。通过以下的方程左边取值最小来获得

Xs, X°,该方程为:
F(XS,X。)= Fs(Xs)+ F°(X。)+ A(XS,X°)	(3-11)
其中，Fs只是和显著性相关的能量，F。只是和objectness相关的能量，而△是两者的交 叉能量。如图3-6所示的能量图。
其中	Fs(x') = Zm(鴻i —蓊i)? +	Um,nee	—獄)之	(3-12)
^m,n =	(-川咬 一 0||2)	(3-13)
F°(x。)=	- x?)2	(3-14)
其中*和也分别为像素k和啲RGB值，是超像素m, n的边界的相邻像素对,


乙是平滑因子，	￡是所有的相邻超像素对的集合。确是权重。
A(Xs,X°)=ASm(^-X^)2	(3-15)
必5)=以"盘	(3-16)
Cl ~ l+exp(-(x2(hu,/iis)-J2))	° ")
儒=泮也導	(3-18)
再经过一系列的优化措施，求得XIX。的值。
利用该方法求得的显著性图的结果如图3-3最右边一列所示，可以看到图像被划分为 了一个一个的区域，并且每个区域的亮暗程度不同，即每个区域的显著性值不同。下面结 合具体的图像质量评价局部质量计算方法，来详细描述基于区域的加权策略。

3.2.3结合具体局部质量计算策略的区域加权策略
1)基于区域加权的SSIM[9]算法R-SSIM
前面已经详细的介绍过SSIM,并给出了计算质量图的过程下面直接给出基于区域加 权的 SSIM,即 R-SSIM
R-SSIMRj = —^SSIMi	(3-19)
yMQjR-SSIMR
R-SSIM= 一■、	(3-20)
其中，R」是参考图像或者失真图像中的第j个区域，Nr,是图像中第j个区域中的像素 级的SSIM(x,y)的值。cDr,是第j个区域的权重。
2)基于区域加权的MS-SSIM算法㈣
王周等人经过研究指出，人眼在观看失真图像时，离图像的距离并不是固定的。观察者离得近的看到图像尺寸大，离得远观看的图像尺寸小，于是提出了多尺度结构相似性算 法。多尺度结构相似性算法的描述如下：
MS-SSIM（x,y） = pM（x,y）r，川勺*）了 [sj（x,y）F	（3-21）
J=1
，（x,y）= 2竺 2**	（3-22）
用 +W +G
/	、 2o-rcr + C2
3时）=，±^	（3-23）
J +气,+。2
s （x, y） = —-~—	（3-24）
gQy + C3
其中卩X，咛分别为块x和y中像素的均值，描述的是对图像局部亮度的估值，敬，。'分 别为是x和y亮度的方差，描述的是对图像局部对比度的估值，是x和y的协方差，表明x 和y的结构相似性信息。C1,C2,C3是三个比较小的常数，通过以下表达式给岀C| =（K|L）2, C2=（K2L）2 C3=C2/2oL是图像中像素的动态范围°M = 5,即一共用了五个尺度参与计算，
四，闵和的分别为第j尺度下亮度，对比度，结构相似度的权重。这里令气邛j"j。通过实 验数据得出：
崗,用,冋，04，丹={0.0448,0.2856,0.3001,0.2363,0.1333}	(3-25)
在MS-SSIM的基础上R-MS-SSIM的定义如下：
对于' = {1,2,3,...,〃 —1}来说：

对于j=M来说
R-MS-SSIMjR“ = + p(Xj0,yjR“)c(XjR*yg)s(XjR,j,yg)	(3-28)
R-MS-SSIM计算表达式为：
R-MS?SSIM=[7 (R-MS-SSIM"	(3-29)
j=i
其中M为图像的级数，各级图像都是通过原始图像抽样获得，通常M越大，图像的 尺寸越小。
3)基于区域加权的 IW-SSIM (Information Content Weighted Structure Similarity)算法 王周等人提出了一种基于内容信息的较为复杂的，但是结果较好的算法"J。通过结合 本文所提出的基于区域加权的策略和1W-SSIM,实验结果表明R-IW-SSIM比IW-SSIM的结 果有所提高。
下面给出具体的介绍，IW-SSIM的权重计算公式如下：
<o=I(R;E)+I(D;E)-I(E;F)	(3-30)
其中R和D分别为参考图像和失真图像，E和F分别为R和D通过一个带有噪声的信道。 作者把R建模为高斯混合信号，具体可以表示为R = sU, U是一个零均值的高斯信号, s是一个乘机因子，并且D = SR + V, g是增益因子，V是高斯噪声，协方差为q=o仃.
E=R+N, =sU+N [	(3-31)
F=D+N2 =gsU+V+N2	(3-32)
其中Ni，N2是两个独立的高斯信号，并且有协方差矩阵Cn=CN2=q；Io
结合以上各式，3的最终表达式是
1K	2 / 2 1	2、
69=lW= — ￡log2< 1 +典+ 与+ _	s2\ >	(3-33)
2k=\	、b” I。” 丿
由于计算权重?采用了金子塔模型，所以一共有五个尺寸的权重图。
R-IW-SSIM也是基于原有的金字塔模型，分别划分五个尺度下的图像的区域，并在每 个尺度下都加入区域加权策略。具体计算表达式如下：
对于丿= {1,2,3,来说：
IW-SSIM  	 ￡i ①j，R”"s(Xj,R*.i，yJ,R,,,i)c(Xj.R,,,i,y."R”.i)
j，Rn
乙* j，R"
Enn
..QinlW-SSIMin
IY-1 VV -DD11V1 ?——~
J 时，
对于j = M来说

R-IW-SSIMj,R“ = + p(XjRi,,j,yj,%,i).c(Xg,yj，s)?s(Xj,R"yj,R"J	(3-36)
其中，丿?表示金字塔的第丿层，乌表示第层金字塔中被划分的的丿区域中的第力?个区 域。
R-IW-SSIM计算表达式为：
M
R-IW-SSIM=n(R-IW-SSIMj)Fj	(3-37)
j=i
4)基于区域加权的基于特征相似性FSIM的图像质量评价算法
Zhang等人提出了基于特征的图像质量评价算法四'，用到了图像中的梯度特征 (gradient magnitude, GM)和相位一致性特征(Phase congruency, PC)。
FSIM结合相位一致性和梯度幅度特征计算局部质量图
(3-38)



3.3本章实验
本章前面几节详细介绍了基于区域加权的图像质量评价算法，并给岀了结合SSIM、 MS-SSIM. FSIM、IW-SSIM四种算法的具体公式。下面列出算法的试验结果，已验证算 法的合理性和有效性。目前有很多的图像质量评价标准库，这些数据库由大学或者一些国 际机构维护。本章挑选两个有代表性的库，来进行我们的试验，分别为LIVE图像数据库 [4切和TID2008图像数据库[4刀。
3.3.1 LIVE和TID2008数据库
LIVE 图像数据库全名为 LIVE image Quality Assessment Database Release 2 是由美国德 州大学奥斯丁分校的图像与视频工程实验室建立的。LIVE数据库中包含29幅高分辨率的 RGB参考图像，内容包括自然场景、人造场景、动物、人物等各种元素。这29幅参考图 像经过 JPEG2000, JPEG, White Noise, Gaussian blur, Fast fading 这五种不同类型不同 程度的失真处理产生779幅失真图像〔48〕。在获得原始图像质量评分之后，经过统计方法, 比如除去异常评分等措施，便可得出失真图像的平均主观意见评价分数。而失真图像的差 异平均意见分（DMOS）通过计算参考图像与失真图像的主观意见评分差获得。差异平均 意见分越小，图像质量越好，反之，图像质量越差。
TID2008图像数据库由乌克兰国家航天航空大学、意大利罗马第三大学以及芬兰坦佩 雷理工大学创建㈣。TID2008数据库由25张参考图像以及由25张参考图像经17种失真 类型产生的1700张失真图像构成。这17种失真类型分别是：（1）加性高斯白噪声；（2）加性 噪声，但噪声的强度在CbCr两个彩色通道中是不均衡的；（3）加性噪声，噪声在空间位置 上相关联的；（4）掩盖加性噪声；（5）高频加性噪声；（6）椒盐噪声；（7）颜色量化失真；（8）高 斯核模糊失真；（9）图像去噪后的失真；（10）JPEG压缩失真；（ll）JPEG2000压缩失真； （12）JPEG图像通过快衰落信道引起的失真；（13）JPEG2000图像通过快衰落信道引起的失 真；（14）非反常失真；（15）块失真;（16）均值漂移失真；（17）图像对比度失真㈣。TID2008 图像数据库提供了图像的平均主观意见评价分数（MOS值）。


3.3.2实验结果
下面详细的给出本章的试验结果，试验是在TID2008数据库和LIVE数据库，PLCC, SROCC, RMSE, KROCC 作为评判指标。SSIM図、R-SSIM、MS-SSIM[24]> R-MS-SSIM、 IW-SSIM[44\ R-IW-SSIM. FSIM〔27]、R-FSIM、FSIMc[27\ R-FSIMc 10 中方法的结果 列于表3-1、3-2、3-3中。
表3-1 TID2008上面的结果
Model	PLCC	SROCC	RMSE	KROCC
ssim[9]	0.7732	0.7749	0.8511	　　　0.5768
R-SSIM	0.7919	0.7926	0.8187	　　　0.5942
ms-ssim[24]	　　　0.8451	0.8542	0.7173	　　　0.6568
R-MS-SSIM	0.8545	0.8609	0.6969	　　　0.6666
iw-ssim[44]	0.8579	0.8559	0.6895	　　　0.6636
R-IW-SSIM	0.8601	0.8611	0.6846	　　　0.6657
fsim[27]	0.8738	0.8805	0.6525	　　　0.6946
R-FSIM	0.8803	0.8858	0.6367	　　　0.7030
FSIMc[27]	0.8762	0.8840	0.6468	　　　0.6991
R-FSIMc	0.8836	0.8900	0.6283	　　　0.7088


表3-2 LIVE上面的结果
Model	　　　PLCC	SROCC	RMSE	　　　KRCC
SSIM	0.9449	0.9479	8.9455	0.7963
R-SSIM	　　　0.9491	0.9523	8.8609	　　　0.8085
MS-SSIM	　　　0.9489	0.9513	8.6188	　　　0.8045
R-MS-SSIM	　　　0.9512	0.9553	8.3100	　　　0.8090
IW-SSIM	　　　0.9522	0.9567	8.3473	　　　0.8175
R-IW-SSIM	　　　0.9577	0.9600	8.2100	　　　0.8200
FSIM	　　　0.9597	0.9634	7.6780	　　　0.8337
R-FSIM	　　　0.9644	0.9690	7.5380	　　　0.8355
FSIMc	0.9613	0.9645	7.5296	　　　0.8383
R-FSIMc	0.9689	0.9660	7.1244	　　　0.8400


表3-3在TID2008各个失真类型上的結果(SROCC)
Dis.Type	R-FSIMc	FSIMc	R-FSIM	FSIM	R-IW-SSIM	IW-SS1M	R-MS-SSIM	MS-SSIM
AGN	0.8754	°	0.8758	0.8599	0.8566	0.7920	0.7869	0.8024	0.8094
ANC	0.8934	0.8931	0.8610	0.8527	0.7892	0.7920	0.8034	0.8064
SCN	0.8713	0.8711	0.8514	0.8483	0.7704	0.7714	0.8166	0.8195
MN	0.8397	0.8264	0.8132	0.8217	0.8021	0.8087	0.8215	0.8155
HFN	0.9124	0.9156	0.9096	0.8670	0.9093	0.8662	0.8686	0.8685
IN	0.7892	0.7719	0.7677	0.6746	0.7452	0.6465	0.7051	0.6868
QN	0.8532	0.8726	0.8442	0.8073	0.8564	0.8177	0.8496	0.8537
GB	0.9514	0.9472	0.9514	0.9632	0.9472	0.9636	0.9605	0.9607
DEN	0.9614	0.9618	0.9594	0.9471	0.9603	0.9473	0.9591	0.9571
JPEG	0.9283	0.9294	0.9261	0.9224	0.9279	0.9184	0.9313	0.9348
JP2K	0.9799	0.9780	0.9787	0.9745	0.9773	0.9738	0.9736	0.9736
JGTE	0.9004	0.8756	0.8939	0.8841	0.8708	0.8588	0.8846	0.8736
J2TE	0.8589	0.8555	0.8587	0.8281	0.8544	0.8203	0.8581	0.8525
NEPN	0.7723	0.7514	0.7679	0.7817	0.7491	0.7724	0.7597	0.7336
Block	0.8295	0.8464	0.8279	0.7686	0.8492	0.7623	0.7636	0.7617
MS	0.6724	0.6554	0.6774	0.7122	0.6720	0.7067	0.7429	0.7374
CTC	0.6571	0.6510	0.6556	0.6345	0.6481	0.6301	0.6364	0.6400

表3-1和3-2分别给出了以上20种方法在TID2008和LIVE数据库上面结果，从表3-1 可以看出，在TID2008上SROCC、KROCC、PLCC基于区域加权进行改进的算法R-SSIM、 R-MS-SSIM. R-IW-SSIM、R-FSIM、R-FSIMc均比原来未改进的算法值要高。同时，基 于区域加权进行改进的 R-SSIM、R-MS-SSIM、R-IW-SSIM、R-FSIM、R-FSIMc 的 RMSE 的取值均比原来的算法要低。表3-2以上10个算法在LIVE数据库上的结果也表明基于区 域加权的算法 R-SSIM、R-MS-SSIM、R-IW-SSIM、R-FSIM、R-FSIMc 相较于 SSIM、MS-SSIM、 IW-SSIM、FSIM、FSIMc 有较高的 SROCC、KROCC、PLCC 和较低的 RMSE。以上的结 果充分说明基于区域加权的算法R-SSIM、R-MS-SSIM, R-IW-SSIM、R-FSIM、R-FSIMc 更加符合人眼的特性，更加的接近主观质量的评分。表3-4还给出了在TID2008的各个失 真类型上以上10种算法的结果。这里的评价指标采用了 SROCC。可以看出在大部分的失 真类型上改进的算法表现出较好的性能。这再一次说明基于区域加权的算法更加符合人眼 的特性。
经过用logistics函数进行非线性拟合之后的曲线(这里只给出了在TID2008数据的非 线性拟合的结果)：



图3-7在TID2008上的拟合曲线
图3-7中，第一行为SSIM和R-SSIM非线性拟合的结果，第二行为MS-SSIM和 R-MS-SSIM的结果，第三行是IW-SSIM和R-IW-SSIM的结果，第四行是FSIM和R-SSIM 非线性拟合的结果。从这些曲线中可以看出，经过区域加权改进的SSIM, MS-SSIM,

IW-SSIM和FSIM比没有经过区域加权的算法图像中离散的点更加的聚集。说明本文提出 的经过区域加权的算法更加符合人眼的特性。
3.4本章小结
本章主要介绍了基于区域加权的图像质量评价算法。首先介绍已有的图像质量评价加 权策略，然后详细介绍本文所提出的二级加权策略，接着把本文所提的基于区域的加权策 略和已有的图像质量评价算法相结合，给出具体的算法表达式，最后给出本章算法的实验 结果。通过对试验结果的分析以及和其他算法的比较，论述本算法的优点和有效性。

第四章基于内容信息相似性的图像质量评价算法
图像的客观质量评价方法是为了更好地拟合人眼视觉系统(HVS)的感觉特性，HVS 可以看成是--个信息提取系统。当图像中有失真的时候，被提取的信息也会变化。根据这 一特性，已有的很多图像质量评价算法取得了很好的成绩。比如视觉信息保真度模型SI (Visual information fidelity, VIF)算法把对全参考图像质量评价问题作为信息保真度问题， 并把信息保真度量化为参考图像和失真图像之间的互信息。内容信息加权算法(information content weighting)提出对于图像中的不同部分［44-50］, HVS提取的信息是不同的。于是根据 提取信息的多和少来决定图像的那一部分更受关注，那么这一部分的图像的质量就应该赋 予更多的权重。既然HVS是…个信息接受者，参考图像和失真图像由于HVS的感觉不同， 那么HVS对参考图像和失真图像提取的信息必然不同。本部分正是基于此，提出了一种 新的全参考图像质量评价算法。由于图像中的信息和图像的内容信息，因此本部分命名为 基于内容信息的图像质量评价算法。利用信息论的知识，本文对图像的内容信息进行建模。 通过比较局部内容信息的相似性来对失真图像的质量进行评价。但是研究表明由于对内容 信息的简单建模，仅仅基于内容信息的图像质量评价对图像中的对比度失真和颜色失真捕 捉效果不是很好。梯度被认为是能够很好地捕捉图像中的对比度失真。因此在内容信息的 基础上，又加入了梯度信息和颜色信息来对图像进行评价。
4.1本章算法介绍
下面几部分详细介绍基于内容信息的图像质量评价算法。
4.1.1内容信息相似性
人眼是一个很好地信息提取者，信息论的知识在图像质量评价领域早有应用，基于信 息保真度准则的ifc［51］和vif〔22］通过对参考图像和失真图像的互信息进行建模来对图像进 行评价取得了很好的效果，内容信息(information content, IW)加权方式通过计算图像的 内容信息来对图像的局部质量进行加权［44'50］o试验表明，IW加权算法，相对于闵可夫斯基 和基于局部质量的加权策略更加符合人眼的特性。本文在研究已有的算法的基础上结合信 息论的知识，对图像的内容信息进行建模，具体如下：
为了简单起见，假设人眼是一个高斯噪声信道，并且假设图像(参考图像和失真图像) 局部块中的亮度值分部为高斯型。这种假设在SSIM［9］中也有用到。根据信息论的知识，如 果信号是高斯并且信道也是高斯型的，那么这种模型成为双高斯模型。根据信息轮的知识， 假设信源的功率为S,信道的功率为N,那么接受到的信息可以描述为

I =-log(l + S/N)	(4-1)
假设x是参考图像中某一个局部块的位置，也相应的是失真图像中所X寸应的位置，那 么局部的内容信息（informationcontent, IC）可以描述为
ICi （x） = jlog （1 + 气勺	（4-2）
@3）=泗（1+零）	（4-3）
其中，IC1。）是参考图像的局部内容信息，IC2（X）是失真图像的局部内容信息，bR（x）是 参考图像的局部亮度的方差，bD（x）是失真图像的局部亮度的方差，N是模拟人眼的高斯信 道的方差。以上各式是通过窗口来来计算的，每一个局部是一个大小为size* size的窗口。 也就是将一个大小为size * size的窗依次划过图像，每一个窗有一个IC值。因为假设人眼 的信道是高斯的，所以该size * size的窗是一个高斯窗，高斯窗的方差选择为1.5。窗的大 小会在试验部分进行设定。
下图是两张基于以上两式计算的IC图。
图4-1给出了三张图像的IC map图，其中最上方的两张为参考图像及其对应的IC图。 下面的两行分别为JPEG2000和JPEG类型失真的图像。从图4-1可以看出，每当图像有变 化和失真时，该图像所对应的IC图也会出现变化。
为了进一步的说明IC特征的有效性，我们做了一个实验，在数据库TID2013[52]（一 个用于图像质量评价的标准数据库）上面，计算所有失真类型（24个失真类型，每种失真 类型125张图片）的图片的IC图和参考图像的IC图的均方误差值（MSE）。TID2013的每 张失真图片都给出了图片的主观平均分值（MOS）。每个失真类型一共有五个真尺度，分 别为level 1至U level 5,其中level 5失真最为严重，相应的MOS也比较低。对于每一个失 真类型每一个失真尺度下的所有图片计算平均的MSE值和对应的平均的MOS值，计算结 果下表所示：



(f)
图4-1相应的参考图像和待评价图像及其对应的IC图,(a)mos=5, (b)mos=4.511 (c)mos=2.422,
MSE (d, b) =26.81, MSE (f, b) =122.31

表4-1 TID2013数据库上各个失真类型各个尺度下的平均RMSE和平均MOS
Type	Level 1	Level 2	Level 3	Level 4	Level 5
AGN	6.73	17.33	40.31	82.81	154.09
(MOS)	5.67	5.23	4.85	4.25	3.77
ANC	0.88	2.43	7.03	17.920	40.84
(MOS)	5.93	5.85	5.53	5.07	448
SCN	24.49	52.89	106.45	191.49	31827
(MOS)	4.76	4.24	3.71	3.20	2.70
MN	0.14	0.30	0.66	1.53	3.69
(MOS)	5.92	5.79	5.51	5.09	4.48
HFN	2.16	6.11	28.26	95.46	248.09
(MOS)	5.89	5.64	5.12	4.16	3.23
IN	1430	35J9	70.72	129.67	219.13
(MOS)	4.72	4.36	3.99	3.64	3.27
QN	13.05	28.61	50.80	82.18	157.0
(MOS)	5.25	4.69	4.11	3.47	42.83
GB	3.53	12.19	44.18	143.95	340.10
(MOS)	5.66	5.03	4.16	3.32	2.46
DEN	8.45	17.08	43.15	115.36	299.27
(MOS)	6.07	5.75	4.82	3.44	2.02
JPEG	0.39	1.04	5.64	45.17	154.89
(MOS)	5.94	5.70	4.92	3.31	2.08
JP2K	3.91	15.07	61.52	144.06	384.31
(MOS)	5.65	5.03	3.92	2.80	1.28
JGTE	1.31	5.08	22.78	46.52	114.42
(MOS)	5.74	5.41	4.61	3.88	2.98
J2TE	21.32	60.40	11545	243.77	373.09
(MOS)	4.89	4.19	3.62	2.97	2.60
NEPN	1.90	0.71	3.71	8.62	16.46
(MOS)	5.72	5.90	5.33	4.72	3.86
Block	30.79	58.90	81.77	103.85	125.48
(MOS)	4.07	3.73	3.48	3.34	3.28
MS	0.02	0.30	1.53	3.66	13.84
(MOS)	6.08	6.07	5.64	5.34	4.66
CTC	4.61	13.18	33.09	51.68	183.04
(MOS)	5.63	6.48	4.48	6.29	3.45
CCS	0.1072	0.1027	0.1066	0.11	0.13
(MOS)	5.06	4.66	4.23	3.93	3.69
MGN	8.68	20.98	45.11	88.89	159.86
(MOS)	5.52	5.14	4.70	4.13	3.68

（续上表）
Type	Level 1	Level 2	Level 3	Level 4	Level 5
CN	0.74	1.85	5.13	12.95	29.14
(MOS)	5.88	5.55	5.01	4.17	3.31
LCNI	4.01	10.55	26.54	60.23	118.04
(MOS)	5.52	5.00	4.33	3.53	2.50
ICQD	2.82	7.45	21.49	56.53	183.38
(MOS)	5.69	5.27	4.59	3.79	2.91
CHA	0.86	4.94	35.23	91.03	262.32
(MOS)	6.11	5.88	5.19	4.41	3.01
SSR	6.87	20.20	62.34	162.80	434.54
(MOS)	5.77	5.10	3.99	2.61	0.95

表4-1给出了各个失真类型下的参考图像的IC map和其对应的参考图像的IC map之 间的MSE的平均值。从表4-1可以看出，在几乎所有的失真类型上，随着图像质量的下降 （MOS的值越来越小），所对应的平均MSE的值也增大。图4-1也给出了单个失真图片与 其参考图片的IC图之间的MSE,可以看出MOS越小，MSE越大。由此说明我们所用的 IC特征非常的有效。
再看表4-1,我们发现在CTC （对比度失真）和CCS （色度失真），IC map表现的不 是很好。所以这就激发了我们探讨另外的特征，来对IC特征进行补充。从大量的参考文 献里得知，梯度信息对于描述对比度的失真，非常的有效。而对于色度的失真，我们采用 了在去掉图像亮度的信息之后计算图像的色调和饱和度相似性。下面对梯度特征和色度特 征做详细的描述。
表4-2截取表4-1中的CTC和CCS
CTC	4.61	13.18	33.09	51.68	183.04
(MOS)	5.63	6.48	4.48	6.29	3.45
CCS	0.1072	0.1027	0.1066	0.11	0.13
(MOS)	5.06	4.66	4.23	3.93	3.69

4.1.2梯度特征
人眼更加关注的是图像中的边缘信息，梯度是对边界信息的很好描述，而且梯度特征 在描述图像的对比度失真方面非常的有效。很多的图像质量评价算法也采用了梯度算子。 例如刘等人基于梯度相似性的图像质量评价算法，整个算法就只用了梯度信息和亮度信息。 张等人的基于特征相似性的图像质量评价算法，用到了 Scharr梯度算子SI,而陈等人的 GSSIM算法DI,是在梯度图的基础计算SSIM值，用的是Sobel梯度算子⑴。下面详细介 绍本文所用到的梯度特征描述符。
本文采用了 Prewitt梯度算子卩】，Prewit梯度算子描述如下：
4.1.3 基于内容信息的图像质量评价
（1）内容信息相似性
(2)梯度相似性
假设GM|(x)是参考图像梯度幅度图，GM2(x)是失真图像的梯度幅度图，则梯度幅度 相似性定义为如下：
S = 2GM](x)?GM2(x)+C2
GM GM21(x)+GM22(x)+C2
(3)色度相似性
人类视觉系统(HVS)不仅对图像的亮度信息感兴趣，也会对图像的色度信息感兴趣。
内容信息相似性和梯度相似性是在图像的亮度分量上进行计算(灰度图)，色度信息的提 取需要把图像的RGB表示转化为亮度色调和饱和度的表示，本文采用了文章【涸所给出的 转换公式，具体如下：

假设和叫(x)分别为参考图像的M分量和N分量，山2<>)和N#)分别为参考 图像的M分量和N分量。下面给出色度相似性的计算公式：

S , )_2M,(x)-M2(x)+C3
Mt M21(x)+M22(x)+C3	(4-H)
S(：；)_2N|(x)?N2(x)+C3
n 丿 N2,(x)+N22(x)+C3	(4-12)
Sc(x)=SM-SN	(4-13)

其中，C,, C2, C3为常数，为了保持上面两式的稳定性。
(4)这样基于内容信息的图像质量评价方法(ICSIM),最终可以表示为：
ICSIM(x) = [S/C(x)]? * [Sgm(x)]〃 * [Sc(x)]*	(4-14)
其中，a, 6, y分别为权重因子。通过调节a, P，丫使得ICSIM的性能达到最优，在 本章的实验部分，通多迭代寻优，确定a, P，y的值。
人眼对不同图像不同部位提取的信息不同，更加感兴趣的区域提取的信息多更多，因 此内容信息作为权值用来对局部的质量值进行加权：具体如下式所示：
3 = IC](x) + IC2(x)	(4-15)
其中/C,(x)和/G(x)是和式(3-1)、	(3-2)计算表达式一致。因此最后整个图像的
质量分值为
M
^w-ICSIM(x)
ICSIM= 一		(4-16)
其中M为局部质量的个数。
4.2本章实验部分
为了客观地衡量图像质量评价方法效果的好坏，最直观且最有效的办法就是将图像质 量评价方法的结果与人为主观评价的结果进行对比，并进行分析。为了对质量评价算法的 质量进行评价，目前一些大学和学者创建了图像质量评价数据，常见的图像质量评价数据 库为：LIVE database?, Categorical Image Quality (CSIQ) database[54], Tampere Image Database 2008 (TID2008)印1, Tampere Image Database 2013 database (TID2013)其〕。
4.2.1 CSIQ和TID2013数据库
在第三章的时候已经详细介绍过了 TID2008数据库和LIVE数据库，这里只详细介绍 CSIQ数据库和TID2013数据库。CSIQ数据库由Oklahoma state university创建，支持与维
39 护。它包含30张无失真的参考图像，以及由这些参考图像所产生的866张失真的图像。 失真类型有6种，分别为：JPEG压缩失真，JP2K失真图像，全局对比度失真，高斯噪声 产生的失真，高斯模糊失真图像。每种失真有五个失真尺度。每个失真图像都提供了平均 意见分值。
TID2013图像数据库是TID2008图像数据库的更新版本。TID2013数据库由25张参 考图像以及由25张参考图像经24种失真类型产生的3000张失真图像构成。这24种失真 类型分别是：（1）加性高斯白噪声；（2）加性噪声，但噪声的强度在CbCr两个彩色通道中是 不均衡的；（3）加性噪声，噪声在空间位置上相关联的；（4）掩盖加性噪声，即失真图像的某 一区域完全被噪声所覆盖，该区域完全看不到图像内容；（5）高频加性噪声；（6）冲击加性噪 声，有的文献里又称之为椒盐噪声；（7）颜色量化失真；（8）高斯核模糊失真；（9）图像去噪 后的失真；（10）JPEG压缩失真；（ll）JPEG2000压缩失真；（12）JPEG图像传输中遇到快衰 落丢失某些比特造成的失真；（13）JPEG2000图像传输中遇到快衰落丢失某些比特造成的失 真［49】；（14）非反常失真，这种失真将某个小图像块由它附近的图像块取代，在没有参考图 像时，这种失真很难由人类视觉系统观察到；（15）块失真，某些图像块被某一种颜色覆盖； （16）均值漂移失真；（17）图像对比度失真㈣；（18）图像饱和度失真；（19）乘性高斯噪声失真； （20）舒适噪声；（21）噪声图像损耗压缩；（22）图像色彩量化抖动；（23）色差；（17）系数采样与 重构。TID2013图像数据库提供了图像的平均主观意见评价分数MOS值。
4.2.2参数的确定
（1）	高斯窗大小的确定
在4.1.1中，为了计算简单我们把人眼信道假设高斯信道，为了计算的更为准确，采 用大小为size* size的高斯窗在整个图像上进行滑动。在文献°用的窗的大小为11*11,这里 为了使我们的算法更有效，对高斯窗的大小进行寻优。寻优方法为：随机选取TID2008图 像库1700张图片库中的500张失真图像，以SROCC作为衡量size大小的准则（实际上采 用其他三种评价指标得到的结果完全相同）在TID2008得到的size和SROCC的关系图如 下图所示：


图 4-2 SROCC vs local patch size
由图4-3的结果，我们最终选取的size的大小为61*61.
(2)a, p, 丫的值
对于a, 6, y，我们釆用的是一种迭代的策略，随机选取了 TID2008图像库中的10张 参考原图所对应的680张17种失真类型的图像。设定a, 6, y的初始值，在每次迭代式如 果当前的a, p, y值所得到的SROCC值比较大，就更新，否则不更新。直到a,y的值 最终趋于稳定。我们进行三次这样的迭代过程，每次都随机选取10张参考图所对应的680 张失真图。这三次迭代的最终结果特别的相近，最终我们确定a = 0.01, p = 0.12, y = 0.008.
(3)Cl, C2, C3,的值
试验发现Cl, C2, C3的取值对于算法的结果影响不大。所以Cl, C2, C3的值采用了 随机选取的策略。
4.2.3试验结果及分析
一个好的算法，应该具有较高的PLCC值，SROCC值，KROCC值和较小的RMSE值。 SSIM [9]> MS-SSIM [24\ VIF [22\ VSNRp3\ MAD 网、GSM [28]> IW-SSIM [44]和FSIMc㈣ 全参考图像质量评价领域的8大算法以及我们的算法进行了比较，结果见如下表格：

表4-3九种算法在tid2013上面的结果
Model	SROCC	PLCC	KROCC	　　　RMSE
ssim[9]	0.7417	0.7895	0.5588	0.7608
ms-ssim[24]	0.7859	0.8329	0.6047	　　　0.6861
VIF四	0.6769	0.7720	0.5147	　　　0.7880
VSNR〔23]	0.6812	0.7402	0.5084	　　　0.8392
mad[26]	0.7807	0.8267	0.6035	　　　0.6975
gsm[28]	0.7946	0.8464	0.6255	　　　0.6603
iw-ssim[44]	0.7779	0.8319	0.5977	　　　0.6880
FSIMc[27]	0.8510	0.8769	0.6665	　　　0.5959
Our ICSIM	0.8710	0.8902	0.6899	　　　0.5647


表4.4九种算法在tid2008上面的结果
Model	SROCC	PLCC	KROCC	　　　RMSE
ssim[9]	0.7749	0.7732	　　　0.5768	　　　0.8511
ms-ssim[24]	0.8542	0.8451	0.6568	　　　0.7173
ViF〔22】	0.7491	0.8084	0.5860	　　　0.7899
vsnr[23]	0.8340	0.6820	0.5340	　　　0.9815
mad[26]	0.7807	0.8308	　　　0.6445	　　　0.7468
gsm[28]	0.8504	0.8422	0.6596	　　　0.7235
iw-ssim[44]	0.8559	0.8579	0.6636	　　　0.6895
FSIMc[27]	0.8840	0.8762	　　　0.6991	　　　0.6468
Our ICSIM	0.8949	0.8832	0.7125	　　　0.6294


表4.5九种算法在CSIQ上面的结果
Model	SROCC	PLCC	KROCC	　　　RMSE
SSIM 図	0.8756	0.8613	0.6907	　　　0.1334
ms-ssim[24]	0.9133	0.8991	0.7393	　　　0.1149
vif[22]	0.9195	0.9277	0.7537	　　　0.0980
vsnr[23]	0.8106	0.8002	0.6247	　　　0.1575
mad[26]	0.9466	0.9502	0.7970	　　　0.0818
GSM㈣	0.9108	0.8964	0.7374	　　　0.1164
1W-SSIM[441	0.9213	0.9144	0.7529	　　　0.1063
FSIMc[27]	0.9310	0.9192	0.7690	　　　0.1034
Our ICSIM	0.9415	0,9297	0.7898	　　　0.0960

表4-6九种算法在LIVE上面的结果
Model	SROCC	PLCC	KROCC	　　　RMSE
ssim[9]	0.9479	0.9449	0.7963	　　　8.9455
ms-ssim[24]	0.9513	0.9489	0.8045	　　　8.6188
VIF〔22]	0.9636	0.9604	0.8282	　　　7.6137
vsnr[23]	0.9274	0.923 1	0.7616	　　　10.506
MAD㈣	0.9669	0.9675	0.8421	　　　6.9073
gsm[28]	0.9561	0.9512	0.8150	　　　8.4327
iw-ssim[44]	0.9567	0.9522	0.8175	　　　8.3473
FSIMc[27]	0.9645	0.9613	0.8363	　　　7.5296
Our ICSIM	0.9652	0.9615	0.8357	　　　7.5052

表4-3、表4-4,表4-5、表4-6给出了九种图像质量评价算法的KROCC, SROCC, PLCC和RMSE的分别在TID2013数据库、TID2008数据库、CSIQ数据库、LIVE数据库 上面的结果。从结果可以看出我们的ICSIM方法在这四个图像质量评价库上都表现出了较 好的性能。具体的说，在TID2013和TID2008上面，我们的算法无论在KROCC, SROCC, PLCC和RMSE评价指标下，在所比较的九种算法中都是最好的。在CSIQ数据库和LIVE 数据库上面，虽然ICSIM在KROCC, SROCC, PLCC和RMSE指标上面结果不是最好的 但结果距离最好的方法MAD的差距也是非常小的。另外，虽然MAD算法在LIVE和CSIQ 上效果较好，但是在TID2008和TID2013上的表现却性能较差。而且MAD方法的计算复 杂度很高，在实际中几乎很难去应用。还有利用图像内容信息和信息论方法的VIF和 IW-SSIM方法不论在TID2013数据库、TID2008数据库还是CSIQ数据库、LIVE数据库 也不管是KROCC, SROCC, PLCC和RMSE指标上面均没有本章提出的算法ICSIM的性 能好。更要强调的是虽然GSM方法也采用梯度算子，但是我们的以内容信息结合梯度特 征的方法，效果更好。
表 4-7 还给出了 ICSIM 和 SSIM, MS-SSIM, VIF, VSNR, MAD, GSM, IW-SSIM 和 FSIMc在TID2013数据库、TID2008数据库、CSIQ数据库、LIVE数据库各个失真类型上 的性能情况，不难看出我们的方法在许多失真类型上也取得了较好的效果。
由以上的分析充分说本章提出的基于内容信息的ICSIM图像质量评价方法在评价图 像质量方面的有效性和优越性。


表4-7各个失真类型上九种算法的结果
Distion
type	SSIM	MS-SS
IM	VIF	VSNR	MAD	GSM	IW-SSI
M	FSIMc	ICSIM
T
1
D
2
0
1
3	AGN	0.8671	0.8646	0.8994	0.8271	0.8843	0.9064	0.8438	0.9101	0.9294
ANC	0.7726	0.7730	0.8299	0.7305	0.8019	0.8175	0.7515	0.8537	0.8642
SCN	0.8515	0.8544	0.8835	0.8013	0.8911	0.9185	0.8167	0.8900	0.9280
MN	0.7767	0.8073	0.8450	0.7072	0.7380	0.7293	0.8020	0.8094	0.8052
HFN	0.8634	0.8604	0.8972	0.8876	0.8869	0.8553	0.9040	0.9130	0.9200
IN	0.7503	0.7629	0.8537	0.7363	0.2769	0.7965	0.7281	0.8251	0.8657
QN	0.8675	0.8706	0.7854	0.8357	0.8514	0.8841	0.8468	0.8807	0.8730
GB	0.9668	0.9673	0.9650	0.9470	0.9319	0.9689	0.9701	0.9551	0.9638
DEN	0.9254	0.9268	0.8911	0.9081	0.9252	0.9432	0.9152	0.9330	0.9457
JPEG	0.9200	0.9265	0.9192	0.9008	0.9217	0.9284	0.9187	0.9339	0.9505
JP2K	0.9468	0.9504	0.9516	0.9273	0.9511	0.9602	0.9506	0.9589	0.9711
JGTE	0.8493	0.8475	0.8409	0.7908	0.8283	0.8512	0.8388	0.8610	0,9051
J2TE	0.8828	0.8889	0.8761	0.8407	0.8788	0.9182	0.8656	0.8919	0.9140
NEPN	0.7821	0.7968	0.7720	0.6653	0.8315	0.8130	0.8011	0.7937	0.8203
Block	0.5720	0.4801	0.5306	0.1771	0.2812	0.6418	0.3717	0.5532	0.5514
MS	0.7752	0.7906	0.6276	0.7736	0.7487	0.7833	0.7875	0.6450	0.4871
CTC	0.3775	0.4634	0.8386	0.3320	0.1972	0.4857	0.4593	0.4679	0.4770
CCS	0.4141	0.4099	0.3099	0.3677	0.0575	0.3578	0.4196	0.8359	0.8042
MGN	0.7803	0.7786	0.8468	0.7644	0.8409	0.8348	0.7728	0.8569	0.8941
CN	0.8566	0.8528	0.8946	0.8683	0.9046	0.9124	0.8762	0.9135	0.9270
LCNI	0.9057	0.9086	0.9204	0.8821	0.9443	0.9563	0.9037	0.9485	0.9611
ICQD	0.8542	0.8555	0.8414	0.8667	0.8745	0.8973	0.8401	0.8815	0.8840
CHA	0.8775	0.8784	0.8848	0.8645	0.8310	0.8823	0.8682	0.8925	0.8767
SSR	0.9353	0.9461	0.9483	0.9339	0.9567	0.9668	0.9474	0.9576	0.9654
T
1
D
2
0
0
8	ANC	0.8029	0.8054	0.8757	0.7793	0.8255	0.8091	0.7920	0.8931	0.9115
SCN	0.8144	0.8209	0.8698	0.7665	0.8678	0.8941	0.7714	0.8711	0.9248
MN	0.7795	0.8107	0.8683	0.7295	0.7336	0.7452	0.8087	0.8264	0.8148
HFN	0.8729	0.8694	0.9075	0.8811	0.8864	0.8945	0.8662	0.9156	0.9146
QN	0.851	0.8589	0.7970	0.8270	0.8160	0.8800	0.8177	0.8726	0.8624
IN	0.6732	0.6907	0.8327	0.6471	0.0650	0.7235	0.6465	0.7719	0.8302
GB	0.9544	0.9563	0.9540	0.9330	0.9196	0.9600	0.9636	0.9472	0.9504
44

（续上表）
Distion
type	SSIM	MS-SS
IM	VIF	VSNR	MAD	GSM	IW-SSI
M	FSIMc	ICSIM
T	DEN	0.9530	0.9582	0.9161	0.9286	0.9433	0.9725	0.9473	0.9618	0.9690
I	JPEG	0.9252	0.9322	0.9168	0.9174	0.9275	0.9393	0.9184	0.9294	0.9498
D	JP2K	0.9625	0.9700	0.9709	0.9515	0.9707	0.9758	0.9738	0.9780	0.9829
2	JGTE	0.8678	0.8681	0.8585	0.8055	0.8661	0.8790	0.8588	0.8756	0.9061
0	J2TE	0.8577	0.8606	0.8501	0.7909	0.8394	0.8936	0.8203	0.8555	0.8850
0	NEPN	0.7107	0.7377	0.7619	0.5716	0.8287	0.7386	0.7724	0.7514	0.8005
8	Block	0.8462	0.7546	0.8324	0.1926	0.7970	0.8862	0.7623	0.8464	0.8346
MS	0.7231	0.7336	0.5096	0.3715	0.5163	0.7190	0.7067	0.6554	0.6885
CTC	0.5246	0.6381	0.8188	0.4239	0.2723	0.6691	0.6301	0.6510	0.6469
L	JP2K	0.9614	0.9627	0.9696	0.9551	0.9676	0.9700	0.9649	0.9724	0.9718
I	JPEG	0.9764	0.9815	0.9846	0.9657	0.9764	0.9778	0.9808	0.9840	0.9841
V	AWGN	0.9694	0.9733	0.9858	0.9785	0.9844	0.9774	0.9667	0.9716	0.9716
E	GB	0.9517	0.9542	0.9728	0.9413	0.9465	0.9518	0.9720	0.9708	0.9653
FF	0.9556	0.9471	0.9650	0.9027	0.9569	0.9402	0.9442	0.9519	0.9503


表4-8每种算法每张图片的平均时间
Model	SSIM	MS-SSIM	VIF	VSNR	MAD	GSM	IW-SS1M	FSIMc	ICSIM
时间（毫
秒）	28.0	110.6	880.3	37.4	1186.4	28.8	421.6	210.9	50.8

实际上，我们的算法不仅性能上是非常好的，算法所消耗的时间也是比较小的。表3-6 给出了 ICSIM和其他8种算法对每张图片进行评价所消耗的平均时间。我们采用的计算机 平台是四核，8G内存，3.30GHz CPUo
从表4-8可以直观的看出我们的算法ICSIM （50.8）所消耗的时间仅为SSIM（28.0
）的不到两倍的时间，而像同样利用信息论知识的VIF的时间性能上为880.3毫秒，在 LIVE和TID2008数据集上的MAD的性能很好，但是时间效率上却是1186.4毫秒，大约是 ICSIM的43倍之多。同样用到图像梯度信息的GSM,虽然时间上（28.8）毫秒比ICSIM 快一点，但是在四个数据库上的性能却都不如ICSIMo下面给出在TID2008 ±面这九种算 法利用logistics函数的得到的拟合曲线图。



图4-3 8种算法在TID2008上的拟合曲线图
图 4-3 给出了 ICSIM 和 SS1M【9I、MS-SSIM 网、VIF [22\ VSNR [23]> MAD [26\ GSM ㈣、IW-SSIM〔44]和FSIMc[27]在TID2008数据库上的散点以及拟合曲线图。从图4-3可 以看出可以看出我们的算法ICSIM的离散点更加的集中，VSNR最为吱散。说明ICSIM在 TID2008与人的主观评分更为接近。
4.3本章小结
本章主要介绍了把内容信息作为图像质量评价的一维特征的基于内容信息的图像质 量评价算法。首先对图像的内容信息进行建模，并且详细介绍了针对内容信息建模的某些 局限性，引入的梯度和色度两个特征，最后给出了算法的整体表达式。接下来介绍了本章 试验部分所用到的数据库，给出了详细的实验结果。并给出实验结果的详细分析已验证本 文算法的有效性。

第五章色调映射图像质量评价算法
色调映射转换器会丢失高动态范围图像的很多信息，比如细节动态范围等。由 于动态范围的损失，色调映射转换器所进行的转换必然会造成图像质量的损失。非 常多的研究结果表明人眼对于一幅图像的边缘和轮廓非常敏感，因为对于人眼而言, 在获取一幅图像的时候边缘和轮廓是获取一幅图像结构信息最重要的部分。基于这 种理论，图像的梯度图被用到很多图像质量评价算法中，如Chen等人〔25］提出了基 于梯度的结构相似性(GSSIM), Liu等人的基于梯度相似性的图像质量评价算法/J。 而且梯度可以详细的捕捉到图像中的对比度失真和结构性失真。这就激发我们将图 像的梯度信息运用到色调映射图像质量评价上面来。一副图片也应该看起来更加的 自然，图像的自然性作为色调映射图像评价的第二个特征被釆用。算法的框架如下 图所示：




图5-1本章算法框图

下面具体描述本章的算法。
5.1梯度相似性测量
有很多方法可以获得图像的边缘信息，比如边缘检测算法DR,局部梯度法等等。 结构相似性方法提供了一种有效实用的测量图像之间相似性的思路。通过寻找一种 合适的梯度算子来求取图像的梯度信息。
由于大多数文献中采用的三阶梯度算子比较简单，本文釆用了一个五阶的梯度算子，描述如下:

「0	1	0	-1	O'		■ 0	　0	　0	　0	0_
0	3	0	-3	0		　1	　3	　8	　3	　1
gl =	0	8	0	-8	0	g2 =	　0	　0	　0	　0	　0
0	3	0	-3	0		-1	-3	-8	—3	-1
0	1	0	-1	0_		_ 0	　0	　0	　0	　0_

其中，gl, g2, g3, g4来源于文献参考文献 Image quality assessment based on gradient similarityo gl是水平梯度算子，g2是垂直梯度算子，g3和g4为对角线方向的 梯度算子。
假设/(X)为一副图像，x图像中任意像素点，GM(x)为最后的梯度幅度图，则 GM】(x) =^(gl*I(x))2+(g2*I(x))2	(5-1)
GM? (x)=J(g3*I(x)y +(g4*I(x)y	(5-2)
GM(x)=max{GM| (x),GM, (x)}
其中，”*”代表卷积算子。
用以上的过程分别应用到带参考的HDR图像和待评价的LDR色调映射图像。 但是，色调映射图像势必会改变局部的强度和对比度，直接对比局部梯度的方法不 可取。需要把局部梯度幅度值进行适当的转换，分别令从高动态范围图像与经色调 映射转换的低动态范围图像提取得到的对应的块分别为x和y表示。假设未修正的高 动态范围图像所对应的梯度幅度图和低动态范围图分别为GMh，GMi，则局部梯度幅 度相似性度测量数学表达形式为：

其中GM“x)是经过修正的高动态范围图像所对应的梯度幅度图，GM；(x)是经过 修正的低动态范围图像所对应的梯度幅度图。匕是为了维持公式稳定的常量。下面 讨论变换原则，变换的两个主要约束条件为：第一，高动态范围图像与低动态范围 图像块区的信号强度差异不应该受到它们的信号强度的影响，比如会出现它们的信 号显著性都超过了阈值或者它们的信号强度都没有达到阈值。第二，算法应该减小
50 受到某张图像的信号强度尤其显著而另一张图像的强度尤其不显著这种情况的影响。 将局部标准差GM(x)进行非线性映射，以区分分辨信号强度的显著度，进而得 到GM，(x)的值。经过这种非线性映射之后，过于显著的信号强度值被映射成了 1而 不显著的信号强度值被映射成了 0,而其中的信号则有一个0到1之间的平滑的取 值。因此，这种非线性映射与对比度的视觉敏感性有关"I。实际上，人类视觉系统 对于对比度的检测并没有固定的门限，根据相关对人类视觉系统的研究发现这种检 测概率是随着观察物体的对比度的变化增加的。经过心理物理学进行的实验，构造 出了信号强度检测概率心理测量学函数模型。心理测量学函数图像呈现为一个S形， 感知门限-般被定为检测概率的50%o而使用的函数形式为：
P(s)=爲』二咬[-dx	(5-5)
式中P即为检测概率密度，S为正弦刺激函数的幅度，压为调制阈值，虫为控制 检测概率变化斜率的归一化分布的标准差，而比值：
k =頒	(5-6)
可以粗略认为k是一个常数。而k的取值一般是2.3至4之间，而当k = 3可以 使得假警报量达到非常的小。
而调制阈值门限乌的倒数经常用来量化视觉对比敏感度，视觉对比敏感度是一 个与空间频率有关的函数，即对比度灵敏度函数。并通过如下对比度灵敏度函数方 程与不同心理实验中获得的数据进行匹配：
A(f) ? 2.6[0.0192 + 0.114f]exp[—(0.114/')11]	(5-7)
/即为空间频率，且此函数是归一化函数，因此仅提供了跨越整个频谱的相对灵 敏度。实际上这个值需要通过使用一个常量入来进行缩放以匹配心理数据并通过如下 公式来进行缩放；
1
W)= W)-	(5-8)
所以，在假设在纯正弦信号刺激下基于对比度敏感度测量值计算出了阈值。为 了将此结果转换为使用信号标准差的信号强度测量值，需要考虑有对比度以及平均 信号强度的信号幅度尺度，在幅度和正弦信号的标准差之间有了一个据的因子。可 以得到基于信号标准差的阈值计算式可以表示为：
5 = 7^(7)	(5'9)
?为平均强度值，并且：
"=%	(5-10)
定义GM (x)与GM' (%)之间的映射为：
GM，(x) =		fa exp —M3)，dx (5-11)
I 7 面。GM(x) J-8 F 26如3)	'	,
它们的值都是?()至1之间，0代表完全即为微小，而1代表极为重要。
局部梯度相似性得到的结果就是一个反映整体图像结构保真度变换的图。假设 观察距离是32周每度，这样就能无损展示16周每度的信号，因此为了使对比度敏 感度函数获得最佳维度测量效果时使用16周每度作为空间频率参数。空间频率参数 应用在接下来更精细的维度分别就是8, 4, 2, 1周每度〔27】。
最后，图像梯度幅度相似性值gscore的计算公式为：
]M	b
gscore=—^SGM(xj)	(5-12)
M j=i
其中，b决定着灵敏度，i是图像中的第i个像素，M是一副图中所有的像素



图5-1色调映射图像和其对应的各自的梯度幅度图


图5-2修正后的梯度相似度

5.2自然度统计特征测量
一张高质量的色调映射的低动态范围图像不应该是仅保存高动否范围图像的轮 廓和结构信息而已，也应该看起来自然。然而，自然度是一种主观扇量，而且很难 量化地定义自然这个概念。大量的文献都在致力于研究自然图像的统计性特征，这 不仅对于数字图像处理的应用有着巨大意义，对于理解生物视觉系统也有重大意义。 色调映射图像主观评价的研究了一些图像自然度与图像不同属性之间的关系，这些 属性包括亮度，对比度，色彩再现，清晰度以及细节再现。研究结果表明，在所有 被测试的属性当中，亮度与对比度相对其他属性而言与自然度有更高的相关度。所 以建立相关模型的时候就要主要考虑到这两个属性。这种选择可能过分简化了图像 的自然统计性的一般概念，但是它提供了一个模型实现的简易性与重要成分的可检 测性的理想的折衷，而亮度映射是所有色调映射转换器不可避免的问题。
图像自然度统计性模型建立在3000张8bit灰度图上[30][31],这个3000张图的图 像数据库包含了很多的不同类型的自然场景。图5-7与图5-8,展示了这些图像的均 值与标准差，这些数据反映了图像全局的强度与对比度。这些直方图与一个高斯分 布与一个Beta概率密度函数匹配：一张高质量的色调映射的低动态范围图像不应该 是仅保存高动态范围图像的轮廓和结构信息而已，也应该看起来自然。然而，自然 度是一种主观的量，而且很难量化地定义自然这个概念。大量的文献都在致力于研 究自然图像的统计性特征，这不仅对于数字图像处理的应用有着巨大意义，对于理 解生物视觉系统也有重大意义。色调映射图像主观评价的研究了一些图像自然度与 图像不同属性之间的关系，这些属性包括亮度，对比度，色彩再现，清晰度以及细 节再现。研究结果表明，在所有被测试的属性当中，亮度与对比度相对其他属性而 言与自然度有更高的相关度。所以建立相关模型的时候就要主要考虑到这两个属性。 这种选择可能过分简化了图像的自然统计性的一般概念，但是它提供了一个模型实现的简易性与重要成分的可检测性的理想的折衷，而亮度映射是所有色调映射转换 器不可避免的问题。
图像自然度统计性模型建立在3000张8bit灰度图上网㈣，这个3000张图的图 像数据库包含了很多的不同类型的自然场景。图3-7与图3-8,展示了这些图像的均 值与标准差，这些数据反映了图像全局的强度与对比度。这些直方图与一个高斯分 布与一个Beta概率密度函数匹配：
咏冲=島丁冲［-書］	(5-13)
=4 理*1	(5-14)
/(x;a,j?) - B(a ^xa 1(1	1	(5-15)
B(x，y) = ?- ty^dt	(5-16)

8(.,.)即为Beta函数，函数形式见式5-13与5-14,模型的参数经回归估计，拟
合此统计特性的参数的最佳值分别为“m = 115.94, am = 27.99, ad = 4.4,宙=lO.lo
最近的研究发现亮度和对比度在自然图像统计特性测量方面很大程度上相互独
立DA因此，自然度的统计性测量函数定义为：
N =洲 ％	(5-17)
〈为由K = max{PmPd\n出的归一化因子。这样将自然度的统计性特征约束到了 0至1之间。

图5-7自然统计性特征与亮度的关系


图5-8自然统计性特征与对比度的关系

5.3基于梯度的色调映射图像质量评价模型
结构保真度测量值S与自然度统计特性测量值N是色调映射图像质量评价的两 个不同方面。他们可以单独或联合作为一个测量标准。而在很多实际应用中，用户 更加希望的到一个单一的评分来表明图像的整体质量评分。因此，这些参数就应该 通过一些方式联合起来。本文通过使用一个三参量函数来标量化这个联合测量值， 得到色调映射图像质量指数(Tone Mapped image Quality Index, TMQI):
Q = a* gscore + (1 — d)Nc	(5-18)
0<a<l以调节两个部分之间的权重，a和0分别决定了他们的敏感程度。因为 S和N的上界都为1,所以，整体的质量评分也是上界为1的。
而这三个参数仍需要确定。为了得到更加符合人类视觉系统的观察效果，需要 一种迭代的方法来取得参数。每次迭代随机选取一组数据中的随机一对图片进行测 试。如果模型的客观评分排序与主观评分排序相同，模型参数就不会改变；否则， 每个参数都向修正误差方面修改一步直到迭代收敛。最终得到a=0.8122 , b=0.5370, cf0.3018作为模型参数。
5.4实验部分
下面详细介绍本文的实验部分。
5.4.1数据库简介
色调映射图像质量评价领域的数据库目前还不太完善，这里我们采用了文献［33】 中给出的数据库。名字为 Subject-rated image database of tone-mapped images 图像数 据库。Subject-rated image database of tone-mapped images 图像数据库由 15 组图像构 成，并提供了以Excel文件存储的平均意见评价分数。每组图片包括由八种不同的色调映射转换器转换得到的8幅色调映射图像。每组图片的平均意见评价分数由20 个观察者评价的分数取平均值得到。每个观察者要求分别为每组图片的八张按1 (最 好)至8 (最坏)来进行排序。
5.4.2评价指标
本章用Spearman和Kendall系数作为评价指标，并且求出相应的均值最大值最 小值以及均方误差。在图像质量评价领域，计算相关系数的两个向量就是图像的质 量值向量和图像的主观评价值MOS之间的相关度。Spearman和Kendall的具体定义 如下：
1)斯皮尔曼相关系数(SROCC) [54]：
SROCC = 1-& 項=)	(5-19)
n(n2-l)	'	7
假设主观评价分数序列为X,客观评价分数为y, n为样本容量。将％和y按照从 大到小的顺序进行排列，记旳、为为原数组中班、％在排序之后的位置。
2)坎德尔相关系数(KROCC)网：
KROCC = (P —(5-20)
其中F为和谐对的个数,Q为不和谐对的个数，孔为样本容量。和谐对指变量大小 顺序相同的两个样本观测值，否则为不和谐对。
一个好的图像质量评价算法，应该有一个较高的SROCC和KROCC的值。
5.4.3实验结果与分析
表5-1, 5-2和表5-3给出了实验结果。其中TMQI[33]结果是参照TMQI论文仿 真出来的结果，FSITM[34]是引用的论文里面的结果。
表5-1和表5-2为TMQI与基于梯度改进的本文的算法在Subject-rated image database of tone-mapped images图像数据库上运行的仿真结果，取各组图片的综合评 分Q值与平均主观意见分进行相关度分析得到各自的SROCC与KROCC值，并对 最终结果取平均分析总体算法性能。


表5-1图片库上的仿真结果
Index	Model	Median	Average	STD
SROCC	TMQI	0.7857	0.8058	0.1058
FSITMR	0.8095	0.8145	0.1214
FSITMG	0.8333	0.8178	0.1310
FSITMB	0.8571	0.7183	0.2536
our proposed	0.8571	0.8225	0.1745
KROCC	TMQI	0.6429	0.6840	0.1221
FSITMR	0.7143	0.7126	0.1423
FSITMG	0.7143	0.6935	0.1711
FSITMB	0.7143	0.5979	0.2711
our proposed	0.7143	0.7223	0.2086

表5-2各个图片组上的仿真结果
图组	SROCC	KROCC
TMQI	本文算法	　　TMQI	本文算法
1	　　0. 9048	0. 9762	　　0.7857	0.6429
2	　　0.7857	0.8095	　　0.6429	0.6429
3	　　0.8095	0.6429	　　0.6429	0.5000
4	　　0.8810	0.7857	　　0.7143	0.5000
5	　　0.7381	　　　　0.8571	　　0.6429	0.7143
6	　　0.9762	1.0000	　　0.9286	0.9286
7	　　0.6905	　　　　0.7857	　　0.5714	0.7143
8	　　0.7143	0.9762	　　0.5714	0.5714
9	　　0.6905	　　　　0.8333	　　0.5714	0.5714
10	　　0.9286	0.9286	　　0.8571	0.8571
11	　　0.8810	0.9048	　　0.7143	0.7857
12	　　0.7143	　　　　0.7143	　　0.5714	0.5714
13	　　0.6826	　　　　0.8144	　　0.5455	0.6910
14	　　0.7381	　　　　0.8571	　　0.6429	0.7143
15	　　0.9524	　　　　0.8571	　　0.8571	0.8571
均值	　　0.8058	　　　　0.8225	0.684	0.6842
中位数	　　0.7857	　　　　0.8571	　　0.6429	0.6910
最大值	　　0.9762	1.0000	　　0.9286	0.9286


表 5-3 Subject-rated image database of tone-mapped images 第七组图片按照 MOS、基于梯度的算法、 TMQ1标准得到的图片质量顺序
MOS	基于梯度的算法	TMQI
4	4	2
6	6	1
1	1	6
7	7	5
5	2	4
2	5	7
8	8	8
3	3	3

下面对试验结果进行详细的分析，表5-1给出了目前比较好的色调映射图像质 量评价方法之间的比较，FSITM算法利用图像的相位一致性信息，是2014年比较新 的一个算法，但是该算法特别的复杂。从表5-1可以看出我们的算法在列出的五种 算法中在SROCC和KROCC的均值和中值方面是最好的。虽然均方误差STD我们 的算法没有达到最好，但是它和最好的算法TMQI之间的差距是极其渺小的。表5-1 进一步的说明了我们的算更加的符合人眼的特性。从表5-2我们可以看到，在15张 图像产生的失真类型中有13张图片组不论在SROCC还是KROCC都比TIMQI好, 并且本文的算法在15组图像的SROCC和KROCC的平均值，最大值，以及中位数 方面比TMQI要高很多。这说明本文的算法更加贴近人的主观打分值，也就是人的 主观感受。表5-3给出了 15组图片中某一组图片的具体MOS和客观质量值之间的 顺序。可以看出，在这一组图片中基于梯度的算法排名与MOS的排名更加的匹配。
5.5本章小结
本章详细介绍了基于梯度幅度相似性的色调映射图像质量评价算法。首先介绍 梯度相似性和图像自然性测量表达式，然后给出整体表达式，最后对本章所用到的 数据库和评价指标进行介绍，并给出试验结果和对试验的详细分析结果。

第六章总结与展望
6.1工作成果总结
本文对有参考的图像质量评价方法进行了研究，不仅在已有算法的基础上进行 了改进，并提出了一种基于内容信息的图像质量评价算法。由于高动态图像的应用 越来越广泛，本文在研究色调映射图像特征的基础上，提出了一种新的色调映射图 像质量评价算法。
基于相似性算法在图像评价方面的有效性，首先在已有的图像算法的基础上, 提出了 ?种新的加权方法。其次，提出了-种基于内容信息特征图像质量评价算法。 第三，由于冃前?高动态范围图(high dynamic range, HDR)应用的广泛性，而高动态 图要想在正常设备上进行显示必须将其转化为低动态范围图像(称为色调映射图 像)。本文学习基于结构相似性算法在色调映射图像质量评价的基础上实现了 -种 基于梯度特征相似性的图像质量评价算法。
6.2存在的问题与下一步工作
基于梯度相似性的色调映射图像质量评价算法虽然在整体性能上效果很好，但 是对于某些图片如图像的细节特别少，有大片的白或者黑的评价效果不是很好。下 一步寻找更加有效的特征来弥补本文色调映射图像质量评价的不足。由于基于内容 信息的图像质量评价算法更加符合人眼的特性，并且运算时间短，所以下一步打算 把它应用到对于要求实时性的视频质量评价系统中。


参考文献
[1]Gonzalez, R.C., Woods, R.E.著.阮秋琦等译.数字图像处理.第3版电子工业出 版社.2011:2-17
[2]Ma K L, Yeganeh H, Zeng K, et aL High dynamic range image tone mapping by optimizing tone mapped image quality index[C]// Multimedia and Expo (ICME), 2014 IEEE International Conference on. IEEE, 2014:1-6.
[3]Brunnstrom K, Hands D, Speranza F, et al. VQEG validation and ITU standardization of objective perceptual video quality metrics [J]. IEEE Signal Processing Magazine, 2009, 26:96-101.
[4]Chikkerur S, Sundaram V, Reisslein M, et al. Objective Video Quality Assessment Methods: A Classification, Review, and Performance Comparison[J]. Broadcasting IEEE Transactions on, 2011, 57(2):165-182.
[5]Wang Z, Bovik A C, Lu L. Why is image quality assessment so difficu!t?[C]// Acoustics, Speech, and Signal Processing, 1988. ICASSP-88., 1988 International Conference on. 2002:IV-3313- IV-3316 vol.4.
[6]Reinhard E, Devlin K. Dynamic range reduction inspired by photoreceptor physiology [J]. Visualization & Computer Graphics IEEE Transactions on, 2005, 11(1):13 - 24.
[7]Methodology for the Subjective Assessment of the Quality of Television Pictures, ITU-R Recommendation BT.500-1L
[8]张桦.基于视觉感知的图像质量评价方法研究[D].浙江大学生物医学工程 与仪器科学学院浙江大学5 2009.
[9]Wang Z.5 Bovik A. C., Sheikh H. R?,and Simoncelii E. P., “Image quality assessment: From error visibility to structural similarity,IEEE Trans. Image Process., vol. 13, no. 4, pp. 600-612, Apr. 2004.
[10]Bovik A C. Reduced- and No-Reference Image Quality Assessment [J]. Signal Processing Magazine IEEE, 2011, 28(6):29-40.
[11]Rehman A, Wang Z. Reduced-reference image quality assessment by structural similarity estimation.[J], IEEE Transactions on Image Processing A Publication of the IEEE Signal Processing Society, 2012, 21(8):3378-3389.
[12]Mittal A, Moorthy A K, Bovik A C. Blind/Referenceless Image Spatial Quality Evaluator[C]// Circuits, Systems and Computers, 1977. Conference Record. 1977 11th Asilomar Conference on. 2011:723-727.
[13]Reinhard E, Stark M, Shirley P, et aL Photographic tone reproduction for digital images[M]// ACM Transactions on Graphics (TOG). ACM, 2002:267-276.
[14]Larson G W, Rushmeier H, Piatko C. A Visibility Matching Tone Reproduction Operator for High Dynamic Range Scenes [J]. Visualization & Computer Graphics IEEE Transactions on, 1997, 3:291-306.
[15]Fattal R, Lischinski D, Werman M. Gradient Domain High Dynamic Range Compression卩]。Acm Transactions on Graphics, 2002, 21(3):249-256.
[16]Cadik M, Slavik P. The Naturalness of Reproduced High Dynamic Range Images[C]// 2013 17th International Conference on Information Visualisation. IEEE Computer Society, 2005:920-925.
[17]Hore A, Yadid-Pecht O. A statistical derivation of an automatic tone mapping algorithm for wide dynamic range display[C]// Acoustics, Speech and Signal Processing (ICASSP), 2014 IEEE International Conference on. IEEE, 2014:2475-2479.
[18]Ma K L, Yeganeh H, Zeng K, et aL High dynamic range image tone mapping by optimizing tone mapped image quality index[C]// Multimedia and Expo (ICME), 2014 IEEE International Conference on. IEEE, 2014:1-6.
[19]Yoshida A, Blanz V, Myszkowski K, et al. Perceptual evaluation of tone mapping operators with real-world scenes[C]// Electronic Imaging 2005. International Society for Optics and Photonics, 2005:192-203.
[20]Cadik M, Wimmer M, Neumann L, et al. Evaluation of HDR tone mapping methods using essential perceptual attributes [J]. Computers & Graphics, 2008, 32(3):330-349.
[21]Yeganeh H5 Wang Z. Objective assessment of tone mapping algorithms[C]// Image Processing (ICIP), 2010 17th IEEE International Conference on. IEEE, 2010:2477-2480.
[22]Sheikh H R, Bovik A C. A visual information fidelity approach to video quality assessment[C]// in The First International Workshop on Video Processing and Quality Metrics fbr Consumer Electronics. 2005:23—25.
[23]Chandler D M? Hemami S S. VSNR: a wavelet-based visual signakto-noise ratio for natural images.[J]. IEEE Transactions on Image Processing A Publication of the IEEE Signal Processing Society, 2007, 16(9):2284 - 2298.
[24]WANG Zhou, SIMONCELLI P9 BOVIC A C. Multiscale structural similarity for image quality assessment [C]//Proc of the 37th Asilomar Conference on Signals, Systems and Computers. 2003: 1398-1402.
[25] CHEN Guan-hao, YANG Chun-ling, XIE Sheng-li. Gradient-based structure similarity for image quality assessment[C]//Proc of International Conference on Image Processing. 2006:2929-2923.
[26]Larson E C, Chandler D M. Most apparent distortion: full-reference image quality assessment and the role of strategy [J]. Journal of Electronic Imaging, 2010, 19(1):143-153.
[27]Lin Z, Lei Z, Xuanqin M, et al. FSIM: a feature similarity index fbr image quality assessment.[J]. IEEE Transactions on Image Processing A Publication of the IEEE Signal Processing Society, 2011, 20(8):2378 - 2386.
[28]Liu A, Lin W, Narwaria M. Image quality assessment based on gradient similarity.[J]. IEEE Transactions on Image Processing A Publication of the IEEE Signal Processing Society, 2012, 21(4):1500 - 1512.
[29]Lin Z, Ying S, Hongyu L. VSI: a visual saliency-induced index fbr perceptual image quality assessment.[J]. IEEE Transactions on Image Processing A Publication of the IEEE Signal Processing Society, 2014, 23(10):4270-4281.
[30]M. Cadik and M. Wimmer and L. Neumann and A. Artusi. Image attributes and quality fbr evaluation of tone mapping operators. National Taiwan University. 2006: 35—44.
[31] Mantiuk R, Daly S J, Myszkowski K, et al. Predicting Visible Differences in High Dynamic Range Images - Model and its Calibration^]. Proc Spie, 2005, 5666:204-214.
[32]Aydin, Tun&#, Ozan, Mantiuk, Rafa&#? et al. Dynamic Range Independent Image Quality Assessment^]. Acm Transactions on Graphics, 2008, 27(3):15-19.
[33]Yeganeh H, Wang Z. Objective Quality Assessment of Tone-Mapped Images [J]. Image Processing IEEE Transactions on, 2013, 22(2):657 - 667.
[34]Ziaei Nafchi H, Shahkolaei A, Farrahi Moghaddam R, et al. FSITM: A Feature Similarity Index For Tone-Mapped Images[J]. IEEE Signal Processing Letters, 2015,22(8):1026-1029.
[35]Gu K, Zhai G, Liu M, et al. Details preservation inspired blind quality metric of tone mapping methods[C]// Circuits and Systems (ISCAS), 2014 IEEE International Symposium on. IEEE, 2014:518-521.
[36]Hamid Rahim S, Muhammad Farooq S, Alan Conrad B. A Statistical Evaluation of Recent Full Reference Image Quality Assessment Algorithms[J]. Image Processing IEEE Transactions on, 2006, 15(11):3440-3451.
[37]Hou X, Zhang L. Saliency Detection: A Spectral Residual ApproachfC]// 2013
IEEE Conference on Computer Vision and Pattern Recognition. IEEE, 2007:1-8.
[38]张鹏，王润生.基于视点转移和视区追踪的图像显著区域检测[J]。软件学报, 2004, 15(6):891-898.
[39]Itti L, Koch C. Itti, L. & Koch, C. A saliency-based search mechanism for overt and covert shifts of visual attention. Vision Res. 40, 1489-1506[J]. Vision Research, 2000, 40.
[40]Achanta R, Hemami S, Estrada F9 et aL Frequency-tuned Salient Region Detection[C]// IEEE International Conference on Computer Vision and Pattern Recognition (CVPR 2009). 2009:1597-1604.
[41]Mingming Cheng, Shimin Hu, Guoxin Zhang5等.基于色彩直方图和全局对比 度的图像视觉显著性计算方法WO2012122682Al[P].2012.
[42]Chang K Y Liu T L, Chen H T, et al. Fusing generic objectness and visual saliency for salient object detection[C]// IEEE International Conference on Computer Vision. IEEE Computer Society, 2011:914-921.
[43]Achanta R, Shaji A, Smith K, et al. SLIC Superpixels [J]. Epfl, 2010.
[44]Alexe B, Deselaers T, Ferrari V. Measuring the Objectness of Image Windows [J]. IEEE Transactions on Pattern Analysis & Machine Intelligence, 2012? 34(11):2189-2202.
[45]Zhou W, Qiang L. Information content weighting for perceptual image quality assessment,[J]?IEEE Transactions on Image Processing, 2010, 20(5):1185 - 1198.
[46]H.R. Sheikh, Z. Wang, L. Cormack, and A.C. Bovik, “Live image quality assessmement database release2Z，2006, Available from: http://live.ece.utexas.edu/research/quality.
[47]Ponomarenko N, Lukin V, Zelensky A, et al. TID2008 - A Database for Evaluation of Full-Reference Visual Quality Assessment Metrics[J]. Adv Modem Radioelectron, 2009, 10:30-45.
[48]马丽红，龚紫平.频率与方向敏感SSIM的图像质量评价方法[J]计算机工 程,2012,第 5 期(05):19-24.
[49]刘寅.基于稀疏表达的全参考图像质量评价[D].中国科学院研究生院(西安 光学精密机械研究所)，2013.
[50]Wang Z3 Shang X. Spatial Pooling Strategies for Perceptual Image Quality Assessment[C]// Image Processing, 2006 IEEE International Conference on. IEEE, 2006:2945-2948.
[51]Hamid Rahim S, Alan Conrad B, Gustavo D V. An information fidelity criterion for image quality assessment using natural scene statistics[C]// IEEE TRANS.

参考文献
IMAGE PROCESSING. 2005:2117-2128.
[52]Ponomarenko N, leremeiev O, Lukin V, et al. Color image database TID2013: Peculiarities and preliminary results[C]// Visual Information Processing (EUVJP), 2013 4th European Workshop on, IEEE, 2013:106-111.
[53]Geusebroek J M, Van d B R, Smeulders A W M, et al. Color Invariance [J]. IEEE Transactions on Pattern Analysis & Machine Intelligence, 2001, 23(12):1338-1350.
[54]Eric C Larson and DM Chandler, ^Categorical image quality (csiq) database," Online, http://vision.okstate.edu/csiq , 2010
[55]褚江，陈强，杨曦晨.全参考图像质量评价综述[J].计算机应用研究，2014, 31(1):13-22.
附录1色调映射图像质量评价所用部分图片
(1)第一组
(2)第二组

附录2第三、四章数据库中部分图片

