第一章绪论
1.1	课题研究背景
近年来，随着信息技术的飞速发展、智能终端的大量普及，人们生活、工作的 各个领域对于移动宽带业务的需求呈井喷式增长。从业务类型看，移动宽带业务呈 现全IP化、业务类型多样化以及以高速率大流量数据业务为主的特点。从业务发 生的场景统计，在全球主要运营商的数据业务中，移动话音业务的60%、数据业务 的70%发生在室内和热点地区；根据预测，未来室内及热点业务将占总业务量的 90%,但根据CCSA的调查，如今室内的站点建设较少，其中室外建设力度占了 90%, 而室内建设只有io%m,因此，提高系统流量、支持室内及热点场景业务是解决移 动数据流量增长问题的关键。
以通信行业的视角来看,有两种技术方案能满足未来移动通信网络的发展需求: 一种为MBB = LTE+Wi-Fi,另外一种为MBB =LTE+LTE高频热点增强。虽然基 于IEEE 802.11标准的Wi-Fi网络已经成为一个超高速本地接入的成熟产业,其最新 的正EE802.ilac版本理论支持1Gbit的速率，但由于其过高的可用性，使其无法做 到严格的管控，而且使用非授权频段，运营商等无法控制移动性管理、用户QoS需 求和热点间干扰等，再由于运行在2.4GHz或5GHz,难以做到和传统蜂窝移动网络 融和，使其不能作为移动通信网络的长远发展战略。由此可见，在现有的LTE网络 基础上，重点放在高频热点增强，重视室内及热点场景，会是未来移动通信网络发 展的主要趋势⑵。
因此，移动网络带宽未来的发展前景有两种趋势：从移动网络的数据业务的使 用场景来看，用户主要是集中在室内和热点地区；从移动网络的频段需求来看,3GHz 及以上的高频段将成为满足未来移动网络数据业务的潜在频段。为应对未来移动网 络的数据业务的速率需求，高频段、大容量、小覆盖的移动通信系统将成为技术研 究的重点。在LTE/LTE-Advanced的R8到R11版本中主要是针对宏覆盖场景的发展 和研究，然在产品形态上支持Macro/Micro/Pic。以及Femto等针对不同覆盖距离的 设备，但标准设计的重点是面向移动场景，并没有针对宽带数据业务需求以及高频 段热点场景进行针对性的设计。
2012年国际标准组织3Gpp为了满足热点及室内覆盖的需求提出了 LTE-Hi技 术，LTE-Hi技术是LTE技术的演进技术，其重点致力于提高室内数据业务的性能， 与传统LTE网络不同，重点在于提高热点和室内覆盖场景下传输速率和容量，是基
于LTE和LTE-A演进的技术。LTE-Hi的Hi具有多重含义，如hotspot and indoor、 higher frequency> high bandwidth、higher performance,系统提出的目的是建立小覆 盖、高吞吐量、低移动性、架构优化的低成本室内热点无线通信解决方案1%满足 该场景的大数据量需求，其物理层关键技术具有广阔的研究空间。
1.2	LTE-Hi系统的关键技术及优势
1.2.1	LTE-Hi系统的关键技术
1.2.1.1较高的工作频段
LTE-Hi的工作频段为3.5GHZ,相比于LTE系统的2GHZ, LTE-Hi拥有更高的 工作频段，一方面对于3.5GHZ频段而言，其占用带宽较小，有更多的频谱资源， 从而提高了传输速率和频谱利用率。由于室内所进行的业务往往是数据流量业务， 其下行速率很大，这也使得LTE-Hi需要有较高的工作频段。除此之外，较高的工 作频段也令小区与宏小区之间的工作频段差异较大，减少了小区之间的信号干扰叫
1.2.1.2动态调整子帧结构
TDD和FDD是实现双向通信系统主要的两个双工模式。FDD模式是利用成对 的频率信道来实现基站和终端信号的发送和接收，在基站发送信号给终端的同时， 基站可以利用与其对称的频率信道接收信号。这两个成对的频率信道之间会有 190MHZ的频率保护带，以防止上行信道和下行信道相互干扰。由于这种特性，FDD 双工模式适合对称的业务，例如话音业务。但是如果我们所进行的业务是非对称的 话，无论是下行业务大，还是上行业务大，使用FDD双工模式总会造成频谱资源的 浪费，据统计，进行非对称数据业务时，FDD模式的频谱利用率仅为对称业务的 60% o
与FDD模式不同，TDD模式是在固定频率下不同时隙进行信号的发送和接收。 由于TDD模式是用不同的时隙来进行上传和下载的，所以它不需要成对的频谱资 源，也不需要190MHz的频率保护带，在进行非对称业务中，TDD模式能够充分 利用频谱资源。
随着人们生活水平的调高以及互联网的普及，人们对数据的下载量往往远大于 上传量。对于室内数据业务而言，其下行速率应该远大于上行速率，针对这种典型 的非对称数据业务，采用TDD双工模式能够到达最大的频谱利用率。
考虑到人们在室内可能需要进行话音业务，LTE-Hi系统采用的是动态的TDD 双工模式。即通过动态地调整不同的子帧配置，使得用于上行传输的子帧数和用于 下行传输的子帧数能够适应当前所进行的业务。
1.2.1.3	高阶调制方式
目前为止，调制方式常用的有QPSK、16QAM和64QAM。QPSK使用的是调 相技术，也就是说它是使用四个不同相位的载波来调制信号的，因此在使用QPSK 调制方式时，传输一个符号相当于传输了两个比特。而对于16QAM、64QAM而言， 它们属于正交幅度调制，即它们的相位和幅度都是变化的，当幅度固定，而相位变 化时，正交幅度调制（QAM）就会退化为相移键控（PSK）调制。由于QAM调制 方式充分利用了信号的相位和幅度信息，所以其传输速率也会大大提高，例如 16QAM传输一个符号时相当于传输了 4个比特，而64QAM则传输了 6个比特，显 然QAM调制方式的阶数越高，它的传输速率就快，而其出错的可能性也会变大。
由于在LTE-Hi系统中，移动台的移动速度较慢，信道环境较好，所以与室外 环境相比，LTE-Hi系统为更高阶数的QAM调制方式的引入带来了希望⑸。
1.2.1.4	小区开关
LTE-Hi小区拥有分布密集，覆盖范围小的特点，它能够动态的调节小区开启或 者关闭根据小区的业务负载⑶。小区的关闭或者开启取决于该小区所进行业务的多 少，如果该小区的业务较少时并且用户较少的时候，系统可以将其关闭，这样能够 减少小区的干扰、能耗及提高频谱利用率。当然在关闭该小区之前需要将其中所进 行业务的终端移至别的小区或者是宏小区，宏小区需要根据终端所进行业务负载的 大小来给终端分配新的小区。小区在关闭的时候不再进行发送下行数据和接收上行 数据，利用参考信号（DRS）来实现对终端的检测，当其到达指定要求的时候，系 统重新激活该小区用于数据传输。
1.2.1.5双连	接技术
LTE-Hi小区覆盖较小，当用户在小区边缘来回走动而频繁切换小区时很容易导 致用户掉线的情况，为了解决这一问题，人们提出了宏微小区双连接的方案。双连 接分为用户平面和控制平面⑹，其原理图见图1-1。对于处于双连接模式下的终端 而言，它既处于LTE-Hi小区的覆盖范围，又处于宏小区的覆盖范围，这个时候宏 小区为主小区，LTE-Hi为辅小区，当终端进行小区切换时，将宏小区作为控制小区 来减少切换次数，以此来降低用户掉线的可能性。这种模式下，终端（UE）需要与 主服务基站（MeNB）保持无线资源控制（RRC）连接，RRC连接是用于处理终端 和基站控制平面信息的。辅服务基站根据（SeNB,也就是这里的LTE-Hi小基站） 将一些配置信息通过X2接口传递给主服务基站（MeNB）,然后MeNB在将其转 换为相应的RRC信息发送给终端。当用户处于LTE-Hi小区中央时，宏小区和小小 区之间的回程网络质量较好，用户平面采取的是将核心网只接入主服务基站（MeNB） 中的方案，终端UE的数据由MeNB与SeNB之间的X2接口进行传输。而当用户 处于小区边缘，即宏小区和小小区之间的回程网络质量较差时，核心网可以同时与
MeNB与SeNB连接，核心网可以分别通过MeNB和SeNB与终端进行数据传输, 这大大降低了用户的时延，但也同时增大了核心网的压力。
图1-1双连接技术原理框图
（6）室内空口同步技术
众所周知对于TDD系统在同一频率或者是同一频道的不同频率之间的小区需 要进行小区间的同步，除此之外，研究小区间的同步机制对于TDD和FDD系统中 一些技术的增强大有帮助，例如一个良好同步网络能够提高先进接收机的性能。因 此，研究小区间的同步机制是极为重要的。传统的同步机制有全球导航卫星系统同 步（GNSS）和回程网络同步。但由于LTE-Hi室内热点受周围高层建筑的影响较大 以及传统同步机制的高成本，人们提出了室内空口同步技术，它是基于无线电通信 接口的同步机制。其中比较关键的技术是网络监听技术。网络监听技术指的是目标 小区通过监听源小区发送的RS参考信号（例如公共参考信号CRS、定位参考信号 PRS）来保持与源小区的同步。在目标小区监听源小区时，如果目标小区与源小区 处于同一个频率下的话，目标小区需要关闭它的数据传输。网络监测技术同步时间 的精度会受很多因素的影响。其主要影响因素有信道条件的好坏；监听的参考信号 RS是否正在被使用；小区簇中跳跃小区的数目；目标小区和源小区的传播时延等。 1.2.2 LTE-Hi系统的优势
1.2.2.1	高传输速率及高频谱利用率
LTE-Hi的适用场景为室内场景，与其它场景相比，其拥有较大的带宽和较低的 移动台移动速度，所以使得LTE-Hi具有较好的室内信道环境和较高的峰值吞吐量, 从而大大的提高了它的传输速率。除此之外，LTE-Hi较小的覆盖范围，使得在相同 区域LTE-Hi小区数量变多，加大了小区之间的密度，提高了信道容量。而LTE-Hi 使用的高工作频段使得它与其它宏蜂窝网络的工作频段相分割开，降低了与其它蜂 窝网络之间的干扰，提高了频谱利用率。
1.2.2.2	较低的成本和系统开销
由于LTE-Hi系统是LIE系统用于室内热点覆盖优化的方案。考虑到室内环境 的影响，LTE-Hi的接入设备的体积和功率损耗都不应该过大，将其控制在与WIFI
设备相接近即可。既然接入设备的体积和功率损耗都不大，那么相应的生产成本和 系统开销也会相应的降低，这样为LTE-Hi设备的普及提供了可能性。
1.2.2.3	可管可控
LTE-Hi不仅支持网络特性的增强以及在任何回转条件下对网络设备的可管可 控，还支持对终端业务和行为的可管可控。由于LTE-Hi系统中所采用的关键核心 技术如小区开关，双连接技术以及室内空口同步技术，都需要对终端业务和行为进 行操控，可以说对终端业务和行为的可管可控是这些核心技术的前提。当然这也是 LTE-Hi系统的优势所在，这样能大大提高运营商对网络以及终端业务的管理能力。
1.2.2.4	向后兼容
一个好的移动通信系统必须具备良好的向后兼容性。LTE-Hi在LTE系统的框 架上进行设计和修改的，因此使用LTE系统的终端同样也可以用于LTE-Hi系统中。 倘若LTE-Hi是基于新的架构设计的系统，那么使用现有LTE版本的终端将不再能 够使用LTE-Hi系统，用户就不得不选择更换终端来适应LTE-Hi系统，这将会牺牲 用户的利益，而这是用户和运营商所不愿意看到的。所以LTE-Hi这样的设计既方 便了用户也方便了运营商，可谓是一举两得。
1.3	LTE-Hi系统下高阶调制技术的应用进展
在传统宏基站覆盖场景下，信道环境较为复杂，而在LTE—Hi应用的室内热点 场景中，基站通常部署在室内或热点区域内（图1-2）,距离用户薮近，信道条件 较好。
图 1-2 LTE-Hotpot Indoor 应用场景
迄今为止,256QAM已经被广泛应用在数字电视等通信系统中，业界对256QAM 解调方案非常成熟，IntekTI和STM等主流芯片厂商均可提供256QAM解调IP核。 在IEEE最新发布WLAN标准IEEE 802.1 lac中，也将256QAM列为可选项。
IEEE802.11ac支持上下行256QAM161，最高速率可达1.3 Gbit/s。2012年1月，美国 博通公司(Broadcom)发布业界第一个支持256QAM的802.llac芯片系列。同时，罗 德&施瓦茨(Rohde - Schwarz)等公司也推出了针对802.11ac 256QAM的测试解决方 案。
值得注意的是，256QAM已经加入在最新的3GPPR12中皿引，下行256QAM 的引入对现行的信道质量指示符CQI、对应的调制与编码策略MCS和传输块IBS 进行扩展以涵盖256QAM等高阶调制方式；同时上层MAC/RRC层的适配机制和 eNodeB选择/通知UE使用新CQI/MCS/TBS的机制也做了相应的适配和完善。但对 于256QAM的引入LTE-Hi系统中所带来的实际增益和对信噪比环境的需求也尚未 得到验证，高阶调制技术链路级和系统级的验证工作都亟待开展。
至今为止，很少有论文在MIMO信道和宽带系统下对室内信道引入高阶调制的 吞吐量性能进行过仿真工作。大部分提案冲1。】在非链路自适应下高阶调制的链路及 系统性能进行仿真，信道一般选取的为EPA 10Hz,而对于进行链路仿真的一小部分 提案中仍旧使用了低阶调制下的信噪比合并方法和参数值，显然是并不合理的。此 外，还有少量论文进行了高阶调制相关的研究，文献［11］对LTE-Advanced系统中高 阶调制引入后CQI和MCS表的设计进行了相关研究，但缺少对链路性能的整体评 估；文献［13-16］尽管进行了小基站室内/室外信道下高阶调制的评估工作，但论文并 未在256QAM下准确的应用链路自适应关键技术。从采取有效信噪比合并自适应方 法完善自适应调制与编码角度而言，仅有一篇文献［17］在256QAM下有效信噪比的 合并技术中的MEESM方法进行了详细的讨论，但只进行了单天线简单信道环境下 进行了仿真验证，在性能验证上还远远不充分，并且未涉及对HARQ下应用MESM 的性能研究。由此可以看出，迄今为止，在LTE-Hi系统中引入256QAM的增益情 况仍没有得到充分的评估，涉及到的高阶调制下的关键技术也缺乏验证和优化，因 此本文所做的工作是具有价值的。
2015年底，由工业和信息化部电信研究院牵头，国家科技重大专项课题“LTE-Hi 公共测试验证平台”项目开始启动，各大运营商和企业开始开展基站的测试工作， 由北京邮电大学承担LTE-Hi仿真平台的搭建及性能验证工作。在项目需求下，本 论文完成了 LTE-Hi链路级仿真平台的搭建，验证了高阶调制技术在LTE-Hi系统中 的链路性能，为各厂家的基站测试及商用化提供了可靠的参考依据。
1.4	论文的研究内容与结构安排
本论文主要的研究内容如下：
主要研究目的是对LTE-Hi系统高阶调制及链路仿真评估涉及到的关键技术进 行了研究。
为了搭建以吞吐量为性能指标的LTE-Hi链路级仿真平台，首先对高阶调制下 的链路自适应技术中涉及的有效信噪比合并（ESM）方法进行了研究，对两种主流 的ESM,即指数有效信噪比合并（EESM）和互信息有效信噪比合并（MIESM）进 行了大量的仿真和优化工作。
在这基础上完成了在LTE-Hi静态/动态信道环境下2x2天线的下行PDSCH信 道的仿真与分析工作，对LTE-Hi静态LOS和NLOS信道下所适用的分集复用传输 模式及自适应传输模式进行了讨论，并且通过LTE-Hi动态的场景下高阶调制的仿 真指出了引入在室内的低速运动的场景下引入高阶调制的可行性。仿真在lOOPRBs 和非理想信道估计下进行，并严格遵循了协议中对PDSCH物理层的规定，得到的 仿真结果可为厂家的测试工作提供基础依据。
最后，IRHARQ系统链路的抽象是系统级到链路级仿真接口（L2S）的一部分， 对基于MIESM的重传版本间去相关的链路抽象方法进行了实现与仿真验证，发现 随着调制阶数和编码速率的增加，各次重传后映射AWGN曲线得到的误帧率与真 实误帧率之间的偏差会增大。通过大量仿真得到了各调制编码方式（MCS）下的偏 差补偿量，完成了对ESM公式的修正，计算及仿真得到的参数和修正量为HARQ 的系统级仿真提供了依据。
主要的工作安排如下：
第一章：绪论，LTE-Hi关键技术及高阶调制的研究现状。
第二章：LTE-Hi系统下高阶调制关键技术的介绍，对比了 256QAM相对于低 阶调制方式的误码性能。
第三章：研究了高阶调制下的自适应调制与编码，关注信噪比合并算法一一 EESM和MIESM算法的原理，对这两种主流算法的优劣进行比较。搭建了 EESM 和MIESM算法中参数值优化验证框架，通过大量仿真得到了 256QAM下，EESM 和MIESM算法的最优化参数，并对比了两者的性能。
第四章：搭建LTE-Hi链路级仿真平台，仿真高阶调制下的LTE-Hi静态/动态 场景及TM2/TM3传输模式下的上下行吞吐性能。
第五章：介绍了高阶调制下增量冗余HARQ链路抽象技术，指出高阶调制下基 于MIESM进行HARQ链路抽象的问题，并给出了一种迭代式的误差补偿解决方案。
第六章：总结全文研究成果和意义，指明课题前景及LTE-Hi标准化的其他挑 战问题。
8
第二章LTE-Hi系统下高阶调制链路关键技术
LTE-Hi链路性能的评估是建立在对LTE-Hi信道建模与特性分析的基础上，因 此对LTE-Hi静态场景和动态场景的建模及采用的关键参数都需要被明确说明。此 外，高阶调制解调技术，多天线技术及MIMO检测技术将影响LTE-Hi系统下高阶 调制链路性能评估的有效性，是LTE-Hi系统下高阶调制链路关键技术。
2.1	LTE-Hi信道建模
本平台所采用的LTE-Hi信道分为两个场景：静态场景与动态场景。LTE-Hi信 道的建模由CATR主导完成的，ANITE已经确认了模型的正确性，CATR中给出了 各种场景下的信道仿真结果口刃，在此只对该系统的仿真场景和建模关键参数进行说 明。由于本文仅关注了对LTE-Hi的链路级性能评估，因此信道模型中不包含阴影 衰落的建模。
下面主要介绍下LTE-Hi的两种场景的拓扑及关键参数。
2.1.1	静态场景建模
2.1.1.1	静态场景拓扑
室内场景的拓扑由图2-1给出，围绕大厅两侧各有6个独立房间，每个房间的 面积是6mX6m。在大厅的中央有两个大房间，所占比例为8mX8m。图中线的粗 细程度表征了墙体的厚度情况，粗线代表较厚的墙体，细线代表较薄的墙体。基站 被部署在大厅的中心处，用于信号的发射(Tx),而三个位于图中测试点处的UE 为接收机(Rx),与Tx的直线距离分别为3m, 15m, 24m。显然，距离为3m的Tx 与Rx之间信号的传播方式为LOS,称Rx处的测试点为“好点”，15m和24m的 传播方式为NLOS,且所穿透的墙体厚度不同，分别称Rx处的测试点为“中间点” 和“差点”。
初始时，每一集群所有径的相位为0,因此一开始时s所有相同相位径相累加 的结果克服了信道衰落，从而使功率得到了增益。随着时间的推进，每个径的相位 因多普勒相位的变化而发生变化，因此在一段时刻之后才建立起随机化的稳定信道。 所以在试验中，尽管对于实际每个点持续接收了 40000个子帧，但应舍弃前100子 帧的不稳定信道数据之后开始读取信道。
®静态检测点（UE）
图2-1 LTE-Hi静态场景拓扑图
2.1.1.2	静态场景下信道建模关键参数
LTE-Hi静态场景下信道的模型是根据Rep. ITU-RM.2135采用的固定参数法 （CDL）构建的。固定参数法指的是在搭建LTE-Hi信道模型时所采用的一些参数 是人为固定的。LOS传输方式下的延时，功率，各个簇的到达角（AOA）和离开角 （AOD）,子径的功率，簇的ASD/ASA以及XPR的参数值可参考［20］,其余在 建模中所需要的参数，包括莱斯系数K（直射径与所有散径功率之和的比值LOS下 专有），初始相位（initial phase） ,BS 角度（theta_BS） , UE 角度（theta_BS）来自 于文献［21］。
图2-2时域特性上对比了室内LTE-Hi静态场景和室外宏基站场景的信道特性， 横坐标的含义为帧号（每帧的时间为1ms）,纵坐标为当前帧IPRBs带宽的信道能 量幅值的均值。可以看到，室外信道在时域上快衰特性比室内信道更加明显，但整 体的来看，两种信道的H的变化范围相近，因此室内信道慢速衰落上与室外信道并 没有很大差异，因此对室内LTE-Hi信道下关键技术链路吞吐性能的评估工作必须 要在链路自适应下开展。
10
X J。① pm_dE4
0	100	200	300	400	500	600	700	800	900 1000
t(ms)
图2-2 LTE-Hi静态场景下NL0S信道时域特性
2.1.2动态场景建模
2.1.2.1动态场景拓扑
e路径中检测点	厚墙壁
一移动路径	—薄墙壁
图2-3 LTE-Hi动态信道拓扑图
如图2-3所示为动态场景的拓扑情况，用户移动的路线为X->A->B->C-> D->E->D->C->B->F->G->H->I o从X到A的移动路径用于完成信道环境的初始化 及测试工作，将不包含在性能仿真中。图中可以观察到，A->B->C和C->B-〉F为
11
LOS传输，D->E->D和G->H->I是NLOS传输(分别穿透了一堵薄墙体和两堵薄墙 体)。C->D, D->C和F->G是LOS到NLOS的转换状态。另外需要说明，UE的 速度为3km/h,路线的总长为32m的，因此路径的总持续时间为38.4s。
2.1.2.2动态信道建模关键参数
(1)信噪比(SNR)参数
图2-3中点X到I之间的接收功率是发射机中的功率减去每个点的路径损耗。 在这个信道模型中，发射功率/为500mW,带宽3%为20MHz。噪声功率谱密度与 为-144dBm/Hz。接收功率由下式得出
Prx = Ptx - PL -「A"	(2-1)
其中匕，含义是天线和电缆损耗，其值恒定为10dB,路径损耗由等式(2-2)给出, 则发射机的SNR可通过下式计算
PL = ^log10(«/[/»]) + B + Clog10 工[誓】+X
I ' J	(2-2)
^ = 1010810(-^^)
(2-3)
通过单位为1ms的线性插值得到X-I的41000个点的SNR, SNR的变化情况为
图24
mp)SN-s P①」民①E
LTE4ii动态信道的全路径中SNR变化情况(41000frame number)
30 28 26 24 22 20
14
12
0	0.5	1	1.5	2	2.5	3	3.5	4	4.5
Frame Number/100	x w4
图2-4 LTE-Hi动态场景下X->l路径中SNR变化规律
18
(2)功率参数
12
X到A点的参数参考自ITU-R M.2135M中的CDL参数，由于LOS和NLOS 之间的场景转换，簇的数量被设置为20。对于LOS中的点（X/A/B/C/F）,第 16-20个簇的功率为JOOdB,而对于NLOS中的点（D/E/G/H/I） , LOS的簇（第 0个簇）的功率为-100dB。线性插值的计算以1ms为单位，由此可得到40800个功 率值。
（3）时延参数
第1簇的延迟的计算公式为，= d/c,其中是发射器和接收器之间的距离，是光 速。对于剩余的19个簇，应用以下方法计算：在LOS场景中（路径X-A-B-C和 B-F）中，每个簇的延迟基于LOS场景中的CDL参数，而在NLOS场景（路径D-E-D 和G-H-D中，每个簇的延迟则基于NLOS场景中的CDL参数。在LOS到NLOS 的场景切换（C-DD-CF-G）中，直接通过线性插值计算。
图2-5中给出了所有簇的延迟情况。
(Su) AEQP
050505050505 075207520752
322221111
0	10000	20000	30000	40000
t （ms）
图2-5动态场景延时情况（裳=1, 2... 20）
（4） AOD&AOA
根据协议TR 3Gpp25.996, AOD/AOA分别由发射方向与BS之间的夹角和到 达方向方向与UE之间的夹角定义。每个簇中的AOD/AOA的值在M.2135的CDL 参数中定义。在这个仿真模型中有20个簇，对于LOS场景，根据LOSCDL参数 定义从第0（LOS簇）至！］第15个簇（第1到第15个簇是NLOS簇），第16到20 个簇基于NLOS参数，由于功率极低可以被忽略不计。对于NLOS场景，第0簇是 LOS簇，也具有极低的功率。第1到19个簇基于NLOS场景的CDL参数。对于场 景切换（C-D和F-G）,参数AOD/AOA可通过欧拉插值获得。
13
（5）基站（BS）和 移动台（MS）方向角度参数
图2-6所示，以点B为例来描述参数%,4s，%的计算。
图2-6以B点为参考点描述BS和MS角度参数值
通过场景实测，从点X到I的这些点的运动方向的角度规定如下:

表2-1点X到I范围内BS和MS角度参数值
0BS (degree)	90	90	63. 435	69. 444	73. 301	75. 964	75. 96 4
0MS (degree)	-240	-240	-213.435	-219.444	-223. 301	-225. 964	-225. 964
0V (degree)	300	300	30	300	300	300	120
Point	D1	C1	B1	F	G	H	1
0BS (degree)	73. 301	69.444	63. 435	50. 194	40. 601	21.801	0
6Ms (degree)	-223. 301	-219.444	-213.435	-200. 194	-190. 601	-171.801	-150
0V (degree)	120	120	120	30	30	30	120
使用表2-1中的值，我们可以内插以1ms为单位的路径的角度作为41000点的 单位。插值方法与AOD / AOA的插值方法相同。
此外，在建模过程中，由于LOS环境下有15条簇，而NLOS环境下则有19 条簇，每条簇分20条子径。对LTE-Hi动态场景的CDL参数表进行了特殊的处理, LTE-Hi动态移动路径中存在三个LOS与NLOS相切换的位置，但是LOS和NLOS 的簇径情况并不一致，不能满足信道间插值运算的条件。因此采取了补哑量的方式, 即在NLOS的CDL表中增加了一个JOOdB的LOS径，同时在LOS的CDL表中增 加16, 17, 18, 19四个值为-100dB的哑径，保证LOS和NLOS的径数相同。
14
2.2高阶星座调制与解调技术
2.2.1	正交幅度调制（MQAM）与解调原理
LTE-Hi链路平台中的QAM调制是一种幅度和相位联合调制的技术，调制后的信 号可以表示为a】
Y(t) =Amcosw0t + Bm sin
(2-4)
式（2-4）中cosw。/为同相信号或者信号，sinw。/为正交信号或者Q信号，是两个 相互正交的同频载波；Am,Bm分别为载波cos%，，sinw°f的离散振幅；m为4，B„，的 电平数，对256QAM来说，m取值为8。
（1）	256QAM的调制原理。
256QAM的调制的理论框图为2-7,调制过程可等效为同相及正交之路的16进制 的ASK信号之和，每个支路具有16个信号电平。其中对电平的选择，即式（2-4）中 4,凡的确定是通过星座映射实现的，在R12之前的版本的LTE/LTE-A标准中，下行 数据信道QAM调制阶数最大支持到6,即64QAM调制，上行数据信道受功率的限制， 最大支持16QAM。256QAM作为8阶QAM调制，具有256种符号，每个符号周期Ts 传送8bit,在数据速率上相比64QAM提高了33%。矩形256QAM的星座图是根据3Gpp 协议标准［22］中给出的256QAM的星座映射表来确定的,两个相邻星座点的最小欧式 距离为希*疽，映射仍采用格雷码（Gray）方式。
调制信号s可以表示为：
s = （。- 2〃）侬3 +1 + 4/ （4 也）+ 20（4, b7）
+/ * （1- 2% ）（8% +1 + 4/（4 也）+ 20四,^8））/>/170	（ 2一5）
八。"b.	（2-6）
^min(w,n)-2 ' bfn - 'n
。（3也）=
(2-7)
上述公式中”代表8bit数据中的第i个比特，奇数位的比特对应调制成信号的同 相分量，偶数位的比特对应调制成信号的正交分量，最后信号乘上了一个标量 1/届完成对能量的归一化，图2・9为256QAM星座图。经过调制后，每8位二进制 特变为一个码元符号，再经过后续的处理后通过OFDM映射物理资源结构的RE中。
15
信号输入
4值调幅器
串并转换
2-4值转换
⑴
90°移相
图2-7 256QAM调制原理框图
256QAM星座图
2-4值转换—> 4值调幅器
^1-
号 空
1.......................................................
0.5 ...................................................
o o -........................................................
-0.5....................................................
-1......................................................
-1	-0.5	0	0.5	1
图2-8 256QAM星座图
(2)	256QAM的解调原理。
256QAM的解调理论框图为图2-9,分别按同相及正交支路的进制ASK进行解调, 即将接收到的已调信号分别和两路相互正交的载波信号相乘。图中的I(t)和Q(t)见表 达式(2-8)和(2-9) o
i(t) =y(r)cos6?0z
二(Am cos ①0，+ 蜃 sin a)Qt) cos g)qI
二工 4 十 L Amcos2a)Qt + —Bm sin 2o)Qt
2	2	2	(20
16
Q(0 =y(Osin a)Qt
={Am cos a)Qt + Bm sin 670Z) sin a)ot
=+ ~^Bmcos2a)^ + 34 sin 2如
90°移相
±码映射不
并串转换
图2-9 2560AM解调原理框图
经过解调得到同相与正交两路相互独立的多电平基带信号，然后把多电平基带 信号经过低通滤波之后得到直流分量和，再进行电平判决、L-2值电平转换、码映射 和并/串转换输出解调的数字信号。这是我们通常所说的解调(硬解调)，目的是根 据接收信号判断发射信号，解调输出是某个调制符号或其对应的比特向量，其行为 属于 Decision。
(3)	256QAM最佳接收误符率
对于协议中256QAM采用的矩形星座图来说，在星座图的平均能量保持不变的情 况下增加星座点会使星座点之间的距离变小，进而导致误码率上升，因此高阶星座 图的可靠性比低阶要差。矩形星座QAM最佳接收误符率与MASK的一样，取决于数字基 带MPAM的误符率。［23］中给出了MQAM的正确判决符号的概率Pc和误符率PM如下：
93	(2-10)

min
(2-11)
Pm = 2P国 - PJm
(2-13)
心表示同相或正交支路历进制的ASK的误符率，其中4sli是矩形星座图的 星座点最小欧式距离，当采用格雷码，且以较大时，MQAM的误比特率近似于 误符号率除以log?"。
17
可以看出，随着M的增大，QAM的误符率和误比特率增大，对MQAM的误 符号率统计如下表2-2。
表2-2 MQAM的误符号率计算式
MQAM调制阶数	Pm
4QAM	20(J2 耳/*)-C(j2 耳/N0)
16QAM	30(j4/5*&/N°)-02Q4/5*居/N°)
64QAM	7/2Q(j8/21*耳 /N0)-49/16*Q2(j8/21*& /No)
256QAM	15/4。（戊6/85*玛/阳）-。256/85*&/砥）
不同QAM调制方式的理论误符率曲线
由此可以得到MQAM的误符号率。曲线：
io1
10-2
10-3 工 0.
10-4
10-5
代
-5	0	5	10	15	20	25	30
图2-10各阶MQAM理论误符号率曲线
一般意义的矩形星座MQAM信号是由同相及正交支路的4M进制ASK信号叠 加而成，而同相及正交支路的平均功率谱密度是相同的，其符号间隔7；=也，所以 MQAM的功率谱是同相及正交支路功率谱之和。在给定信息速率4及M进制的条 件下，MQAM功率谱的主瓣宽度为2凡，&=&/K,随着M的增加，MQAM的主 瓣宽度变窄，使得频带信道的频谱利用率提高。对256QAM, M=256, K=8,频谱 利用率比64QAM提高了 33%。但是，对矩形QAM来说，在星座图的平均能量保 持不变的情况下增加星座点会使星座点之间的距离变小，进而导致误符号率上升， 因此高阶星座图的可靠性比低阶要差，频谱利用率的增益在信道质量比较好的
（Eb/N0>15dB）条件下才能得到体现。QAM调制的误码率与接收端采用的解调技 术有关，当采用高阶调制并且信道质量比较差时，接收端的基于硬判决解调性能降
18
低明显，并且影响接收端信道译码性能。下一节主要介绍了两种软解调算法，将采 用软判决系统中的几何距离而非传统硬判决系统的汉明距离来提高系统性能［2叫 2.2.2通信系统中的软比特解调及性能比较
软解调技术和后续的需要软信息量输入的信道译码（Turbo, LDPC等）结合起 来，成为现代系统中使用最广泛的解调技术。软解调的目的是根据接收信号估计发 射信号的概率分布，解调输出是对应所有可能调制符号的概率或等效的对应所有可 能比特的概率，即软信息量，其行为属于Estimation。下面对高阶调制下的软解调 技术进行阐述和分析。
首先，为了方便对软比特解调算法的阐述，假设在任意的M进制（" = 23 K=l, 2, 3…）调制星座图S,星座图上各星座点表示集合S = ｛4,$2,S3,...,s〃｝,每个星 座点都包括I路（同相）的分量和Q路（正交）的分量｛0为｝,并且已对此星座图 进行了功率归一化，其中|sj=s/+s1，表示该星座点到星座图远点的距离的平方。 调制器把某二进制向量4=也”生也，…也｝按照公式（2-5）映射到该星座图上的星座 点上。
将发送端进行调制后的星座点为记名= %,%）,则该星座点经过均值为0,方差 为/的AWGN信道后，接收端接收到的星座点为「=（小为），发送星座点与接收星座 点之间满足如下关系式：
…（2-14）
K+%	（2-15）
其中，%和为分别是星座点r的I路和Q路所对应的独立同分布的加性高斯白噪 声，均值为0,方差为
在通信系统中，调制与解调往往是与信道编解码相结合，解调后输出的信息因该 为二进制比特所对应的软信息，使用LLR （LogLikelihood Ratio,对数似然比）来 计算QAM信号软判决度量值，以便传递给信道解码模块进行信道解码。
在发送端各调制星座点先验等概的条件下，即
P（s,） = J
M	（2-16）
接收星座点可解调为参考星座点§ = S,的后验概率为㈤：
19
CL I 、 P(r|i = 5.)P(5 = 5,) P(s = s, I r)=--------------------
YjP(r\s = si)P(s=si) i=0
(乙 一 % )2 + (%  $近)
2
T^exp(-J27rb
2cr2
exp(14)
M ]
Z 万hexp(一 ?=0 V 2.710
2b2
m a?
Y" (2」7)
G - S〃)2 +(b—Sf°)2
其中d； = (r - s；y =(，7 -s“)2 +(rQ -s©)?为解调后星座点r到参考星座点号的欧式 距离的平方。在这基础上有两种常用的软解调算法，Log-Map和Max-Log-Map。
1)	Log-Map算法
调制星座点4对应的二进制向量为"=也也,则解调后输出的每个二 进制比特的对数似然比为：
Z P(S = sj r)
LLR(bk-) = hi %=°L;2 = 必普/-
次勾=1卜) £ P(S = s/r)
4 e ⑷％=】)	(2-18)
对于QPSK星座图中，解调后相应的二进制比特(现62)的对数似然比值为：
LLR(ht) = In
LLR(b2) = \n
P(b] = 0 卜)_ 出尸(3=001 /)+ 尸3 = 011 r) P(b】二11 /)一 n P(『=10|7)+P(* = ll|r)
P(b? = 0 I 0 _ 如 P6 = 00 I -)+尸(以= 10 | 尸) 尿2 二 1 ⑺一 n P(si = 01\r)A-P(si = U\r)
(2-19)
以上所述为Log-MAP算法125】，此算法需要已知信道的信噪比信息。
2)	Max-Log-Map 算法
Max-Log-map算法是对Log-MAP算法进行简化，以下通过数学推导来说明简化 的依据。
M
定义噎。)，或“(2)..…<
,表示式⑴中的力=(—s,)2,s, e{s,也=1}由小到大的
M
排序，类似定义，之⑴4.(2)，「嚎
也是对式⑵中的片=(…厅应G {S,| % = 0}由小
到大的排序。
同时定义:
20
4W ⑺-4式),24/万
、 o	M
A^o(0 = Co(0-<=o(iX2</<T
(2-20)
则Log-Map算法可以改写为:
LLR(bk) = In
尸(仇=0卜)
£ P(s = s, I r)
_ ]4€3」纵=。｝__________
S P(§ = sj r)
MH 1 a 小
1 + ge -
=彳(%0)-%(1))+E—―二”)
2b	1 +32…)
i=2
i	MH ( J_.
一行(以。⑴-%⑴)+0 e"
ZCF	i=2 I

(2-21)
由于A3]⑺和c是按由小到达的顺序排列的，所以上式求和中的各项参数基本 以指数速率衰减，取该加法的前若干项可以构成一种近似算法，最简单可忽略求和 项从而构成如下算法：
]「 一 =--7 min (r- 5,)2- min (r- 5,)2
2b~ |_*亳%=0}	s,eg,%=l}	J	.	(2-22)
将Log-Map中的对数运算转化为欧式距离的运算，因此这种算法称为软解调的 Max-Log-Map算法闽，又称为最小欧式距离法。
(2)	256QAM下仿真比较两种算法软解调性能
对软判决解调方式进行仿真，仿真信道为高斯信道，Turbo译码算法为 MaxLog-Map,从图2-11可知，随着信噪比的增加，Max-Log-Map算法的误比特 率略低于log-map算法，差距非常小。表2-3为两种算法在不同调制方式下计算复 杂度对比126-27],从计算复杂度方面比较两种软解调算法的硬件实现难度，当数据量 增加时，Max-Log-Map算法明显优于Log-Map算法，并且没有指数和对数运算， 更利于工程实现。
21
图2-11 256QAM Iog map与max Iog map软解调算法性能对比
表2-3 Log-Map和Max-Log-MAP的运算量比较
调制方式	解调算法	加/减	乘/除	指数	对数
16QAM	Max-Log-Map	4N	4N	0	0
Log-Map	28N	16N	32N	8N
64QAM	Max-Log-Map	6N	6N	0	0
Log-Map	90N	48N	96N	12N
256QAM	Max-Log-Map	8N	8N	0	0
Log-Map	248N	64N	256N	16N
因此，256QAM的软解调算法应采用Max-Log-Map算法，后续仿真中软解调 皆是采用了该算法。
2.3	LTE-Hi系统下行MIMO技术
2.3.1	室内系统下多天线传输模式的考虑
无线通信系统可以利用四个维度的资源：空间、时间、频率和功率。在B3G/4G 系统中，空间资源和频率资源被重新开发使用，从而大大提高了系统的性能。所谓 的多天线技术通常在发送端和接收端同时使用多根天线，扩展了空间域，充分利用 了空间扩展所提供的特征，从而带来了系统容量的提高。多天线构成的信道称为 MIMO(Multiple Input Multiple Output)信道，使用多天线技术的系统称为MIMO无 线通信系统。
22
图272 MIMO系统模型
图2-12给出了一个基于空间复用的MIMO系统模型,具有叼根发送天线，既根 接收天线。在每个符号周期内，为根发送天线发射的信号向量可以表示为： $ =现,$2,…,%},既根接收天线发射的信号向量可以表示为尸=限出…4经过 MIMO接收检测器之后的信耗向量可以表示为3 =%,务，…,对}。4表示从第j根发 射天线到第i根接收天线的复值信道响应系数。
为了满足LTE在高数据率和高容量方面的需求，下行MIMO技术包括空间复 用、波束赋形和传输分集，2天线可以获得分集和复用增益，8天线可综合获得3种 增益：赋形增益、分集/复用增益。波束赋形一方面能提高覆盖能力，另一方面可以 降低小区内/间干扰，从而提升系统吞吐量，文献［29J通过场地测试的得出了 8天线 波束赋形技术是室外场景的宏蜂窝的主要使用技术，2天线分集和空间复用技术将 是室内场景的微蜂窝的主要使用技术。因此，在本文的LTE-Hi链路平台中基站 MIMO技术下行基本天线配置为2x2,即2天线发送和2天线接收，在LTE-Hi系统 中应用TM2和TM3进行吞吐性能的仿真评估是符合实际和厂家测试需求的。
尽管IM3存在发射分集和开环复用两种，但本文未在TM3上应用的发射分集, 在RI=1时，TM2对应的传输方式是单码字发送分集，对于RI大于1的情况，TM3 对应的传输方案是large delay CDD。原因是，large delay CDD的预编码模块包含通 过U矩阵进行的的层交织、通过D矩阵进行的CDD以及通过循环切换W矩阵实现 的层-CRS端口映射。如果RI=1时仍然使用这种预编码方式，那么RI=1时预编码 的操作将只起到循环切换预编码向量的作用。这样做在一定程度上可以提高等效信 道的频率选择性，但是其分集增益将极大地受到具体的信道实现以及编码速率的影 响而很难保证传输的可靠性。从链路性能角度考虑，RI=1时采用TM2的SFBC或 SFBC/FSTD这样相对可靠的分集方案比采用TM3 large delay CDD更适合叫因此， 下面对本文搭建的LITE-Hi链路仿真平台采用的TM2 SFBC及TM31arge delay CDD 技术进行介绍，为后续LTE-Hi系统下进行多天线仿真工作做铺垫。
23
城区/郊区室外连续覆勰:
建议部署8天线产品，在常规环境
下使用波束贼形，中等移动速度的
/情况下切换到空间复用/发射分集
品，使用发射分集/ 开环空间复用
室内覆盖： 建议部署单/双 天线产品，使 用单天•线发射/ 发射分集/空间 复用
室外热点/盲点覆盖， 建设部署2天线产 品，使用发射分集/空 间复用
图2-13多天线传输模式的应用场景
2.3.2	TM2发射分集
发射传输分集的主要原理是利用空间信道的弱相关性，结合时间/频率上的选择 性，为信号的传递提供更多的副本，提高信号传输的可靠性，从而改善接收信号的
信噪比，提高数据传输质量，有利于增加覆盖。发射分集的应用场景较多，如：小 区边缘、切换区域、阴影区等信道环境较差区域；适用于低速或高速等不同移动速 度情况；适用于低相关特性天线；小区配置多个天线端口时下行的公共传输信道和 信号（PBCH, PDCCH, PCFICH和PHICH和主同步和从同步信号等）均使用该模 式传输。
发射分集时，只允许对一个码字流进行分集，支持eNodeB侧两天线或四天线 配置，因要求映射层数d须和天线口数目P相等，故预编码模块输入的层数也是2
层或4层，层映射关系如表25。
24
表2-4发射分集层映射表冏
■
2	1	X(0)(Z)=i/(0)(27) ”(7)=淤)(万 + 1)			MZ：=ACb/2	；
4	1	x(0)(/)=^(0)(4z) /)(7•) =/。)(4i + l) x ⑵(i) = d⑼(4i + 2) x(3)(z) = <Z(0)(4z+3)			%*/4	若 M*bmod4 = 0 2 一 [.黑 + 2）/4	若M黑 mod4Ho 如果A/（°）mod4w0,那么有两个空符 号映射到d（°）（M⑵—1）
当p=2,也就是2天线时，发射分集预编码处理为:
谭⑵）'		1 0 j 0一		Re(x(0)(/))
ym(2i)	1	0-107		Re(x(1)(0)
yo)(2/ + l)	二正	0 1	0 J		Im(x(o)(z))
严⑵+1)		.1	0 -J 0		Im，，。）
(2-23)
即：
y(o)(2z) j(o)(2z+l) 严⑵)严⑵+1)
(2-24)
2.3.3	TM3开环空间复用
空间复用时，最多允许两个码字流，物理信道传输时的映射层数u须满足U9, P为eNodeB侧天线口数目，可为2或4。层映射如表2-5。
表2-5空间复用层映射⑶）
■iiif
1	1	r(o)(z) = J(o)(z)	“器=心胃
2	2	X(O)(7)=^O)(7) X(1)(Z)=i/(I)(Z)
2	1	x（o）（j） =淤）（2。 凡）=淤）（2，+ 1）	“黑=M£/2
25
3	2	X⑼(i) = d⑼⑺ x(,)(z) = iZ(0)(2z) x(2)(z) = £Z(0)(2z + 1)	“器=〃绘/2=〃缁/2
4	2	x(o)(z) = J(o)(2z) x⑴(i) = d⑼⑵+1) x(2)(j) = d。)⑵) x(3)(z) = J(1)(2z+1)	射器=〃缁=〃瘟/2
大延迟发射分集（Large Delay CDD）是一种常见的时间分集方式，可以通俗的 理解为发射端为接收端人为制造多径。LTE中采用的延时发射分集并非简单的线性 延时，而是利用CP特性采用循环延时操作。根据DFT变换特性，信号在时域的周 期循环移位（即延迟）相当于频域的线性相位偏移，因此LTE的CDD （循环延迟 分集）是在频域上进行操作的。
基于LTE协议定义，大循环延迟分集CDD按以下模式进行预编码：
严⑴
产 ）（，）
式中，小⑴是Pxv阶的预编码矩阵，D（i）和U是支持大延迟CDD的矩阵，针 对各种不同层映射，具体设置参见表2-6所示。
表2- 6开环空间复用矩阵设置表
1
0
m/2
-j2n/3	/如3
-j4n/3	j3n/3
1
一/2%/2
0
1	0	0
0	0-/26/3	0
0	0	e-j4m73
1	1	1	1			1	0	0	0 ■
1	1	e-J'2fr/4	?-/44/4	«-/6万/4			0	e-j2x;/4	0	0
2	1	e-w/4		jjl2 加 4			0	0	-j4jri/4	0
1	e-j6x/4	e-712x/4	6-/184/4			0	0	0	«_/6万〃4
26
V3
式2-25中，印■«）是Pxu阶的预编码矩阵，O（i）和U是支持大延迟CDD的矩 阵，针对各种不同层映射，具体设置参见表2-6所示。
由于开环空间复用（TM3）要求UE反馈的信息只有CQI和RI,因此eNB侧 的决策工作也比较少，是适合于LTE-Hi系统下的室内小基站的、在传输的稳定性 和高吞吐量上实现增益的传输模式之一。
2.3.4	TM3模式内自适应切换
图2- 14模式内自适应切换流程
TM3、TM7、TM8、1M9均支持模式内自适应传输。除主模式外，这几种模式 内部均支持发射分集作为回退模式。虽然发射分集作为TM2单独存在，但是由于与 其他模式进行模式间切换时间较长，如果在此期间信道发生变化，则很有可能会造 成系统性能的急剧下降。因此这就需要TM3、TM7、TM8、TM9能够支持模式内自 适应至发射分集模式，以适应低信噪比条件下等不适于多流传输的情况。
TM2发射分集作为回退模式单流传输，一般适用于信道条件较差的场景；开环 空间复用作为主模式多流传输，一般适用于信道条件较好的场景。TM3下，eNB需 要根据从UE接收到的CQI和RI参数（不需要PMI）动态选择是使用单流发射分
27
集，还是使用TM3双流Large Delay CDD (大时延CDD)。对于单双流和传输模 式的选择的选择，本文基于［32］中提出的一种基于信道质量信息(SINR)和信道质 量指示(CQI)在发射分集和空分复用两种LTE MIMO模式的切换思想，按图2-14所 示做如下判断：
1)在子帧N传输时，接收端根据信道估计所得H,计算信道的秩(即RI)。
2)当RI为1时，采用传输分集模式，根据之前流程确定CQI并向基站端反馈； 当RI为2时，需要执行后续判断(由于信道特性在绝大多数时候会呈现秩为2,但 此时次优的流性能较差，此时并不适合双流传输)。
3)当RI为2时，需要分别计算单流和双流情况下对应的CQL并将单流对应 的TBS和双流情况下两流TBS之和进行比较，选择较大者对应的模式进行传输。
2.4	MIMO下行链路评估中的接收检测算法
2.4.1	高阶调制下的MIMO接收检测算法
MIMO技术为系统提供分集增益和空分复用增益，可以在不增加功率和带宽的 情况下极大提高通信系统的容量和频谱效率。然而，MIMO技术提高无线通信性能 的同时，也增加了信号处理复杂度。尤其是采用高阶调制的MIMO系统接收机，其 高复杂度给无线通信基带处理带来了重大挑战。虽然最大似然算法(ML, maximum likelihood)是最优的检测算法，能够完全获得接收分集增益，但其需要遍历所有可 能的发射向量，复杂度与发射天线数和调制阶数的乘积成指数关系，在实际中不易 实现。
为了降低检测算法的复杂度，近年来各种复杂度相对较低的MIMO检测算法 相继涌现。其中线性算法有迫零算法(ZF,zero forcing)和最小均方误差算法(MMSE, minimum mean square error),这两种线性算法运算复杂度较低，但是性能相对较差。 非线性检测算法有球形译码(SD, sphere decoding),最小均方误差串行干扰消除 算法(MMSE-SIC, MMSE successive interference cancellation)等。
在AWGN信道下仿真对比16QAM, 64QAM,256QAM在应用SD与ZF检测 时的误符号率，图2-15为仿真结果。从误符号性能角度看，不管对于何种调制方式， SD算法的检测性能都要远远优于ZF算法，随着信噪比的升高，两者的性能差异越 大；还可以得到，SD接收检测的性受到调制阶数的影响，在相同的信噪比条件下， 调制阶数越高，误符号率越高。从运算量角度看，ZF检测算法的运算量与调制阶数 无关，而SD检测算法由于搜索半径与调制阶数有关的原因，使得SD的复杂度随 发射天线数和调制阶数的增加成指数增长，在高阶调制下的应用受到限制图1。但SD 在室内信道下应用的还存在一个显著的优势，即SD算法的搜索半径的初值与噪声
28
方差有关，随着信噪比的提高，搜索半径也在缩小，越来越多的网格点被排斥在球 外，搜索就变得更为容易。因此，在室内良好的信道下应用SD算法时，应对考虑 运算量和性能两个因素进行折中考虑。
10°
10」
10-2
tr LU co
10-3
104
Tx = 2,Rx = 2,SD与ZF检测算法性能比较
10-5
5	10	15	20	25	30	35	40
Eb/No in dB
图2- 15 SD与ZF接收检测误符号率对比
2.4.2	MMSE算法数据流性能衡量矩阵的推导
ZF算法能有效的消除来自其他天线的干扰，但是也存在着放大噪声的缺点，最 小均方误差准则（MMSE）基本思想是使得判决统计量和发送信号矢量间的均方误 差最小，在降低复杂度的同时可以比较显著地提高链路性能，因此在实际商用化过 程中得到了广泛的应用。为了使评估的结果可以更直接的为厂家提供测试数据，本 文采用MMSE算法作为所搭建的链路级仿真平台中接收检测算法。
MMSE算法中得到的数据流SINR是进行链路评估技术的基础，MSE和SINR 都是两个重要的衡量数据流性能的矩阵，以下给出了 MIMO系统中MMSE准则下 的检测矩阵G、检测后MSE和SINR的计算式的推到过程和结果。
1）求MMSE检测矩阵G
一般来说，MIMO的系统模型可以表示为y =总+%,%发々收，H为巧*2维 信道矩阵，n为加性白噪声信号。假设接收端经过检测后得到£ = G（加+〃），则MSE 矩阵为：（凡
E[G]— x）（3 — x）H ] =（GH — I）（H hgh — I） + GR
=G（HHh + Rn）GH +I-GH-HhGh	c 小
29
晔（叱）=［司,,=叱（瓦产+凡）/+1—叱
(2-27)
其中吗为G的第i行，由于MMSE检测是通过滤波检测矩阵G的设计使得实
际传输的信号和输出信号之间均方误差MSE保持最小，则使得初珥的梯度为0时 得到的G即为应用MMSE时的滤波矩阵。
G=（hhh+RmFhh
=赞时+5『
=与1『(/+附十尸
2)求检测后的各支流的MSE：
Em 5[G*] = Wh +RnNt^HH(HHH +R„)[(HhH +RnNtxNty'HH]H
+/ ~(HhH +&加初尸*目+ R…J'HH f
=	+ 凡)+凡)一听
+1 -Hh(HHh +R")T"-Hh(HHh +凡)
= (I+HhR；1H)~1
(2-28)
(2-29)
其中采用了公式（4+比0尸=4】-4旗r4~叨+仁1尸。4"1
MSE，=lQ+HHR[Hn,i
(2-30)

(2-31)
MSg =
1
（凡=印/”+凡）

(2-32)
Ini表示第i个对角线元素为0的单位阵。这三个MSE的表达式是等价的。
算简便的考虑，我们一般用第二个表达式。
3）求检测后各支流的SINR：
出于计
SINR =
|［G町J	帆闻2
Nt
=]H hr1H* = %h ( £ /也H + ”也
(2-33)
w/X叫w/&叫
SINR=——-1 ，MSE,
R"=a】
-1 =
(2-34)
1
1

［（/ +〃密初一工

30
i Nt	r	。
E帆闻+珑IM』
J=ig	（2-35）
其中〃，为"的第，歹U。2-33, 2-34, 2-35这三个表达式也是等价的，出于计算简 便的考虑，一般选用第三个表达式。
4）在使用上述公式实现MMSE算法时，应该注意：
本文推导中用=或/,表示每个接收天线上噪声功率是各天线上的噪声独 立，所以相关阵是对角阵。如果系统中有用户间干扰，小区外干扰等等因素，系统 模型为y = Hx + /”咨rence + n,则均表示后两项（干扰+噪声）的相关阵，此时不 再是对角阵。
通过2）中给出的公式计算出检测后各支流的SINR,表征的是符号级别的子信 道的信道质量，可以准确的反映出整个信道，各频点处的信道质量。当将这些信息 全部反馈到基站时，会消耗大量的信令资源，因此实际系统中需要某种方法对整个 带宽上载波的SINR进行压缩。一种最简单的压缩方法是求所有SINR的平均值 夕环也用于表征信道状态信息。对于OFDM调制技术的多载波系统来说，每个载波 所经历的信道相差很大，因此传统的采用平均值来作为“有效SINR”的方法不能 正确的评估信道的质量。下一章将对压缩带宽上载波SINR的算法，即有效信噪比 合并算法进行详细的探讨。
2.5	本章小结
本章对高阶调制链路关键技术进行了详细的介绍。首先对LTE-Hi系统的仿真 场景和信道建模关键参数进行说明，为后续的仿真分析做铺垫；然后对高阶调制 （256QAM）的星座调制及软解调算法进行研究和性能仿真分析；其次，对多天线 技术中的TM2发射分集和TM3开环空间复用技术及传输模式在LTE-Hi系统中的 应用细节进行了说明，在这基础上仿真比较了常见的MIMO下行接收检测算法在高 阶调制下随调制阶数的升高的误符号性能的变化，主要涉及了 ZF和SD两种算法； 最后，由于检测算法中得到的数据流SINR是进行链路自适应技术的基础，本文完 成了对MMSE检测算法中数据流SINR矩阵的推导工作，作为有效信噪比合并模块 的输入为下一章有效信噪比合并方法的研究奠定了基础。
32
第三章有效信噪比合并技术在自适应调制编码中的应用
自适应调制与编码技术（AMC）是链路自适应的重要组成部分，影响链路评估 的正确性。但高阶调制（256QAM） OFDM系统中的引入对原有的AMC中有效信 噪比合并带来了挑战，影响了链路质量的评估及信道质量信息（CQI）上报的准确 性，因此需要在高阶调制（256QAM）给出有效信噪比的计算方法。
3.1	自适应调制与编码技术原理
自适应调制与编码技术（AMC）就是根据信道条件的变化，动态地选择适当 的调制和编码方式（Modulation and Coding Scheme, MCS）,这种技术已经广泛应 用于现有的无线通信系统中。图3-1给出了的AMC的接收端与发送端的处理流程, 可以看到进行AMC需要依赖于发送端利用接收端反馈回测量到的信道质量信息来 作为CQI上报的依据,进而发送端根据CQI选择适合当前信道条件的调制解调方式 和MCS,在不同的信道条件下使系统吞吐趋于最优。
图3- 1AMC传输模型
信道质量信息后验SINR的获得是由检测算法（即图3-1中的MMSE检测）得 到，继而通过有效信噪比合并（ESM）将整个带宽上载波合并为一个当前帧下该发
33
送端的SINR,称之为有效信噪比。影响AMC自适应性能的关键步骤有两个1351,其 一为合并检测算法得到的后验SINR为有效信噪比的信噪比合并算法；其二为CQI 上报值的确定。为了在原本的AMC流程中引入高阶调制，下面首先对256QAM引 入后对MCS/TBS选择的更新内容进行了阐述与对比分析，在这基础上研究了 AMC 的两个核心步骤中涉及的关键技术在高阶调制下的性能，对高阶调制引出的问题给 出了相应的解决方案。
3.2	高阶调制下的MCS选择及CQI上报
3.2.1	高阶调制对MCS/TBS配置的影响
物理下行链路共享信道（PDSCH）是LTE承载主要数据的下行链路信道，数据 在传输时已传输块（TB）作为基本传输单元，根据无线信道的情况（UE上报）选 择合适的调制方式和TBsize,最大化信道的利用率。由于RU之前的LTE系统并不 支持256QAM,如果要引入256QAM技术，则需要对目前的MCS （调制编码策略）、 CQI （信道质量标志）、TBS （传输块大小）等信令信息进行修改。R12引入256QAM 之后，确定了新的配置。
表3-1中为协议［34］给出的256QAM引入后的MCS/TBS配置方式，为保证引 入256QAM后MCSIndex仍为0〜27,保持对系统的兼容性。一方面，将QPSK的 TBS Index = {0, 1, 2, 3, 4, 5, 6, 7, 8}减少为={0, 2, 4, 6, 8）,另一方面去 掉了相邻调制方式切换的位置时所用的重复TBS Index,使所有调制方式下使用完 全不同的TBS Indxo将余出来的20〜27项补充为256QAM的TBS Index,最终确定 为新的MCS/TBS映射表。
通过仿真可以得到在各个MCS下BLER=0.1时对应的SNR,信道类型为AWGN 信道，使用的PRB数为1。图3-2给出了仿真的结果，可以明显看到256QAM引入 后的不同MCS之间的切换的跳跃性变大，随着MCS的升高，各调制方式下MCS 选择的粒度变细〔36】，增强了高阶调制下AMC的自适应能力。
34
(ZH4-q) AOUOoiE① LU2O① dg
BLER=0.1时各MCS需要的SNR 8 7 6 5 4 3 2 1 0
-5	0	5	10	15	20	25	30
SNR(dB)
图3-2 256QAM引入后各MCS的频谱效率(SE)与SNR的关系
表37 256QAM引入后新的MGS/TBS配置表皿
MCS Index Ajcs	Modutation Order Qm	TBS Index ,TBS
0	2	0
1	2	2
2	2	4
3	2	6
4	2	8
5	4	10
6	4	11
7	4	12
8	4	13
9	4	14
10	4	15
11	6	16
12	6	17
13	6	18
14	6	19
15	6	20
16	6	21
17	6	22
18	6	23
19	6	24
20	8	25
21	8	27
22	8	28
23	8	29
24	8	30
35
25	8	31
26	8	32
27	8	33
28	2	26
29	4	reserved
30	6
31	8
3.2.2	高阶调制下的CQI上报
（1）	CQI配置
进行CQI上报时，需要使用CQI映射表，在规定的各CQI等级对应的编码效 率下得到BLER-CQI映射表，作为有效信噪比映射曲线以确定上报的CQI等级。引 入256QAM后，与MCS/TBS表的变化规则一致，新的CQI配置表（表3-3）与原 表（表3-2）相比减少了 QPSK所对应的CQI等级，增加了 256QAM对应的CQI^o
表3-2原CQI表
CQI index	modulation	code rate x 1024	effi c i ency
0		out of range
1	QPSK	78	0. 1523
2	QPSK	120	0. 2344
3	QPSK	193	0. 3770
4	QPSK	308	0. 6016
5	QPSK	449	0.8770
6	QPSK	602	1.1758
7	16QAM	378	1.4766
8	16QAM	490	1.9141
9	16QAM	616	2. 4063
10	64QAM	466	2. 7305
11	64QAM	567	3.3223
12	64QAM	666	3. 9023
13	64QAM	772	4. 5234
14	64QAM	873	5. 1152
15	64QAM	948	5. 5547
表3-3新的CQI表
CQI i ndex	modulation	code rate x 1024	effi c iency
0	out of range
1	QPSK	78	0. 1523
2	QPSK	193	0. 3770
3	QPSK	449	0. 8770
4	16QAM	378	1.4766
5	16QAM	490	1.9141
36
6	16QAM	616	2. 4063
7	64QAM	466	2.7305
8	64QAM	567	3.3223
9	64QAM	666	3.9023
10	64QAM	772	4.5234
11	64QAM	873	5.1152
12	256QAM	711	5. 5547
13	256QAM	797	6. 2266
14	256QAM	885	6.9141
15	256QAM	948	7.4063
当通过EESM或MIESM合并得到有效SINR之后，便可以基于15条AWGN 信道下得到的SINR-BLERCQI判决线来进行CQI的上报表中所示的15个等级的 CQIo
AWGN
图3-3 CQI曲线仿真获取流程
(2)	CQI上报流程，分为如下三个步骤：
首先，根据协议要求仿真确定AWGN信道下仿真得到15条CQT线。协议中对 CQI等级编码效率进行了规定，结合15个等级各自不同的调制方式及编码效率，通 过在AWGN信道下仿真得到15条CQI线，反应了不同CQI(调制方式与编码效率) 的条件下SINR与BLER的关联。如图3-3,随机生成的比特流经过码块分割，添加 CRC,信道Turbo编码，码速匹配后通过256QAM的星座调制为符号流。通过噪声 AWGN信道后在接收端进行发送端逆处理的过程，最后通过CRC校验得到该信噪 比下的BLER。为了得到适用性更强的CQI判决线，首先根据协议中不同的CQI等 级的编码效率确定选用的 及TBSizeo本文选用5个物理资源块(Physical Resource Blocks, PRBs)的总数据量，去掉3个符号PDCCH的特殊符号及两端口的参考符 号占位(CRS)后，实际上总共有600个资源元素(ResourceElement, REs)用于 数据传输。公式(3-11)为编码速率(CodingRate , CR)与TBSize,之间的关系， 具协议中建议的CR取值，结合Turbo编码对分块后码长的兼容性需求，表34为 计算出的建议值。
37
CR =
TBSize + TB CRC + CB CRC Qm * nREs
(3-1)
表3-4 CQI上报参数表
CQI等级	调制方式	编码速率	码长(TBSize)	BLER=O. 1 对应 的 SINR (dB)
1	QPSK	0. 076	88	一
2	QPSK	0.188	224	-3. 15
3	QPSK	0. 438	528	0. 701
4	160 AM	0. 369	885	4. 606
5	16QAM	0. 479	1152	6. 431
6	16QAM	0. 602	1440	8. 326
7	64QAM	0. 455	1632	10.3
8	64QAM	0. 554	1984	12. 22
9	64QAM	0. 651	2368	14. 01
10	64QAM	0. 754	2688	15.81
11	64QAM	0. 853	3072	17. 68
12	256QAM	0. 694	3328	19. 77
13	256QAM	0. 778	3712	21.51
14	256QAM	0. 864	4147	23. 52
15	256QAM	0. 926	4444	28.81
然后，通过仿真得到（Block Error Rate,误块率）为0.1时得到相邻CQI线间切 换时对应的SINR,即为CQI切换的门限值。下表中给出了仿真得到的CQI线及切 换的SINRo通过仿真得到15条CQI线（图3/2）,可以观察到随着SINR的增加, CQI线之间的距离也增加，也反应出相对于低信噪比，更关注信道高信噪比下信道 质量跟踪的效果。
38
-10	-5	0	5	10	15	20	25	30
SNR(dB)
图3-4 用于上报的15条CQI曲线
最后，将有效SINR映射为CQI。由于用于映射的15条CQI线是在AWGN下 得到的，因此有效SINR应该能包含信道的信息，使得可以在不同信道环境下使用 同样的CQI线，具体有效SINR的计算方法在下一节会进行详述。得到有效SINR 之后，可以根据表中最后一列来选择合适的CQL表中最后一列的含义大于该信噪 比时，上报本CQI等级，否则上报前一个CQI等级。在将CQI通过上行信道上报 给基站之前，需要根据当前误帧的情况即ACK,对CQI进行再一次调整，若误帧 则将新的CQI更新为原CQI-Aco；双，经过最优化测试得到的当公服ack取1时， 性能最接近于理想的AMC性能。图3-5为CQI调整过程的流程图。
(3)基站对MCS选择的准则
当UE完成CQI上报之后，由基站来完成MCS的选择。在当前带宽下按照公 式计算得到频谱效率矩阵(SE_matrix) , TBS_matrix的含义为按表TBS Index得通 过查协议中TBSize的表得到的值再添加CRC后的结果。比较发送端根据接收的CQI 等级映射表3-4中频谱效率得到的SE与SE_matrix可以得到最大可采用SE及对应 的MCS,确定包长Lp。
SE
matrix =
TBS matrix nREs
(3-2)
39
图3-5基于ACK结果进行CQI上报调整
3.3	高阶调制下的有效信噪比合并方法的应用
参照AWGN信道的SNR-BLER性能，只与MCS有关
图3-6 有效信噪比合并的应用
3.3.1	有效信噪比合并的基本原理
有效信噪比映射方法(Effective SINR Mapping, ESM)是目前链路与系统级仿 真接口(Link to System, L2S)技术中常用基于SINR进行链路抽象的合并方法。 在系统级仿真中，仅仅通过AWGN下的SINR-BLER线可以将合并得到的有效信噪
40
比映射到链路级的误帧率结果上，剥离了信道环境与链路误帧率的关联，大大减少 了系统级仿真的工作量。同时，为了解决链路自适应过程中对OFDM系统下的链路 信噪比的准确估计，使用ESM得到的有效信噪比，以达在不同信道类型下使用同 样的CQI映射关系完成CQI的上报Hl。图3-6示意了有效信噪比在链路设计及系统 仿真中的应用的原理。
宽带OFDM多载波通信系统由于受频率选择性衰落的影响，需要采用非线性的 信噪比映射方法来达到与测量值接近的信道质量SNIR估计值，即有效信噪比值。 为了达到不管信道环境如何，最终通过ESM得到的有效信噪比都可以通过AWGN 下得到的BLER曲线映射到实际的BLER值上(实际中通过查表来实现)，需要满 足公式：
BLER(M ｝卜 BLER.GN (为)	33)
其中｛4｝代表各子载波的SINR, 7w是映射后的有效SINR, BLER(｛yQ)是与 即时信道状态对应的真实误块率，BLERawgnWQ是AWGN信道情况下的误块率。 同时该公式(3)是之后对ESM合并方法进行性能验证的依据。
一般意义的有效信噪比九广的计算公式如(3-4)所示，其中K是用户使用的子 载波的数目，九是第k个子载波信噪比。
1 K
7或=尸(亍2，(九))
K *=1	(3-4)
/㈤为信息度量函数，根据/㈤的不同，由于信息测度函数的不同而产生多种映 射方法。实际仿真中采用两种主要的ESM方法，指数有效SINR映射(Exponential Effective SINR Mapping, EESM)和互信息有效SINR映射(MI-ESM)。这两种方法 的基本思想是统一的，都是要找到一个压缩函数，把一组不同的SINR序列映射成 一个单一的有效SINR值，该值可以反应真实环境信道的质量，然后通过这个值可 以查AWGN BLER表得到真实SINR值。
3.3.2	指数有效信噪比合并(EESM)原理
指数有效信噪比合并方法(Exponential Effective SINR Mapping, EESM))中， 使用下面的I(x)：
这样得到:
*
(3-6)
(1)	EESM公式推导
41
EESM是基于错误概率的Union-Chernoff界得到的，通过编码二进制传输和最 大似然解码联合定界，已经得到广泛认可，公式为：
co
匕(，)<
公加	(3-7)
其中7是信道符号SINR, 4nm是二进制码最小距离，为是汉明距离为d的码 字数，乃是假定特定的汉明距离d和特定的符号SINR/的成对出错概率(PEP)o
对AWGN下的BPSK传输，运用ChernofT-bounded定界技术，PEP的上界可按 如下公式得因1：
巴 @乃=。(师上 e" = P2M.(d,r) ~ ^^Chernoff (L 乃?	(3-8)
表达式的最后一部分意味着Chemoff-bounded PEP可直接由Chemoff-bounded 的误符号率得出。那么Chemo毋bounded错误概率尺加“0。)只依赖于码字的权值 分配，按照如下式子计算 Chemoff-bounded symbol-error probability P2chem
co	co	d
匕口)< E 为鸟(。,7)< E 丹［&*™#。，/)］':^e,Chemoff (7)
d=dmin	d=4ni,	(3-9)
多态信道Chemoff-bound的基本原理，比如一个不同的编码比特经历不同的 SINR值的信道，通过一个简单的二态信道来解释，原理随即能扩展到多态信道。
二态信道由SINR向量歹=仇,为］定义，通常情况下，％，%发生的概率分别是 “，P2。另外，两个SINR值彼此独立，在实际情况下需要一个相应的交织器。二 态信道中两个码字的精确PEP不仅依赖于汉明距离d还与d个不同的符号位置有关。 因此，在经典意义上的union bound方法，即所有码字对都要经过比较就还需要关 于比特位置的细节码字信息。相反，在这种情况下，就采用遍历了 d个不同符号所 有可能位置的平均PEP。这相当于遍历了 SINR值力和%在d个不同的符号间分配 的所有可能情况。从而，ChemofFbounded PEP可以这样描述网：
. p；pW-)=5L + —力)”
，=。⑺	(3-10)
为区分第二个式子， * 代表了 d个不同的符号中的i个与％有关，而剩 下的(d-i)符号与SINR %有关。假设有1"］个这样的事件，0-(小阳'必)是这 样事件的 Chernoff-bounded PEP。
注意到，pxe~ri + p?e 丫'是二态信道的averaged Chemoff-bounded符号差错概率 因此一态信道中得出的简单关系同样在二态信道中有效al,如：
42
Pz,Chemctff	/2 D =[々Cie#
(3-11)
另外，从多项式理论中得出，多态信道的情况也同样适用，由一个向量定义: 如：
Gc加.“，力= ^^2,Chemoff Q, 7)]
(3-12)
研究Chemoff-bounded PEP的特性来得出EESM的目标是寻找到相当于一态信 道的等效SINR值” ,所以一态信道的Chemoff-bounded错概率就和多
态的相等。如:
^e,Chemoff (/d)一 ^e,Chernqff (7 )
(3-13)
鉴于上述特性，这个可以通过匹配各自的Chernoff-bounded符号概率得到
^2,Chemoff eff )-	(1，/)
（3-14）
带入Chemoff-bound表达式直接得到指数EESM:
(N
Yeff =Tn 工 Pke
（3-15）

对于有N个子载波，每个子载波的SINR值为乙的OFDM系统来说
一n篇
~Yk
7
(3-16)
上述公式的获得基于二进制传输的假设,
对于QPSK调制，EESM可以写为:
f 1 N
2 1 n
I N k=]
“、
7
(3-17)
对于更高阶调制，比如16QAM,并不能直接的得到EESM的精确表达式。原 因就是从二进制符号传输的角度看，高阶调制本身就可作为一个多态信道［39］。我们 可以在EESM中设定一个调整因子与特定的调制方式和编码速率相对应。每种 调制方式和编码速率的月值可以通过单纯的仿真得到，并没有实际的物理意义。
（2）	EESM的优缺点
43
EESM的优点是计算公式简单，易于实现，对基本的映射函数进行扩展后可以 应用于HARQ技术中。但存在两个显著的缺点：
在使用时对不同的调制方式(QPSK, 16QAM, 64QAM)和编码速率等级分别 给出对应补偿系数乃，由于"的值波动很大，若不补偿则预测性能会很差，由于 EESM缺少物理意义上的理论支撑，在高阶调制(64QAM, 256QAM)下，以产值 来区分MCS的方法会产生难以很大误差。此外，EESM接口要求一个终端的所有 子载波都必须使用相同的调制和编码方式，限制了自适应调制编码方式(AMC)的 使用。
3GPP协议网中建议了 OFDM系统中QPSK与16QAM在使用EESM作为ESM 的£值，对64QAM和256QAM并没有给出参考值。由于推导过程可以分析，随着 调制阶数的升高，高阶调制所带来的多态性更加复杂，尸值对弥散的多径信道中链 路的抽象能力下降，许多论文中已经指出了这一点，本文通过对参数夕的优化，进 一步对256QAM下EESM合并方法的性能进行了印证。
3.3.3	互信息有效信噪比合并(MI-ESM)原理
MI-ESM分为两种：基于每个接收到符号的交互信息产生比特交互信息 (Received Bit Mutual Information Rate, RBIR)和直接计算比特交互信息-平均每比
特互信息(Mean Mutual Information Per Bit, MMIB)O
RBIR ESM是先通过符号互信息(Symbol Mutual Information, SI)计算每 个接收比特互信息RBIR,文献［41］中对该合并方法了介绍，通过查找RBIR与SINR 的表格来获得SINReff,进而在理想AWGN曲线上查找到BLER值，RBIR ESM中 没有考虑星座映射，因而无法考虑不同的比特到符号的映射方式。而MMIBESM 是通过函数直接获得获得每比特互信息MMIB,可直接用MMIB到BLER的映射关 系来获得误块率BLER,也可利用MMIB来计算有效SINR,然后查找理想AWGN CQI曲线，完成CQI的上报。本文主要介绍MMIB ESM方法及映射的性能。
(1) MMIB ESM
平均每比特互信息MMIB度量了在特定的信道下传输时该二进制码字所体现 的该信道的“质量”，因此可以用度量信道的质量信息。该方法是在比特信道上直 接定义互信息，因此目标是观察基本二进制码的性能，由于一组待星座调制的二进 制码中不同位置的比特所得到差错保护是不均衡的，对实际解码器性能最接近的近 似是通过在输入信道编码后的二进制码字(星座调制之前)与星座解调后(接收机 信道译码前对数似然比(LLR)间的互信息，比特信道的两端如下图3-7所示。
44
图3-7 MIESM比特信道示意⑼
上图所示为比特信道，现在任务是定义能获得每比特互信息的函数。下面
将介绍通过高斯PDF来近似LLR PDF的方法来计算MB的有效算法图】。
在［39］的工作中介绍了从编码比特及LLR值来计算互信息的方法。
每种不同的星座映射方式决定了编码比特的互信息（Mutual Information, MI）, 因此每个比特信道的MI是通过在QAM符号中的比特来获得的平均值。在信道编
码（如Turbo）后，在QAM映射前产生二进制编码比特流加。QAM调制可表示为一 种符号映射〃:NfX,其中A为m数组集合，me{2, 4, 6, 8}分别代表QPSK, 16QAM与64QAM, X为星座。假设在一个码字中，对应于第n个QAM符号观察
得到笫，解调器通过下式计算组成该符号的第i个比特的对数似然比（Likelihood
Rate）5（4"）（其中为了简化去掉了符号指示n）
LLR(a)= ln
"3也=1)、
(3-18)
当在比特交织编码调制系统中编码块大小非常大时，此时比特交织器有效突破 调制器的所能记忆容量，系统可以表示为并行独立比特信道的集合。由于调制映射 式的非对称性，使得在调制符号的每个比特位置经历不同的“等效”比特信道。在 上述图3-8模型中,每个编码比特是以概率1/m随机映射到其中m个比特信道中的。 等效信道的互信息可表达如下：
1 m
(3-19)
I电,LLR（b）是在调制映射中第i个输入比特与输出LLR之间的互信息，反应 了解调过程，是与RBIR的主要区别。更一般情况下，通过考虑N个符号（或信道） 的接收观察值，码字间平均互信息可这样计算：
I N m
必=箴卒1心⑹烟））
(3-20；
45
互信息函数/也,〃衣（4））是QAM符号SINR的函数，因此，平均每比特互信息
MI可以表示为：
］ N m	1 N
MI =9方工留（SIN&》= ^£l <SINR„）
mN得七帖	N念	（3.21）
平均每比特互信息MI取决于每个调制符号（指示n）与编码比特指示i（或 i个比特信道），及星座图阶数m。相应的，对每个调制方式与编码比特，需要 La⑸M?）来获得（（初尔）。
在［42］中给出了互信息函数的表达式的近似方法，由于可由公式推导出
m e {2,4,6,8}的调制方式的LLR的PDF近似为高斯分布，因此相应的互信息可以 表示为1/（•）函数的和。本文在LTaHi系统下应用MIESM时，基于提案［42］中给出 的在不同调制阶数下得到的系数及7（.）函数三项内容的参量值，式中x代表通过 MMSE或其他检测算法之后得到的每个载波的SINRo
①（x）=,㈤= £aj-
比=1	（3-32）
（3-23）
上=1
'-0.04210661X3 + 0.209252炉-0.00640081X,	if X < 1.6363
/(无)=■ 1-exp(0.00181492x3 - 0.1426757 - 0.0822054X + 0.0549608), X < 7.9999
、1,	otherwise
(3-24)
文献[42]给出了上式中参量值的参考值，见下表所示：
表3-5互信息近似表达式中的相关参量值阳
调制方式	数值近似的结果，K
BPSK	K=l, a = [l]f c = [ V2 ]
QPSK	K=I,a = [l],cY2]
16QAM	K=3, a = [0.5 0.25 0.25], c = [0.8 2.17 0.965]
64QAM	K=3, a = [1/3 1/3 1/3], c = [1.47 0.529 0.366]
256QAM	K=3, a = [0.6 0.36 0.04], c = [0.24 0.96 2.76]
图3-8为根据上式得到的各阶调制对应的MI映射线。曲线有一些特点，呈“S” 型，更重视高信噪比带来的信道质量的增益；
46
SINR^ =101g 伙力其零))
L = "=i	"」	(3-25)
对于不同的调制方式，在同一信噪比下，高阶调制实际传输信道的信道质量要 好于低阶调制；不同调制阶数的最高互信息值等于它的调制阶数。为了减少仿真的 耗时，实际中一般会根据公式3-23分别在不同调制阶数下生成SINR与MI的查找 表(Look Up Table, LUT),完成SINR到MI的映射和逆映射。不同于EESM 一 次传输的数据包只支持一种调制方式，MIESM对于同种调制方式或不同的调制方 式都可以满足信噪比合并的要求。
SNR/dB
图3-8 SNR-MI映射曲线
在MMIBESM中，为了得到有效信噪比，然后通过有效信噪比映射AWGN的 BLER曲线，进而完成CQI上报，采用如下过程(接收检测算法采用了 MMSE)：
(1)根据MMSE得到每载波的SINR,通过正向查LUT,对应得到每个载波的 MI；
(2)计算平均的互信息值；
(3)根据平均互信息反查LUT,映射得到有效信噪比；
(4)按照上一节中的CQI上报流程，参照15个CQI下的AWGN性能曲线得到 BLER及上报的CQI值。
文献［44-47］及［42］中的仿真结果证明，相比EESM在个MCS下都需要对应的最 优£值，而对MMIBESM来说，即使在不加调整(£=1)下使用该参数下获得很 好的链路抽象能力，但这一结论未对256QAM下做过验证。对高阶调制下的LTE-Hi 系统，国内外现今仅有一篇文献［17］对MMIBESM在高阶调制(256QAM)下的性 能做过研究仿真，但是仿真结果仅在SISO及未指明信道下进行了验证，结果还有
47
很不充足的之处。下文基于EESM和MIESM在LTE-Hi MIMO信道中对高阶调制 下链路抽象性能进行了验证，并对比了链路抽象的性能并给出可参考的参数值。
3.3.4 256QAM下的参数优化设计
3.3.4.1	获取最优值仿真验证方案
EESM及MIESM中的调整因子£是最优化的值，与调制阶数紧密相关，最优 化目标是使多态信道下的性能曲线都通过有效信噪比的映射，得到与AWGN下相 同的SNR-BLER性能曲线。调整因子的最优化原则有两个，一是优化过程涉及的信 道变化应尽量覆盖广泛，充分验证调整因子对多径信道的抽象能力，二是选择合适 的衡量标准类似评估仿真得到的误帧率与由有效信噪比映射AWGN SINR-BLER线 得到的真实误帧率之间的差距，即要找到这样一个夕值，保证通过映射后的有效 SNR查找AWGN性能曲线所得的BLER预测值(BLER_est)与实际运行所得的BLER 真实值(BLERjeal)之间的误差最小。
本文中选择了下式作为最小化尸的准则149】，其中L的含义为帧数，代表的是L 种不同的信道实现。
1 L
MSE = - |BLER_est(i,^)-BLER_real(i)|2
L i=i	一	(3-26)
为了在特定的调制阶数(256QAM)完成有效信噪比的合并工作，需要在特定 的调制阶数下对调整因子进行最优化的仿真工作。图3-9为调整因子优化过程的处 理流程。
图3-9调整因子用优化步骤
(1)产最优化的一般思路
如果在下行链路的基础仿真平台上进行最优化参数，直接可采取的思路为:
48
首先确定一个月值和初始信噪比（SINR）；在LTE-Hi信道下进行10000帧的 仿真，并统计每帧每帧按有效信噪比公式计算得到的有效信噪比及当前帧的正确性。
具体操作分成两部分：
首先，维护一个矩阵E,行号为由O.ldb粒度划分的“有效信噪比”区间，第 一列为该信噪比下的总帧数，第二列为该信噪比下错误的帧数。则E中每行对应的 有效信噪比的实际链路误帧率（记为BLERjeal）为E的第二列的值除以第一列的 值。例如 20dB 在第 20/0.1=200 行，E（200, 1） =1000, E（200, 2） =50,则该有效 信噪比点的 BLER_real=E（200, 2） /E（200, 1） =0.02
然后，计算该月值下，每个有效信噪比映射AWGN信道下的SINR-BLER曲线 得到的估计的BLER_est与实际BLER_real之间的差距量,基于MMSE准则。
通过实践发现，尽管仿真了足够多的帧数，实际得到的仿真结果并不如意。原 因是因为在10000帧的信道实现中，信道质量变化幅度很大，但对于特定的CQI等 级所确定的调制编码方式，只有很小的区间（大约2dB）能够取得有效值
（0.001<BLER<l）,即E矩阵计算得到的有效信噪比点的BLER可能只有几个， 因为有效帧数不足而得到并不准确的BLER_real。因此，这种仿真的思路并不适合 于实际的参数优化。依据上述两个准则，设计了如下的参数优化步骤，分为两步进 行。第一步为最优化值的训练，第二步为最优化值验证。
（2） 一种高效率的调整因子最优化方法
在256QAM的调制方式下，首先进行了 £值训练的步骤：
A.确定一种MCS,随机生成LTE-Hi信道下的20种信道实现，将每个信道实 现存为文件；
B.载入一个信道文件，在该信道下，变化初始SINR （此处指路损加上阴影效 应），SINR以0.3dB为步长取6个点，保证经过实际仿真所得的PER大致分布在 0.05〜0.5范围内（或上下浮动）,画出对应该信道实现的SINR-PER曲线；
C.将上述仿真运行后的25个子信道存为文件，以备后用（用来获得25个子载 波的SINR）；
D.重复3、4,遍历20个信道实现，分别画出20个信道实现下的SINR-BLER 曲线，并得到相应的20组子信道；
E.以20组子信道为内层循环，对每组子信道，对应于每个初始SINR值，分 别得到相应的25个子载波的SINR,即（i=l,2,3,…,25）,共得到120（20x6=120）组；
F.以£值的搜索区间为外层循环，使用每一个£值，根据映射函数式（3-5） 得到各组子载波经过合成后的有效SINR,毁SINRe徉，然后在AWGN信道下查对应 的BLER值，累计100组映射得到的BLER est与对应的预存的BLER real的MSE, 画出代价函数与£值的关系曲线。
49
G.找出曲线的最低点对应的力值，即使代价函数最小的月值。
对上一步获得的夕进行在整体的链路平台下性能的验证的步骤如下。
A.设定一个初始SINR值，遍历4000个信道实现，每个信道实现下设定至少运 行5000帧。
B.重复上述一系列的仿真流程，得到不同的SINR,它们分布在一个区间，对 应于区间内的每一个点，分别得到相应的误块率，此即BLER真实值。
C.对应于区间内的每一个点，通过MIESM方法映射查找所得的BLER预测值。
D.针对BLER预测值和真实值，同样按公式计算MSE。
E.将后处理SINR分布区间内的通过两种不同的方法得到的每一个点在图形上 打印出来，观察他们的接近程度与收敛性。
第二种最优值得仿真验证方案在效率和结果的有效性上都优于第一种做法。
3.3.4.2	仿真条件
SISO是MIMO的特殊情况，SISO下得出的调整因子的适用性有限，但反过来 在MIMO下得到的优化结果在SISO系统中同样适用。本文是在2x2 MIMO , TM3 CDD的传输模式下进行链路仿真，可以得到通用性更强的最优调整因子。具体仿真 条件为下表：
表3-6仿真条件
参数	值
载波频率	3.5GHz
带宽	900kHz
子载波间距	15kHz
FFT数目	2048
PRB数目	5
每个TTI中使用的OFDM符号数	11
发送天线数X接收天线数	2x2 MIMO
传输模式	TM3 CDD
信道环境	LTE-H i静态信道NLOS
信道环境	IMT-Hotspot Indoor 3km/h NLOS
信道编码	Turbo 1/3
接收检测算法	MMSE
图为预存的20种信道实现的SINR-BLER分布图，20条曲线基本没有重叠或十 分贴近的现象，而在生成信道时又保证了信道的不相关性，因此，这20条信道能够 作为典型的信道代表，训练出来的最优化参数适用性更强。
50
12	14	16	18	20	22	24	26	28
SNR （dB）
图3-10参数训练所需的20种信道实现下的SNR-PER分布图（ci=0.69）
3.3.4.3	仿真结果及分析
对于低阶调制已经有了很多研究成果，因此本文只关注了高阶调制和高码率下 MMIBESM和EESM在256QAM参数的优化仿真，其余调制编码下的调整因子 可以分别按上最优值的获取方案来获得。其中，对EESM进行了单参数的优化（式 3-16）,对MIESM即进行了单参数（式3-22）,又进行了双参数优化。双参数优 化的公式：
防/加=ioig 1mq1n心詈））
(3-27)
将P参数分成名, «2,从参数的位置可以看出会分别影响到最终SNReff-BLER 曲线的上下和左右偏移，理论上可以获得更准确的合并性能。图3-11, 3-12分别为 cr=0.864时，MIESM单参数和双参数优化过程中得到的中间结果，选择最低点对应 的0/（见«2）为最优的调整因子。
51
图3-11MIESM单参数优化结果cr=0.864
alpha1,alpha2 for MIESM cr=0.864
alpha2 0.6 o.7	alphal
图3-12MIESM 双参数优化结果cr=0.864
按照上述最优化参数的获取步骤，在256QAM的三种码率下获取了 EESM单参 数，MIESM单参数及双参数优化后的结果及选择响应调整因子时对应的MSE,结 果如表3-7, 3-8, 3-9所示。
尽管在较低阶的调制方式下，不使用调整因子的MIESM( £ = 1)可以与EESM 达到相近的MSE, MIESM可以省去逐个MCS分别对调整因子的优化的步骤，采用 MIESM非常简便。但是在高阶调制下，从表中EESM和MIESM参数优化后的MSE 的结果来看，EESM与MIESM单参数优化后的性能非常相近，但MIESM的性能相 对更稳定一些；256QAM下，不优化的MIESM (夕=1 )性能很差，双参数优化的 MIESM的性能远远优于不优化及单参数优化的MIESM及EESM的性能。因此在高
52
阶调制下可以通过MIESM双参数优化最终得到更好的链路抽象及之后进行链路自 适应的效果。
表3-7 EESM调整因子参考值对应表
Code Rate	Optimized b forEESM	Optimized MSE
0. 694	64. 76	0. 070
0. 778	190. 22	0.40
0.864	127. 05	0. 0422
表3-8 MIESM单参数调整因子参考值对应表
:然燃就蒸缪套黑热微然泌常%沁 褒3 Y撼三 Code Rate	■ 	■■■■■■■ ■ ■ ■■■■ ■ —< "■ Optimized B for MIESM	Optimized MSE	Raw MSE 0 = 1
0.694	1.016	0. 074	0. 305
0.778	0.985	0.087	0.544
0.864	1	0.069	0.069
表3-9 MIESM双参数调整因子参考值对应表
Optimized%,	% for MIESM	.. ■■ ■. ' 、 : ' ' ' " ■ ', Optimized MSE
Code Rate	%
0.694	0.872	0.880	0. 042
0.778	1. 180	1. 164	0. 014
0.864	1. 108	1. 110	0. 038
为了进一步比较高阶调制下，EESM和MIESM有效信噪比合并的性能，在 LTE-Hi信道下进行仿真验证。下图3-13为在256QAM的三种码率下由EESM算法 得到的有效信噪比，图3-14为MIESM得到的有效信噪比，采用了优化的双参数作 为调整因子。图中横坐标的含义为有效信噪比，纵坐标的含义为误帧率，将有效信 噪比合并映射AWGN得到的误帧率估计值与仿真得到的误帧率实际值进行了对比。 对比两图，可以明显看出，双参数的优化后的MIESM的链路抽象性能明显好于参 数优化后的EESM链路抽象的性能。
53
基丁参数优化后的EESM在256QAM下有效信哄比合并性能
18	19
20	21
22	23	24	25
SNR(dB)
图3T3 LTE-HiNL0S信道下EESM性能验证
基于双参数优化后的MIESM在256QAM下有效信噪比合并性能
18	19	20	21	22	23	24	25
SNR(dB)
图3T4 LTE-HiNLOS信道下NIIESM双参数优化后的性能验证
3.4本章小结
本章首先结合协议介绍了 256QAM引入后对AMC在MCS选择和CQI上报造 成的影响，然后对CQI上报中关键的有效信噪比合并技术进行了详细点的研究，对 两种主流信噪比合并技术EESM及MIESM设计了参数最优化训练方案，并在高阶 调制下对比了两者的链路抽象性能，得出此在高阶调制下可以通过MIESM双参数 优化最终得到更好的链路抽象性能。最终完成了 LTE-Hi系统在高阶调制下链路自 适应调制编码模块的设计，为下一章的链路仿真评估奠定了基础。
54
第四章LTE-Hi系统高阶调制的链路仿真及分析
据笔者调研发现，迄今为止国内外共有3篇文献涉及了小基站场景下的高阶调 制(256QAM)技术的仿真性能研究。其中文献［14］和［15］仅比较了 64QAM和 256QAM在较高信噪比下的吞吐量，均未进行链路自适应和传输模式自适应，对 256QAM引入后的链路评估不全面。文献［13］的仿真结果虽然在链路自适应下得到 的，但论文中所采用的MMIBESM公式在256QAM下应用时性能比较差，这将会 影响到链路评估的准确性，且此文献仿真的信道环境为EPA 10,这并不能直接作为 LTE-Hi系统室内信道环境下的链路的评估结果。因此，在LTE-Hi信道，链路自适 应及MIMO的前提下，开展高阶调制的链路性能评估的工作，为厂商测试提供直接 的参考数据，加速高阶调制阶数在LTE-Hi系统中的商用化。
4.1下行链路总体处理流程
图4-1下行链路总体处理流程
57
LTE物理层信道分为上行物理信道和下行物理信道，其中上行信道指的是终端 向网络端发送信息的信道，下行信道是指网络端想向终端发送信息的信道。物理下 行共享信道(PDSCH)是物理下行链路的关键信道，它的性能直接影响到整个物理下 行链路的性能，所以PDSCH链路关键技术的研究就显得尤为重要。下行PDSCH发 端及收端的基本处理步骤可以简单概括如图4-1所示，其中左侧从上到下为eNodeB 发送所需要经过的处理模块，经过OFDM调制之后的符号通过LTE-Hi信道后，进 入右侧的UE接收端的处理流程。本章主要研究高阶调制下的下行发射端的链路， 它主要由Turbo编码、速率匹配、加扰、调制、层映射、预编码、资源映射、OFD 调制/解调等功能组成。
LTE-Hi系统室内良好的信道环境适合采用多天线技术，因此在发送端和接收端 都采用了双天线发收信号，考虑了单路(一个码字)和两路(两个码字)PDSCH数 据，不同的码字用来区分不同的数据流，其目的是通过多输入多输出(MultipleInput Multiple Output, MIMO)技术发送多路数据，实现空间复用。
1)码字分块与CRC,在发送端，基站根据上行链路中中UE反馈得到的信道 质量，通过调度算法选择TB的大小即为每个码字数据的原始长度，然后对每个码 字进行循环冗余校验码(Cyclic Redundancy Check, CRC)的添加，PDSCH规定的 CRC长度为24,主要用于校验。根据对Turbo码的性能仿真，编码块继续加长会增 加译码时延，但纠错性能提升却不明显，因此对于长度大于6144的码字需要进行分块 操作。另外还考虑交织器的设计，折中选择了 188种长度的码块进行分块，分块后继 续对每个块进行CRC的添加。在接收端，Turbo解码的结果在进行码块合并之后送 入CRC校验，校验正确的情况下进行码块合并并进行统计，如果失败则通过HARQ 重传机制进行重传。
2)信道编解码与交织技术，PDSCH主要采用的是1/3码率的Turbo编码，其分 量编码器中多以递归系统卷积码(Recursive Systematic Convolutional, RSC)作为其 分量编码器。交织的作用是为了有效的解决突发干扰所产生的影响，实际上是一个 一一映射函数，作用是将输入序列中的比特位置进行重置，以减小分量编码器输出 校验序列的相关性和提高码重。交织器的出现使得Turbo编码出现了随机性符合香 农限成立的随机编码的前提条件，作为Turbo码技术的关键性环节，对其性能的提 高有很大的影响。Turbo码的解码 算法采用了 MAP算法，迭代解码结构，通过分 量解码器之间软信息的交换来提高解码性能。解码器由两个分量解码器和交织器与 解交织器组成的，它将一个分量解码器的软输出信息作为第二个分量解码器的输入， 然后第二个分量解码器的软输出信息作为第一个分量解码器的软输入，如此进行反 复迭代数次，以便达到更好的解码性能。
58
4)速率匹配，是指传输信道上的比特被重发(repeated)或者被打孔(punctured), 以匹配物理信道的承载能力，信道映射时达到传输格式所要求的比特速率。根据物 理资源可承载比特的大小，数据多了就打孔，数据少了就重复，当然根据RV版本 号的不同也可以配合进行重传，RV重传的各个版本之间会有不同程度的重叠，重 复传输的码字与编码效率有关。
5)调制与解调，调制的结果是比特级的数据按相应的调制阶数的星座图映射到 符号上，解调为调制的逆过程，一般情况下，为了与Turbo解码结合到一起，解调 的输出软判决信息。由于在第二章已经对调制解调技术进行了详细的描述，此处不 再赘述。
6)层映射和预编码，由于在一个TTI里面最多只能传两个TB 了，而天线可能 大于2,用层映射(layer mapping)可以解决输入输出不匹配的问题,将码字 (codeword)映射到天线的端口上。层映射技术分为单端口层映射、发射分集层映 射、空间复用层映射。由于发射端能准确知道各用户的信道状态信息，所以在发射 端采用反馈干扰抵消的方法不存在误码扩散问题，性能更优，反映出来就是预编码。
7)资源映射，将各天线端口的调制符号映射到资源粒子，在仿真平台中需要根 据数据符号的数量得到导频在RB中的位置图样以及数据在RB中的位置图，按频 率顺序将数据和导频映射到对应的位置上。
8)	OFDM调制和添加循环前缀(Cyclic Prefix, CP) , OFDM调制是LTE系统 给的关键技术之一，在实际中通过IFFT运算来完成，添加循环前缀的目的是为了 消除符号间干扰和码间干扰，最终生成各天线端口的时域OFDM信号。
4.2静态信道下的高阶调制链路级仿真
在LTE-Hi静点信道的LOS和NLOS场景下进行了仿真，目的是对高阶调制 引入后的链路性能进行评估。
4.2.1	仿真条件
表47 LTE-Hi静态场景信道下的仿真条件
测试场景	LTE-Hi NLOS LOS 静点场景
系统带宽	20M
RB资源数	WOPRBs
上下行配比	上下行配置1: 3,特殊子帧配置7
HARQ	打开
AMC	自适应调制 阶数范围：	QPSK 16QAM 64QAM ;记为 without 256QAM QPSK 16QAM 64QAM 256QAM 记为 with 256QAM
59
MIMO模式	TM2 TM3
载波频率	3.5G
接收算法	MMSE
信道估计算法	2维维纳滤波
CFI	3符号
PSS\PBCH\SSS	理想已知
天线配置	eNode B 2天线（发送、接收）； UE 2天线接收，1天线发送；
Antenna configuration (base station)	基站10倍波长； （直射径与移动台天线阵法线夹角0 degrees）
Antenna configuration (UE)	终端0.5波长； （直射径与移动台天线阵法线夹角150degrees）
需要说明，仿真条件中的信道估计算法并未采用一般论文研究中采用的理想信 道估计，而是采用了基于二维维纳滤波的信道估计算法。原因是由于本文进行链路 级仿真的目的不仅是为了得到256QAM所能带来的增益比例，还包通过仿真得到吞 吐量的具体峰值和增长量，本文的研究结果力图接近真实的吞吐性能，所以采用了 非理想信道估计的算法。
4.2.2	仿真结果及分析
（1）	LTE-Hi信道SNR累积分布图
LTE-Hi动态信道下实测SINR的累积分布图
60
采用动态LTE-Hi信道下的SNR累积分布图(图4-7)来表征如图2-1室内环境 下用户的SINR分布情况。可以看出，约有70%的用户的SINR高于16dB；约50% 以上的用户的SINR高于20dB；约有40%的用户的SINR高于25dB。使用SNR分 布情况可以检验高阶调制在LTE-Hi中的可用性，用做下文进行仿真分析的基础。
(2)在TM2/TM3下分别进行仿真结果及分析
70	LTE利信道TM2100RB链路自适应仿真结果
605040302010 (sdqw)5d€)no」qj_
-5	0	5	10	15	20	25	30
SNR(dB)
图4-3 TM2传输模式下得到的下行链路吞吐量性能曲线
图4-3为TM2传输模式下得到的下行链路吞吐量随SNR的变化情况，分别在 LOS和NLOS两种场景下进行了高阶调制的链路评估。
对于LOS,当SNR高于12dB左右时，256QAM相比64QAM可以带来增益； 当SNR高于16dB左右时，增益开始明显；当SNR高于20dB左右时，最高使用 64QAM时链路的吞吐能力达到上限，而最高使用256QAM的链路吞吐继续提升， SNR高于24dB左右时，链路吞吐能力到达上限。最终，TM2LOS下，链路最高使 用256QAM相比最高使用64QAM吞吐量提高了 L2dB左右。
对于NLOS,当SNR高于6dB左右时，256QAM相比64QAM可以带来增益; 当SNR高于12dB左右时，增益开始明显；当SNR高于16dB左右时，最高使用 64QAM时链路的吞吐能力达到上限，而最高使用256QAM的链路吞吐继续提升； 当SNR高于244dB左右时，链路吞吐能力到达上限。最终，TM2NLOS下，链路 最高使用256QAM相比最高使用64QAM吞吐量也提高了 1.2dB左右。
61
80
70
不使用256QAMn、j信噪比与Qm选择间的关系
图4-4统计TM2传输模式下最高64QAM时，信噪比与调制阶数选择间的关系
80
使用256QAM时信噪比与Qm选择问关系
OOOOOOOO 7 6 5 4 3 2 1
(％)① 6-2u(Do」① d
MMqpsk B—B 16QAM EZ7Z3 64QAM I 256QAM
-4	0	4	8	12	16	20	24	28
SNR (dB)
图4-5统计TM2传输模式下最高2560AM时，信噪比与调制方式选择间的关系
图4-4, 4-5统计了41B到28dB区间上，调制方式自适应的结果（NLOS信道）, 当引入高阶调制之后，调制方式的选择发生了明显的变化。4dB及以下几乎不会选 择256QAM；当信噪比高于8dB时，对256QAM的选择机会增加，16dB以上几乎 所有的帧都选择了 256QAM,验证了图4-3仿真中得出的结论。
62
(gqH) -nd.c6no ±1
图4-6 TM3传输模式下得到的下行链路吞吐量性能曲线
图4-6为TM3传输模式下得到的下行链路吞吐量随SNR的变化情况，分别在 LOS和NLOS两种场景下进行了高阶调制的链路评估。
从图中可以看出，对于NLOS,当SNR高于12dB左右时,256QAM相比64QAM 可以带来增益；当SNR高于20dB左右时，增益开始明显；随着信噪比的升高，链 路吞吐能力都未达到上限。对于LOS,出现了链路通信质量低下的结果，在TM3 下产生这一现象是由于LOS信道的强相关性引起的，为了明确问题产生的原因，分 别从统计条件数(Condition Number)和数值互相关计算的角度对LTE-Hi LOS和 NLOS信道的相关性进行了分析。
MIMO信道容量与信道奇异值的关系表达式为：
n	n
C = ^Blog2(l + ^o-,2(77))
日	N	(4-7)
其中N表示独立的Tx-Rx对的数目,of的含义为无线信道矩阵H的奇异值。 通过对信道矩阵H进行SVD分解可以得到S对角矩阵即为奇异值，奇异值的大小 衡量了信道所支持的“自由度”的“健康状况”，数值越趋近0,说明该自由度越 接近“退化”的边缘。对于理想的“最优信道”，两个奇异值大小相同，意味着信 道对两个自由度的支持都很好，没有任何差别；而在一般信道条件下，可能会出现 一个数值特别大，一个特别小，即这个信道可支持1个自由度(秩)，但支持2个 信道的效果差。因此定义了参数：ConditionNumber (条件数),含义为“对角阵S” 中，最大奇异值与最小奇异值的比值。条件数越接近1,说明信道中各个平行子信 道(自由度)的传输条件性能好且平均；比值越大，说明各个子信道的传输条件差 异大。下图4-7为LTE-HiLOS和NLOS信道的条件数累积分布图，可以看出NLOS
信道的相关性更接近理想MIMO信道（完全不相关），LOS信道的相关性很强，仅 可支持一个自由度。表4-2中计算出的互相关性给出了相同结论,Corrcoef（H00,H10） 的含义为到同一个接收机的两个发射机信道矩阵的互相关值，数值越大，相关性越 强。
LOS NLOS信道条件数累积分布图
8 6 4 2 O.O.GO.
(%)LLdo
0 0	10	20	30	40	50	60	70	80	90	100
Conditon Number
图4-7 LTE-HiLOS与NLOS信道条件数CDF ® （用于相关性分析）
表4-2对比LOS与NLOS天线间互相关值
互相关值	Corrcoef (H00,H10)	Corrcoef (HO1,H11)
LOS	0.9937	0.9881
NLOS	0.6003	0.3380
TM3 CDD是双码字传输，利用天线间的不相关性来得到增益，因此并不适合 LOS的信道环境。而实际环境下，尤其是动态信道条件下，LOS和NLOS处在不断 的切换中，所以进行自适应是必要的。
（3）在传输模式自适应条件下进行仿真与分析
传输模式对链路吞吐性能的影响很大，NLOS信道下，TM3相比TM2可以利 用天线不相关性带来吞吐增益［的，而在信道相关性强的LOS信道中采用TM3会导 致极差的链路性能，更适合采用传输。因此，实际中需要通过TM自适应选择 合适的传输模式。
64
。-5
LOS NLOS下*™自适应仿真结果
.51
(sdqw)Jndu6no.1 111
5	10	15	20	25	30	35
SNR(dB)
o
图4-8 TM自适应传输模式下得到的下行链路吞吐量性能曲线（2PRBS）
在m［自适应的条件下进行了仿真，资源大小为2PRBs,采用了高阶256QAM。 图4-8中给出的仿真结果显示，当进行TM自适应之后，相比于不进行自适应，LOS 和NLOS下在TM2和TM3中选用了最合适的传输模式，从而最大化链路的吞吐性 能。
除了上述可以从性能曲线中看到的显著特点，在低信噪比（OdB）以下时，最 高使用256QAM的吞吐性能要低于最高使用64QAM的吞吐性能。在OdB以下时, 引入256QAM后的平均误码率要与原本的性能。这是256QAM的弓j入后对 TBS/MCS/CQI的配置表的更新（上文3.2.1节对此进行了详述）而影响的，QPSK MCS选择的粒度加粗导致在低信噪比下对链路的自适应能力下降。尽管高阶调制的 引入对低信噪比下的吞吐性能略有影响，但当应用在室内优质的信道环境下这个缺 陷不会产生实际问题。
4.3	动态信道下的高阶调制链路级仿真
首先需要确定LTE-Hi动态场景信道的仿真方法，LTE-Hi静点场景信道与动态 场景信道在仿真时的方法不同，在静点信道分为LOS和NLOS两种信道模型，而动 点的路径中既有LOS,又有NLOS,因此仿真必须在传输模式自适应的条件下进行; 此外，静态场景下，信道模型使得信道每一帧的特性（时延，功率等）与SINR无 关，仿真时可以在自己设定的SNR下，遍历所有帧完成对整体链路的评估。而在动 点下，除去从X到A的移动路径用于完成信道环境的初始化及测试工作所占的帧
65
数后，信道全长38400帧，每一帧（时延，功率）与SINR （发射功率与到达功率 的比值）一一对应，并且两者都与室内的场景（墙体厚度，行走路线）紧密相关， 因此在仿真必须逐帧进行。因此，为简化仿真，将每1200帧作为一个仿真点，以 1200帧范围内的SINR的平均值作为仿真的SNR,在38400帧内共选择了 33个点 进行了仿真，以下给出了仿真条件及仿真结果。
4.3.1	仿真条件
表4-3 LTE-H i动态场景信道下的仿真条件
测试场景	LTE-H i动点信道场景
系统带宽	20M
RB资源数	lOOPRBs
上下行配比	上下行配置1: 3,特殊子帧配置7
HARQ	打开
AMC	自适应调制 QPSK 16QAM 64QAM ；记为 without 256QAM 阶数范围：QPSK 160AM 64QAM 256QAM 记为 with 256QAM
MIMO模式	TM2 TM3自适应
SNR范围	图2-4中每12000帧平均值
载波频率	3. 5G
接收算法	MMSE
信道估计算法	2维维纳滤波
CFI	3符号
PSS\PBCH\SSS	理想已知
天线配置	eNode B 2天线（发送、接收）；UE 2天线接收，1天 线发送；
Antenna conf i gurat i on (base stat ion)	基站10倍波长； （直射径与移动台天线阵法线夹角0 degrees）
Antenna configuration (UE)	终端0.5波长； （直射径与移动台天线阵法线夹角150degrees）
66
4.3.2	仿真结果及分析
(sdqwncn 三 du6n021
图4-9动态场景的信道下行链路吞吐量性能曲线（TM自适应）
从仿真结果（图4-9）中可以观察到三个明显的LOS/NLOS切换点，产生了吞 吐量的骤升或者骤降。整体来看，AMC最高256QAM的链路相比最高使用64QAM 的链路性能平均提升了 0.36dB»而实际通信系统中存在发射机和接收机的信号功率 损耗使得0.46dB的增益几乎不能体现。因此在文中所描述的设定路径的LTE-Hi动 态场景下，高阶调制并不能带来充足的链路吞吐性能增益。
4.4	本章小结
对LTE-Hi静态/动态场景下的LOS/NLOS信道及动态场景和TM2发射分集与 TM3大时延CDD及自适应传输模式下进行了链路仿真评估工作。在链路自适应的 条件下比较了高阶调制技术（最高使用256QAM）与不引入高阶调制技术（最高使 用64QAM）下吞吐性能，此外还对天线相关性，256QAM引入后更新的MCS/TBS 对吞吐性能的影响进行了仿真与解释。仿真的信道场景和仿真条件尽量贴近了实际 应用情况。
67
68
第五章高阶调制下增量冗余型HARQ链路抽象技术
广义来讲，链路评估工作不仅仅包含通过链路级仿真对特定场景下的仿真结果 进行直接的性能评估工作，还包含为系统级仿真提供链路的物理层抽象结果，是链 路级到系统级仿真接口（L2S）技术中重要的一部分。
对HARQ的系统级仿真需要建立在各次重传后的链路评估结果之上，通过将评 估得到链路质量（即有效信噪比）映射AWGN信道下的SNR-BLER性能曲线，即 可以获得当前信道条件下的误帧率，用以分析系统整体性能。目前HARQ的链路抽 象模块尚没有明确、完整、统一的做法，在大部分用于学术研究的系统级仿真平台 中都没有较为合理精确的HARQ模块，更没有论文在高阶调制下实现HARQ链路 抽象过程。如何准确在包含高阶调制的各MCS下抽象HARQ,尤其是复杂的增量 冗余型（IR） HARQ的物理层过程，提出更加合理的HARQ模型对系统级仿真平 台的实现具有很大的实际价值。
5.1	HARQ 概述
HARQ（混合自动重传请求）技术是FEC（前向纠错）技术和ARQ（自动请求重传） 技术的结合，发端发送的码不仅能够检错，而且还具有一定的纠错能力。根据重传 内容的不同，HARQ可以分为两类：第一类HARQ是FEC和ARQ的简单结合，只 是将ARQ中传送的码字进行纠错编码，每次重传码字与先前传送的码字完全相同。 第二类HARQ则是将码字的信息部分与校验部分分开传送，对信道有一定的适应性。 第二类HARQ根据重传码字的不同，又可以分为三种类型：I型追赶合并（CC： Chase Combining）方式、n 型全递增冗余（Full IR： Full IncrementalRedundancy）方式和 III 型部分递增冗余（Part IR）方式is1
CC方式是指每次重传发送的码字与初传完全相同，包括信息位和同样的 校验位。接收端保存收到的无法正确译码的码字，将其和重传分组合并，合并时 根据每个分组发送时的信道信噪比进行加权合并，然后再进行译码。Full IR方式是 指每次重传发送的码字都各不相同，没有重复的比特位。第一次发送的码字中包含 信息位或者一部分冗余的校验位，重传的码字则只包含校验位，不包含以前传输中 已经传送过的信息位和校验位。Part IR方式是CC方式和Full IR方式的综合，每次 传输的码字中都包含信息位和校验位，只是校验位各不相同。又可以分为两种，一 种是可以自解码的，另一种则不能进行自解码。
69
在系统级仿真过程中，信道类型是多样的，对当前帧是否误帧需要根据相应信 道下的链路级仿真的结果来判定，这使得系统级仿真在时间和复杂性上难以忍受， 于是产生了链路级到系统级仿真接口技术(Linklevel to Systemlevel Interface, L2S) 的概念，而其本质是是链路抽象技术。链路抽象过程应该具有这样的特性，将当前 所有载波符号的后验SINR矩阵输入L2s接口，通过映射AWGN曲线，可以立即得 到当前链路的误帧率，因此，对于涉及HARQ的链路抽象，目的也是通过抽象当前 次重传与合并后的链路性能，映射AWGN参考线，获得当前重传后的误帧率，用 以分析系统整体性能。下面首先对HARQ链路抽象的基本方法进行了介绍。
5.2	HARQ链路抽象的基本方法
文献［55］给出了各种HARQ重传信噪比的基本合并方法。HARQ中的CC合并 重传版本间的数据是完全相关的，对于EESM和MIESM的公式的扩展方式相同， 从理论上，只需要对ESM方法进行简单的修改就可以应用到这两类HARQ系统中【52〕。
由于加入了重传，接收端收到的SNR合并后将发生改变，式(3-15)变形为
1"侬犯。J)
其中：/(•)为有效信噪比压缩函数； 以为等效子载波总数； 。为等效子载波的集合；
N*是一个HARQ过程的传输次数； 外是第k次传输的比特序列；
%是Vk的一个指示函数，
%是k次传输中，序号为i的比特序列的SINR。
对于CC合并，每次传输的bit相同，接收端采用最大比合并(MRC),所以 对于每次传输，处于相同子载波上多次传输的SNR可以直接叠加。由CC的性质, 可以得到。=匕，Ntol=N1,式(3-17)可以转化为

\
7
%=
(5-3)
70
对于Fun IR合并，第一次传输所有的信息bit和相应的冗余bit,以后每次重传 不再传输信息bit,只传输不同的冗余bit,假设没有外包效应（wrap around effect）, 没有合并发生，则鼠=/乂，式（3-4）理论上可以转化为
（1 如「	）
九行=L =七£/（加）	（5-4）
上述公式中/值取决于Ntx次传输合并后的有效码率P/N, P是编码器输入分 组的比特数。对于CC合并，每次重传的比特与第一次传输的信息相同，有效码率 等于尸/2,分值在每次重传中保持不变；对于Full IR和PartIR这类增量冗余型
的HARQ,月值随着码率改变，多次重传比特之间存在相关性，因此使得对力值敏
感的EESM在应用起来非常复杂。MIESM的物理意义是从比特级信道的级别来对 链路进行评估，使用起来更加灵活，本文基于MIESM合并方法对IRHARQ的链路 抽象技术进行研究。
5.3	高阶调制下增量冗余型HARQ的链路抽象方案实现与优化
5.3.1	重传版本间相关性的分析
HARQ IR重传版本间的重复导致的相关性是有效信噪比合并不能直接采用 CC重传合并方法（式）的根本原因，理解重传版本（RV）的产生原理十分重要。 而RV产生的过程与Turbo编码和交织密切相关。如图5-1,码块分割之后的原码先
进行Turbo编码，Turbo编码器由一个编码器与两个卷积器组成。
\
Output
图5~1 turbo编码器
71
其中输入为：C0,4c2，。3,…,CRT，输出为：成”;，成,4。,…〃名,飕一。
其中：
(1)	D = K + 4 ；
(2)或，4°,"〉..,境_1为输入序列°0,6，02，。3，..,明加4个尾bit；
(3)	4a及…，必为输入序列c°,c”q,C3,…,经过卷积G(0)= L8果，
L g。。)」
g0(D) = 1 +D2 + D3, &(。)= 1 +。+。3,末尾再加 4 个尾 bit；
(4)	《…,为输入序列/，6笛2，。3,…,曝_1经过交织。；=0①再经过同
样的卷积器得到。末尾再加4个尾bit；
交织方法：n(i) = "； + [/)modK, /,人根据输入数据长度K查内交织 表。
将turbo编码器的输出再分为d：,《°,心…，埋t , d；,d；,dL , 4，d；,d"..,d"三组,每组重排为32列，不足时在第一行补空比特NULL。行数R 为「少/32],行数随写入比特流的长度而变化。要按照整行和整列的方式写入交织矩 阵，根据三路比特流中的比特数目会预先填入空比特。随后进行列置换，列置换规 则如表5-1所示。列置换工作完成后按列输出即完成子块交织。
表57 列置换规则
原列	0	1	2	3	4	5	6	7	8	9	10	11	12	13	14
目标列	0	16	8	24	4	20	12	28	2	18	10	26	6	22	14
原列	16	17	18	19	20	21	22	23	24	25	26	27	28	29	30
目标列	1	17	9	25	5	21	13	29	3	19	11	27	7	23	15
根据上一步中输出的bit流，RV版本重传的具体信息便可以确定下来。如图5-2 所示为虚拟二维循环缓冲，该缓冲有固定96歹U，行数与子块交织矩阵的行数相同。 将交织后的系统比特流按列写入，随后将两路分别交织后的校验比特流交替按列写 入即完成了比特收集工作。LTE中的四个冗余版本起点分别为第2列、第26列、第 50列和第74列的顶部。下图所示为冗余版本的示意图。一般初始传输Rv=0版本, 需要重传时，依次传输Rv=l, RV=2, RV=3版本。
72
图5-2冗余版本选择起点示意图
5.3.2	基于MIESM对IR重传合并的链路抽象方法
（1）递归的纯IR重传转换的原理
HARQ-IR重传时，若为每次重传间没有重复比特的纯IR重传（FullIR）,则 可以按重传次数将合并后结果分q部分，每部分码长G，互信息量（MI）为M,,
X信息比特

初次传输 幽		第二次传输 mi2	■ ■ ■ ■	第q次传输 Ml3

C1编码比特	C1编留比特	Cq编码比特
图5-3信息比特结构
总的MI为:

C5-5)
再根据此等效MI查MI-BLER曲线得到系统级所需的误帧率。
这是Full IR在MIESM中的实现方法。而对与Part IR, 1R重传实现时粒度有限, 因而会有比特在重传中重复，重复的比特和不重复的比特在传输过程中经历了不同 的信道增益，因此应该采取公式（5-4）来计算MI和有效信噪比。
实现时的思路是将重传后收到的重复和不重复的比特分割开来，可以采用一种 递归的方式对重传版本去相关，每次重传后MI的计算，从而转化为一种纯IR重传 ［的。设在一次重传中，新传输且与已有合并结果不重复的比特数为名新传输但 与己有合并结果重复的比特数为%,已有的合并结果中这次没传输的比特数为； 之前的合并结果的MI为新的传输的比特互信息为：7；o
则新合并后的MI为网：

%・MjNg •小Nr •工夕(Mj+尸⑷) Npre+NZ%
(5-6)
73
SN%=f；'(MG
(5-7)
其中工。)是比特SINR到互信息的映射，工'•)为互信息到有效SINR的逆映射, 实际中通过查表来得到互信息和有效信噪比。“整,可以看作是由于重传版 本间相关性后所引入的加权因子，可以通过数值仿真来获得。
(2)重传加权因子的计算
式(5-6)中阳历,外,"”的取值与MCS密切相关，不同MCS下母码的长 度及重传版本的起点和终点不同，并且每个版本里都分布有不同数量的空比特，需 要对所有MCS对应的RV版本进行统计。
图5-4两次重传后各加权值的含义示意图
图5-5三次重传后各加权值的含义示意图
表5-2是在10RB下(120*10=1200 Symbols)统计出来的重传版本中不同MCS
下乂尔,砥，N片的取值情况，pre的含义为本次重传版本中之前版本已传，但本次
N
未传的比特数量占已传比特总数的比例，即为不一手；
华“+必+队
74
NR的含义为本次重传版本中新传的比特数量占已传比特总数Nr的比例，即为
N曲	；
Npre+ Nr + Nnr
R的含义为本次重传版本中重复传的比特数量占已传比特总数的比例，即为
Nr
Np.+Nr+Nnr。
因此公式（5-6）可以改写为
M『=Pre	降 + NR.l； + R•4（MQ + 公«》
表5-2 10Rb下历次重传各种比特数
pre	NR	R
Mcs_0 (256/2400,QPSK)	Rv_l	0	0	1
Rv_2	0	0	1
Rv_3	0	0	1
McsJL (424/2400,QPSK)	Rv_l	0	0	1
Rv_2	0	0	1
Rv_3	0	0	1
Mcs_2 (696/2400,QPSK)	Rv_l	0	0	1
Rv_2	0	0	1
Rv_3	0	0	1
Mcs_3 (1032/2400,QPSK)	Rv_l	768/3168	768/3168	1632/3168
Rv_2	768/3168	0	2400/3168
Rv_3	768/3168	0	2400/3168
Mcs_4 (1384/2400,QPSK)	Rv_l	1056/3456	1056/3744	1344/3744
Rv_2	1824/4224	768/4224	1632/4224
Rv_3	1824/4224	0	2400/4224
Mcs_5 (1736/4800,16QAM)	Rv_l	480/5280	480/5280	4320/5280
Rv_2	480/5280	0	4800/5280
Rv_3	480/5280	0	4800/5280
Mcs_6 (2024/4800,16QAM)	Rv_l	1344/6144	1344/6144	3456/6144
Rv_2	1344/6144	0	4800/6144
Rv_3	1344/6144	0	4800/6144
Mcs_7 (2280/4800,16QAM)	Rv」	1728/6528	1728/6528	3072/6528
Rv_2	2112/6912	384/6912	4416/6912
Rv_3	2112/6912	0	4800/6912
Mcs_8 25 36/4800,16QAM)	Rv_l	1920/6720	1920/6720	2880/6720
Rv_2	2880/7680	960/7680	3840/7680
75
Rv_3	2880/7680	0	4800/7680
Mcs_9 (2856/4800,16QAM)	Rv_l	2112/6912	2112/6912	2788/6912
Rv_2	3840/8640	1728/8640	3072/8640
Rv_3	3840/8640	0	4800/8640
Mcs_10 (3112/4800,16QAM)	Rv_T	2352/7152	2352/7152	2448/7152
Rv_2	4608/9408	2256/9408	2544/9408
Rv_3	4608/9408	0	4800/9408
Mcs_ll (3240/7200,64QAM)	Rv_l	2448/9648	2448/9648	4752/9648
Rv_2	2596/9796	148/9796	7052/9796
Rv_3	2596/9796	0	7200/9796
Mcs_12 (3624/7200,64QAM)	Rv_l	2736/9936	2736/9936	4464/9936
Rv_2	3744/10944	1008/10944	6192/10944
Rv_3	3744/10944	0	7200/10944
Mcs_13 (4008/7200,64QAM)	Rv_l	3024/10224	3024/10224	4716/10224
Rv_2	4896/12096	1872/12096	5328/12096
Rv_3	4896/12096	0	7200/12096
Mcs」4 (4264/7200,64QAM)	Rv_l	3216/10416	3216/10416	3984/10416
Rv_2	5664/12864	2448/12864	4752/12864
Rv_3	5664/12864	0	7200/12864
Mcs_15 (4584/7200,64QAM)	Rv_l	3456/10656	3456/10656	3744/10656
Rv_2	6624/13824	3168/13824	4032/13824
Rv_3	6624/13824	0	7200/13824
Mcs__16 (4968/7200,64QAM)	Rv_l	3744/10944	3774/10944	3456/10944
Rv_2	7488/14688	3774/14688	3456/14688
Rv_3	7776/14976	288/14976	6912/14976
Mcs_17 (5352/7200,64QAM)	Rv_l	4032/11232	4032/11232	3168/11232
Rv_2	8064/15264	4032/15264	3168/15264
Rv_3	8928/16128	864/16128	6336/16128
Mcs_18 (5736/7 200,64QAM)	Rv_l	4320/11520	4320/11520	2880/11520
Rv_2	8640/15840	4320/15840	2880/15840
Rv_3	10080/17280	1440/17280	5760/17280
Mcs_19 (5992/7200,64QAM)	Rv」	4512/11712	4512/11712	2688/11712
Rv_2	9042/16242	4512/16242	2688/16242
Rv_3	10848/18048	1824/18048	5376/18048
Mcs_20 (6200/9600 256QAM)	RV_1	5102/14702	5102/14702	4498/14702
RV_2	9240/18840	4530/18840	5070/18840
RV_3	9600/18840	0	9240/18840
对5-2表进行观察后发现：对于每个RV, pre+NR+R=l； MCSO,MCS 1 ,MCS2 的编码效率皆小于1/3,每次重传都会传输整个母码，使得pre=NR=O, R=l；当编
76
码速率较小时，随着重传次数的增加，重传的新数据会减少到0,随着码率的增大, RV传输的总码长会呈递增的增长，每次重传都会传输新的数据。
为了验证基于公式的合理性，需要按如下步骤进行仿真：
1）在不采用HARQ的条件下，定义第一次发送的数据为RV0,分别在各 种MCS下得到相应的RVO BLER曲线，记为Curve_RV0,表示的是（SNR" BLERrvo ）之间的关系。
2）在采用HARQ,并且每次重传使用相同SNR的条件下，通过限制重传 的最大次数得到各次重传后的BLER曲线，分别记为Curve_RVl, Curve_RV2, Curve RV3。以下以第x次重传说明，Curve RVx表示的是（SNRRVx, BLERRVx ） 之间的关系。
3）查询表中对应MCS及RVx的Pre, NR, R的值，代入公式（5-8）计算 出合并后的第x次重传后的ML
4）将MI代入公式得到合并后重传x次后的有效信噪比，记为SNReff R"
5）映射Curve_RV0得到的BLER即为预测的BLER.,实际对应的
BLERRVx为实际BLER31。理想情况下BLERes,应该近似等于血眼血。
遗憾的是，按照上述步骤仿真结果并不能正确的拟合到AWGN曲线上，随着 编码速率的提高，瓦瓦却偏离9㈤心山的差距越大[53-54],可猜测随着编码速率的升 高，其他MCS也会出现不理想的合并结果。尤其是在高阶调制下，在不进行改进 的情况下，公式的合并方法难以应用到HARQ的L2s接口中。
5.3.3	IR HARQ重传合并值与真实值的差距分析
实际的仿真结果显示出团工凡成与卸无存在横向的差距，为了更定量的分析 分析传统基于MIESM的去相关链路抽象技术的应用时的性能问题，定义了 A来衡 量表示差异量：
SNRSD”	（5.9）
其中△的含义为调整量，单位为dB,仅与调制阶数和编码效率有关。差异分析 不仅是为HARQ下链路抽象技术的相关学术研究做基础，并且由于该差异量是与信 道无关的，仍然满足L2s接口的要求，因而在实际HARQ的系统级仿真也可以将该 量加入系统中用于结果校准，因此也是一种可实际应用的、直接而准确的实现HARQ 链路抽象的方法。
下面以MCS20RV1对△的仿真获取过程进行说明，将MCS20 RV1在表中对应 的重传版本统计值代入公式中合并得到有效信噪比，获得的性能曲线与参照线之间 调整量为△=6.0961。为了进一步验证调整量的有效性，仿真了 RV0与RV1使用不
77
同信噪比时的误帧率，经过相同的调整量后可以同样贴近无HARQ的参考线。说明 了合并公式和△值可以在重传信噪比相同和不同的多种情况下使用。
图5-7 RVO与RV1信噪比不同时，重传一次后得到的性能曲线（2PRBs）
Effective SNR
图5-8重传一次（RV1）的得到的有效信噪比与AWGN的贴合性能（MCS20）
在lOPRBs下进行大量的仿真，在各MCS和RV下得到的A值可以统计如下表 5-3 o
78
表5-3 10Rb下A值
码率	Rv_0	Rv_l	Rv_2	Rv_3
Mcs_0(256/2400,QPSK)	0.1067	0	0	0	0
Mcs_l(424/2400,QPSK)	0.1767	0	0	0	0
Mcs_2(696/2400,QPSK)	0.2900	0	0	0	0.1
Mcs_3(1032/2400,QPSK)	0.4300	0	1.6	0.6	0.3
Mcs_4(1384/2400,QPSK)	0.5767	0	2.3	2	0.7
Mcs_5(1736/4800,16QAM)	0.3617	0	0	0	-0.4
Mcs_6(2024/4800,16QAM)	0.4217	0	0.6	0.3	-0.2
Mcs_7(2280/4800,16QAM)	0.4750	0	1.7	0.7	0.15
Mcs_8 ( 2536/4800,16QAM)	0.5283	0	2.2	1.2	0.4
Mcs_9(2856/4800,16QAM)	0.5950	0	2.6	1.8	0.5
Mcs_10(3112/4800,16QAM)	0.6483	0	2.9	2.6	0.7
Mcs_l 1(3240/7200,64QAM)	0.4500	0	3.6	3.1	0.85
Mcs_12(3624/7200,64QAM)	0.5033	0	3.1	0.6	0.7
Mcs_13(4008/7200,64QAM)	0.5567	0	3.1	0.8	0.8
Mcs_14(4264/7200,64QAM)	0.5922	0	3.6	1.7	1
Mcs_15(4584/7200,64QAM)	0.6367	0	3.9	2.6	1.2
Mcs_16(4968/7200,64QAM)	0.6900	0	4.2	3.2	1.3
Mcs_17(5352/7200,64QAM)	0.7433	0	4.7	3.8	1.4
Mcs_18(5736/7200,64QAM)	0.7967	0	5.1	4.4	1.7
Mcs_19(5992/7200,64QAM)	0.8322	0	5.6	4.7	2.1
Mcs_20(6200/9600 256QAM)	0.6458	0	6.2	4.9	2.6
Mcs_21(6712/9600 256QAM)	0.6992	0	7.1	5.6	3.7
Mcs_22(6968/9600 256QAM)	0.7258	0	7.9	5.8	3.8
Mcs_23(7480/9600 256QAM)	0.7792	0	8.6	6.7	4
Mcs_24(7736/9600 256QAM)	0.8058	0	8.9	6.6	4.2
Mcs_25(8248/9600 256QAM)	0.8592	0	9.2	6.2	4.3
Mcs_26(8504/9600 256QAM)	0.8858	0	10.7	7.8	5.4
对于第x次重传(x=0, 1, 2, 3),上表中Rv_x列对应的△值得含义为对在 第x-l次重传下计算得到的有效信噪比加△可以得到第x次重传得到的有效信噪比。 根据表中的数据，可以对各MCS在相应的重传次数下的△值作图如下。
79
各MCS由RV卜差异量
-2	0	2	4	6	8	10	12
△皂（dB）
图5-9参照表5-3得到的各MCS在不同重传次数下的△值
观察表中A值的变化规律，可以做出如下分析。对第一、第二次重传，当码率 cr<0.3时，对第三次重传，当码率cr <0.2时，A=0；对其他A不为0的情况，横向 来看，对同一个MCS随着重传次数的增多，△呈下降的趋势，原因可从表中看出, 同一个MCS的NR比特占比随着重传次数的增多而下降，即整个母码所剩的未传输 的冗余比特减少，从而增益量减少导致了 A的减小；纵向来看，在一种调制方式下 的相同重传数目下，随着码率cr的增加，A呈上升的趋势，也与表中NR列的变化 趋势一致。因此△值与每次重传中新比特占己传比特的比例有密切关系，而在调制 阶数一定的条件下，这个比例只与码率cr有关。
5.4	本章小结
HARQ的系统级仿真建立在IRHARQ链路性能评估与抽象的基础上，是链路 级到系统级仿真接口（L2S）技术的重要部分。本文采用了基于MIESM的IRHARQ 链路抽象方法，对其迭代式的、去重传相关性的方法进行了实现与仿真验证，发现 随着调制阶数和编码速率的提高各次重传后映射AWGN曲线得到的误帧率与真实 误帧率之间的偏差会增大。通过大量仿真得到了各调制编码方式（MCS）下的偏差 补偿量，并初步分析了补偿量与编码速率之间的关系。通过仿真得到的不同重传版 本和调制方式下的加权参数及修正量为HARQ的系统级仿真的研究中HARQ模型 的搭建提供了依据。
80
第六章总结与展望
6.1论文工作总结
移动通信用户对数据流量不断增长的需求，使得LTE-A承载的数据流量越来越 多，而越来越多的数据流量发生在室内及热点地区。3Gpp在R12中提出大规模部 署小基站来解决室内和热点地区的流量问题。本文紧跟3GPPR12的最新进展，研 巧围绕LTE-Hi的室内场景和热点场景展开，主要的研究工作和研究成果总结如下：
(1)高阶调制技术引入对自适应调制与编码技术带来了挑战，其中有效信噪比 是CQI上报过程的关键技术。为了将现有的有效信噪比合并方法应用到256QAM中, 搭建了参数仿真与验证平台，对EESM和MESM算法中的调整因子进行了最优化 仿真，最终完成了高阶调制下链路自适应调制与编码模块的设计。
(2)根据3GPPLTE的相关物理层协议使用MATLAB搭建了下行链路仿真平 台，链路仿真平台主要包括BS端传输下行数据块的所有处理流程及UE端相应的 解码过程，引入了链路自适应AMC、HARQ及多天线技术，主要评估参数为吞吐 量。仿真在LTE-Hi的静态和动态场景下进行，平台的搭建为之后关键技术的性能 研究工作打下了基础。
(3)验证了高阶调制下基于MIESM的HARQ系统链路的抽象方法的准确性， 发现随着调制阶数和编码速率的提高，链路抽象的偏差会增大。通过大量仿真得到 了各MCS下的偏差补偿量，完成了终公式的修正，计算及仿真得到的参数和修正 量为HARQ的系统级仿真提供了依据。
6.2	论文进一步工作方向
运营商和设备商对小基站组网技术越来越重视，3GPP中也提出了很多关于小 基站组网的增强技术，未来，小基站应用场景中仍有下方面需要进一步研究：
(1)调制解调技术本身己经发展很成熟，但是就应用而言，为基站或者手机 终端增加256QAM调制还需要从硬件实现角度考虑，加入256QAM调制会给硬件 实现带来一定复杂度，所以高阶调制进一步应用将取决于硬件的实现情况。
(2)本文主要搭建了链路级仿真平台，并验证了高阶调制技术的吞吐性能。 LTE-Hi除了高阶调制之外的关键技术，如动态子帧调整，双连接，小区开关等技术
81
都需要系统级仿真进行性能验证。为了对这这些关键技术进行有效评估，应该进一 步搭建LTE-Hi的系统级仿真验证平台。
（3）本文在IRHARQ链路的抽象技术研究中发现了调整因子与编码速率和版 本间重复比特的数量有密切的关系，因此与Turbo码的编码方式有紧密的关联。本 文对加权量和调整量的仿真结果为这一问题的进一步研究起到了重要的辅助作用。
参考文献
[1] CCSA TC5 WG6,未来10年IMT业务市场预测，2012
[2]陈山枝，秦飞.LTE-Hi一无线移动宽带网络演进路线[J]电信科学,2012, 28(11):6-12.
[3]	Chen S, Wang Y, Qin F, et al. LTE-Hi: A new solution to future wireless mobile broadband challenges and requirements [J]. Wireless Communications EEEE, 2014,21(3):70-78.
[4]林言超，高月红，张欣等.LTE-Hi系统关键技术及发展方向[J].现代电信科技, 2013,(1):49-52.
[5]朱颖LTE-Hi关键技术研究[J].电信网技术,2014, (7).
[6]	by "IEEE Standard, for Information Technology: Wireless LAN Medium Access Control (MAC) and physical layer (PHY[C]// Specifications/' IEEE Std 802.11-2007 - Revision of IEEE Std. 2013.
[7]	3GPP TR 36.872 3rd Generation Partnership Project; Technical Specification Group Radio Access Network; Small cell enhancements for E-UTRA and E-UTRAN-Physical layer aspects (Release 12).[S].April.2O13
[8]	3GPP TS 36.211 3rd Generation Partnership Project; echnicai Specification Group Radio Access Network; Evolved Universal Terrestrial Radio Access； Physical Iyer procedure (Release 12)
[9]	3GPP TSGRAN3WG1 RI-130856.Evaluation assumptions for small cell enhancements physical layer
[10]3GPP TSGRAN3WG1 Rl-130748.Evaluation assumptions for small cell enhancements physical layer
[11]何丽峰，刘建军，沈晓冬,256QAM在LTE—Advanced标准中的应用[J].现代 电信科技,2012(12):47-52.
[12]刘晓松.LTE-A系统中small-cell的高阶调制关键技术研究[D].北京邮电大学， 2015.
[13]EIbassiouny S O, Ibrahim A S. Link level performance evaluation of higher order modulation in Small Cells[C]// International Wireless Communications and Mobile Computing Conference. 2014:850-855.
[14]刘珊，陶成 刘留. LTE-Hi系统室内场景下256QAM性能研究[J].电信科学， 2016,32(1):25-33.
[15]刘珊.LTE-Hi系统中高阶调制与干扰协调技术的研究[D].北京交通大学， 2016.
[16]Hanzaz, Z, Schotten, H.D. Performance evaluation of Link to system interface for Long Term Evolution system[C]// Wireless Communications and Mobile Computing Conference. IEEE, 2011:2168-2173.
[17]Hanzaz, Z, Schotten, H.D. Comparison of link to system interface models for WiMAX system[C]// International Congress on Ultra Modern
83
Telecommunications and Control Systems and Workshops, Icumt 2011, Budapest, Hungary, October. 2011:1-6.
[18] Yang J, Zhao H, Wang W, et al. An effective SINR mapping models for 256QAM in LTE-Advanced system [J]. 2015:343-347.
[19]Report CATR, "LTE-Hi channel modeling and simulation results”
[20] Report ITU-R M.2135, "Guidelines for evaluation of radio interface technologies for IMT-Advanced' , 2008.
[21]Report CATR, '2.6GHz TD-LTE MU-MIMO channel model'
[22]3GPP TS 36.211, 3rd Generation Partnership Project;Technical Specification Group Radio Access Network;Evolved Universal Terrestrial Radio Access (E-UTRA);Physical Channels and Modulation(Release 12)
[23]周炯盘，等.通信原理[M].北京：北京邮电大学出版社，2008.
[24] Wang J, Zhang Y, Xu L, et al. Torsional Vibration Suppression of Rolling Mill with Constrained Model Predictive Control[C]// Intelligent Control and Automation, 2006. WCICA 2006. The Sixth World Congress on. IEEE, 2006:291-300.
[25]吴湛击.联合编码调制技术理论及应用[J]. 2014.
[26]Kim K S, Hyun K, Chang W Y, et al. General Log-Likelihood Ratio Expression and Its Implementation Algorithm for Gray-Coded QAM Signals[J]. Etri Journal, 2006, 28(3):291-300.
[27]Fagervik K, Jeans T G. Low complexity bit by bit soft output demodulator [J]. Electronics Letters, 1996, 32(11):985-987.
[28]何燕锋，杨鸿文，郭文彬.高阶调制的软输出算法比较[J].北京邮电大学学 报,2003, 26(1):82-85.
[29]徐翠君，刘磊.TD-LTE多天线解决方案分析[J].邮电设计技术， 2013(1):26-29.
[30]Ball C F, Miillner R, Lienhart J, et al. Performance analysis of Closed and Open loop MIMO in LTE[C]// Wireless Conference, 2009. EW 2009. European. IEEE, 2009:260-265.
[31]3GPP 36.212,3rd Generation Partnership Project;Technical Specification Group Radio Access Network;Evolved Universal Terrestrial Radio Access (E-UTRA);Multiplexing and channel coding(Release 12)
[32]Adhikari S. Downlink transmission mode selection and switching algorithm for LTE[C]// International Conference on Communication Systems & Networks. IEEE, 2011:1-10.
[33]Hassibi B, Vikalo H. On sphere decoding algorithm. Part I. Expected complexity [J]. IEEE Transactions on Signal Processing, 2005, 53(8):2806-2818.
[34]3GPP TS 36.213, 3rd Generation Partnership Project;Technical Specification Group Radio Access Network;Evolved Universal Terrestrial Radio Access (E-UTRA);Physical layer procedures(Release 12)
[35]文荣.LTE下行链路AMC反馈映射关键技术研究[D].电子科技大学,2012.
[36]Mu Q, Liu L, Chen L, et al. CQI table design to support 256 QAM in small cell
84
environment[C]// International Conference on Wireless Communications & Signal Processing. IEEE, 2013:1-5.
[37]Donthi S N, Mehta N B. An Accurate Model fbr EESM and its Application to Analysis of CQI Feedback Schemes and Scheduling in LTE[M]. 2011.
[3 8] Ericsson u system-level evaluation of OFDM-further considerations^ TSG-RAN WG1 #35
[39] S. S. Tsai and A. C. K. Soong, uEffect!ve-SNR mapping fbr modelingframe error rates in multiple-state channels,v 3GPP2, Tech. Rep. 3GPP2-C30-20030429-010, 2003.
[40]3GPP TR 25.892 V6.0.0, Feasibility Study for Orthogonal Frequency Division Multiplexing(OFDM) for UTRAN enhancement(Release 6) PP.65-73.
[41]Sreenivas B, Lal R J. Physical Abstraction Method (RBIR) for OFDM System[M]// Advances in Computing and Information Technology. 2013:431-438.
[42] IEEE 802.16m-08/004r5, IEEE 802.16 Broadband Wireless Access Working Group, IEEE 802. 16m Evaluation Methodology Document(EMD), 2009-01-15.
[43]IEEE 11-14/03531-0 Suggestion on PHY Abstraction fbr Evaluation Methodology , 2014-03-16.
[44]He X, Niu K, He Z, et al. Link Layer Abstraction in MIMO-OFDM System[C]// International Workshop on Cross Layer Design. IEEE, 2007:41-44.
[45]K. Brueninghaus, D. Astely, T. Salzer, S. Visuri, A. Alexiou, S. Karger,and G.-A. Seraji, “Link performance models fbr system level simulationsof broadband radio access systems/' in Proc. PIMRC, Sep. 2005, pp.2306 -2311.
[46]Hanzaz, Z, Schotten, H.D. Impact of L2S interface on system level evaluation fbr LTE system[C]// IEEE Malaysia International Conference on Communications. IEEE, 2013:456-461.
[47]Hanzaz, Z, Schotten, H.D. Analysis of effective SINR mapping models for MIMO OFDM in LTE system[C]// Wireless Communications and Mobile Computing Conference. 2013:1509-1515.
[48] Yang J, Zhao H, Wang W, et al. An effective SINR mapping models fbr 256QAM in LTE-Advanced system[J]. 2015:343-347.
[49]2004-10-26_WINNERt25_L2Sinterface__v02.5.doc
[50]王琛琛，薛浜华，唐苏文，等.EESM中最佳8值的确定[J].通信技术,2009, 42(12):215-216.
[51]Benice R, Frey AH. An Analysis of Retransmission Systems[J]. Communication Technology IEEE Transactions on, 1964, COM-12(4): 135-145.
[52]Classon B, Sartori P, Blankenship Y, et al. Efficient OFDM-HARQ system evaluation using a recursive EESM link error prediction [J], 2006, 4:1860-1865.
[53]Latif I, Kaltenberger F, Knopp R, et al. Link abstraction fbr variable bandwidth with incremental redundancy HARQ in LTE[C]// International Symposium on Modeling & Optimization in Mobile, Ad Hoc & Wireless Networks. 2013:23-28.
[54]蒋丰亦.FDD-LTE中HARQ的研究与在系统级仿真中的实现[D].东南大学，
85
2013.
86
