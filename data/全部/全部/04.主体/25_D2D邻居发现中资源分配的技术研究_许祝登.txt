第一章绪论
本章首先阐述论文的研究背景，D2D通信技术的发展和研究现状，最后给出 论文的内容和结构安排
1.1研究背景及意义
4G系统从几年前的新起到如今在中国乃至全球都得到了广泛的部署，它提 供了在任何时间、任何地点都能接入的通用宽带移动服务。然而各种快速增长的 新兴的服务如移动社交网络和物联网等应用，对现有移动通信网络提出了更高的 需求。接下来的十年，物联网的发展将使得联网的设备大规模增加，联网设备预 计将超过50亿。这将极大地刺激移动数据流量的增长，移动数据量预计将增加 1000倍⑴。更加多样和复杂的宽带服务需求推动着当前移动通信标准去更加紧密 地集成各种无线通信技术，从而向新一代的移动通信系统也就是5G系统演进。 各公司已经开始计划5G的技术路线图，预计5G系统将在2020年左右开始部署。 5G系统在各方面都将提出更高的要求，10-100倍的峰值速率，1000倍的网络容 量，10倍的能量效率和10-30倍时延缩减⑴。移动运营商也探索着新的方式去规 划、部署和管理他们的网络，从而提高系统的网络容量、减少基础设施投资和运 营的花费。如今社会的发展更加注重环保和节能，更加环保、节能的通信技术更 能受到运营商和社会的支持和推动。因此，尽可能地减少每比特传输的能量消耗 和花费成为了新兴的通信服务和通信技术发展的明显趋势。
为了提高带宽资源的利用率，研发出了很多新的通信技术。其中改变传统的 蜂窝网络结构，采用异构网络的部署成为了一种有效的思路。当前巳经发展出了 多种异构网络的部署形式如家庭基站、微微小区基站和中继基站等小功率基站来 提高网络覆盖率。D2D通信可以改变传统蜂窝网络单一的“设备-基站-设备”的 通信模式，引入了 “设备-设备”的通信模式，使用“设备-设备”的模式来承载 本地服务的数据流量，从而减轻基站和核心网的负担。
D2D通信是一项新兴的使用授权频段提供近距离设备到设备通信的技术， 近几年来得到了众多研究者和移动通信厂商的广泛关注，被认为是下一代移动通 信系统中的一项关键技术。D2D通信相比于基站传统的上行、下行的通信模式， 由于通信链路的减少，频谱的利用率得以提高，在一定程度上解决了无线通信系 统频谱资源匮乏的问题。与此同时，由于设备到设备之间近距离的特性，它还可 以有效降低终端的发射功率，减小电池消耗，延长手机续航时间和减少通信的时 延。此外，D2D通信的引入并不会带来额外的建设成本。
高通公司作为先驱者研发出了一套D2D通信系统FlashLinQ⑵，该系统实现 了让手机自动发现一公里半径以内的已经连接WIFI的手机，并进行相互的点对 点连接，从而实现带宽共享，减少基站的压力。
D2D通信发展的另外一个驱动是为公共安全(Public Safety, PS)服务冈提供 技术支持。当基站在遭受地震或其他灾害被损坏时，利用D2D通信来进行应急 通信。在2014年的IT展会中，KT和三星公司首次展示了在发生灾难时使用的 基于D2D技术的位置发现服务。救援队员使用这项技术时，可以通过信号的强 度定位500米以内的使用者的位置，从而对遇险人员实施更及时的救援。
D2D通信的标准化工作已经在进行之中，3GPP (Third Generation Partnership Project)无线接入网(RAN, Radio Access Network)小组在2012年的时候通过 了针对D2D通信技术的研究立项〔4】,这是D2D通信发展的一个重要里程碑o3GPP 的技术报告中把基于D2D通信的服务称为近距离服务(Proximity Service, PoSe)。 在LTE Rel-12中，3GPP对D2D通信在商业领域和公共安全领域的应用进行了 深入的可行性研究⑸。公共安全领域主要考虑的是自然灾害或安全事件导致网络 不可用或出现故障的情况下通过D2D通信来实现应急通信，一个公共安全领域 的使用案例是发生灾害的情况下帮助应急救援人员对遇险人员的搜寻。而在商用 领域中，主要是通过结合蜂窝通信和D2D通信来提供新的商业服务或利用D2D 通信减小蜂窝网络核心网的负载、提高频谱利用率。3GPP对D2D的研究进展目 前还处于提交技术报告(Technical Report, TR)的阶段，还未形成技术标准 (Technical Standard, TS)。目前已经提出了近距离业务的应用场景和架构设计， 其中包括D2D邻居发现和D2D通信的通用概念模型。
1.2本文的主要研究内容
本文主要研究的是D2D邻居发现阶段的资源分配。
D2D邻居发现通常是建立D2D通信链路过程中的重要一步，此外，应用也 可以单独使用D2D邻居发现提供一些服务，而没有后续的D2D通信。在很多场 景下，资源分配的方案与邻居发现流程的设计是紧密联系的。3GPP对D2D邻居 发现己经有了一些初步的设计参考⑹，其中主要研究的是基于直接信号的邻居发 现方案，即通过发送和检测发现信号来让设备感知周边的其他设备。基于直接信 号的发现流程中，主要把资源分配的方式分为了两类，分布式的和集中式的。如 果采用了分布式的资源分配方式，系统会半静态地分配一个资源池给所有需要进 行邻居发现的设备使用，系统是通过广播信令告知系统中的D2D设备用于邻居 发现的资源的配置情况，系统不会为每个D2D设备指定其使用的无线资源，而 是由每个设备自己从资源池中进行选择。分布式的资源分配方案相比集中式的资 源分配方案能够减少大量信令的开销因而更受青睐，然而通过分析和仿真我们发 现现有的分布式的资源分配方案对不同用户密度场景的扩展性很差，在用户密度 大的情况下将导致性能的恶化。基于这个问题,本文首先提出了一种通用的方案, 通过发送概率的自适应调整来减轻用户密度很大造成的性能恶化的问题，接着提 出了两种基于时延性能的自适应调整方案来保障系统的时延性能。
总的来说，本文是在D2D通信研究现状的基础上，对D2D邻居发现的流程 和资源分配方案展开研究，分析了现有方案在不同场景中适应性很差的缺陷，通 过发送概率的自适应调整和自适应的资源分配方案来提高邻居发现方案在不同 场景的扩展性。
1.3论文的组织结构
本文主要研究了 D2D邻居发现中资源分配的方案，重点研究了自适应的资 源分配方案。本论文的内容安排如下，
第一章为绪论。介绍了本文的研究背景和研究意义，简述了应用场景和研究 现状，提出了文本研究的定位和主要的创新点。
第二章为D2D通信技术基础。首先介绍了 D2D通信的基本概念；其次详细 介绍了 D2D通信中的关键技术；最后对D2D通信技术与类似的设备到设备的通 信技术进行了比较，指出了 D2D通信的优缺点和适用场景。
第三章为D2D邻居发现中资源分配的方案。介绍了目前己有的资源分配方 案，通过仿真和分析比较了各种资源分配方案的优缺点，针对主要研究的分布式 的资源分配方案进行了详细的分析，并指出其在不同用户密度场景下暴露出来的 性能缺陷。
第四章为D2D邻居发现中自适应的资源分配方案。本章针对目前邻居发现 中资源分配方案对不同用户密度场景扩展性差的问题，提出了基于随机的资源选 取方案的改进。首先提出了一种通用的方案，通过发送概率自适应调整方案来减 轻用户密度很大造成的性能恶化，接着提出了两种基于时延性能的自适应调整方 案来保障系统的时延性能。
第五章对全文进行总结，指出了论文的不足，探讨了未来进一步研究的方向。
第二章D2D通信技术基础
在本章中，我们将首先介绍D2D通信的基本概念，然后详细地说明其中的 一些关键技术如设备的同步、邻居发现的流程、模式选择、资源管理和干扰控制。 最后比较D2D通信技术与类似的设备到设备的通信技术的优缺点。
2.1 D2D通信概述
D2D通信广泛的含义是指设备与设备之间不经过基站或AP等基础设施转发 而通过直接的通信链路进行数据传输的通信技术。广义的含义中蓝牙、Wi-Fi Direct、ZigBee都属于D2D通信技术，而实际上D2D这个名词是Klaus Doppler 在2009年提出在LTE-Advance网络中引入underlay模式下的D2D通信可以提高 蜂窝网络的系统容量⑺后才开始流行的。现在学者主要研究的D2D通信一般指 的是使用LTE授权的频段进行设备到设备的通信。3GPP对D2D通信的标准化 工作，致力于在LTE通信系统中集成设备到设备的通信技术，所以D2D通信有 时候也被称为LTE D2D,在LTE系统中融合的D2D通信逐渐成为大家对D2D 通信的普遍认识。而本文中的提到的D2D通信如果没有特指也是这个含义。
2012年3GPP RAN全体会议通过了“基于近距离服务（ProSe）的LTE D2D通 信”的研究立项，3GPP现阶段对D2D通信主要涵盖两个领域，商用领域和公共 安全领域。
商用领域方面包含以下的一些应用场景：
（1）	移动广告：基于环境感知获取周边的服务或广告信息，如商店、酒店 的促销信息。
（2）	社交类应用：用于构建新型的社交应用如发现周边有相同爱好的人。
（3）	多媒体类：通过本地终端的缓存来实现邻近设备多媒体资源的P2P传 输，从而减少网络的负载。
公共安全领域方面主要是为了实现在蜂窝网络遭受如地震或其他的一些自 然灾害而不能正常工作时，快速地建立应急通信，例如警察或消防员可以利用 D2D通信设备进行PTT （Push to talk）方式的通信。
ProSe中定义了两种重要的服务：
（1）	D2D邻居发现：移动设备可以发现其邻近的周边设备。
（2）	D2D通信：近距离的移动设备之间可以进行直接的通信。
D2D邻居发现可以作为D2D通信先前的一个步骤，也可以单独支持一项服 务而没有后续的D2D通信。D2D设备也可以不经过D2D邻居发现的流程而直接 进行D2D通信，例如在广播通信中。D2D设备通过邻居发现过程可以获得信道
的状态信息来帮助后续的D2D通信的模式选择。
下图给出了 D2D通信的四种场景：
(1)场景A,无蜂窝覆盖的场景。通信的双方都在不在蜂窝覆盖范围内。
(2)场景B,部分蜂窝覆盖的场景。通信的双方其中一个在蜂窝覆盖范围外, 另外一个在蜂窝覆盖范围内。
(3)场景C,蜂窝小区内的D2D通信场景。通信的双方在同一个蜂窝小区。
(4)场景D,跨蜂窝小区的D2D通信场景。通信的双方在不同的蜂窝小区。 商用领域主要研究的是蜂窝控制下的D2D通信，也就是场景C和场景D。
而公共安全领域对于上述的四种场景都需要考虑。



图2-1. D2D通信的场景
在蜂窝覆盖的场景，D2D通信相比于基站传统的上行、下行的通信模式有 以下几个优势：
(1)在传统的蜂窝通信模式下，当UE与UE进行通信时，两个UE需要与 基站分别建立一条上行链路和一条下行链路，而D2D通信模式只需要在两个移 动台之间建立一条直接链路。这不仅节省了频率资源而且减轻了基站的负担，对 于数据量大的业务优势尤为明显，此外还可以减少通信的时延。
(2)D2D的通信距离较短，一般D2D通信的链路质量要比蜂窝通信链路的 质量要好，可以有效降低终端的发射功率，减小电池消耗，延长终端的续航时间。
(3) underlay模式下的D2D通信通过资源复用的方式可以提高系统的频谱 利用率。
虽然D2D通信的引入可以提高蜂窝系统的频谱利用率和系统的容量，但是 也给现有的蜂窝网络带来了很多的挑战，例如如何进行合理的模式选择来增加系 统的容量、如何解决频谱的共享带来的干扰问题。因此D2D通信优势的发挥依 赖于其中各种关键技术的支撑，后续的小节将介绍D2D通信中的关键技术和研 究现状。
2.2同步
同步的系统可以使用更高效的调制技术如SC-FDMA和OFDMA来实现更高 的频谱效率。此外，同步系统相比于异步系统，可以设计更高效的设备发现机制 从而减少能量的消耗和发现的时延。由于诸多的好处，D2D通信系统也被设计 成一个同步的系统来实现高效的通信。
2.2.1LTE系统中同步的设计
LTE系统中上行链路采用的是SC-FDMA的调制方式而下行链路采用的 OFDMA的调制方式，SC-FDMA和OFDMA要求发送端和接收端在时间和频率 上都实现同步。LTE中的同步是通过每个小区的eNB每5ms广播一次主同步信 号(Primary Synchronization Signal, PSS)和辅同步信号(Second Synchronization Signal, SSS)实现的，其中PSS由长度为63的Zadoff-Chu (ZC)序列组成，而 SSS是基于M序列的最大长度序列。UE能够快速地检测到PSS,并在此基础上 检测SSS ,从而获得时间和频率的同步凶。
频率偏差会破坏子载波间的正交性，引入子载波间的干扰，影响信号的正确 接收，所以需要频率同步检测来校正频率偏差。可以通过导频序列、辅同步序列 等信号进行频偏估计从而对频率偏移进行纠正。
2.2.2FlashLinQ系统中同步的设计
FlashLinQ是高通公司研发的一个初步的D2D通信系统，其中同步是通过主 同步和二次同步相结合的方式实现的。在蜂窝覆盖范围内，FlashLinQ采用基站 的同步信号作为主同步信号；在无蜂窝覆盖的环境釆用类似GPS的全局时钟信 号作为主同步信号。基站或GPS的主同步信号源需要周期性地广播主同步信号。 在有些环境下，主同步源有可能失效，比如基站因为自然灾害或者意外故障而无 法正常工作。此外，因为不同的UE到基站的距离不同，接收到的主同步信号存 在不同的时延。通过二次同步可以很好地解决上述问题。每个UE会周期性地向 外广播自己的同步信号，此外每个UE既会去检测主同步信号也会去检测其他 UE发送的二次同步信号。如图2-2所示，UE1会接收到来自基站的主同步信号 和来自UE2的二次同步信号，UE1也会广播自己的同步信号。当UE检测到多 个二次同步信号时，会对检测到的二次同步信号划分优先级，然后按照优先级选 择出第一同步源和第二同步源，继而确定第一组时间中断和第二组时间中断，并 按照时间中断依次发送或接收D2D信号。


图2-2. FlashLinQ系统同步示意图
2.2.3 LTE D2D系统中同步的设计
系统同步的设计使得D2D通信可以使用LTE系统中上、下行信道使用的多 载波调制方式。D2D设备之间的同步可以采取IEEE 802.11或LTE中使用的同步 方法来实现。D2D的同步信号可以使用ZC序列来构造，接收解调ZC序列的复 杂度比较低，此外复用ZC序列不需要在UE的射频模块做修改。
考虑到D2D通信不同的场景，同步信号源可以是基站、一个D2D簇的簇头 或D2D通信对的其中一个设备。针对不同的蜂窝覆盖场景，用户将选择不同的 同步源。在蜂窝覆盖的场景下，基站可以作为更高优先级的同步信号源，因为它 具有更高的可靠性。在无蜂窝覆盖的场景，D2D设备可以通过中继的方式获取 同步或者自己广播同步信号。
当前3GPP对同步的设计给出了以下几条建议⑹：
(1)D2D同步信号源应该至少发送一个D2D同步信号(D2DSS)。
(2)当同步信号源是基站时，同步信号釆用Rel-8 PSS/SSS的设计。
(3)当同步信号源是非基站的其他设备时，同步信号至少应该包含一个主
D2D 同步信号(Primary D2D Synchronization Signal, PD2DSS) , PD2DSS 使用 ZC序列，同步信号还可以包含一个辅D2D同步信号(Secondary D2D Synchronization, SD2DSS) , SD2DSS 使用 M 序列。
(3)UE在发送D2DSS之前会去检测D2D同步信号源，如果检测到了同步 信号源则会将自己的接收机与同步信号源同步，否则将发送自己的D2DSS。
(4)基站相比其他的同步信号源有更高的优先级。
(5)UE作为同步信号源时，蜂窝小区中的同步信号源比蜂窝小区外的优先 级高。
虽然可以参考现有的一些同步系统的同步实现机制，D2D系统的同步依然有 一些关键的问题亟需解决。例如，如何解决D2D设备广播同步信号对电池消耗 过快的问题、如何在异步蜂窝网络间的D2D设备实现同步的机制以及不同运营 商网络间的D2D设备实现同步的机制。
2.3 D2D邻居发现
D2D邻居发现是D2D设备感知并识别其周边邻近的其他D2D设备的过程。 一般地D2D邻居发现是建立D2D通信链路过程中的重要一步，如果一对设备在 发现彼此之后希望进一步地进行通信，后续将进行会话的建立和资源的分配。应 用也可以单独使用D2D邻居发现提供一些服务，而不需要有后续的D2D通信。 D2D邻居发现的应用场景很多，如构建移动社交网络，当用户的好友出现在用 户周边的时候，用户的移动设备会相互进行告知；在移动营销场景，当用户靠近 一个商店时，用户可以接收到商店发送的优惠券和折扣信息；在公共安全领域， 在灾害的情况下帮助应急救援人员对遇险人员的搜寻等。因此D2D邻居发现是 研究D2D通信的一个重要问题。
Wi-Fi Direct和蓝牙系统都是异步的系统，都是釆用发送和扫描检测信标信 号的方式实现设备发现的，发现阶段的能耗比较高。蜂窝覆盖下的D2D邻居发 现中，基站可以承担发现过程中的同步、资源的分配、提供标识、安全性管理、 功率控制等工作，这将减少发现过程的能耗和时间并且提高服务的安全性。蜂窝 外的D2D邻居发现可以参考Wi-Fi Direct中设备发现的实现。
对于D2D邻居发现流程的设计主要分为两种，基于EPC的发现流程和基于 直接信号的发现流程。系统在进行邻居发现服务时可以单独地利用上述方案中的 一种，也可以将两种方案进行结合。
2.3.1 基于EPC的发现流程
基于EPC的发现流程是一种集中式、基于地理位置信息的方案。这种方案中 需要在每个蜂窝小区中添加新的功能实体——ProSe实体，ProSe实体负责收集 蜂窝小区内D2D设备的地理位置信息，通过比较两个D2D设备的位置信息来判 断它们是不是邻居设备，判决的结果会依赖于具体阈值的选取。当D2D设备请 求邻居发现服务时，eNB会告知它有哪些邻近的设备。
为了实现不同蜂窝小区间D2D设备的邻居发现，蜂窝小区的ProSe实体需要 通知邻居蜂窝小区的ProSe实体本蜂窝小区内用户的位置信息。
这种方案由于需要蜂窝网络的辅助，只能在蜂窝覆盖的场景下使用。需要特 别注意的是距离上相近的两个UE的无线信道可能是不适合于直连通信的。例如 在地理位置上相近的两个UE被建筑物隔开了，这种情况两个UE间的信道条件 是很差的，可能无法进行直接通信。所以这种方案对于一些依赖于建立后续的 D2D通信的邻居发现服务来说，在准确性上是有问题。
2.3.2 基于直接信号的发现流程
基于直接信号的发现流程在蜂窝网络覆盖下和无蜂窝网络覆盖的环境都可 以使用，比基于EPC的发现流程有更好的扩展性。
基于直接信号的发现流程中，期望被发现的D2D设备会使用一定的时频资 源来发送发现信号，使得一定范围内的其他设备能够接收到这个发现信号，发现 信号会携带设备的标识和应用层的标识。期望发现邻居设备的D2D设备会去检 测和识别发现信号，如果成功地检测到其他D2D设备的发现信号，则完成了邻 居发现的流程。邻居的发现暗含着两个UE之间的通信信道是比较好的，相比基 于地理位置信息的EPC方案有更高的准确性。
图2-3给出了蜂窝覆盖场景下D2D邻居发现的系统架构，基站会为邻居发现 过程提供一些支持如提供同步信号、资源分配、管理服务的授权。依赖于资源分 配方案的设计，基站会半静态地或动态地为D2D用户分配用于发送发现信号的 资源。

授权的LTE频段：
在LTE FDD系统使用上行的资源
在LTE TDD系统使用专用的帧
邻居发现

图2-3.蜂窝覆盖下D2D邻居发现的系统架构
由于不同运营商使用不同的授权频段进行通信，需要设计不同运营商的D2D 设备之间相互发现的机制。下面给出了两种方案来实现不同运营商的D2D设备 之间的邻居发现：
(1)方案一：如图2-4所示，D2D设备使用所从属的运营商的D2D邻居发 现空中接口来广播发现信号，同时设备将检测该空中接口中接收到的发现信号。 为了发现其他运营商的D2D设备，D2D设备需要去检测其他运营商的邻居发现 空中接口接收到的发现信号。
运营商A的上行资源或TDD

图2-4.不同运营商设备间的邻居发现的系统设计

(2)方案二：在一个国家或区域，不同运营商的所有设备使用一个共同的频 段来广播发现信号。
在无蜂窝覆盖的场景中。如果多个D2D设备进行了成簇，簇头可以充当基 站的角色来负责发送同步信号和分配资源。如果没有成簇，D2D设备将使用专 用的资源来发送发现信号。
2.3.3 现有方案的不足和挑战
基于EPC的邻居发现方案无法应用于无蜂窝覆盖的场景，而且它的性能依 赖于定位的精度和具体的服务。对于某些服务这种方案的缺点很明显，比如当 UE希望寻找一个D2D设备中继来连入蜂窝网络时，通过EPC的方案只能够让 这个UE 了解到它附近有哪些D2D设备，而无法基于信道的质量来选择一个理 想的中继。
基于直接信号的邻居发现方案需要D2D设备周期性地发送发现信号，如何 减少能耗是设计中的一大挑战性。此外，在蜂窝覆盖的场景下，如何高效地复用 蜂窝的频谱资源是一个关键的问题。
2.4模式选择
D2D通信中一个主要的问题是设备选择使用传统的蜂窝通信模式还是D2D 的通信模式。高效的模式选择能够减小系统干扰、提高系统容量。
在传统的蜂窝网络中，设备与设备间的通信都需要基站进行转发。发送端通 过上行链路发送数据给基站，然后基站通过下行链路转发数据给接收端设备。 D2D通信引入蜂窝网络让移动设备多了一种通信的方式。D2D设备可以选择多 种模式。按照通信的方式以及频谱资源的利用方式把D2D设备的通信模式划分 为以下三种：
(1)蜂窝模式。D2D设备还是通过基站转发的方式进行通信，而不是通过 直通链路。D2D用户和蜂窝用户使用的频谱资源是正交的，不会相互干扰。
(2)专用信道模式。D2D设备之间使用直通链路进行通信，给D2D设备分 配的频谱资源是与蜂窝用户正交的，可以使用专有的频段或正交地复用蜂窝的上 行资源或下行的资源，这种模式下蜂窝用户和D2D用户不会相互干扰。
(3)复用信道模式。D2D设备之间使用直通链路进行通信，与某些蜂窝用 户使用相同的频谱资源，通过选择合理的复用资源可以提高系统的频谱效率，提 高系统的容量。但是这种模式有可能会给系统带来干扰，需要进行合理的资源分 配和干扰管理来保证蜂窝用户的通信质量并有效地利用D2D通信来提升系统容 量。
集中式的控制方式是当前模式选择主要采用的方式，这种方式需要用户向基 站反馈用户的蜂窝链路信道状态和D2D用户间直通链路的信道状态，基站依据 反馈的信道状态信息为D2D用户进行工作模式的选择。系统的容量是模式选择 的一个重要优化目标，文献［7］考虑了单小区内一个D2D用户对可以与一个蜂窝 用户进行资源复用条件下，通过干扰和蜂窝网络的操作状态来解决模式选择问题。 文献［11］研究了单小区和多小区场景下，在保证所有用户最小的信噪比的条件下
12
最大化系统容量的模式选择。
2.5资源管理和干扰控制
频谱共享的方式可以分为两类，overlay模式和underlay模式。
Overlay的模式下，D2D用户将使用蜂窝网络空闲的频谱来进行通信。这种 模式是一种正交的信道分配，通过把授权的频谱分为两部分，可以完全消除干扰。 频谱中的一部分由蜂窝用户使用而另外一部分由D2D用户使用。虽然干扰的角 度来看这种模式是最优的，但是这种模式的频谱效率不高。
Underlay模式下，D2D用户将与蜂窝用户使用相同的频谱资源，可以提高频 谱的利用率。虽然从技术角度来看，这种模式要比overlay模式复杂很多，但对 于运营商来说，将蜂窝用户和D2D用户进行共道的资源分配是更加高效和有利 的。文献［12］研究表明相较所有的D2D流量都通过蜂窝传输的方式，underlay模 式下的D2D通信可以带来65%左右系统容量的提升。文献［13］［14］提岀了寻找使 用相同资源的蜂窝用户和D2D用户的合适配对来进一步提高蜂窝小区内的频谱 利用率。
Overlay模式的频谱共享很容易实现，但是对频谱的利用是不高效的。尽管 underlay模式可能会引入各种干扰如D2D链路对蜂窝链路的干扰、蜂窝链路对 D2D链路的干扰以及不同D2D链路之间的干扰，但是通过高效的无线资源管理 和干扰控制能够提高系统的频谱利用率并保证原有蜂窝通信的服务质量。无线资 源的管理可以工作在协作的模式和非协作的模式下。在非协作的模式下，每个 D2D用户管理自己使用的频谱资源并且以最大化系统容量和服务质量为目标； 而在协作的模式下，D2D用户需要收集频谱资源使用的部分信息，在进行频谱 分配时考虑对共道的邻居D2D用户的影响，蜂窝网络和D2D用户的平均吞吐量、 QoS和系统性能都可以进行局部的优化。文献［15］［16］中研究了限制共道干扰的 一些策略。［17］中研究了干扰管理的策略来控制蜂窝对D2D通信的干扰和D2D 通信对蜂窝的干扰。［18］中提出了一个启发式的、贪婪的资源分配算法，算法利 用信道状态信息(CSI)来减少D2D通信对蜂窝网络的干扰，这种方案比较好实 施并且不会引入额外的信令开销。文献［19］提出了一种资源分配的方案来避免远 近效应带来的干扰，确定带来干扰的蜂窝用户并高效地使用上行的频率资源。
优化功率控制也是干扰管理的一种策略。对于协调共道干扰，功率控制是一 个关键有效的途径。功率控制的方式可以分为以下两种类型：
(1)自组织的功率控制。D2D设备以自组织的方式来调整它们的发送功率， 其中一种简单的控制策略是D2D设备有预设的信噪比门限，设备在不影响蜂窝 用户的前提下调整发送功率来满足预设的信噪比。
13
(2)网络控制的功率控制。蜂窝用户和D2D用户同时根据信噪比的报告对它 们的发送功率进行动态的调整。通常情况下，D2D用户会率先调整它们的发送 功率，蜂窝用户在其后进行调整，然后又是D2D用户进行调整，反复地进行这 样的迭代过程。当所有用户的信噪比都达到了预定的要求时，迭代的过程将终止。
自组织的功率控制方案不会改变蜂窝用户的行为，实施起来比较简单，但是 相比于网络控制的功率控制的效率要低。网络控制的功率控制需要蜂窝用户、 D2D用户、eNB之间传输更多的反馈信息，信令的开销比较大。
研究表明联合资源管理和功率控制可以进一步提高系统的容量。文献［20］对 蜂窝连接和D2D连接使用不同的资源共享模式下最优的资源分配和功率控制进 行了分析，对单蜂窝小区的场景和Manhattan网络环境underlay模式下的系统性 能进行了评估。
蜂窝通信分为上行链路和下行链路。对于D2D通信，复用上行的链路资源 和复用下行的链路资源是两种不同的复用方式。3GPP选择了复用上行链路的方 式，FDD系统中的D2D通信复用蜂窝上行的频谱资源，而TDD系统中的D2D 通信复用蜂窝上行的子帧。主要是基丁以下几点考虑：
(1)复用蜂窝的下行链路对蜂窝用户的干扰相比于复用蜂窝上行链路对基 站的干扰更大且更不可控。
(2)当前LTE系统在上行链路使用的是SC-FDMA调制方式，而在下行链 路使用的是OFDMA,因此UE配置有SC-FDMA的发射机和OFDMA的接收机。 如果D2D通信复用蜂窝上行的链路，D2D设备需要装备新的SC-FDMA的接收 机，如果复用的是LTE下行的链路,D2D设备需要装配新的OFDMA的发射机。 SC-FDMA的发射机可以维持比较低的峰均比(PARA)。
(3)一些国家频谱的分配禁止了 UE使用预留给蜂窝下行链路的频带⑵］。
(4)当前蜂窝系统上行的负载要比下行的轻。
2.6与蓝牙、WiFi-Direct等类似技术的比较
多样的近距离通信业务的发展推动着人们对近距离通信技术的不断探索，当 前市场主要使用的设备到设备通信的解决方案有蓝牙(Bluetooth)、Wi-Fi Direct. ZigBee和近场通信技术(Near Field Communication, NFC),这些解决方案适用 于不同的场景。下面对各项技术进行了具体的分析比较，具体的性能指标和参数 见表2-1。
(1) Wi-Fi Direct提供的邻近设备的发现支持的用户数比较小(小于10个用 户)，用户数量的增加对电池使用寿命的影响是指数型增长的，这主要是由于其 设备发现阶段是一个两步的发现过程并且工作在未授权的频段，需要处理使用相
14
同频段的其他设备带来的干扰。
(2)蓝牙的通信范围通常是在十几米之内，也有与Wi-Fi Direct相似的问题， 当有很多设备在通信范围内时，接收拒绝率是很高的。
(3)NFC是由RFID演变而来，使用无线电磁场代替了传统的无线电传输 技术，通信距离要求小于20cm,通信数据在100kbps到500kbps之间，具有更 高的安全性，现在主要应用在一些刷卡类的服务如移动支付如门禁和移动支付。
(4)ZigBee有低功率、低复杂度、自组织、低数据速率的特点，主要适合 用于自动控制和远程控制领域。
(5)D2D使用授权频段，可以减少通信的干扰。通信的最远距离大概是500 米左右，通信距离要比Wi-Fi Direct和蓝牙要远得多。
NFC只适用于通信距离特别近的服务，蓝牙、Wi-Fi Direct、ZigBee都工作 在ISM(IndustriaI Scientific Medical)频段，此频段主要是开放给工业、科学、医 学这三个主要机构使用，属于未授权的频段，无需授权许可，只需要遵守一定的 发射功率(一般低于1W),并且不要对其它频段造成干扰即可。由于工作在未授 权的频段，有可能受到其他系统的干扰，不能保证在所有地方都可以工作。D2D 使用授权的频段，相比异步的蓝牙和Wi-Fi Direct发现机制，同步的D2D系统的 邻居发现消耗的能量要少得多。设备可以一直开启发现的服务。高层应用可以利 用这个特性来减少类似WLAN和蓝牙使用中要进行手工的配对或接入点设置的 繁琐操作。
表2-1各种设备到设备的通信技术的对比
名称	LTE D2D	Wi-Fi Direct	NFC	蓝牙	　　ZigBee
距离(标称的)	500m	200m	0. 2m	10m	室内100m, 室外1.6km
耗电量	低	中	低	低	低
最大速率	IGbps	250Mbps	106/212/424
Kbps	24Mbps
(v3. 0+HS)	250Kbps
工作频率	LTE-A 的 频段	2. 4, 5GHz	13. 56MHz	2. 4GHz	　　2. 4GHz

2.7本章小节
本章的内容系统地介绍了 D2D通信的基础知识包括D2D通信的场景、同步、
邻居发现、模式选择、资源管理与干扰控制的概念。对比了 D2D通信与类似的
15
设备到设备的通信技术，说明了 D2D通信的优势：能够更好的与蜂窝网络融合 用于卸载蜂窝网络的负荷，能够更方便地实现同步来减少邻居发现过程的能耗。 此外，介绍了 D2D邻居发现流程设计和资源分配方案需要考虑的场景。本章为 后文的研究作铺垫，内容主要围绕后文的研究重点展开解释，有关这些技术更为 细致的讨论可参见参考文献。
16
第三章D2D邻居发现中的资源分配方案
在上一章介绍了 D2D通信的概念和关键技术，其中介绍了邻居发现的两类 方案设计，基于地理位置信息的发现流程和基于直接信号的发现流程。当前D2D 邻居发现的研究主要集中在基于直接信号的发现流程，本章将介绍该流程中的资 源分配方案。资源分配方案可以分为两类，集中式的和分布式的。我们将深入研 究两种主要的分布式的资源分配方案，随机的资源选取方案和基于能量检测的资 源选取方案，详细分析了它们的优缺点并对它们的性能进行了仿真对比。对于随 机选取的资源分配方案，本文提出了一个简化的分析模型，通过这个模型分析了 平均发现概率、平均发现时延与用户数、资源池大小、发现周期等参数的关系。 通过仿真说明了这个分析模型和实际场景的结果是很相近的。
本章将重点针对现有的资源分配方案的实现机制和性能进行对比分析，总结 现有的资源分配中亟待解决的关键问题。
3.1 LTE系统中的资源结构
资源分配的目标是支持多个用户的通信需求和更好地提升用户的通信服务 质量。在LTE系统中，物理层使用的是OFDM的多载波调制技术。OFDM技术 将宽带信道划分为若干个并行的窄带子载波信道，能够很好地对抗频率选择性衰 落。LTE系统中用户资源的复用主要是通过正交地分配由频率和时间维度构成的 资源块(Resource Block, RB)来实现的。
蜂窝通信中，用户与基站的通信包括上行链路和下行链路。LTE系统中规定 了两种上、下行链路的资源复用方式，频分双工(FDD)和时分双工(TDD) o LTE系统因此也分为了两大类，LTE FDD系统和LTE TDD系统。LTE FDD系统 中上行链路和下行链路的传输使用不同的频段，并且上、下行链路使用的带宽是 大小相同而且对称的，上下行频带之间设有保护频带。LTE TDD系统中上行链 路和下行链路的传输使用的是相同频带的不同时间段。对应这两种双工系统，有 两种无线帧结构，类型一帧结构和类型二帧结构，每个帧的时长均为10ms。类 型一帧结构适用于FDD和TDD的系统，类型二帧结构仅适用于TDD系统。
类型一帧结构如图3-1所示，一个10ms的无线帧由10个1ms的子帧 (Sub-frame)组成，而每个子帧是由两个0.5ms的时隙(Slot)组成。当釆用常 规循环前缀(Cycle Prefix, CP)时，每个时隙包含7个OFDM符号，当采用扩 展的CP时，每个时隙包含6个OFDM符号。
17

1个无线帧，时长10ms



图3-1类型一帧格式
类型二帧结构如图3-2所示。与类型一帧结构不同之处在于类型二帧结构中 包含特殊子帧，例如1号子帧和6号子帧都是特殊子帧，它们包含三个特殊时隙， 分别为下行同步时隙(Downlink Pilot Time Slot, DwPTS)、保护周期(Guard Period, GP)和上行同步时隙(Uplink Pilot Time Slot, UpPTS)。其中，0号子帧、5号 子帧和下行同步时隙都是用于下行传输，2号子顿、7号子倾和上行同步时隙都 是用于上行传输。



频域上12个间隔为15KHZ的连续子载波构成一个频带资源单元，一个时隙 的频带资源单元构成一个资源块(RB),如图3-3所示。在LTE系统中RB是 资源分配的最小单元，也就是说上、下行链路中的传输占用的是一个或多个RBo
18


1个资源块（RB）'
图3-3资源块的示意图
3.2集中式的资源分配
如图3-4所示的釆用集中式的资源分配的邻居发现流程可以分为以下几步： （DeNB以半静态的方式分配一些RBs用于邻居发现并将分配的RBs的信息 通过系统信息广播（System Information Broadcast, SIB）告知蜂窝中的所有用户。
（2）	期望被发现的D2D设备向eNB请求资源。
（3）	eNB动态地为请求资源的D2D设备指定发送发现信号使用的RBs。
（4）	D2D设备使用分配到的RBs来发送发现信号，发现信号中会包含UE的 身份标识，D2D设备通过检测预分配的资源中接收到的发现信号来发现其他设 备。

邻居发现的服务通常是假定为常开的状态，所以需要周期性地进行邻居发现 的流程。由于设备的移动性，集中式的资源分配需要基站对资源进行实时地管理, 会引入大量的信令开销。此外，这种方式无法支持无蜂窝覆盖或部分蜂窝覆盖的 场景的邻居发现。
3.3分布式的资源分配方案
分布式的资源分配方案需要按应用场景加以区分。
在无蜂窝覆盖的场景中，会有一个专用的公共资源池预留给D2D设备来进 行邻居发现，D2D设备自己从资源池中选择资源用于发送发现信号。
在蜂窝覆盖的场景中，基站会以半静态的方式为所有的用户分配一个公用的 资源池用于邻居发现，半静态的方式可以节省信令的开销，基站会通过系统信息 广播向D2D用户告知分配用于邻居发现的资源的配置，网络并不会去指定每个 进行邻居发现的设备使用哪个资源块进行发现信号的发送，而是由每个设备自己 从资源池中进行选择。
当前D2D通信的研究主要都集中于LTE网络中D2D通信，下文中的分布 式的资源分配方案也是针对LTE蜂窝网络中的。
LTE网络会分配周期性的资源用于D2D邻居发现，把分配用于邻居发现过 程的子帧称为发现子帧，发现子帧的分配可以是连续的也可以是不连续的。连续 的分配可以减少唤醒设备的时间从而延长设备电池的寿命。下图是发现子帧连续 分配的资源结构图，
发现周期%
<	>
多个发现子帧 多个LTE WAN子帧
<	>
发现区间N个子帧
图3-5.连续分配的发现子帧
然而在某些情况下可能需要发现子帧的非连续分配，例如在承载低时延要求 服务（如语音服务）的数据传输时，需要在连续的发现子帧中间隔插入一些LTE WAN （无线接入网）的子帧。考虑到发现子帧的非连续分配会导致高的能耗， 间隔插入连续发现子帧的WAN子帧应该比较少。在发现过程中，移动设备选择 一个邻居发现资源块（Discovery Resource Block, DRB）5fe发送发现信号，发现信 号中携带移动设备的标识和一些其他必要的信息；同时，移动设备会监听其他设 备在DRBs中发送的发现信号。在邻居发现阶段，移动设备是工作在半双工的模 式，半双工的模式是指正在发送发现信号的移动设备无法同时去检测其他设备发 送的发现信号。图3-6给出了发现子帧连续分配方式下的子帧结构图，对于TDD 的双工系统，系统会周期性地分配一些子帧用于邻居发现，对于FDD的双工系
20
统，系统会周期性地分配上行频段的一些子帧用于邻居发现。下面考虑10MHz 的FDD系统，每个时隙有25个RBs,其中的4个RBs用于物理上行控制信道
(Physical Upper Control Channel, PUCCH)发送 UTE 的控制信令，其余的 21 个 RBs用于物理层上行共享信道(Physical Upper Shared Channel, PUSCH)发送发 现信号。
发现区间



使用序号为m以外的其他的DRB发送发现信号
图3-7.用于邻居发现性能分析的空间模型
考虑单个蜂窝小区的情况，小区中有M个用户开启了邻居发现的服务，所 有参与邻居发现的用户用集合U = {1,2,表示。
图3-7给出了 D2D邻居发现的空间模型。当两个D2D用户使用了相同的 DRB时，它们的发现信号会相互的干扰。如图3.7所示，UE2和UE3在一个发 现周期选择了相同的资源用于发送发现信号，UE1在检测UE2的发现信号的时 候会受到UE3的发现信号的干扰。如果UE2到UE1的距离要比UE3到UE1的 距离远，这个干扰会比较严重，从而导致UE1在这个发现周期无法发现UE2。
用户，•接收到用户丿•的发现信号的SINR为
&=	巴团4
y £ 2,R(*)=A(j) 4 禺 I "kJ + S
其中g是用户z•的发现信号的发送功率，为了简化，这里假定所有用户的发 现信号的功率都为々呃“，％表示用户Z•和顶之间的欧式距离，与表示用户Z•到用 户项的信道衰落，为噪声功率，正⑺表示用户z•所选择DRB。
当接收的信干噪比大于门限值季时(专是保证发现信号能被成功检测时对接 收信噪比要求的门限值)，认为用户Z•可以成功发现用户
集合S (/)=(/1 rtj > &,jeU,j丰i}表示一"发现周期内成功发现用户i的其他 用户，叫表示集合S«)的大小。
单个周期的发现概率定义为一个用户经过一个发现周期被小区中的其他用 户发现的概率，表示如下
22
PdN) = m」M,	(3-2)
因此，单个周期的平均发现概率为
Pd，，=&£P"(i)，	(3-3)
单个周期的发现概率可以作为D2D邻居发现阶段的资源分配方案的性能指 标，发现概率越大时，D2D设备会被蜂窝小区中的更大比例的其他D2D设备发 现，反之。
3.3.2 随机的资源选取方案
随机的资源选取是一种相对简单的资源选取方案，UE在每个发现周期会从 资源池中随机地选择一个或多个DRBs作为发送发现信号使用的时频资源。这种 资源选取的方案有需要以下两个问题，
(1)半双工的问题。全双工的通信模式因为会带来很强的自干扰而去干扰 的花费很高，因而不被采用。因此邻居发现采用的是半双工的通信模式。工作在 半双工模式的D2D设备不能在发送发现信号的同时接收其他设备发送的发现信 号。因此，如果两个邻近的设备在一个发现周期选择了同一个子帧中的资源块用 于发送发现信号，这两个设备在这个发现周期都无法发现对方。因此，随机的资 源选取方案不能保证邻近的设备在一个周期内能发现彼此，但经过多个发现周期 后半双工的影响会减小，如果信道条件比较好，邻近的设备经过一定的发现周期 还是能够发现对方。
(2)资源选取冲突的问题。因为设备之间没有相互的协调，多个设备可能 会选取相同的资源块来发送发现信号，把这种情况定义为资源选取的冲突。如果 两个邻近的设备发生了资源选取的冲突，对于它们共有的邻居设备来说，它们发 送的发现信号在这些共有的邻居设备处将相互干扰，从而造成它们共有的邻居设 备对这两个设备的发现变得更加的困难，如果干扰特别严重，有可能根本就无法 发现。
下面将给出了采用随机的资源选取方案时，对发现概率进行数值分析的近似 模型，模型对发现条件进行了简化
(1)如果多个设备选择了相同的资源块用于发送发现信号，则这些设备都不 能够被其他的设备发现，可以理解为如果资源选取有冲突，则有冲突的资源块中 的发现信号的相互干扰将使得它们都不能被其他设备发现。
(2)如果设备A选择的资源块是其他设备都没有选择的，而设备B选择的资 源块跟设备A选择的资源块不在一个子帧，则设备B可以发现A。这里假定了 发现信号能够覆盖整个小区。
由以上两个简化的条件，可以得出平均的发现概率
23

(3-4)
其中N是发现子帧的个数，k是一个子帧内发现资源块的个数。通过仿真可以 看出这个模型与实际场景下的结果是很相近的。
图3-8给出了分析模型和实际仿真情况下，发现概率随分配的子帧数的变化。 其中的仿真参数见表3-1。为了表示清楚，图3-8给出了用户数分别为150、250、 350时实际仿真得到的发现概率和分析得出的发现概率，可以看出实际的发现概 率和分析岀来的发现概率是很接近的。通过大量的仿真发现不管用户数为多少, 实际的发现概率和分析的发现概率的取值都是很接近的。所以可以把这个发现概 率的模型作为后续分析的基础。
表3-1.仿真参数配置
蜂窝半径	250 m
载波频率	2.0 GHz
信道模型	路径损耗+阴影衰落
路损模型(PL)	PZ = 128.1 + 37.6 log】。d(km)
阴影衰落	标准差为7dB的对数正态分布
D2D UE的发射功率	23dBm
每个RB的噪声功率	-121.4473dBm




2
4	5
分配的子懒数
6	7
图3-8.单个发现周期的平均发现概率随分配的子帧数的变化
,5
4 3 2 O.O.0.
.6
O.
0
24



















3.3.3 基于能量检测的资源选取方案
每个设备在开始进行邻居发现时会选择这个设备检测到的能量较小的一个 资源块作为发送发现信号的时频资源〔22】，这本质上是一种贪婪的思想。D2D设 备基于这种策略选取有两种可能的结果：一种是这个资源块没有被它周边的设备 使用；另一种是这个资源块有被它周边的设备使用，但是这个资源块中信号相互 的干扰程度很大概率要比其他的资源块中的信号相互的干扰程度小。此外，D2D 邻居发现的信号传输中有时候会受到带内辐射的影响，带内辐射可能会导致远近 效应。例如，UE1与UE3选取了相同子帧的资源块用于发送发现信号，UE1离 UE2的距离要比UE3离UE2的距离近得多，那么在UE2处接收到UE3的发现 信号将严重地受到UE1的发现信号的带内辐射的干扰。
研究人员提出了资源跳跃的方案来减少半双工和带内辐射带来的影响。资源 跳跃是指在D2D设备进入邻居发现流程并已经选取了一个DRB后，在实际的第 一个发现周期D2D设备将使用这个DRB发送发现信号，其他的发现周期UE将 跳跃到与上一个发现周期不同的DRB上发送发现信号，而这个跳跃的模式由映 射函数决定，映射函数根据上一个发现周期使用的DRB在邻居发现资源池中的 时频位置求出接下来的一个发现周期使用的DRB的时频位置。映射函数最好能 够满足一个DRB不会总停留在子帧的中间频段区域的要求，因为这个区域受载 波泄露的影响很大。
在上一节中提到的资源选择冲突的问题在这个方案中也会遇到，资源选取冲 突的设备并不知道冲突的存在，这将导致资源选取冲突的设备间永远无法相互发 现。为了解决这个问题，需要UE进行适时地沉默并进行能量的检测，如果发现 有资源选取冲突的可能则进行资源的重选。
具体的方案描述如下：
（1）	D2D设备的邻居发现流程启动后，UE先监听一个发现周期，检测发 现资源池中的每个DRB接收到的信号的能量。
（2）	对发现资源池中所有的DRBs按照检测到的能量进行排序，在能量值 排在后y%的DRBs中随机地选择一个资源块，在接下来的一个发现周期，设备 将使用这个DRB来发送发现信号。
（3）	D2D设备根据预设定的资源跳跃的函数来决定接下来的每一个发现周
期中使用的DRB,资源跳跃函数的设计有多种，下面是［22］中提出的一种资源跳 跃的函数，N是每个发现周期中发现子帧的个数，上是每个发现子帧中DRB的 个数。，表示发现周期的序号。因此第，个发现周期选择的DRB可以用 （秫（，）/（。）的二元组来表示，其中表示选择的DRB所在子帧的编号 （0 <n（t）<N）, 表示选择的DRB在子帧中的编号（0	“）。公式（3-5）
25
中的®和$分别表示的是在由p生成的Galois域上的乘和加，其中pa=N ,例 如GF（p。） o整数，将通过t mod （p"）和GE（p"）之间的一一映射关系映射到 GF（pa）的一个元素。这种样式的映射函数可以保证两个UE选择的DRB岀现在 同一个子帧的频率最小，这将减小半双工和远近效应带来影响。实践表明即使N 不是一个质数或质数的蓦次方，下面的映射函数也将工作地很好
= I.
/、	（3-5）
心）=丿®（1釦）.
（4）	D2D设备每凡札"，个周期随机地选择一个周期作为沉默周期，沉默周期 中UE不发送发现信号，而是监听发现资源池中所有的DRBs接收到的发现信号。 如果D2D设备选择的DRB上接收到的信号的能量比其他DRBs中接收到的能量 要高，具体来说就是UE会测量所有DRB中接收到的信号的能量，并以测量到 的能量值对所有的DRBs排序，如果所选的DRB接收到的能量比所有DRBs接 收到能量值后y%中的最高值的还要高zdB时,UE会重新从能量值后y%的DRBs 中随机地选择一个资源块。
3.3.4 两种方案的比较
基于能量检测的资源选择方案本质上是一种贪婪的思想，每个用户在进行资 源选择时是根据自己的对周边环境的感知，尽可能地避开能量拥挤的资源块。虽 然这种方法不能完全避开资源选取的冲突，但相比随机的资源选取，这种趋利避 害的策略还是能让它的冲突概率变小。总体来说基于能量检测的资源选方案要比 随机的资源选取方案的性能要好，特别是在资源池的大小相对用户数少的情况下。
我们采用3GPP中对比不同方案的平均发现的邻居用户数随发现周期的变化 曲线来对比两种资源选取的方案的性能。
这里假设所有的用户是同时开启的邻居发现服务。采用基于能量检测的资源 选取方案时，用户需要先检测一个发现周期，这将使这种方案相比于随机的资源 选取方案会差一个周期的发现邻居用户数。为了对比的公平性，对原有的基于能 量检测的发现方案进行了如下的更改：
（1）	在第一个发现周期，用户会随机地选择一个资源块用于发送发现信号， 选择的这个资源块是临时资源块，这个资源只在第一个周期有效，在第二个发现 周期，用户将使用基于（2）中选出的资源块。
（2）	在第一个发现周期，用户会去检测除了临时资源块所在子帧的其他发 现资源块中接收到的能量，并把这些资源块按检测到能量的大小排序。用户从能 量值后y%的资源块中随机地选择一个作为下一下周期使用的资源块。后续的流 程依照原有的方案。
26
第三章D2D邻居发现中的资源分配方案
我们对两种资源选取的方案进行了仿真的对比，图3-6、图3-7、图3-8分别 给出了（子帧数，用户数）对应为（5, 200）、（10, 200）、（10, 300）时, 平均发现的邻居用户数随发现周期的变化。仿真中基于能量检测的资源选取方案 中，沉默的周期使用的是4。可以看到在第一个发现周期，基于能量检测的资源 选取方案与随机的资源选取方案的平均发现用户数是相同的，这是因为更改的方 案在第一周期釆用的也是随机资源选取的策略。基于能量检测的资源选取方案要 比随机的资源选取方案的性能要好，用户数量相对资源池大小越大即资源分配越 拥挤两者性能的差异越明显。
基于能量检测的资源选取方案整体的性能要比随机的资源选取方案好，但是 对于某些发现服务可能会出现性能不稳定的情况，比如用户想发现某个特定的邻 居用户时，这个两个用户有可能在加入发现过程时选择的是相同的资源块，此时 这两个用户的相互发现依赖于发现流程中设计的第（4）步即适时地沉默，而发 现需要的时间依赖于沉默周期的长度。如果沉默的周期比较长，发现需要的时间 会比较长；如果缩短沉默的周期比较短，用户发送发现信号的机会会减少，会一 定程度上影响发现的性能，此外会增加设备用于能量检测消耗的能量。

图3-9.发现的邻居设备数量随时间变化（5个子帧，200个用户）






经玩的发现周鄒的数H
图3・10.发现的邻居设备数量随时间变化（10个子帧，200个用户）


图3-11,发现的翎居设备数量随时间变化（10个子帧，300个用户）
3.4本章小结
本章主要介绍邻居发现的流程和资源分配的方案。发现的流程有基于EPC 和基于直接信号的发现流程，基于直接信号的发现流程拥有更高的准确度而更受 青睐。基于直接信号的发现流程，主要介绍了两种分布式的资源分配方案，随机 的资源选取方案和基于能量检测的资源选取方案。基于能量检测的资源选取方案 在用户密度更大的时候有更好的性能，然而实现起来的复杂度要高得多。此外, 本章提出了发现概率的概念，并针对随机的资源选取方案提出了分析发现概率的 简化模型，通过仿真分析说明了这个分析模型与实际仿真的结果很贴近。这个简
28
化的发现概率将作为后续研究的基础。通过分析发现现有的方案不适应不同用户 密度的场景和用户数动态变化的场景。因此将在下面一章提出提高资源分配方案 适应性的方案。
29
第四章D2D邻居发现中自适应的资源分配方案
如图3-6所示，系统会分配一部分的时频资源用于邻居发现，在LTE FDD 系统中分配的是上行频段的一部分资源，在LTE TDD系统中分配的是一些帧。 如果每个发现周期中分配的这部分资源是固定的，这样的设定不能适应于不同的 场景，如在用户稀疏的郊区和用户密集的市中心。自适应的资源分配技术能够提 高邻居发现服务的适应性，从而提供更可靠的邻居发现服务』文献［23］中提出了 一种自适应的资源分配方案，然而方案中的一些假设与现有3GPP中给出的假定 并不一致o3GPP技术文档中提出参与D2D邻居发现的设备在邻居发现阶段是工 作在半双工的模式，尽量分配连续的子帧用于D2D邻居发现。本节将基于3GPP 技术文档中提出的一些共识，给出实际可行的自适应资源分配的方案。
当参与邻居发现的用户数相对于分配用于邻居发现的资源较多时，也就是资 源分配出现拥挤的情况时，用户选取资源的冲突概率和用户选取的资源在同一个 子帧的概率都比较高，这将使得邻居发现的性能下降。本章中将引入发送概率的 概念，并通过发送概率的自适应调整方案来减轻资源分配拥挤对发现性能的影响。 对于某些邻居发现服务，用户对发现时延是比较敏感的，如果发现时延比较大可 能会导致服务的失效。本章将研究系统参数配置如分配的子帧数、发现周期等对 于发现时延的影响，并将提出两种自适应的资源分配方案来保障服务的时延质量。 4.1发送概率的自适应调整
随机的资源选取方案中，D2D设备在每一个发现周期都会从资源池中选取 资源用于发送发现信号，并且方案中发现资源池的大小是固定的。发现概率和发 现的用户数是衡量D2D邻居发现资源分配方案性能的重要指标，发现概率是指 在一个或多个发现周期发现某个设备的设备数量占蜂窝小区中总的参与邻居发 现的用户数。在参与邻居发现的用户数相对资源池大小比较小的情况下，随着参 与邻居发现的用户数的增加，即用户密度增加的时候，用户平均发现的邻居用户 数将增加。当用户密度增加到一定程度时，用户平均发现的邻居用户数将减少， 平均的发现概率也将减小。这是因为密度比较小的时候，资源选取的冲突比较小， 发现信号间的干扰比较小，平均发现的邻居用户数随用户密度的增加而增加。而 当用户密度比较大的时候，资源选取的冲突比较大，发现信号间的干扰比较大， 并且用户选取的资源在同一个子帧的概率比较大，如果用户密度继续增大将对邻 居发现的性能造成严重的影响。图4-1和图4-2分别给出了分配子帧数为5和7
30
时，平均发现的D2D用户数和发现概率随D2D用户数变化的仿真图，仿真参数 同表3-1。



参与D2D邻居发现的用户数
图4-2发现的用户数和发现的概率随用户数的变化（7个子帧）

从两个图可以看出，当分配的资源池大小是固定的，用户发现的概率将随用 户数的增加而减小，这是冲突概率增大的缘故，而发现的用户数将随用户数的增 加先增后减。发现用户数变化的拐点与分配的资源池有关，资源池的大小越大,
31
拐点处的用户数越大。当子帧数为5时，对应DRB的数量为220。图4-1可以 看出当用户数小于200左右时，资源的冲突比较小，发现的用户数是随D2D用 户数的增加而增加；而大于200左右时，资源的冲突比较大，发现的用户数将随 D2D用户数的增加而持续的恶化。应该尽可能地避免拐点后的情况发生，增加 的用户数反而使得发现的用户数减小。
发现信号的发送概率是指D2D设备在每个发现周期以一定的概率决定在该 发现周期是否发送发现信号，本节将研究如何设计合理的发送概率的自适应调整 方案来减少资源分配拥挤造成对邻居发现服务的影响。
我们对不同的子帧数量、不同用户数下发现信号的发送概率对D2D设备的 单个周期发现概率的影响进行了仿真，仿真参数同表3-1。



图4-3给出了几条典型的仿真曲线，其中(用户数、子帧数)分别设置为(200,5)、 (400,5)、(400,6)。下面对仿真结果进行详细的分析。
当用户数为200,子帧数为5时，发现概率随着发送概率的增大是一直增大 的，在发送概率为1时取得最大值。此时，DRB的数量为220,这时用户数量和 资源的数量是相当的，资源的分配并不拥挤，因此设备可以选择最大的发送概率 1以实现最大的发现概率。
当用户数为400,子帧数为5时，发现概率随着发送概率的增大是先增后减 的。用户数量要比资源的数量大得多，这使得资源的分配很拥挤，这时发送概率
的选取应该小于1来减少资源分配的冲突，然而过小的发送概率将使得设备发送 发现信号的机会少，从而被其他设备发现的概率变小。
对于用户数相对资源数目较多的情况，设备的发现概率将随发送概率的增大 先增大后减小，会有一个发送概率的最优取值。由于现在没有成熟的理论分析， 可以通过大量的测试来获得一个(用户数、资源池大小)对应最优发送概率的对 应关系，测试的时候用户数和资源池的大小取一些离散值，通过测试可以获得在 一些离散点的最优的概率选取。在实际的系统中，可以用一个表格来存储在对应 不同的用户数、资源池大小时发送概率最优的取值，系统根据用户数和资源池的 值在表格中查询最优的发现概率的取值从而统一地调整所有用户的发送概率。
4.2基于时延性能的自适应调整方案
发现时延是邻居发现的一个重要性能指标。由3.2.2节对随机的资源选取方 案的分析,D2D设备发现它邻近的一个设备的过程可能需要经历多个发现周期， 记需要经过的发现周期数为为，则发现时延可以表示为
也=2眼,	(4-1)
不同发现周期中的发现过程是相互独立的过程，因此为•服从参数为Pdls的几 何分布，平均的发现时延表示如下
— 1
\t=nTTDi=	TDls,	(4-2)
Pm
由图4-1和图4-2可以看出，在资源池大小固定的情况下，当用户数增加时 发现概率将减小，结合式(4-2)可以得出此时平均的发现时延将增大。当用户 的数量比资源池的大小大很多时，发现时延可能会超出服务的容忍上限。
4.2.1	基于时延性能的子帧调整方案
有些邻居发现服务对于时延过长的情况是不可容忍的或者服务有一个预期 的时延，4.1节分析了在用户数大于资源池数量的时候通过引入发送概率可以一 定程度地减少资源选取的冲突，从而提高发现概率，减少发现时延。然而这种时 延的减小有可能仍无法满足服务的要求。
为了避免在用户数较多的时候出现过长的发现时延，而在用户数较少的时候 浪费频谱资源，系统可以设定一个预期的平均发现时延。结合式(3-4)和式(4-2) 可以看出发现时延与资源池的大小成反比，而与用户数成正比。可以通过调整子 帧的数量来满足发现时延的要求。当平均时延大于预期的时延时，增加分配的子 帧数以使平均时延小于预期的时延；当平均时延小于并且减少分配的子帧数可使 平均时延小于预期时延时，减少分配的子帧数。具体需要分配多少子帧，可以通 过简化的发现概率模型推导得出。
33

根据时延性能的要求
阵〉令，
记Pl=虹,由（3-4）和（4-6）有
■Brl
（4-8）可以近似地简化为下面的表示


式（4-8）到式（4-9）的推导是通过求渐进线的方式得出的，通过分析可知 渐进线与原有的函数非常接近。由图3-8可以看出这个简化的模型与实际的场景 得出的结果是很相近的。于是，可以根据（4-11）估算的值和蜂窝中加入邻居发 现的用户数来调整分配的子帧数。
4.2.2	基于时延性能的子帧、发现周期联合调整方案
上一节提供的方案是根据预期的平均时延去动态调整分配的子帧数，本节将 提出另一种方案，通过联合地调整子帧个数和发现周期，在保证发现时延的前提 下最大化频谱利用率。
定义邻居发现使用资源的占用比2为邻居发现使用的资源块的数量占总的 资源块数量的比值，可得，
0 kN
1000%
34

K是一个子帧中总的资源块的数量，在这里左和K都是常量。 结合（4-2）和（4-12）有

_M + 2k-l + ^M2-2M +(2A：-1)2 m
* _	2k	ftiT +
式（4-18）中不等式的推导是通过求渐进线的方式得出的，通过分析可知渐进线 与原有的函数非常接近。得出分配子帧的数量后，通过（4-16）和（4-14）可以求解出 对应的发现周期
M-2
(4-19)
此时的资源占用比


我们对很多的发现时延阈值和用户数下的资源占用比随子帧个数的变化情 况进行了仿真，资源占用比的值是通过仿真得到的发现概率带入得到的。为了表 示清晰，图4.4给出其中的几组仿真结果，其中平均时延的期望值设为Is,用户 数分别取250和350,仿真参数同表3.1。

由图可以看出，资源占用比随子帧数的增加先减后增，对应一个用户数，会 有一个最优的子帧数使得资源占用比最低。此外，可以看出实际仿真得到的结果 和数值分析得到的结果是很相近的。于是可以根据式（4-18）和式（4-19）估算 的值来配置分配的子帧数和发现周期，这种子帧、发现周期联合调整的方案在满 足发现时延的要求下可以最大化频谱利用率。
4.3本章小结
本章针对随机的资源选取方案适应性差的问题，提出了三种自适应的调整方 案，发送概率的自适应调整方案、基于时延性能的子帧调整方案和基于时延性能 的子帧、发现周期联合调整方案来提高资源分配方案的适应性。当参与邻居发现 的用户数相对于分配给邻居发现的资源较多时，也就是资源分配出现拥挤的情况 时，用户选取资源的冲突概率和用户选取的资源在同一个子帧的概率都比较高, 这将使得邻居发现的性能下降，发送概率的自适应调整能够一定程度地提高发现 性能。此外，针对时延敏感的服务提出两种基于时延性能的自适应调整方案，基 于时延性能的子帧调整方案和基于时延性能的子帧、发现周期联合调整方案都能 够一定程度地保障服务的时延性能，而后者可以进一步使资源的使用最少，从而
36
节省频谱资源。通过大量的仿真验证了发送概率的自适应调整方案的中概率选取 的准确性。针对基于时延性能的子帧调整方案和基于时延性能的子帧、发现周期 联合调整方案进行了详细的数值分析和仿真验证。
37
第五章论文总结与展望
5.1全文总结与主要贡献
D2D通信作为一个新兴的研究领域，让负重不堪的基站和核心网看到了减 负的希望，日益增长的本地服务流量有望通过D2D的直连链路得到更加快速、 节能的传输。此外，D2D通信在公共安全领域也能够提供强有力的技术支持， 诸如在应急救援事件中提供可靠的通信或辅助灾难场景中搜救工作的人员定位 和报警。D2D通信的这些优点吸引了很多专家学者对其相关技术进行研究-3GPP 也有很多的D2D通信的标准化工作正在进行。D2D通信的发展依赖于很多相关 技术的发展如设备同步、邻居发现、模式选择、资源分配、干扰管理、功率控制 等。
本论文以现有的D2D通信研究成果为基础，对D2D通信中的关键技术邻居 发现中的资源分配进行了深入的研究。由于资源分配的方案与邻居发现的流程设 计紧密相关，介绍了基于直接信号的邻居发现流程，基于直接信号的邻居发现流 程的资源分配方案有集中式的和分布式，分布式的资源分配方案相比集中式的方 案能够节省大量信令开销而备受关注。当前分布式的资源分配方案主要有两种， 随机的资源选取和基于能量检测的资源选取。本文的主要贡献分为以下三个方面:
(1)建立基于直接信号发现的随机资源分配方案的平均发现概率和平均发 现时延分析模型，这个分析模型通过对发现条件进行适当的简化得到的，通过仿 真可以看出在一定的情况下分析模型得出的发现概率和平均时延与实际仿真的 结果是很相近的，所以可以通过这个数值分析的模型简化对基于直接信号发现的 随机资源分配方案的性能分析，并通过这个模型去估计系统性能最优时的子帧数、 发现周期等参数的取值。
(2)提出了一种通用的提高邻居发现中资源分配方案适应性的改进，即发现 信号的发送概率自适应调整的方案，通过数值分析模型和仿真结果都能看出当用 户密度比较大即当资源块的数量小于用户数时，随着用户数的增加用户的平均的 发现的用户数和平均的发现概率都将减少。通过分析和仿真得出对应于一组确定 的(子帧数、用户数)组合会有一个最优的发送概率的取值。当用户数相对资源块 的数目比较大的时候，这个最优的发送概率是小于1的。可以通过数值分析模型 的公式去根据用户数的变化动态地调整发送的概率，也可以通过大量的仿真来获 取不同用户数和资源块数量时最优的发送概率的取值从而获得一个(子帧数、用 户数)对应最优发送概率取值的表格，系统通过查询这个表格来动态地调整D2D UE的发送概率。
(3)提出了两种基于时延性能的自适应资源分配方案，第一种是通过动态地
38
第五章论文总结与展望
调整连续分配的子帧数来满足服务的时延要求；第一种是通过联合调整连续分配 的子帧数和发现周期在满足服务的时延要求同时最小化资源的占用比，从而在满 足时延性能的前提下最大化资源利用率。
5.2未来工作展望
由于个人能力和时间的限制，本文的研究工作做的还不够深入，所以在以下 几个方面还需要进一步探索和补充：
(1)本文中的数值分析模型和资源分配的方案都是基于随机的资源分配方 案的改进，并不适用于基于能量检测的资源分配方案。由于基于能量检测的资源 分配方案在某些性能上随机的资源分配，后续的研究需要对基于能量检测的资源 分配方案进行建模和对应的方案的改进。
(2)基于时延性能的资源适应分配方案中考虑的时延是一个系统平均的发 现时延，所以对应的方案并不能保证每个D2D设备的时延。对于具体D2D设备 发现时延的研究，后续需要提出进一步的调整方案。
(3)本论文考虑的是单小区的情况，并没有考虑多小区，尤其是蜂窝小区 之间是异步的情况。异步的蜂窝小区，需要对现有的资源分配方案作出调整实现 发现其他小区的D2D设备的功能。在多小区的场景需要对现有的仿真和分析的 模型做适当的修改。
(3)分析模型和仿真中并没有考虑带内辐射各种实际场景部署的影响，后 续需要加入带内辐射的模型和实际场景部署对系统进行更完善的分析和仿真。
39




























































40


参考文献
[1]Osseiran A, Boccardi F, Braun V, et al. Scenarios for 5G mobile and wireless communications: the vision of the METIS project[M]. IEEE Communications Magazine, 2014:26-35.
[2]Corson M S, Laroia R, Li J, et al. Toward proximity-aware internetworking [J]. IEEE Wireless Communications, 2010, 17(6):26-33.
[3]Rainer L, Devaki C, Curt W, et al. LTE for public safety networks[M]// LTE for Public Safety. John Wiley & Sons, Ltd, 2015:106 - 112.
[4]3GPP TR 23.703 vl2, Rel 12, in Technical Specification Group Services and System Aspects; Study on architecture enhancements to support Proximity Services (ProSe), March 2014.
[5]3GPP TR 22.803 "Feasibility study for proximity services (ProSe),"(Release 12),V12.0.0, Dec.8, 2012.
[6]3GPP TR 36.843 "Study of LTE device to device proximity services; Radio aspects," VI.2.0, Mar, 2014.
[7]Wijting C, Ribeiro C, Doppler K, et al. Device-to-Device Communication as an Underlay to LTE-Advanced Networks [J]. Modem Science & Technology of Telecommunications, 2010, 47(12):42 - 49.
[8]S. Sesia, I. Toufik, and M. Baker, et al, LTE - The UMTS Long Term Evolution From Theory to Practice. John Wiley & Sons, 2011.
[9]Baccelli F, Khude N, Laroia R, et al. On the design of device-to-device autonomous discovery.[C]// Communication Systems and Networks (COMSNETS), 2012 Fourth International Conference on. IEEE, 2012:1-9.
[10]Doppler K, Ribeiro C B, Kneckt J. Advances in D2D communications: Energy efficient service and device discovery radiofC]// Wireless Communication, Vehicular Technology, Information Theory and Aerospace & Electronic Systems Technology (Wireless VITAE), 2011 2nd International Conference on. IEEE, 2011:1-6.
[11]Doppler K, Yu C H, Ribeiro C B, et aL Mode Selection for Device-To-Device Communication Underlaying an LTE-Advanced Network[J]. IEEE Xplore, 2010, 29(16):1-6.
[12]K. Doppler?M. Rinne, C.Wijting, et al, "Device-to-device communication as an underlay to LTE-advanced networks/5 IEEE Commun.Mag., vol. 47, no. 12, pp.
41
42-49, Dec. 2009.
[13]Janis P, Koivunen y Ribeiro C, et al. Interference-Aware Resource Allocation for Device-to-Device Radio Underlaying Cellular Networks[C]// IEEE Vehicular Technology Conference. 2009:1-5.
[14]Zulhasnine M, Huang C, Srinivasan A. Efficient Resource Allocation for Device-to-Device Communication Underlaying LTE Network[C]// Wireless and Mobile Computing, Networking and Communications (WiMob), 2010 IEEE 6th International Conference on. IEEE, 2010:368-375.
[15]YuCH9 Tirkkonen O, Doppler K, et al. On the Performance of Device-to-Device Underlay Communication with Simple Power Control [C]// Vehicular Technology Conference, 2009. VTC Spring 2009. IEEE 69th. IEEE, 2009:15
[16]YU C H, Tirkkonen O, Doppler K, et al. Power Optimization of Device-to-Device Communication Underlaying Cellular Communication. [C]// Proceedings of the 2009 IEEE international conference on Communications. IEEE Press, 2009:1-5.
[17]Peng T, Lu Q, Wang H, et aL Interference Avoidance Mechanisms in the Hybrid Cellular and Device-to-Device Systems[C]// Personal, Indoor and Mobile Radio Communications, 2009 IEEE 20th International Symposixim on. IEEE, 2009:617-621.
[18]Zulhasnine M, Huang C, Srinivasan A. Efficient Resource Allocation for Device-to-Device Communication Underlaying LTE Network[C]// AMreless and Mobile Computing, Networking and Communications (WiMob), 2010 IEEE 6th International Conference on. IEEE, 2010:368-375.
[19]Xu S, Wang H, Chen T, et al. Effective Interference Cancellation Scheme fbr Device-to-Device Communication Underlaying Cellular Networks[C]// Vehicular Technology Conference Fall (VTC 2010-FalI), 2010 IEEE 72nd. IEEE, 2010:1-5.
[20]Yu, Chia-Hao, Doppler K, Ribeiro, Cassio B, et al. Resoxxrce Sharing Optimization fbr Device-to-Device Communication Underlaying Cellular Networks [J] . Wireless Communications IEEE Transactions on, 2011, 10.
[21]Cannon M J. On the design of D2D synchronization in 3 GPP Release-12[C]// Communication Workshop (ICCW), 2015 IEEE International Conference on. IEEE, 2015.
[22]3GPP Rl-134630, Resource management for type 1 discovery, Qualcomm Incorporated.
[23]Yang Z J, Huang J C, Chou C T, et al. Peer discovery fbr device-to-device (D2D)
42


communication in LTE-A networks [C]// IEEE Globecom Workshops.
2013:665-670.
43








































