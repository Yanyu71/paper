
第一章绪论
1.1研究背景
进入二十世纪以来，无线通信技术迅猛发展，人们的生活水平日益提高，对于无 线通信的质量要求也越来越高。近十年来，无线通信技术的迅猛发展，对人类的生产 和生活方式生了巨大的影响，也渗入到人们生活的方方面面。不断增长的数据通信 业务需求，使得第四代移动网络(4th Generation mobile networks, 4G)技术受到人们 的广泛关注。实际上，人们对于4G的研究，可以追溯到21世纪初期。当时，研究 者们已经对beyond 3G/4G蜂窝通信空中接口技术展开了研究。经过几年的努力，4G 研究终于有所突破，并于2013年投入使用。同年12月4日，我国正式向三大运营 商发布了 4G牌照。这预示着，我国无线通信产业已经正式开始进入4G时代，这必 将推动我国的无线通信技术进入一个全新的时代。虽然4G实现了上网速度从2Mb/s 到100Mb/s的巨大飞跃，并具有不同速率间自动切换功能，但是也存在着标准多，各 种移动通信系统彼此之间不能兼容，技术难，容量受限等缺陷。此外，互联网j技术 的迅速发展，也使得无线通信技术必须在包括流量密度，用户峰值，移动性，端到端 时延在内的各方面有所提升，以适应这种爆炸式的增长。为了满足人们日益增长的 通信需求，应对愈来愈庞大的网络信息量，全球范围内的学术界和工业界对第五代 移动网络(5th Generation mobile networks, 5G)技术的研究也逐步提上日程。作为 4G网络的延伸，5G网络的最突出优势就是具有惊人的传输速度，其理论上的最高 传输速度可达每秒数十Gb,也就是说，在5G时代，在1秒之内整部超高画质电影 就可以下載完成。2013年2月，欧盟宣布拨款5000万欧元，用于加快5G技术的研 究和发展。2013年5月13日，韩国三星电子有限公司宣布，其已经成功开发出首个 基于5G核心技术的移动传输网络，该技术可在28GHz的高频段实现每秒IGbps以 上的速度传送数据。此外，韩国还成立了 5G技术论坛，以推进5G技术的进一步发 展。我国的华为公司，也投入大量资金进行5G技术的研发和创新，并预计在2020 年实现20Gbps的商用5G移动网络。我国还成立IMT-2020推进组，以促进5G技术 在我国的研究和发展。另外，日本，英国和欧盟也相继研发出一系列先进技术并取 得喜人的成绩。相信在不久的将来，以“信息随心至，万物触手及”为美好愿景的 5G系统会普及［I。

然而，人们不断提高对无线通信传输质量和传输速度的要求，现有技术已经不 能满足这种需求的实现。此外，人们的不断开发利用，使得现有的频谱资源愈加匮 乏，并逐渐阻碍了无线通信技术的进一步发展。因而，中继协作通信技术一经问世, 便以其在提高频谱率方面的优势受到学术界和产业界的广泛关注。通过对中继系统 中的传输方案和传输协议的设计，并充分利用无线通信的广播特性和通信网络中的 中继设备，提高中继系统中的传输可靠性和传输效率。从理论上来说，无线系统在引 入中继节点之后，从信息论角度看，可以提高整个通信系统的容量。遗憾的是，在实 际应用中，中继往往不能工作在全双工模式，而是处于半双工状态，这就导致传统 的中继协作技术对无线通信网络容量的利用率降低。文献【4］中，研究了以最典型的 三点双向中继系统为研究对象的双向中继技术。文献假设两个源节点必须通过中继 才能实现信息交互，没有直传路径。整个传输的过程可以分成两部分，也就是常说 的多址接入(Multi-Access Channel, MAC)阶段和广播(Broadcasting Channe, BC) 阶段：在MAC阶段，中继节点接收各个源节点发送的信号，并将这些多址信号进行 检测和处理，最后将接收到的信号映射为网络编码字符；在BC阶段，中继将生成的 网络编码字符广播给所有源节点，源节点接收到的网络编码字符，并根据自信息对 进行译码，获取由源节点发送的有用信息。跟传统单向中继系统中的传输方案相比, 双向中继系统在降低信息通信过程中的时间开销方面有很大优势，从而达到有效提 高系统的容量的目的。
中继协作网络的高效、经济特性使得其一经问世，便受到学术界和产业界的广 泛关注，并被迅速应用到各个领域。目前，中继技术已经成功应用于长期演进技术升 级版(Long Term Evolution Advance, LTE-A)系统和全球微波互联接入(Worldwide Interoperability for Microwave Access, WiMAX)系统中，有效提高了 系统的覆盖能 力，并提升了蜂窝网络中边缘用户的服务质量。为了更大限度的提升无线通信网络 中的容量，学术界将多输入多输出(Multi-inputMulti-output, MIMO)技术引入中继 系统中，通过多天线技术，增加了空间的自由度，从而实现空间分集增益和空间复 用增益A。］。MIMO中继系统的提出，为无线通信技术的发展注入了新的能量。然 而，MIMO技术带来更高的频谱利用率的同时，也引入了更多的问题，比如如何合 理处理系统中的干扰等。为了解决MIMO中继系统中的干扰消除问题，研究者们将 干扰对齐(Interference Alignment, IA)技术引入MIMO中继系统卩。，"】。通过在发送 端进行预编码，IA技术能够将接收端接收到的其他发送端的干扰信号对齐到一个空 间维度，有效压缩干扰占用空间，提高整个通信系统的传输效率和自由度。随着无线通信技术的迅速发展，人们对无线移动设备的依赖性也越来越强。这就对现有的 无线设备在续航能力上提出了更高的要求。然而，现在的设备往往不能达到这一要 求，现有的技术手段还不能完美的实现移动设备的超长时间待机。因而，研究者们 试图研究一种绿色通信方案，即实现在信息传输的过程中，同时收集信号中携带的 能量，从而使得无线设备可以拥有更好的续航能力。
1.2研究现状分析
最近，双向中继系统以其提升系统频谱效率的优势受到工业界与学术界的广泛 关注，并应用于ad-hoc网络、蜂窝网络等多种实际场景中。将网络编码技术引入中 继系统后，双向中继系统的信息传输通常分为两个阶段：即MAC阶段和BC阶段。 在MAC传输阶段，两个用户同时发射信号给中继；在BC阶段，中继接收到信号后, 对接收到的信号进行一系列操作，如最常见的放大转发(Amplify-and-Forward, AF) 和解码转发(Decode-and-Forward, DF),在经过一系列的操作后，中继将处理后的 信号广播给两个用户。接收端在接收到信号后，消除自信息的干扰，然后解码出所 需信号［⑵。MIMO系统因为能够显著提升误码率也被引入到中继系统中卩3，1句。
【A技术作为一项正在广泛受到人们关注的传输技术也被引入到中继系统中，通 过消除多用户干扰信道中的干扰，提升系统的自由度(Degree of Freedom, DOF)性 能卩队最近，一项新兴的技术应运而生，即信号空间对齐技术(Signal Space Align, SSA),该技术将IA技术和双向中继技术结合，在文献卩6］中首次提出。在卩6］中，为 了获得最大的DOF,讨论了一种三个用户的场景，这三个用户两两进行信息交互, 又被称为MIMOY系统。假设用户间的通信必须通过中继才能完成。在第一个阶段, 三个用户同时发射信号到中继。然而，在中继端，用户的有用信号和干扰分别对齐。 在第二个阶段，中继进行物理层网络编码(PhysicalNetwork Coding. PNC),并将处 理后的信号发射给接收的三个用户。通过联合设计每个用户的预编码向量，两个不 同用户的成对信号被对齐到一个子空间，这样，接收端在接收到信号后，首先消除 干扰.然后将成对信息中的自干扰信号消除，并对所需信号进行解码。注意到，只有 每个用户配备的天线数量M和中继的天线数量N满足N>	时，系统达到最优
的DOF,即3泌卩7】。可以知道，SSA技术是消除多用户双向中继系统中的干扰问题 的一项有效地技术。因而，后来也有很多学者对该技术进行了进一步的研究
为了能够实现低复杂度的更实际的应用，文献Pl提出一种机会干扰对齐技术 (Opportunistic Interference Alignment, 0IA),考虑一种K小区的单输入多输出的信道。文献〔22］中则考虑了三个用户的干扰信道，并证明，即使用户传输随机波束成型 形成的信号，只要接收端数量足够多能够提供多用户分集，使得干扰能够被彻底消 除，那么，系统也可以达到最优的DOF。文献［23〕的作者考虑了一种多用户双向中继 系统，中继采用AF技术的机会多用户分集场景，该场景下，中继配备多个天线，通 过简单的破龙波束成型方案挑选用户对进行信息交互，从而提高系统的DOF性能和 系统吞吐量。提出信道对齐用户对算法和半正交信道对齐用户对算法，基于多用户 分集技术，对齐用户的信道并消除干扰。然而，文献［23］中只考虑了用户配备一根天 线的场景，这就使得其系统性能的提升是受限的。
近年来，很多研究集中在多用户的双向中继系统中［24,25］,在这些场景中，通常 是多对配备单天线的用户通过一个配备多天线的中继进行信息交互。对于这些研究, 如何消除用户对间的干扰无疑成为提高多用户双向中继系统性能的一项巨大挑战。 因而，ANC技术作为中继端一种独特的解码方式被引进到多用户的双向中继系统中, 由此中继端配备的电线得以更高效的利用。一些研究中将成对用户的信号对应到一 对正交的空间中，使得用户对间的干扰得以消除，同时利用ANC技术让每个用户 提取其想要得到的信号，消除其同伴的自干扰。值得注意的是，这些基本的传输方 案在某种程度上降低了系统能达到的DOF。但是，在实际的信噪比(Signal-to-Noise Ratio, SNR)限定内，该传输方案的应用可以有效提高系统性能。为了解决这种问 题，研究者们提出了许多方案试图获得更优的系统性能。一些研究者将功率配置SI 方案引入双向中继系统中［2728］,虽然该方案能够有效提高系统的性能，但是这种系 统性能的提高是以牺牲复杂度和误符号率(Symbol Error Rate, SER)性能。此外，文 献［29T1］中研究了中继选择技术，该技术是消除用户对间干扰的一项有效技术，然 而，该技术是基于存在较大数量的中继的情况下讨论的，且该调度方案一般计算复 杂度较高。波束成型技术［32,33］也是提高中继系统性能一项不容忽视的技术，该技术 通过优化用户端或中继端的波束成型提高系统性能，然而，该技术的实现很多时候 需要较高的计算复杂度。总之，功率配置，中继选择和波束成型技术虽然可以提高 系统性能，但是却是以牺牲系统的复杂度或SER为前提实现的。
正如我们所知，多用户增益(MultiuserDiversity, MuD)是抵抗无线衰落一项重 要的技术EL假设一个通信系统预备使3个用户进行数据传输，而每个用户配备的 天线数量是受到限制。通过精心设计用户的发射信号，依旧能够得到显著的性能增 益。在文献Ml中，基于MIMO交换网络，考虑普通和网络编码中继方案两种场景提 出最大速率方案和最大用户数量方案来提升系统的和速率性能。然而，提出的这些 算法，计算复杂度普遍比较高且中继需要知道所有用户的全局CSL对于实际系统, 这些要求是非常苛刻不易实现的。迄今为止，对于多用户双向中继网络的低复杂度 用户调度设计依然少有学者涉足，而我们已经对MIMO-Y系统〔35】和MIMO多用户 中继网络〔36］的低复杂度用户调度进行了深入研究。
近年来，工业界对于电池支持的无线通信设备需求越来越大。然而，能量储存 容量却因为电池硬件技术的限制而大大受限。能量收集技术(Energy Harvest, EH) 的出现为延长无线网络的寿命提供了一项有效技术。传统的EH技术主要从周围环 境中进行能量的釆集，如光能和风能等〔37,38］。然而，这些技术由于实际条件限制有 时候并不能应用于无线设备。为了解决这一问题，人们提出一项新的能量收集技术, 它从无线信号中收集能量［39］。该技术能够使设备只有很小的能量需求来保证正常运 行，能够自身提供持续的能量支持。
迄今为止，已经有很多研究者对RFEH技术进行了深入研究作为众多 EH技术中的一员,同步无线信息与功率传输(Simultaneous Wireless Information and Power Transfer, SWIPT)技术在文献钏冋 中被首次提出，这种SWIPT系统的接收 回路能够同时进行EH和信息解码(Information Decoded, ID),因而受到学术界的 广泛关注。最初的SWIPT系统研究主要集中在简单一对源节点和终端的场景，EH 和ID过程在接收端交替进行［45】。后来，文献［46］中，对MIMO系统中的波束成形 进行了研究。除了简单的一对源节点和终端场景的研究，SW1PT传输方案还被应用 到很多其他场景中［47Y9］。比如两个用户间的距离非常远，必须通过中继支持进行信 息交互的无线通信场景为了提高系统性能，用户调度方案也被引入到SWIPT 系统中。文献［52,53］分别研究如何提高多用户SWIPT系统中的中断概率和系统吞吐 量。中继选择技术也是一项提高系统空间分集的有效手段［54-56］,通过釆用中继选择 技术，能够优化给定能量约束的信息传输性能。在文献El中，作者提出一种在源节 点顺序优化中继选择协议的算法。值得注意的是，在这里，选出的中继进行EH或者 ID,而其他用户接收到能量但是并没有进行利用。因而，在这里，我们考虑了一种 所有到达中继的能量都尽量不被浪费的调度方案。
1.3论文结构安排
针对所研究的中继系统中的用户调度问题，本文首先对研究背景，以及国内外 的研究现状进行了全面的调研和分析。首先，本文主要对中继系统中的几种关键技 术进行了详尽的介绍和分析。然后，对本文提出的新的传输方案和用户调度方案进行了介绍，并在MATLAB平台对系统性能进行了仿真分析。
全文共分为六章，全文结构安排如下：
在第二章对后续论文工作的理论基础——中继系统新技术的进行了介绍。主要是 对信号对齐技术和能量采集方案的介绍。
在第三章主要讨论K对用户间的双向通信，在该场景下，每个用户配备Af根天线， 中继配备N根天线，且用户之间只能通过中继进行信息交互，而不能直接通信。在 这里，本章关注一个比较特殊的场景，既，用户和中继的天线数量满足1它肱＜件1。 在这种场景下，因为空间维度不足以支持信号对齐，因而传统的SSA技术不能实 现。本章提出了一项新的机会信号空间对齐方案，该方案基于奇异值分解(Singular Value Decomposition, SVD)技术联合波束成型方案和用户选择技术。机会对齐的实 现主要依托于多用户分集实现。然后，该方案的性能通过在仿真平台实验其可达到 的DOF的以体现。通过一些仿真，可以知道，本章提出的方案在和速率上得到一定 程度的提高。
在第四章主要研究多用户双向中继系统的低复杂度用户调度设计，在该场景下，从 爪对单天线用户中挑选乙对用户通过中继进行用户对与用户对之间的信息传输，该 中继配备M根天线，在传输过程中，中继釆用放大转发AF的工作模式，并引入模 拟网络编码ANC技术。首先，我们提出一种基于信道系数模值的简单用户调度方 案，并命名为信道模值(Channel Norm, CN)选择方案，该方案的实现复杂度非常 低。然后，我们提出了一个近似最优调度的基于信道模值与正交性的调度方案，记 作CNO-A,该方案中，中继需要知道全局信道状态信息(Channel-State Information, CSI)并进行集中运算。值得注意的是，CNO-A方案能够达到接近最优调度的较好 的系统性能，且保证在较低的复杂度条件下完成。最后，本章提出一种分步CNO调 度方案，在该方案中，设定一个固定的阈值来平衡复杂度/CSI和系统性能，CNO-S 调度方案显著改善了中继的CSI开销和运算复衆度，在系统性能上略差于CNO-A方 案。
在第五章考虑一种无线信息与能量传输系统，这是一种经典的能量收集场景。在 该场景下，本章考虑了一种中继选择场景，即成对的用户通过中继节点进行信息交 互，在同一时隙中，只有一个中继从一系列备选中继中被选出，而其他中继则在该 时隙不工作，在下一个时隙重新进行中继选择。本章主要设计一种能够使得系统在 长时间内能够达到平均最大容量的中继调度方案，同时中继能够尽量少的使用能量。 因为此时也将中继需要的能量收集考虑上，在目标函数中引入一个二进制的系数，这样使得目标函数成为一个非凸的优化问题。通过对二进制约束进行松弛，原问题能 够转化成一个凸优化问题。为了减少运算的复杂度，提出一种低复杂度的次优方案。 本章提出的最优算法最大化了系统的平均和速率，同时尽可能的减少从中继中收集 的能量。最后，给出一些仿真结果以证明所提算法的有效性。
在第六章对论文的所做的工作进行了总结，并提出了未来中继系统中的传输策略 和用户调度方案的研究方向。

(C) 1994-2022 China Academic Journal Electronic Publishing House. All rights reserved.
第二章中继系统中的关键技术
随着移动通信技术的迅猛发展，人们对移动通信系统的信息传输速率和传输可 靠性提出越来越高的要求。然而，随着人们对频谱资源的开发利用程度越来越高，频 谱资源日益缺乏的问题逐渐凸显出来，遏制了无线通信的进一步发展。因而，无线协 作通信技术一经问世，便以其在提高系统利用率，扩大系统容量和服务质量等方面 的优势，引起研究者们的广泛注意。在初始阶段，协作通信只有用户和中继的协作 传输，发展到现今可以实现用户或者基站间的协作传输，通信网络的协作传输定义 也越来越广泛。根据传输方式，现有的无线中继网络可以宽泛的划分为单向网络和 双向网络两种类型。以最简单的三节点中继系统为例，所谓单向网络，也就是信号 从一个源节点通过中继节点传输到另一个节点；而双向中继系统，是指信息从两个 源节点发送到中继节点，经中继节点接收处理后，再广播给两个源节点的系统。对 于双向中继系统，通过合理的设计中继节点的双向信息流，有望将双向中继网络的 系统吞吐量提高一倍。如何最大限度的提升双向中继系统的吞吐量和系统性能成为 学术界研究的热点。在本论文中，针对双向中继系统，提出了机会信号对齐和低复 杂度信号调度方案，又结合新兴的节能充电技术，研究了充电中继系统中的用户调 度方案。为了更好的展开论文后续部分的介绍，在本章中，首先重点介绍几种接下 来将会用到的关键技术，即网络编码技术，干扰对齐技术和能量采集技术。
2.1网络编码
网络编码（Network Coding, NO 技术在中提出，该文献证明了通过对中间 节点处的不同路径信息流进行合理的编码处理，可以实现整个网络的最大容量。该 理论为网络传输容量的提升指出了新思路。NC理论的提出，从信息论角度证明了, 通过在中间节点对接收到的多路信息经行编码，接收端接收到编码后的信息后通过 相应的解码，能够获得所需信息。基于此，网络编码技术一经问世，便受到了学术界 的广泛关注。
除了增加系统的吞吐量，网络编码还有均衡系统负载，增加网络安全性等优点。 因为网络编码技术的这些优点，已经被应用于很多领域，并成功与无线中继网络结 合。中继系统引入网络编码技术可以明显提高系统的有效性和可靠性。传统的半双工双向中继系统中，需要四个时隙完成信息交互的过程。在应用了网络编码技术之 后，信息交换过程可以由传统的四个时隙减少到三个，甚至两个时隙。通过在中继 节点的存储转发功能上引入编码功能，能有效提升系统的吞吐量。PNC技术能够有 效提高半双工系统中的频谱利用率，因而受到越来越多的关注。基于PNC的双向中 继传输，对于提高通信系统的频谱利用率，降低通信系统中的信息流传输时间开销 有明显作用。此外，引入PNC技术，为中继系统中的干扰管理和信息流管理问题提 供了新思路。
基于NC技术的双向中继系统常用的传输协议分为AF, DF和CF三种。以最典 型的单天线三节点双向中继系统为例，AF协议是一种最为简单的中继协作方式，中 继在接收到源节点发送的信息后，只需要将接收到的信号直接放大后进行广播，源 节点在接收到中继广播的信号后，对其进行自信息消除并译码。AF协议的本质是对 模拟信号进行适当的线性操作，ANC技术就是釆用的AF协议。AF协议的一个显著 优势就是算法简便易于分析，且性能良好，能够获得满分集阶数。但是，它也存在着 不可避免的缺陷，中继简单的放大操作使得部分能量在噪声功率的放大过程中被浪 费，产生噪声传播效应。DF协议是指，中继在接收到源节点发送的信号后，不再进 行简单的放大转发操作，而是首先进行译码再将信息广播，有效的避免了噪声的放 大效应，本质上是一种数字信号处理的方式。但是，假设中继节点在译码过程中出 现了错误，那么该错误会在多跳传输过程中积累和传播，最终导致整个通信系统性 能下降，而不能获得分集增益。特别的，最早提出的PNC编码方案是通过异或操作 的，并且该方案在中继节点是基于CF协议进行信号处理的。相对于AF协议和DF 协议，人们对CF协议的关注度要低得多。但是，仍然有许多研究者提出一些例如基 于量化转发，基于Wyner-Ziv编码和基于Slepian-Wolf编码的CF协议。
2.2干扰对齐
本节主要介绍IA技术的基本思想和在中继系统中的应用。在这里，重点介绍IA 技术在中继系统中的应用，主要是在典型的Y信道中的应用，也就是人们常说的信 号空间对齐技术，
2.2.1干扰对齐的基本思想
IA技术是一种有效的干扰管理机制，该技术的基本思想是在系统的发送端对信 号进行预处理，通过预编码技术实现接收端接收到的干扰对齐到比较少的维度，从而最大化有用信号可用维度。也就是说，假设有用信号流数一定，应用IA技术之后, 接收端利用较少的维度就能够实现把有用信号从干扰中区分出来。从数学角度出发, IA技术的基本思想可以用求解线性方程组来解释。在通信系统的数学表达中，因为 信道可以认为是线性的，所以，在接收端，每副天线的观测值都是发送端发送的信 号的线性组合。因为研究对象是观测到的数值，因而线性方程是成立。假设有效信 道的系数是互不相关的，那么当满足接收端配备的天线数目大于等于发送端发送的 信息流数的条件时，接收端就可以实现由各个发送端发送的消息的译码。在实际应 用中，接收端只需要解码接收到信号中的一部分，因而，接收到的其余信号都可以 看做干扰。
此外，IA技术不仅可以基于信号向量设计，还可以基于信号尺度设计。当IA基 于信号尺度实现时，实质是将信道增益量化构成多维空间进行方案设计。但是，由 于无线信道的时变特性，信道变化难以精确跟踪，且局限于信道估计方案。所以，基 于信号尺度的IA技术在实用性方面较差。
IA技术可以在时域，频域，相域和空域等维度实现。时域的IA技术实现依赖于 传播延迟。所有的发送端发送信号，只发生在奇数时隙。但是由于距离和障碍物等 外界条件，这些信号到达接收端的时间不同。接收端接收有用信号也发生在奇数时 隙，在偶数时隙实现IA。每个发送端利用一半的时间发送有用信号，有效利用了时 域资源。实际上，频域的IA实现与时域IA类似，只不过该过程发生在频域，而不 是时域。频域IA相对于频分复用有效提高了频谱效率。相位IA实际也是依赖传播 时延实现的。众所周知，在信息传输过程中，传播时延导致了相位的变化。这时候, 就可以在接收端通过分析信号的相位将有用信号与干扰分开。本质上，相位IA利用 了信道衰落系数的相位。空域IA的实现有赖于发送端的联合编码。
2.2.2自由度
近年来，人们对于干扰信道的容量域的研究越来越关注。为了便于研究人员对 系统容量做定量研究，定义了 DOF的概念，可以表示为
Sim絳
p->oo]og(p)
其中，P代表SNR, C(p)则表示系统和速率。在这里，可以把DOF看做是传输过程 中，信号的维度。其中，每个信号维度可以看做是1个无干扰的AWGN信道，且当 发送信号的信噪比p趋于无穷时，该信道的SNR与p成正比增长。
2.2.3信号空间对齐
IA技术以其在干扰管理方面的优势受到越来越多的研究者的广泛关注，并被迅 速的引用到双向中继系统中。信号空间对齐技术是IA技术应用到双向中继系统的技 术，由Lee等人在文献卩1首次提出。假设在一个MIMOY的场景中，三个用户节点 通过中继节点进行通信，其中每个用户配备M副天线，中继配备N副天线。在通信 过程中，每个用户通过中继与其他两个用户分别进行信息交互，并接收来自这两个 用户发送的信号。信息交互过程需要两个时隙，就是所谓的MAC阶段和BC阶段。 在MAC阶段，三个用户节点同时向中继发送信号；BC阶段，中继节点接收到各个 用户发送的信号后，对其进行处理后广播给各个用户节点，用户节点接收信号后，利 用自干扰消除技术消除干扰并解码。信号空间对齐技术可以说很大程度上丰富了 IA 技术在双向中继系统中的应用，并且实现了最优的DOF。众所周知，在实际的无线 网络中，有很多基于MIMOY信道的通信场景，如ad-hoc网络和蜂窝网络等。所以, MIMO Y网络的研究就显得十分必要了。
信号空间对齐技术产生后，由于在提升系统DOF方面的突出表现，受到了研究 者们的广泛关注，并被引入多种多样的中继网络场景中，包括MIMOX、MIMO干 扰广播信道等等。
2.3本章小结
本章主要是对双向中继系统中的网络编码和干扰对齐技术的基础知识进行了概 括的介绍，主要目的是为了更好的理解接下来的中继传输方案中提出的新算法。首 先，介绍了网络编码的产生以及应用，并对基于网络编码的不同中继协议进行了介 绍。然后，介绍了干扰对齐技术的定义以及基本思想。对干扰对齐技术在中继系统 中引用，即信号空间对齐技术，作了介绍。这些基础技术的介绍，主要是从定义和应 用出发，便于更好的理解接下来中继系统的用户调度方案。

第三章 多用户双向中继系统中的机会干扰对齐
本章主要讨论K对用户间的双向通信系统，在该场景下，每个用户配备M根天 线，中继配备N根天线，且用户之间只能通过中继进行信息交互，而不能直接通信。 在这里，本章关注一个比较特殊的场景，即用户和中继的天线数量满足〈写。 在这种场景下，因为空间维度不足以支持信号对齐，因而传统的SSA技术不能实现。 本章提出了一项新的基于SVD技术的机会信号空间对齐方案，该方案通过联合波束 成型方案和用户选择技术实现。机会对齐的实现主要依托于MuD实现。然后，该方 案的性能通过在仿真平台实验其可达到的自由度DOF的以体现。通过一些仿真，可 以知道，本章提出的方案在和速率上得到一定程度的提高。
3.1引言
最近，双向中继系统以其提升系统频谱效率的优势受到工业界与学术界的广泛 关注，并应用于ad-hoc网络、蜂窝网络等多种实际场景中。将网络编码技术引入中 继系统后，一般的双向中继系统的信息传输通常分为两个阶段：即MAC阶段和BC 阶段。在MAC传输阶段，两个用户同时发射信号给中继；在BC阶段，中继接收到 信号后，对接收到的信号进行一系列操作，如最常见的AF和DF,在经过一系列的 操作后，中继将处理后的信号广播给两个用户。接收端在接收到信号后，消除自信 息的干扰，然后解码出所需信号卩］。MIMO因为能够显著提升误码率也被引入到中 继系统中卩？ 1。IA技术作为一项正在广泛受到人们关注的传输技术也被引入到中继 系统中，通过消除多用户干扰信道中的干扰，提升系统的D0F［?］。最近，一项新兴 的技术应运而生，即信号空间对齐技术SSA,该技术结合IA技术和双向中继技术并 在文献【?］中首次提出。在【?］中，为了获得最大的DOF,讨论了一种三个用户的场 景，这三个用户两两进行信息交互，又被称为MIM0Y系统。假设用户间的通信必 须通过中继才能完成。在第一个阶段，三个用户同时发射信号到中继，在中继端，用 户的有用信号和干扰分别对齐。在第二个阶段，中继进行PNC操作，并将处理后的 信号发射给接收的三个用户。通过联合设计每个用户的预编码向量，两个用户的成 对信号被对齐到一个子空间，这样，接收端在接收到信号后，首先消除干扰，然后将 成对信息中的自干扰信号消除，并对所需信号进行解码。注意到，只有每个用户配备的天线数量肱和中继的天线数量N满足N>	时，系统达到最优的DOF,即
可以知道，SSA技术是消除多用户双向中继系统中的干扰问题的一项有效地 手段，后来有很多学者对该技术进行了进一步的研究［???］。为了能够实现低复杂度 的更实际的应用，文献任1提出一种机会干扰对齐技术OIA,考虑一种K小区的单输 入多输出的信道。文献卩］中则考虑了三个用户的干扰信道，并证明，即使用户传输 随机波束成型形成的信号，只要接收端数量足够多以提供多用户分集使得干扰能够 被彻底消除，那么，也可以达到最优的DOF。文献卩］的作者考虑了一种多用户双向 中继系统，中继釆用AF技术的机会多用户分集场景，该场景下，中继配备多个天线, 通过简单的波束成型方案挑选用户对进行信息交互，从而提高系统的DOF性能和系 统吞吐量。提出信道对齐用户对算法和半正交信道对齐用户对算法，基于多用户分 集技术，对齐用户的信道并消除干扰。然而，文献卩］中只考虑了用户配备一根天线 的场景，因而，其系统性能的提升是受限的。在本章中，我们考虑一个多用户的双向 中继系统，中继采用AF技术并配备N根天线，用户间的信号传输必须通过中继得 以实现，用户配备M根天线。假设共有K对备选用户，且备选用户数量远远大于中 继的天线数量，但是中继的天线数量又不足以支持传统的SSA传输。正如我们所知, 当用户和中继的天线数量满足M三也尹条件时，我们从K对备选用户中随机挑选N 对用户进行信息交互，然后利用SSA技术就可以达到2M的DOF。然而，当天线数 量满足〈但尹时，SSA技术就不再适用了，因为此时天线能够提供的空间维 数就不够进行信号对齐了。本章提出一种新型的机会信号空间对齐技术，基于SVD 联合设计波束成型和用户调度方案。当用户数量增长速度远大于SNR速度时，系统 的DOF性能能够到达系统的最大可达DOF。
3.2系统模型
本章中，我们考虑一种多用户双向中继系统，在该场景下，中继配备N根天线 实施半双工AF方案，假设共有2K个备选用户，且每个备选用户配备M根天线，假 设用户间进行成对的信息传输，如图所示。用户之间必须通过中继成对的进行信息 传输。在这里，假设所有的信号都经历独立平坦瑞利衰落，且信道矩阵的元素都是 独立同分布的均值为0,方差为1的复高斯随机变量，即满足C”(0,l)。我们定义左 边的用户记做i，同时i + K记为右边用户的编号，且满足z■，丿￡{1,2,...,长}。用户i 与中继之间的信道表示为日弋时"。假设信道釆用时分双工方案，也就是说H卩代 表从中继到用户，'的信道。没对用户间的信息传输都被分为两部分：MAC部分和BC
图3-1 多用户双向中继系统

部分。在MAC部分，所有用户同时将信号发射给中继，在BC部分，中继对接收到 的信号进行处理，然后将处理过的信号广播给各个用户，接收端接收到信号后进行 解码。
在MAC阶段，从K对备选用户中挑选N对进行信息传输，即中继端挑选用户 i=l,2,..,N进行广播，中继端的信号可记做
N	N
=￡ H,x, + ￡ 且+网+爪 + nr,	(3-1)
i=l	i=l
其中，H,?是用户，到中继的NxM信道矩阵，n’cCNxi表示中继的加性噪声，且矩
阵中得元素满足独立同分布复高斯随机变量，也就是CX(0,l)o用户i发射的信号为
* =咐，	(3-2)
其中，为用户i发送的信号。马.代表&.的MX 1预编码向量。假设X/满足平均功率 限制E[| x(-|2]<Po中继接收到各个用户发送的信号后，在广播之前，首先对接收道 的信号用一个NxN的波束成形矩阵W进行处理。然后，中继在BC阶段将处理过 的信号Wy『广播给用户，且满足中继的传输功率限制EfTrfWy^W^} < Pr.用户 j接收到的中继广播的信号可以写作
yj = H；Wy, + nj,	(3-3)
其中，叼服从分布CAr(0,l)o令衅表示用户j端的波束成形向量，Uy是Af x 1向量, 则得到的信号可以写作
(N	N	\
% =时域W ￡凤旳+ ￡珥+庐"+11, +U所
\i=l	i=l	/
=殍盼 W(H沔十 %+**)	(3-4)
(
N	N	\
E ".+ ￡ 珥+e+k +%,
译 j	)
15 其中，fiy = u7HfWnr+uyny表示噪声。假设自干扰可以在接收端完美消除，则接收 端的信号可写作
勺=u河 W(H 沔+H*x*)	(3-5)
(N	N	\
E H.-X,?+ ￡ 用+財+沢 +%,
令%表示干扰，也就是说巧=u^HfW(￡終1,澎卢内+ ￡宵的H,?+KXj+K)。然后， 可以得到用户j的信干噪比SINR为	’
p| 贊 ws |\
7 K + ||w?h7.uj.||2+i，

3.3机会信号空间对齐
在这一小节中，首先介绍当中继和用户的天线数分别满足1〈啰和 M>^ 时系统的传输机制。提出的方案主要可以分为两步：首先是用户端的波束成 形设计，然后是中继的用户调度方案。在本章中，假设每个用户只传输一流数据，也 就是说d=l。这里主要考虑两种场景：用户与中继的天线数分别满足1SM〈呼 和具体来说，我们设计用户i的预编码向量为％和用户i + K的预编码向 量为v’+K，从而使得用户i和用户i + K编码后的信号向量能够对齐到一个方向，即 满足Hfvf和瓦+及巧+/在同一方向，即span(HjVj = span (Hi+^v/+A-)。如果这两个子 空间想要存在交集，则必须满足下面的条件
冋,-聘+』*	=0	(3-7)
_ *+K _
3.3.1 M>=(N+1)/2
当用户与中继的天线数量满足M>^,公式(3-7)有解。根据公式(3-7)可 知，通过对中继端的波束成形向量设计，可以使得每对用户想要传输的信号对齐到 一个方向上。首先，随机的从K对备选用户中挑选出N对进行信号传输。然后，我 们可以通过下式设计用户的预编码向量满足对齐条件，即
HjV, = Hi+N+K = Gf,	(3-8)

其中，Gj是Nxl向量。每个信道可以轻易的达到自由度N。
3.3.2 1=<M<(N+1)/2
当用户与中继的天线数量满足1 <M<^ 时，公式（3-7）不再有解，因而我 们不能再利用上述的方案对用户的预编码向量进行设计。也就是说，此时的信号空 间不能完美的对齐了。已经不能通过解公式「（3-7）进行预编码向量的设计。因而,
七+K
的信号在波束成形后能够尽可能的对养，这樺我们可以尽可能的达到与SSA方案相
「	-1 ||2
的最小值获得最近接0
的值，即

从而，预编码向量可以设计为




yi+K
C2MX1。在公式（3-10）中我们引入奇异值分解。智先，我们定义奇异值分解矩阵Aj 满足
(3-H)
其中,ReCNx2M 和 Q*2M 包含 2M 列正交的向量，且有	=diag	1, &.,2, ? . ., \2M）,
其中^! > A2,...,> A2Mo则最优的B,.可以写作
(3-12)
其中，（Qi）2M表示。的第2M列。可以得到

0然后，进行用户调度阶段。选择K对备选用户中相对来说比较对齐的M对。也就 是说，选择具有最小&的M对用户，可以写作
"min幻血⑷),
。在选择了 M对用户后，可以得到珥七.和Hi+对+及中的平均干扰向量，即卩]
G'=(臓紺(恥+5,*)/2,	(3-15)
认为上式为有效的信号向量，并定义G=[G1)...,GAr]e CNXN。
3.3.3中继预编码矩阵设计
为了限制中继端的传输功率，中继的波束成形矩阵W需满足E(Tr[Wyry^WH]} < P「，并写作
Tr [V^WHV + I^] =Pr,	(3-16)
其中,H = [H]，…,Hn,Hk+i,...,H/+n] ECNx2MN ?V = diagg,...,nn,v^+ivx+JV] € 矽MNX2MN。为了方便书写，定义Cj=HjVj。中继预编码向tw = PWHW,其中。是 功率控制系数。假设祈的第j列为Wj,且||Wj||=l。假设选择出的用户集合定义为 S = {1,...,N,K+1,...,K+N}, Sj = S/{j,K + j}.第，行可以表述为
譬￥ - ￡'	。-17)
II ck II
当￡为。时，中继可以完全消除对间的干扰。然而，根据实际情况，只能通过机会分 集使得￡尽可能的趋向于0。



3.3.4算法分析
从公式(3-7)可得系统的SINR,可以看出在高SNR情况下，对间干扰的功率 ]巧K成为限制/对用户的吞吐量的主要因素。它的上限可以写作
妍<
<
<
<
<
P&2 || c^W^WCj
PP2Tr [wCyCyW^WcycfW^
Pj32€2Tr [DAD，而湾衲] 尸伐2￡ HcJpTrfDWc^W^, 冋	L	」
(3-18)
p俨X ￡ || % ||2
keSj
X [ll Cj II2 +2(2V-l)e|| Cj II +(N_l)2q
其中，Cj= [Ci，...,Cn,Cn+i，...,Ck+n]/ {c》Ck+/} €CNx2(N-1)M,
O和方分别代表Nx2(N-l)M和NxN的全1矩阵。定义A为2(N-l)Mx
2(N-1)肱的对角矩阵，元素为||cH|2。简单地说，可以计算接收端j的||W%||2 的上界为
||	||2< 俨[|| q ||2 + (N— 1) e2],	(3-19)
接下来，根据文献卩】定义啊=]^細[，Z = 1，???，N，可以知道叩的累积分布函数为 1-(1-时I,概率密度函数为'
f<P (倒)=
(3-20)

那么(P的期望为


在一些处理后，可以得到E((p)MO°令2 =必，可以得到z的概率密度函数和期望W



可以得到E (&2)〈疋|命。这样，(3-24)可以写作
区|2 ＜仰2四一 1)旧緝)+2||c』| ||cj+k||]何(号)+四- 1)?|



値 ||2+||%那 < ||CLCH||2 + 2||c』|||Ci+K||
=人?+2値|| ||。+*||	(3-28)
然后，应用OSSA方案，SINR的下界为
p2Pdj
敞?+阵j+i
(R-n)p&
(渋 + %) (4 - N) + 2NI WjC』2 +1
其中,％=岬啰 W?WjHj+KV*| ,q=[|0||2+(N—1)2 糸]和与.=时||2+辭 假设K的增长速度比4P快，能够证明OSSA提升了系统的SINR和吞吐量，且此 时，％不为0.最后，对间干扰可以忽略，系统容量可以写作



当K足够大时，可以得到DOF为2N。然而，这并不意味着实际应用中DOF能够达 到2N。因而，在今后的工作中，我们将研究更实际的传输方案。
OSSA, CAPS, SAPS,随机ZF方案and最优ZF方案的和速率比较，这里K = 103,
N=10.
3.4仿真与分析
在这一节中，我们将给出多用户双向中继系统中的OSSA方案下的系统性能仿 真。这里，假设中继的天线数量N=10。我们给出图3-2,给出OSSA方案的多用户 双向中继系统的可达和速率随着SNR的变化的性能。在固定SNR下，随着备选用户 数量的增加，系统的和速率增加。这表明，当有更多的备选用户选择时，就有更大可 能从K对用户中选择出更容易实现信号对齐。当给定一定数量的K,在较低的SNR 条件时，系统的和速率随着SNR的增长基本呈线性增长，然而，在高SNR时，曲线 趋于平衡。因为当K不足够大时，能够提供的机会分集相对来说还是很有限的。在 理想情况下，假设爪足够大时，曲线在高SNR下，仍然可以线性增长。
接下来给出多用户双向中继系统中的OSSA方案在用户配置不同天线情况下的 系统性能仿真，如图3-3所示。在图中，［N,M］代表N对用户进行信号交互，每个用 户配置肱根天线。这里，假设总共有K=1000用户。可以从图中清楚的看到，随着 天线的增长，系统的和速率性能增加。当天线在适当情况下增加时，系统的系能得 以提高。我们将OSSA方案与传统的迫零方案（在图中用ZF表示）作比较，此时令 N = 10,如图3-3所示。在图中的ZF方案，共有5对用户相互传输信息，中继釆用迫 零处理，而OSSA方案，则是10对用户交互信息。可以看出，在高SNR下，可以达 到DOF为10。而在传统的ZF方案中，我们只能得到DOF为5。
3.5本章小结
在本章中，我们考虑了一种多用户的双向中继系统，且中继釆用AF方案，配备 N对用户，每对用户通过中继进行信息交互，且每个用户配备M根天线。我们考虑 了两种场景：用户与中继的天线数量分别满足1 <M<^ 和M2啰情形。当用 户与中继的天线数量满足〈哮时，在用户端可以使用传统的SSA方案。然 而，当用户与中继的天线数量满足M>^ 时，基于奇异值分解的OSSA方案被引 进系统中。通过联合设计用户的波束成形向量和用户调度方案，在中继使用简单的 迫零接收，可以有效的提升系统容量。当备选用户数量足够大时，可以达到的DOF 为2冲。

(C) 1994-2022 China Academic Journal Electronic Publishing House. All rights reserved.
第四章多用户双向中继系统的低复杂度用户调度设计
本章主要研究多用户双向中继系统的低复杂度用户调度设计，在该场景下，从 K对单天线用户中挑选L对用户通过中继进行用户对与用户对之间的信息传输，该 中继配备M根天线，在传输过程中，中继釆用AF的工作模式，并引入ANC技术。 首先，我们提出一种基于信道系数模值的简单用户调度方案，并命名为信道模值 (Channel Norm, CN)选择方案，该方案的实现复杂度非常低。然后，我们提出了一 个近似最优调度的基于信道模值与正交性CNO-A的调度方案，该方案中，中继需要 知道CSI并进行集中运算。值得注意的是，CNO-A方案能够达到接近最优调度的较 好的系统性能，且保证在较低的复杂度条件下完成。最后，本章提出一种分步CNO 的CNO-S调度方案，在该方案中，设定一个固定的阈值来平衡复杂度/CSI和系统性 能，CNO-S调度方案显著改善了中继的CSI开销和运算复杂度，在系统性能上略差 于CNO-A方案。
4.1引言
近年来，双向中继与多向中继方案以其显著提高系统和速率性能和频谱利用 率的优势受到了业界的广泛关注。该技术已经被应用于例如ad-hoc网络和蜂窝网 络中。NC技术在文献【?】中首先提出，用于提高无线网络的增益。文献【?］中 提出的物理层网络编码技术和文献［?］中提出的模拟网络编码技术能够显著提高双向 中继系统的和速率性能。PNC和ANC技术使得在两个用户间通过一个半双工的中 继进行同步信息传输得以分步完成，也就是我们常说的MAC阶段和BC阶段。在 MAC阶段，两个用户同时发射信号到中继端。接下来的BC阶段，中继在接收到两 个用户发射的信息后，将信息进行一些处理，然后把处理后的信号转发给两个用户, 常见的技术例如AF和DF等。接收端在接收到中继处理过的信号后消除自信息，最 后解码出想要的信号。
近年来，很多研究集中在多用户的双向中继系统中［??】，在这些研究的场景中, 通常是多对配备单天线的用户通过一个配备多天线的中继进行信息交互。在这些研 究中，用户对间的干扰无疑成为提高多用户双向中继系统性能一项巨大的挑战。因 而，ANC技术作为中继端一种独特的解码方式被引进到多用户的双向中继系统中,
由此中继端配备的电线得以更高效的利用。一些研究中将成对用户的信号对应到一 对正交的空间中，使得用户对间的干扰得以消除，同时利用ANC技术让每个用户 提取其想要得到的信号，同时消除其同伴的自干扰。值得注意的是，这些基本的传 输方案在某种程度上降低了系统能达到的DOF。但是，这种传输方案只有应用在特 定的SNR限定内，可以有效提高系统性能。为了解决这种问题，研究者们提出了许 多方案试图获得更优的系统性能。一些研究者将功率配置〔?］方案引入双向中继系统 中［??】，有效提高系统的性能，但是这种系统性能的提高是以牺牲复杂度和SER性 能换来的。此外，文献【？？？］中研究了中继选择技术，该技术是消除用户对间干扰的 一项有效途径，然而，该技术是基于存在较大数量的中继的情况下讨论的，且该调 度方案一般计算复杂度较高。波束成型技术〔？？］也是提高中继系统性能一项不容忽 视的技术，该技术通过优化用户端或中继端的波束成型提高系统性能，然而，该技 术的实现很多时候需要较高的计算复杂度。总之，功率配置，中继选择和波束成型 技术虽然可以提高系统性能，但是却是以牺牲系统的复杂度或SER为前提实现的。
正如我们所知，MuD是抵抗无线衰落一项重要的技术假设一个通信系统预 备使3个用户进行数据传输，而每个用户配备的天线数量是受到限制。通过精心设 计用户的发射信号，依旧能够得到显著的性能增益。在文献卩］中，基于MIMO交换 网络，考虑在传统方案和应用NC技术两种场景下提出最大速率方案和最大用户数 量方案来提升系统的和速率性能。然而，提出的这些算法，计算复杂度普遍比较高 且中继需要掌握所有用户的全局CSL对于实际系统，这些要求是非常苛刻不易实现 的。迄今为止，对于多用户双向中继网络的低复杂度用户调度设计依然少有学者涉 足，而我们已经对MIMO-Y系统卩］和MIMO多用户中继网络E的低复杂度用户调 度进行了深入研究。
在本章中，考虑多用户双向中继系统中的用户调度方案，在该场景中，假设从K 对配置单天线的用户对中挑选出乙对用户通过一个配置有M根天线的中继成对的进 行信息交互，且满足Nr>2L-l.为了进行有效的信息交互，在中继端引入ANC方 案把每对用户的成对有用信息对齐到相互正交的空间中。在本章考虑的场景中，假 设总的用户对数量比每次挑选的有效用户对数大很多，由此引入MuD提升系统的性 能。在这里，我们研究了该场景下的低复杂度的用户调度方案。首先，我们提出一 种非常简单的CN方案，该方案基于每个用户的独立信道系数提出。在这种CN方 案中，每个用户都掌握CSI信息，但是每次信息传输中，只有CN被反馈回中继系 统，因而基于CN方案的用户调度方案计算复杂度很低。然后，本章提出一种联合考虑信道系数模值与正交性的方案CNO-A,这种CNO-A用户调度方案通过联合考虑 成对信道系数模值和信号的正交性挑选有效用户对进行信息交互。CNO-A用户调度 方案需要中继端掌握全局的CSI并进行集中运算，达到近似于全局搜索的系统性能, 同时保证计算复杂度较低。最后，本章提出一种分步的CNO方案，即CNO-S方案。 在该方案中，首先假设一个固定的阈值来平衡复杂度/CSI开销和系统性能，每个用 户将自己的CN信息反馈给中继端，并基于一个固定的阈值完成一次粗选，然后中 继只需要在这些粗选出的用户对集合中，基于CNO用户调度方案挑选出有效的用户 对进行信息交互。CNO-S方案能够显著降低中继端的CSI开销和运算复杂度。仿真 结果和复杂度分析证明本章提出的这些方案是有效可行的。
4.2系统模型
在本章中，讨论一个多用户双向中继系统场景下的用户调度方案，系统如图4-1所 示。假设一共有K对待选用户且配备耳=1根天线，中继配备M根天线。从这K 对待选用户中选出乙对用户进行对与对之间的信息交互。中继端的天线数量满足 Nr>2L-U我们假设两个用户之间没有中继的协助不能直接进行信息交互。
在MAC阶段,所有的用户同时将信号发射到中继端。中继端接收到的信号可以 写作
L
yr = ￡ (hr,内 +hm+KX，+K)+*,	(4-1)
i=l
其中，站.是用户到中继端的Mxl信道向量。定义X,?为从用户，发 射到中继的Nx 1信号向量。假设用户，配备一根天线，那么其发射的信号可以认为 满足改=如 且满足平均功率限制E｛埠｝ =g,其中弓是每个用户端的功率限制值。 队是中继端的Nr x 1加性高斯白噪声AWGNo假设信道向量的所有元素都是独立同 分布复高斯随机变量，且满足CN%?)。
在BC阶段，中继端利用波束成型矩阵W e C5 处理接收到的来自各个用户 的信号，然后将处理后的信号广播给乙对备选用户，写作
r = 0Wy,，	(4-2)
其中r满足中继端的功率限制条件E{Tr[r产]} =R,且0满足功率归一化系数，可 表示为
「= jE{Tr[Wyr；rHWH]}，	(*3)
用户j,j=l,2,...,L接收到中继广播的信号为
yj = hiirr+nj,	(4-4)
其中顷为中继端到用户j的1 x M信道向量，且n;表示在用户j端的AWGN满足 C”(0,of)。为了提升系统的信道互惠性能，我们利用时分双工，即满足h,?,r = h*
4.3中继预编码设计
为了尽可能的消除用户对间的干扰，我们假设中继的预编码矩阵W = gf 其中wgcMxm,满足
=	(4-5)
其中，Wf G C'，xi表示预编码矩阵W的第i列，定义ft, e CNX0-1)满足片= 卜1,...,%._1,%+1,...,11啓],其中％.=%,瞄+』。在这种情况下，注意到，当 满足Nr>2L-l的条件时，公式4-5有解。然后，我们可以得到
'=J.Tr [WWRRWWH] ] G汁[可钠可啊，	(4'6)
通过这种方式，上行信道的的用户对间的干扰得以消除。这种中继预编码矩阵的设 计可以应用到其他的用户调度方案中。


当我们利用上述方案进行中继预编码矩阵的设计后，公式(4-4)可以被重写为
为=畔产+少
=h?.WWHyr+ny
=饷啊砂(hrjdj + hrJ+Kdj+K)
+Ph 名吧矽 ％ + nj.	(4-7)
然后，接收端消除自干扰并解码出所需的信号，可以写作
y；=伽啊砂瞄+旳+沢
+jBh名資再+勺，	(4-8)
其中，瓦=w^nr,且瓦 ~ CNQ b?).其中，瓦=w^nr,且瓦 ~ CJ\f(O,。 从公式4-8中，可以轻易得出在用户/端的SNR
旳附洲1
r,j+*|
02砰加与W『 + g?
明帆"h
切小啊「+*+*2’
其中，* =of4Tr［WWHHW可幻 旳二芳口 ［可卸神反］。最后，该系统的和速率 可以写作
1 L
R = 5 ￡ {log(1 + SNRi) + log(1 + SN%+k)}?	(4-10)
Zz=l
4.4用户调度方案
在本章中，假设备选用户对的数量远大于挑选的用于信息交互的用户对的数量。 我们从备选用户中挑选适当数量的可用用户进行信息交互来提高系统和速率。在这 一节中，我们将详细介绍三种低复杂度的用户调度方案以提升整个系统的性能。从 上一节中，我们已经得到每个用户端的SNR。通过观察公式(4-8)和(4-9),注意 到通过考虑信道强度和用户对间的干扰来挑选用户可以有效地提高系统的和速率。 正如我们所知，在每次传输过程中，利用信道间的正交特性可以消除用户对间的干扰。在本章中，我们提出了三种用户调度方案来降低中继端的运算复杂度和CSI开 销，且保证较好的系统和速率性能。为了便于下文的描述，在这里首先定义两个用 户集合：被选择的用户集合Si和备选用户集合77用来存储用户的标号。
4.4.1 CN方案
首先介绍最简单的CN用户调度方案，该方案主要考虑信道系数模值对系统性 能的影响。从公式（4-8）和（4-9）不难看出，信道增益对系统的容量有很大的影响。 基于此，我们提出了最简单的基于信道增益模值的CN用户调度算法。详细的CN用 户调度算法过程如下：
1）	初始化:设定&= ，% = {1,2,...,*}。
2）	计算：定义p,?为第z?对用户信道增益的度量标准，可以表示为
$z = arg
3 ）然后，前面定义的两个集合重新设定更新为§_1 U岳} T §和万_1 \ {Sl} T气。 重置1 = 1+1.
4）结束：如果满足1<L,重复步骤3）,否则结束算法。
当在双向中继系统中应用CN用户调度算法时，在MAC阶段，所有用户计算各 自的信道系数模值标准，也就是白，并将该模值标准Pj反馈给中继；中继在接收到 所有用户反馈的信道系数模值后，从中挑选出p,?最大的乙对用户进行信息传输。在 BC阶段，中继端经过一系列的操作后，将处理过的信号广播给用户。基于CN的用 户调度方案具有很低的运算复杂度，这对于实际应用来说是非常有意义的。由于只 考虑用户的信道系数模值，CN用户调度算法非常简单直接。然而，这也带来很大的 问题，因为只考虑了信道强度，而忽略了用户对间的干扰，CN算法的系统性能受到 很大的局限性。因而，我们提出一种近似于最优用户调度的算法，通过联合考虑用 户对的信道强度和用户对信号之间的干扰实现。
4.4.2 CNO-A用户调度方案
上一节中介绍的CN用户调度算法因为只考虑了信道强度对系统性能的影响, 而忽略了用户对间的干扰对系统性能干扰，所以虽然在复杂度上有很大的优势，但 是系统性能却受到局限性。基于此，我们提出一种接近最优用户调度的方案CNO-A, 该方案通过联合考虑用户对的信道强度和用户对信号之间的干扰实现较高的系统性能。该方案的设计可以分为两个步骤：首先，我们仍计算出每对用户的信道系数模 值标准Pi,并从备选用户对中选出具有最大P,?的那对用户；然后，我们从剩下的备 选用户中依次选出与已选用户的信号构成的空间最正交的那对用户，直到选够L对 用户为止。CNO-A用户调度算法的具体过程表述如下：
1）	初始化：设定 &）= ，% = {1,2,...,K}°
2）	设置』=1,计算第2对用户信道增益的度量标准向
Pi = min {||h』2, Ulf}, i = 1, . . ., K,	（4-12）
然后选择第一对用户
Si = arg max p（.	（4-13）
*=1
然后更新 S（）u{si}-To\ {^1} -7i 和瓦=1*罕],hr,S]+K o 为了方便表达，定乂 。1 =冲〃（座）。设置 1 = 1+1.
3）从剩下的备选用户集合7；_1中挑选一对与已选用户对形成的空间最正交的 一对用户，即满足
旬=arg.nux^ min {||瞄 * Q—旷,||临爪 *Q_i |「}.
然后这两个用户集合被重置为Si_i U岳} §和冗1 \岳} t 7；o添加h酣和如何+及 到矩阵珥的最后两列。设置R	和1 = 1 + 1.
4）结束：如果满足g乙，重复步骤3）,否则结束算法。
在所有的用户对将信号发送给中继以后，中继端基于信道强度首先选出用户信 道增益的度量标准最大的以对用户，作为基准。我们将选出的用户的信号空间视为 一个基准空间，然后从剩下的备选用户中选出一对与该基准空间最正交的用户，并 依次挑选直到用户对数达到需要的数量。通过这种方式，用户对间的干扰可以很好 的消除。相较于前面的CN方案，该CNO-A用户调度方案获得很大的和速率提升, 但是其运算复杂度却大大增加了。值得注意的是，在该CNO-A方案中，中继端需要 全局的CSI信息并进行集中运算，但是却得到了近似于全局搜索的性能。
4.4.3 CNO-S用户调度方案
CN用户调度方案因为只考虑了信道强度，从而实现在相对较低的的实现复杂度 情况下获得良好的系统性能，但是由于忽略了用户间的干扰其性能提升受到很大的


Candidate Users

图4-2 CNO算法的几何示意。例如，假设这里有两对用户}从爪对备选用户对中被挑 选出来。信道系数模值最大的用户对必用户对首先被挑选出来，并构成一个基准空间角。然后, 以每对用户投影到基准空间%上比较小的正文投影为衡量，我们挑选出投影最大的那对用户s2 0 CNO方案实现了每对通信用户间最大可能正交。
限制。所以我们提出CNO-A方案来弥补这种不足，通过联合考虑信道强度和用户 的干扰，这种方案达到近似于全局搜索用户调度方案的系统性能，但是中继端必须 获得全局CSI信息并进行集中运算，然而这在实际应用中是很难实现的。这样，本 小节提出一种分步的用户调度方案，即CNO-S用户调度方案来平衡容量性能和复 杂度/CSI开销。该算法的第一步与上一节中提出的CNO-A方案非常类似：基于信 道强度我们首先选出一对具有最大信道增益的度量标准的用户。接下来，CNO-S和 CNO-A最大的不同在于，在这里，我们定义一个固定的阈值在这个阈值确定以 后，下一步就是在剩下的备选用户中选出符合条件的一部分用户对，再从这些挑选 出的备选用户中挑出所需的用户对进行信息传输。这样的操作，使得中继不再需要 所有用户的全局CSL而只需要掌握符合条件的那些备选用户的信息。该方案的具体 操作步骤如下：
1）	初始化：设置 S（）= , % = {1,2,...,K},用=和 L<T<K.
2）	设定Z = l,计算每对用户的信道系数模值衡量标准Pi = min{||h』,||hw+K||2},
然后选择具有最大信道系数模值衡量标准p,?的那对用户作为第一队被 选出的有效用户，即勺=argmaXi=i,...,KP/ 设置	和
珥=&,瞄+』为了方面描述，定义Qi = g〃（H?）。令1 = 1 + 1.
3）	令卩=1。在第"次选择用户的过程中，选择信道强度最大的用户对，也就是 s” = argmax?j,_]Pi。然后，更新 R_iU{s“}tR, 7/z_i\（s//} -> 7J/ 和卩=尸 + 1。 如果满足l'<T,则重复步骤3）；否则，进入4）。
4）	在备选用户集合7；'中，选出一对符合下面条件的用户
力=arg,蜀x min {11 昭 * a _ 1『,11 hg+K * 紿 _ 1112 } .	(4-15)
然后，两个用户集合分别被重置为和7；'\｛勺｝ — 77。将h响和 瞄+K作为矩阵珥的最后两列。令Q,=冲〃(H?) , 1 = 1 + 1.
5)结束：如果满足1<L,重复步骤4)：否则，结束算法。
在CNO-S用户调度算法中，设置一个阈值来平衡实现复杂度/CSI开销和和速 率。这时，在中继端就不再需要所有用户的全局CSL而只需要掌握那些符合阈值条 件的部分用户的CSI。因而，这个阈值可以影响得到更好的系统性能或者更低的实现 复杂度。在该算法中，每个用户反馈CN信息给中继完成粗选，然后中继选出符合阈 值条件的备选用户，最后根据CNO方式从粗选用户集合中选择所需用户进行信息 交互。因此，CNO-S能够很大程度降低中继端的CSI开销和运算复杂度，同时达到 与CNO-A相近的系统性能。可以认为，CNO-S用户调度算法是CN用户调度算法和 CNO-A用户调度算法的结合。
4.5仿真结果与分析
在这一节中，给出了提出的用户调度算法的系统性能比较，这些仿真中，基于 下面的条件完成：假设有L = 3个所需用户对从K对备选用户中被选择出来进行信 息交互，且中继天线数量满足叫=2乙-1=5。假设每个用户都只配备一根天线，在 每次信息传输过程中，每个用户只能发射一流数据。假设每条链路都是快瑞利衰落 信道，为了简便每个信道矩阵都服从C”(O,1)。此外，令每个用户和中继的传输信 号功率为1,也就是4=4 = 1, bs = bfor，= 1,2,3。在仿真中，计算1x103次信 到实现的平均和速率。
在(4-3)中，给出了本章提出的三种用户调度方案与其他方案的和速率对比图。 其中，max-user scheme在文献卩］中被提出。其他的两个用户调度方案分别为：自由 选择方案RN和最优用户选择方案OPTS。所谓RN方案就是在备选用户中随机选择 所需的用户对进行信号传输，而OPTS方案则是按照轮询的原则，从备选用户中选 择所有可能的用户对组合并计算其和速率，最后选择和速率最大的那个组合确定为 进行信息传输的用户足组合。在这里，假设备选用户对数为K = 50, CNO-S中，阈 值数量设置为T = 6°如图4-3中的曲线所示，几种用户调度方案的和速率随着SNR 的增加而增加，其中，CNO-A用户调度方案获得比max-user方案略低的和速率，但 是却在实现复杂度上具有很大优势，我们将在下面给出。从图中可以看出，CN方案 的和速率性能并不是很好，只比随机选择调度方案略高，但是，其极低的实现复杂 度和CSI开销在实际应用中有很大意义。CNO-S方案的和速率性能在CN和CNO-A


……RM
~^-CN
-4"-CNO-S
CNO-A
Max-user[16]
——OPTS
方案之间，这里假设T = 7o如上一节中提到的，CNO-S方案的和速率是受阈值T影 响的，随着选定阈值T的变化，在下面的讨论中，我们会具体研究『的性能。
在图4-4中，给出提出的三种用户调度方案的和速率性能随着备选用户数目增加 的变化情况。假设需要从备选用户中选出三对用户进行信息传输。其中，CNO-S方 案需要特别对待，阈值T的值是随着备选用户数目而变化的，从而达到一种相对稳 定的变化趋势。假设在不同的备选用户数目K= [20,40, 60, 80,100,120,140]下，对 应的阙值数目为T = [6,7,8,9,9,9,9]。图中给出的结果可知，当备选用户数目K不 是很大时，三种调度方案的和速率随着备选用户数目的增加而增加，但是，当备选用 户数目达到一定的数量时，和速率曲线趋于稳定，且不同的用户调度方案之间保持 一定距离不再变化。我们给出CN0-S调度方案，其和速率性能随着阈值T的增加而

变好。给定备选用户的对数为K = 50,而阈值的取值为『 = 4,6,8,12。由图4-5可知, 当T>8时，随着阈值的增加，系统的和速率增加就越来越不明显。此外，当T = 0, CNO-S调度方案退化为CN方案，而当T = K时，则演变为CNO-A方案。
基于很多次实验，我们列出了一个表来评估在不同的备选用户数目下，不同的 阈值大小对系统性能的影响。首先，我们定义一个给定和速率为10dB时，与其相差 0.2dB时，阈值『的取值。仿真结果给出随着备选用户数目的直线增加，阈值T只 需要增加很小的数目。当备选用户数目非常大时，我们即使从较少的粗选用户集合 中选择也能达到相近的性能。我们还计算出了一个百分率这就意味着，即使备 选用户K非常大时，也能选择相对较小的阈值T达到相近的系统性能。从图中可以 看出，当备选用户数目K达到80时，系统性能就基本趋于稳定。所以，表1中给出 的备选用户数目足够。
最后，我们做出一个表格2粗略的计算用户和中继端的计算复杂度以及CSI开 销情况。给出提出的三种用户调度方案的浮点计算复杂度。同时，我们还给出了不 同用户调度方案时用户和中继端的CSI情况对比。从表二中可以看出，CN方案的 复杂度是最低的企鹅集中在用户端。两种CNO方案的实现复杂度均低于max-user 方案。此外，max-user的调度算法中继承担了所有计算功能，而本章提出的CN和 CNO-S算法则是分布式的。在CN和CNO-S调度方案中，中继不再需要所有用户的

表4-2 中继和用户处的运算复杂度和CSI情况。
Complexity
中继	用户
CN
CNO-A	O((K + L)Z?)	无
CNO-S	。即+（7 +乙）乙3）
Max-user	。0+1)乙4)	无
CSI
中继	用户
CN	反馈	本地CSI
CNO-A	全局CSI	无
CNO-S	反馈和T对用户的
CSI	本地CSI
Max-user	全局CSI	无

全局CSI。这对于工程应用是非常有意义的。
4.6本章小结
本章研究多用户双向中继系统中的低复杂度用户调度问题，考虑K对用户从多 对单天线备选用户中选择出，经过一个多天线的中继进行信息交互。本章中，提出三 种用户调度方案：CN, CNO-A和CNO-S,这三种用户调度方案主要关注降低中继 端的计算复杂度和CSI开销。基于简单的信道强度的CN方案的系统性能相对较低 但是拥有极低的实现复杂度，且中继不必掌握全局CSI。CNO-A方案通过联合考虑 信道强度和用户间干扰能够得到相对较好的系统性能，但是这种性能提升确实以牺 牲运算复杂度和CSI开销实现的。最后，为了平衡系统性能和实现复杂度我们提出 CNO-S方案，该方案引入一个固定的阈值实现。虽然其系统性能不能达到最优，但 是可以在相对较低的复杂度情况下达到较高的和速率性能。如何在较低的复杂度下 实现更好的系统性能值得接下来继续研究。


第五章无线信息与能量传输系统中基于容量最大化的用户调度
在本章中，考虑一种无线信息与能量传输系统，这是一种经典的能量收集场景。 在该场景下，本章考虑了一种中继选择场景，即成对的用户通过中继节点进行信息 交互，在同一时隙中，只有一个中继从一系列备选中继中被选出，而其它中继则在 该时隙不工作，在下一个时隙重新进行中继选择。本章主要设计一种能够使得系统 在长时间内能够达到平均最大容量的中继调度方案，同时中继能够尽量少的使用能 量。因为此时也将中继需要的能量收集考虑上，在目标函数中引入一个二进制的系 数，这样使得目标函数成为一个非凸的优化问题。通过对二进制约束进行松弛，原 问题能够转化成一个凸优化问题。为了减少运算的复杂度，提出一种低复杂度的次 优方案。本章提出的最优算法最大化了系统的平均和速率，同时尽可能的减少从中 继中收集的能量。最后，给出一些仿真结果以证明所提算法的有效性。
5.1引言
近年来，工业界对于电池支持的无线通信设备需求越来越大。然而，能量储存容 量却因为电池而大大受限。EH技术的出现为延长无线设备的续航能力提供了一项有 效技术。传统的EH技术主要从周围环境中进行能量的釆集，如光能和风能等卩？］。 然而，这些技术有时候并不能应用于无线设备，比如没有接口等。为了解决这一问 题，人们提出一项新的能量收集技术，它从RF中收集能量【？】。该技术能够使设备 只有很小的能量需求来保证正常运行，能够自身提供持续的能量支持。迄今为止, 已经有很多研究者对RFEH技术进行了深入研究卩???h作为众多EH技术中的一 员，SWIPT技术在文献［??］中被首次提出，并受到学术界的广泛关注。因为，这种 SWIPT系统的接收回路假设能够同时进行EH和IDo最初的SWIPT系统研究主要 集中在简单一对源节点和终端的场景，EH和ID过程在接收端交替进行［?］。后来, 文献卩］中，对MIMO系统中的波束成形进行了研究。除了简单的一对源节点和终端 场景的研究，SWIPT传输方案还被应用到很多其他场景中［???】。比如两个用户间的 距离非常远，必须通过中继支持进行信息交互的无线通信场景卩？］。为了提高系统 性能，用户调度方案也被引入到SWIPT系统中。文献分别主要研究如何提高多用户SWIPT系统中的中断概率和系统吞吐量。中继选择技术也是一项提高系统空间 分集的有效手段［???】，中继选择技术能够优化给定能量约束的信息传输性能。在文 献【?］中，作者提出一种在源节点顺序优化中继选择协议的算法。值得注意的是，在 这里，选出的中继进行EH或者ID,而其他用户接受到了能量但是并没有进行接收。 因而，在这里，我们考虑了一种所有到达中继的能量都不被浪费的调度方案。本章 中，我们考虑一种三个节点的SWIPT场景，其中，一对源节点和终节点通过中继进 行信息交互，该中继从很多备选中继中被挑选出来。假设包括用户和中继的所有节 点都只配备一根天线。在设定的场景中，同一时隙内，被选择的中继进行信息传输, 同时其他没有被选中的中继进行能量收集。本章中，考虑一种长时间的平均状态。此 外，假设所有的中继都掌握用户的完美CSI。我们提出一种最大化长期平均系统和速 率，同时考虑能量收集约束的中继调度方案。一个二进制的系数被引入到目标函数 中，使得目标函数成为一个非凸的优化问题。通过对二进制约束的松弛变换，原始 问题可以转化为一个凸优化问题来解决。为了解决该问题，引入Karush-Kuhn-Tucker (KKT)条件。然而，这种最大化和速率的方案计算复杂度比较大，因而，我们又提出 一种考虑局部最优的次优方案，其复杂度得以降低。最后，仿真实验结果验证了所 提方案的有效性。
5.2系统模型
系统模型如图5-1,假设信息从源节点发出，源节点表示为S,通过一个中继用* 发送到目的节点，用。表示。在一个时隙中，中继节点从半双工的备选中继节 点Rk,k = l,2,--- ,K,中挑选出来，同时其余的中继不参与信息传输过程，而进行能 量收集。假设包括用户和中继的所有节点都只配置一根天线，并且源节点和目的节 点之间没有直通链路。假设共有T个时隙，每个时隙的信息传输都可以分为两个阶 段：在第一个阶段，源节点S发射信息到所有的中继；然后，中继接收到信息后进行 判断由哪一个中继进行信息解码并选出进行信息传输，同时其他中继将接收的能量 进行收集。最后，源节点对中继广播的信号进行解码。假设所有的中继都知道用户 完美CSh令紘表示在时隙f, t =	时，源节点到中继R事=1,2,…，K的
信道向量，gZ表示从中继瓦，k=l,2，…，K,到目的节点的信道向量。假设所有的 信道都服从独立同分布的准静态瑞利衰落。注意到在一个时隙内，信道状态保持不


图5-1 SWIPT系统图
变。中继用接收到的信号可表示为
4 = /im+〃i，*=l，2,???,*,
其中，，是S的信号传输，发射的能量为e[|，|2]=R.。表示加性白高斯噪声，服 从4~CN(O,呼)，所有链路的噪声功率限制假设是一样的。从K个备选中继中挑 选出一个进行信息交互，其余的中继进行能量收集。中继禺收集的总能量可以写作

其中，ek, 0 < ^ < 1为中继母的能量吸收系数，这里噪声功率可以忽略。在广播阶 段，选择的中继将信号Hjr*发射给目的节点，其中信号人在中继端加上了一个幅值 系数吶，哒可以表示为
Wt = . / ,浅	,k = 1,2, , , , , K,	(5-3)
V网紐+E
其中，琮为中继舟的功率限制。在时隙f = i,2,---,r,中继耳接收到的信号然 后被发送给目的节点D,然后可以写作
=戒怵方# +	1,2，…，K,	(5-4)
其中，淤表示AWGN,且服从癒~们\<(0,席)。因此，经过中继&?，从S到。的

信号SNR为 系统的最大可达和速率可以写作

q = §log(l + SNRL),	(5-6)
其中，系数*由中继传输信号的时隙决定。
5.3中继调度算法
下面，提出一种最优最大化平均和速率的OMAS方案，该算法在EH约束下最 大化系统长期的平均吞吐量。由于OMAS方案的计算复杂度很高，本章还提出一种 复杂度相对较低的次优最大化平均和速率方案POMASo
5.3.1最优最大化平均和速率用户调度方案
在这一节中，考虑OMAS中继调度方案，该方案主要研究最大化长期的系 统平均和速率，且该系统是受约束于一对源节点到目的节点的能量收集条件的 SWIPT系统。在这种机制下，从备选中继中挑选出一个最大化容量的中继来传输 信息，同时其余的进行能量收集。在这里，第，个时隙，定义一个二级制辅助变量
羨，t =	变量冬满足：当k = k*时，有童=1；当略,
妒=1,…，K时，［ = 0。这样，可以定义一个长期的平均和速率，写作
(5-7)
其中，己是所提方案的优化目标。然后，中继平均能量收集的总和可以写为

在最小所需能量消耗的约束下，C的最大化问题能够表达为
max C
时r
s.t. flj [e{0,1},$ = ],???,r,k = i，…，k	(5-9)
?2 壬礎=	= …,T，kf …,K
k=l
a3 Er < S
约束的系数灼和。2式用于保证每次传输过程中，只有一个中继被选择，同时其他
剩余的中继对源节点发射的信号进行能量釆集。是中继最小所需的能量。假设

￡r=」(K-l),其中/定义为每个中继所需的最小能量收集。约束系数叫3是为了保 证平均收集的能量不小于与。然而，我们注意到变量[的约束系数灼是一个二进制 数，这使得目标函数是一个非凸优化问题。为了使这个非凸优化问题转换为凸优化 问题，将二进制变量冬进行松弛，因而《满足原问题就等效于
min -C
时,'
s.t. b\ < 1>^ = !)■■, > T, k — !；?,,, K
b2 -終OJ = 1,?"/=1,…，K	(5-10)
b3 ￡，心撰=1,…，T,k=l,…，K
k=l
b4 er<e
然后，我们证明当節是二进制数的时候(5-10)的优化问题能够求解.这样，我们 通过解决(5-10)从而解出(5-9)? (5-10)能够通过解决对偶问题的方式来进行解答。 (5-10)的拉格朗日形式可以通过加入非负的拉格朗日系数V],论Q和〃对应约束饥, 皈缶和为，写作
乙(麋,
r_>0° r t=U=l
+ ￡￡咗(《-1)	(5-ii)
f=l k=\
T K
-￡￡溷
r=U=l
+ ￡ 为‘ (￡〈芸 - 1) + 〃(￡r T), t=i V=i /
其中，拉格朗日系数满足^>0,v|>0,^>0和TJN0。为了得到最优的中继选择 方暮 我们讨论在一个时隙f内的拉格朗日过程。应用KKT约束优化(5-11),满足 迎喘也1 =岑+ vf+X 吟=0,	(5.12)
坟 20,*Z0/=l,2，…，K,	(5-13)
v? —1) = 0/=1,2，…，K,	(5-14)
Yk，k = 0,k=l,2,-,K,	(5-15)
当从备选中继中选出一个中继后，用妒来表示该中继，同时，选择系数满足§妙=1。 此外，未被选择的中继的选择系数满足a = G,k产k*。然后，约束条件(5-14)和(5-15) 能够得到攻=0,1尹k*,和止=0=这样，我们将这些约束代入(5-12)
= 一冬 + **+为+ 〃扌=0,	(5-16)
灭~ = _号_%： + 人+ 门学=0, & =1,…，孩 * 尹**?	(5-17)
接下来，定义一个衡量函数
I\* =『M*+尢)=Q* —乃以*,	(5T8)
rk = T^~Yk) = Ck- T]Ek.	(5-19)
通过将(5-19)代入到(5-18),可以得到吳—D = 7(攻* +外)。根据拉格朗日约束, 可以得出攻*+及2 0，也就是说，当k^k*时，> rAo当0 <#< 1时，互补松 弛条件可以写作昨=阪=0和* =为*=0。这样,「k* =『k的概率就是0.从而，当 k,k*时，rF > rk,冬的规则可以表达为冬=「'说= max,.=i,...,K"。这样，原
I 0, otherwise
始的优化问题可以转换为畠的问题，通过松弛以后是紧的.可以得到中继的选择规 则为
k* = arg max R
k=l,.\K
=arg max (Ck-ri*Ek),	(5-20)
,K
其中，if是满足(5-12)的最优解。变量1?*是由信道状态决定的。通过迭代算法，可
以得到T?*。详细的过程可以描述如下：
第一步：首先，我们定义一"0。
第二步：在第i, i = l,2,…，轮挑选中，产生一个信道集合。利用好计算出眞。
中继#*可以通过(5-20)挑选出来。
第三步：然后，得到平均的收集到的和能量￡。
第四步：变量?]*通过吁汁1 = max｛好+ (乌-￡)。,0｝进行更新，其中Q表示步 的大小。
第五步：如果，塗趋于收敛，迭代在TJ* = 7],+1时停止。如果不收敛，更新 i = i+b重复步骤二。
址的收敛性能从下面的仿真图中看出。
在得到变量〃*以后，信号传输中继能够通过（5-20）轻易的选择出来。值得注 意的是，要完成OMAS算法下的信息传输，由于存在迭代过程其计算复杂度是很高 的。因而，我们考虑了一种相对较低复杂度的中继调度方案，叫做POMAS方案。下 面我们将详细介绍。
5.3.2分步最大化平均和速率用户调度方案
为了降低中继选择的复杂度，本章还提出一种POMAS中继调度方案。我们的 基本原则是在消耗最小中继收集能量的约束下最大化系统的和速率。所以，首先我 们挑选一部分能够使系统达到更大和速率的中继。然后，中继选择过程在这些选出 的中继集合中进行，同时，其余的用户进行能量收集过程。
POMAS算法的具体实现表述如下：
第一步：首先，定义一个集合Ao =保存选出的中继索引号，集合=	…,K}
和中继的阈值数量瓦）。
第二步：计算所有链路的平均和速率为G = limrT8*q。
第三步：在第i,	轮选择中，选出符合下面式子的中继
/ = arg 尸營 ％,	（5-21）
更新聆 \ T &i+l,泌 Ci t A，+i 和 i = i+1。
第四歩：如果i<K0,重复步骤三；否则进入第五步。
第箱步：在集合A临中的中继中，计算变量可*,并选岀最佳信息传输中继
r = arg max （/ -炉以），	（5-22）
值得注意的是，变量科是受限的。集合A%中选出的中继必须满足一些能量约 束。因而，最小所需的收集能量需要满足弓式min矽，i6 A临。POMAS中继调度方 案的具体操作如上所示。通过设置一个中继数量的阈值瓦），计算的复杂度可以有效 降低。此外，不需要掌握所有可能链路的完美CSL在选择过程中，中继禺只需要 变量|te|2并计算出平均和速率任。Q可以视为反馈发射到发射端。通过衡量弓



图5-3	所提两种算法的和速率性能随着最小平均所需能量f比较.
选择部分该标准较大的中继组成一个集合作为最佳传输中继选择的备选集合。新集 合中的中继完美CSI是需要掌握的。
5.4仿真与分析
在这一小节中，我们给出一些仿真实验的结果来证明所提出的理论，并分析了 所提算法的系统性能。为了简单起见，假设所有节点的噪声能量都是一样的，即满 足E = 源节点的发射功率为一个单位，也就是己=1。假设所有中继的功率 约束都为1,也就是说满足珠=1,上=1,2，…，K。中继的能量吸收率为缶= 0.5, k=l,…，K,且SNR = 20dBo我们计算1 x揷次信道实现的平均和速率。首先，研 究变量的收敛性。中继的数量假设为K = 5°变量的收敛特性如5-2所示。当收敛 的次数足够大时，变量〃趋于收敛。如图5-2所显示的那样，随着爪的变化，矿也 随之改变。


然后，我们给出当中继数量为N = 5时，所提中继调度算法的平均收集和能量 与和速率性能，分别如5-3和5-4所示。假设中继数量的阈值为瓦）=4和瓦）=3。传 输过程所需的最小能量为》=六爪-1）。5-3给出，在0MAS和POMAS用户调度方 案下,随着每个中继f = Er/（K-l）的最小所需收集能量增长，系统的和速率随着降 低的特性。注意到，随着f的增长，OMAS方案能够获得更高的和速率。变量瓦）的 取值同样会影响系统的性能。Ko的取值越大，获得的和速率性能也就越好。5-4给出 随着变量/?的增长，收集到的能量也随之增长。但是，POMAS用户调度方案可以获 得更好的收集到的和能量性能。通过比较5-3和5-4,可以知道，容量和能量之间存在 性能折中。通过牺牲系统能够收集到的能量，可以获得更好的系统和速率性能，反 之亦然。当系统釆用POMAS时，系统的和速率性能较差，而采用OMAS方案时, 系统获得的和速率性能更好。5-5和5-6分别给出了在不同的备选中继数量的情况下, 两种算法的和速率性能和收集到的和能量性能。假设每个中继所需的最小和能量为 弓/（爪- 1） = 0.42。5-5所示，随着N的增长，系统的和速率性能随之增长。但是当N


的数量达到一定大时，曲线趋于平稳，且两种算法的性能曲线直接形成一个平稳的 间隔。当釆用OMAS中继调度方案时，系统能够获得更好的和速率性能。5-6证明, 随着N的增长，收集到的和能量基本呈线性增加。且釆用POMAS中继调度算法时, 系统可以获得更好的收集和能量性能。比较5-5和5-6可以得出，和速率和收集的和能 量之间存在性能折中关系。
5.5本章小结
本章中，考虑了 SWIPT场景中的两种中继调度方案，在该场景中，只有一对源 节点和目的节点通过选出的一个中继进行信号传输，其他未被选中的中继进行能量 釆集。提出OMAS方案来提升一段时间内系统的平均和速率，且此时受最小所需釆 集能量的约束。为了减少复杂度，将OMAS方案进行改进，提出了 POMAS方案。 仿真结果表明，在一段时间内，系统的平均和速率和平均收集的能量存在折中关系。 值得注意的是，本章只考虑了最简单的场景，而实际中则是更复杂的场景，因而，更 复杂的能量收集技术研究将在未来的研究中进行。

第六章总结与展望
6.1论文总结
本文主要研究了双向中继系统的用户调度问题，分别讨论了在多用户双向中继 中的基于机会干扰对齐的用户调度算法设计，多用户双向中继系统中的低复杂度用 户调度方案设计以及能量传输下的中继调度算法。现将本文的主要研究内容总结如 下：
对于多用户的双向中继系统，且中继采用AF方案，配备N对用户，每对用户 通过中继进行信息交互，且每个用户配备M根天线。我们考虑了两种场景：用 户与中继的天线数量分别满足1 V M〈啰 和M N零 情形。当用户与中继的 天线数量满足〈啰时，在用户端可以使用传统的SSA方案。然而，当 用户与中继的天线数量满足M>^ 时，基于奇异值分解的OSSA方案被引进 系统中。通过联合设计用户的波束成形向量和用户调度方案，在中继使用简单 的迫零接收，可以有效的提升系统容量。当备选用户数量足够大时，可以达到 的DOF为2N。
针对多用户双向中继系统中的低复杂度用户调度问题，考虑K对用户从多对单 天线备选用户中选择出，经过一个多天线的中继进行信息交互。本章中，提出 三种用户调度方案：CN, CNO-A和CNO-S,这三种用户调度方案主要关注降 低中继端的计算复杂度和CSI开销。基于简单的信道强度的CN方案的系统性 能相对较低但是拥有极低的实现复杂度，且中继不必掌握全局CSI。CNO-A方 案通过联合考虑信道强度和用户间干扰能够得到相对较好的系统性能，但是这 种性能提升却是以牺牲运算复杂度和CSI开销实现的。最后，为了平衡系统性 能和实现复杂度我们提出CNO-S方案，该方案引入一个固定的阈值实现。虽然 其系统性能不能达到最优，但是可以在相对较低的复杂度情况下达到较高的和 速率性能。如何在较低的复杂度下实现更好的系统性能值得接下来继续研究。
针对SWIPT场景中的两种中继调度方案，在该场景中，只有一对源节点和目的 节点通过选出的一个中继进行信号传输，其他未被选中的中继进行能量釆集。 提出OMAS方案来提升一段时间内系统的平均和速率，且此时受最小所需采集能量的约束。为了减少复杂度，将OMAS方案进行改进，提出了 POMAS方 案。仿真结果表明，在一段时间内，系统的平均和速率和平均收集的能量存在 折中关系。值得注意的是，本章只考虑了最简单的场景，而实际中则是更复杂 的场景，因而，更复杂的能量收集技术研究将在未来的研究中进行。
6.2后续工作展望
本文主要研究了双向中继系统中的低复杂度用户调度问题。虽然这些方案能够 以较低的实现复杂度获得较好的系统和速率性能，但是还存在某些不足，后续还可 以进行更加深入的研究。现将本文中有待解决的一些问题和相关的潜在研究方向总 结如下：首先，在多用户双向中继系统中，在不能进行完美信号对齐的情况下，本文 虽然讨论了机会信号对齐的用户调度方案，但是，该方案的性能提升有限，且对用 户对数的需求有一定要求，在接下来的研究中，应该考虑如何实现在尽可能对齐的 条件下，实现系统性能的进一步提升，且放宽对于备选用户数的要求，更有利于实 际应用。然后，在多用户的双向中继系统传输中，本文考虑了低复杂度的用户调度 方案以满足实际应用的需求，但是，从仿真实验可以看出，所提方案虽然复杂度有 较强的提升，但是在性能方面却没有明显的优势。虽然，性能提升和复杂度降低不 可能同时达到，但是，如何取得最好的性能折中，实现系统尽可能优化，是将来研究 的方向。最后，在SWIPT场景中，本文提出了中继调度方案实现能量和值息的同时 传输。虽然，本文提出的方案，通过传输过程中加入中继调度，能够提升系统的性 能，但是如何实现能量和信息的更高效率传输，是接下来研究应该关注的问题。


参考文献
[1]Hossain E, Rasti M, Tabassum H, et al. Evolution toward 5G multi-tier cellular wireless networks: An interference management perspective]J]. IEEE Wireless Communications, 2014, 21(3): 118127.
[2]Chen S, Zhao J. The requirements, challenges, and technologies for 5G of terrestrial mobile telecommunication[J]. IEEE Communications Magazine, 2014,52(5): 36-43.
[3]Mitola J, Guerci J, Reed J, et al. Accelerating 5G QoE via public-private spectrum sharing] J]. IEEE Communications Magazine, 2014, 52(5): 77-85.
[4]R Ahiswede S L R W YN Cai. Network information flow[J]. IEEE Transactions on Information Theory, 2000,46(4): 1204-1216.
[5]AJ Paulraj R H DA Gore. An overview of MIMO communieations - a key to gigabit wireless[J], Proceedings of the IEEE, 2004,92(2): 198—218.
[6]D Gesbert DSPS ANM Shafi. From theory to practice: an overview ofMIMO space-time coded wireless systems[J]. IEEE booktitle on Selected Areas in Communications, 2003,21(3): 281-302.
[7]A Goldsmith N J S V SA Jafar. Capacity limits ofMIMO channels] J]? IEEE booktitle on Selected Areas in Communications, 2003, 21(5): 684-702.
[8]S Vishwanath A G N Jindal. Duality, achievable rates, and sum-rate capacity of Gaussian MIMO broadcast channelsfJ]. IEEE Transactions on Information Theory, 2003,49(10)^2658-2668.
[9]H Weingarten S S Y Steinberg. The capacity region of the Gaussian MIMO broadcast channel[A]. // in Proc. IEEE ISIT[C]. 2004: 174.
[10]Ganesan R, Weber T, Klein A. Interference Alignment in Multi-User Two Way Relay Networks!A]. // Vehicular Technology Conference (VTC Spring), 2011 IEEE 73rd[C]. 1-5.
[11]Lee N, Lim J B, Chun J. Degrees of Freedom of the MIMO Y Channel: Signal Space Alignment for Network Coding[J], IEEE Trans. Inf. Theory, 2010, 56: 3332-3342.
[12]Zhang S, Liew S, Lam R Physical layer network coding[A]? // Proc. Ann. Int. Conf, on Mobile Computing and Networking[C]. 2006: 63-68.
[13]"e K j, Sung H, Park P, et al. Joint optimization for one and two-way MIMO AF multiple-relay gystem[J]. IEEE Trans, on Wireless Commun. (TWC), 2010, 9(12): 3671-3681.
[14]Gao H, Su X, Lv T, et al. Joint relay antenna selection and zero-forcing spatial multiplexing for MIMO two-way relay with physical-layer network coding[A]. II IEEE Global Telecommun. Conf. (GLOBECOM 2011)[C], Houston, TX, USA: 2011: 1Y?
[15]Jafar S, Shamai S. Degrees of freedom region of the MIMO X channel[J]. IEEE Trans, on Inf Theory (TIT), 2008, 54(1): 151-170.
[16]Lee N, Lim JB. A novel signaling for communication on MIMO Y channel: signal space alignment for network coding[J]. IEEE Int. Symp. on Inform. Theory, 2009: 2892-2896.
[17]Lee N, Lim JB. A novel signaling for communication on MIMO Y channel: signal space alignment fbr network coding[J], IEEE Trans, on Inf. Theory, 2010, 56: 3332-3342.
[18]Lee K, Lee N, Lee I. Feasibility conditions of signal space alignmet fbr network coding on k-user MIMO Y channel]J]. Proc. IEEE Inf. Conf on Commun. (ICC), 2011: 1-5.
[19]Ganesan R, Weber T, Klein A. Interference alignment in multi-user two way relay tletworks[A]. // Proc. IEEE Veh. Tech. ConE (VTC)[C]. 2011: 1-5.
[20]Long W, Lv T, Gao H, et al. Interference alignment for multi-user multi-way Relaying X Net- works[A]. // Proc. IEEE Veh. Technol. Con￡ (VTC)[C]. 2012: 1-5.
[21]Jung B, Shin W Y Opportunistic interference alignment for interference limited cellular tdd up- link[J]. IEEE Commun. Lett., 2011,15(2): 148-150.
[22]Lee J H, Choi W, Love D J. On the optimality of opportunistic interference alignment in 3- transmitter MIMO interference channels[EB/OL].
[23]Jung D, Clerckx B, Nam S Sung, et al. Opportimistic multiuser two-way amplify-and-forward relaying with a multi antenna relay[EB/OL].
[24]Ding Z, Wang T9 Peng M, et al. On the Design ofNetwork Coding for Multiple Two-Way Relaying Channels]J]. IEEE Trans. Wireless Commun., 2011,10(6): 1820-1832.
[25]Yilmaz E, Zakhour R, Gesbert D, et al. Multi-Pair Two-Way Relay Channel with Multiple Antenna Relay Station[A]. // 2010 IEEE International Conference on Communications (ICC)[C]. 2010: 1或
[26]Host-Madsen A, Zhang J. Capacity bounds and power allocation for wireless relay channels[J]. IEEE Trans, Inform. Theory, 2005, 51(6): 2020-2040.
[27]Joung J, Sayed A. Multiuser Two-Way Amplify-and-Forward Relay Processing and Power Control Methods for Beamforming Systems[J], IEEE Trans. Signal Process., 2010,58(3): 1833-1846.
[28]Zhang R, Liang Y C, Chai C C, et al. Optimal beamfbnning for two-way multi-antenna relay channel with analogue network coding[J]. IEEE J. Sei. Areas Commun., 2009,27(5): 699-712.
[29]Jing Y A relay selection scheme for two-way amplify-and-forward relay networks [A]. // Int. Con￡ Wireless Commun. Signal Process., 2009. WCSP[C]. 2009: 1-5.
[30]Atapattu S, Jing Y9 Jiang H, et al. Opportunistic relaying in two-way networks[A]. //2010 5th Int. ICST Conf Commun. and Networking in China (CHINACOM)[C]. 2010: 1-8.
[31]Hwang K S, Ko Y C, Alouini M S. Performance Bounds for Two-Way Amplify-and-Forward Relaying Based on Relay Path Selection[A]. // IEEE Veh. Tech. Conf., 2009. VTC[C]. 2009: 1-5.
[32]Tao M, Mng R. Linear precoding for multi-pair two-way MIMO relay systems with max-min feimess[J]. IEEE Trans.Signal Process., 2012,60(10): 5361-5370.
[33]Tse D, Viswanath P. Cambridge university press, 2005,
[34]Wang F. Wireless MIMO switching: network-coded MMSE relaying and user group selection]』. Trans. Emerging Telecommun. Tech., 2012, 25(5): 507-514.
[35]Gao H, Yuen C, Ren Y, et al. Distributed User Scheduling for MIMO-Y Channel[J]. arXiv preprint arXiv: 1408.4238, 2014.
[36]Gao H, Ren Y, Yuen C, et al. A distributed user scheduling scheme for MIMO multi-way relay channel[A]. // 2014 IEEE Int. Conf. Commun. (ICC)[C]. 2014: 4826-4831.
[37]Raghunathan V, Ganeriwal S, Srivastava M. Emerging techniques for long lived wireless sensor networks [J]. IEEE Commun. Mag., 2006, 44(4): 108-114.
[38]Paradiso J A, Starner T. Energy scavenging for mobile and wireless electronics[J]. IEEE Pervasive Computing, 2005, 4(1): 18-27,
[39]Varshney L R. Transporting information and energy simultaneously^]. // Proc. IEEE Int. Symp. Inform. Theory (2008 ISIT)[C], Nice, France: 2008: 1612-1616.
[40]Nasir A A, Zhou X, Durrani S, et al. Relaying protocols fbr wireless energy harvesting and information processing[J]. IEEE Trans. Wireless Commun., 2013, 12(7): 3622-3636.
[41]Krikidis I, Timotheou S, Sasaki S. RF energy transfer for cooperative networks: Data relaying or energy harvesting?[J]. IEEE Commun. Lett., 2012, 16(11): 1772-1775.
[42]Zhang R, Ho C K. MIMO broadcasting fbr simultaneous wireless information and power trans- fer[J], IEEE Trans. Wireless Commun., 2013, 12(5): 1989-2001.
[43]Ishibashi K, Ochiai H, Tarokh V. Energy harvesting cooperative communications[A]. // Proc. IEEE Int. Symp. Personal Indoor and Mobile Radio Communications (PIMRC)[C]. Sydney, NSW: 2012: 1819—1823.
[44]Grover P, Sahai A. Shannon meets Tesla: Wireless information and power transfer [A]. // Proc. IEEE Int. Symp. Inform. Theory (2010 ISIT)[C], Austin, TX: 2010: 2363-2367.
[45]Liu L, Zhang R, Chua K C. Wireless information transfer with opportunistic energy harvesting^]. IEEE Trans. Wireless Commun., 2013, 12(1): 288-300.
[46]Xiang Z, Tao M. Robust beamfbrming fbr wireless information and power transmission]J]. IEEE Wireless Commun. Lett., 2012, 1(4): 372-375.
[47]\ee S, Zhang R, Huang K. Opportunistic wireless energy harvesting in cognitive radio networks[J]. IEEE Trans. Wireless Commun., 2013, 12(9): 4788-4799.
[48]Liu L, Zhang R, Chua K C. Secrecy wireless information and power transfer with MISO beam- fbrming[A]. // Proc. IEEE Global Commun. Conf. (2013 GLOBECOM)[C]. Atlanta, GA: 2013: 1831-1836.
[49]Ding Z, Perlaza S M, Esnaola I, et al. Power allocation strategies in energy harvesting wireless cooperative networks[J]. IEEE Trans. Wireless Commun,, 2014, 13(2): 846-860.
[50]Kaushik K, Mishra D, De S, et al. Experimental demonstration of multi-hop RF energy transfer[A]. // Proc IEEE Int. Symp. Personal Indoor and Mobile Radio Communications (PIMRC)[C]. London, United Kingdom: 2013: 538-542.
[51]Chalise B K, Ma W K, Zhang Y D, et al. Optimum performance boundaries of OSTBC based AF- MIMO relay system with energy harvesting receiver]!]. IEEE Trans. Signal Process., 2013,61(17): 4199-4213.
[52]Ding Z, Poor H V User scheduling in wireless information and power transfer networks[A]. // Proc. IEEE Int. Conf. Commun. Sy st, (2014 ICCS)[C]. Macau: 2014: 82-86.
[53]Chynonova M, Morsi R, Ng D W K, et al. Optimal Multiuser Scheduling Schemes for Simultaneous Wireless Information and Power Transfer[J]. arXiv preprint arXiv:1502.02179? 2015.
[54]Li H, Jaggi N, Sikdar B. Relay scheduling fbr cooperative communications in sensor networks With energy harvesting[JJ. IEEE Trans. Wireless Commun., 2011, 10(9): 2918-2928.
[55]Michalopoulos D S, Suraweera H, Schober R, et al. The impact of relay selection on the ttadeoff between information transmission and wireless energy transfer[A]. // Proc. IEEE Global CoffirtlUtt. Conf. (2014 GLOBECOM)[C], Austin, TX: 2014: 4191-4196.
[56]Xiao X Han Z, DaSilva L, et al. Opportunistic relay selection for cooperative energy harvesting communication networks [A]. // Proc> IEEE Global Commun. Conf. (2014 GLOBECOM)[C]. Austin, TX: 2014: 4371-4376.
[57]Lee H Jung, Choi W. Opportunistic interference aligned user selection in multiuser MIMO interference channels [A]. // IEEE Global Telecommun. Conf. (GLOBECOM 2010),[C] 2010: 1-5.
[58]Chun KAY Love D. On the performance of random vector quantization limited feedback beamforming in a MISO system[J]. IEEE Trans, on Wireless Commun. (TWC), 2007, 6: 458-462.
[59]Rankov B, Wittneben A. Achievable Rate Regions fbr the Two-way Relay Channel[AJ. // 2006 IEEE Int. Symp. Inform. Theory[C]. 2006: 1668-1672.
[60]Rankov B, Wittneben A. Spectral efficient protocols for half-duplex fading relay channels[J]. DEEE J. Sei. Areas in Commun., 2007,25(2): 379-389.
[61]Oechtering T, Boche H. Bidirectional regenerative half-duplex relaying using relay selection[J]. IEEE Trans. Wireless Conunun., 2008, 7(5): 1879-1888.
[62]Ahiswede R, Cai N, Li S Y et al. Network information flow[J]. IEEE Trans. Inform. Theory, 2000, 46(4): 12041216.
[63]Katti S, Gollakota S, Katabi D. Embracing Wireless Interference: Analog Network Coding[A]. // Proc. 2007 ACM SIGCOMM[C]. New York, NY, USA: 2007: 397-408.

