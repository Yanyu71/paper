摘要
近年来，随着互联网的高速发展，各种网络应用层出不穷，中国 乃至全球的互联网使用人数与日俱增。据CCNIC发布的第36次中国 互联网络发展状况统计报告，截至2015年6月，中国网民规模达6.68 亿，半年内总计新增网民1894万人。互联网普及率为48.8%o随着 互联网的越来越普及，人们在日常生活中和互联网之间的联系也越来 越紧密，互联网产生的网络流量数据也越来越大。对于这些包含个人 信息的海量网络流量数据，如何对其进行处理、分析及存储也是运营 商关心的一大难题。Hadoop的出现在一定程度上解决了海量网络流 量数据的处理这个难题，但是随之新的问题出现了。Hadoop的批处 理机制使得其更适合处理海量的离线数据，而对于实时的海量数据处 理，则表现不尽人意。而Storm流处理平台的出现刚好弥补了 Hadoop 实时性不足的缺点，成为大数据时代实时海量数据处理的新利器。
本文首先介绍了海量网络流量的大环境，包括异常网络流量的危 害以及异常检测研究现状。接着，介绍了大数据处理的一些相关技术。 随后，分析了传统的异常网络流量检测法的不足，并在充分了解网络 流量的时间序列性之后，提出将格拉布斯异常值检测法和动态K近 邻相结合的新型检测算法，作为异常流量实时检测的算法，并对算法 合理性和正确率进行了验证。之后，详细介绍了异常流量实时监测系 统，包括Kafka消息系统，Storm流处理平台和Hbase非关系型数据 库，以及基于K近邻-格拉布斯检测法在这套Storm框架系统下的实 现。最后，本文对异常网络流量实时检测系统的实验所得数据进行了 分析。
本文所有的数据均来自于某省的两千多家企业网的日常真实流 量，所以可以保证数据的真实性和海量性。本文中所有的测试也都是 在自主搭建的Storm实时处理平台上完成的。并且，实验数据结果 显示，这套系统能够正确的完成异常流量的实时监测的任务。
关键词:实时流量;异常检测;Storm Kafka;复合会话
RESEARCH AND IMPLEMENTATION OF MASS NETWORK TRAFFIC ANALYSIS SYSTEM BASED ON TIME SERIES

ABSTRACT
In recent years, with the rapid development of the Internet, a variety of network applications springs up all over, Chinese and even the world's Internet user are growing. According to the thirty-sixth China Internet development statistics report released by CCNIC, as of June 2015, the scale of China's Internet users reached 668000000, half a year a total of 18.94 million Internet users were created. Internet penetration rate of 48.8%. With the increasing popularity of the Internet, the connection between people in daily life and the Internet is becoming more and more closely, the Internet generated by the network traffic data is also growing. For these vast amounts of network traffic data containing personal information, how it is processed, analyzed and stored in the operator concerned is a major problem.To some extent, the emergence of Hadoop has solved the problem of mass network traffic data processing, but the new problems arise. The batch processing mechanism of Hadoop makes it more suitable for processing massive amounts of data, while the performance of real-time data processing is unsatisfactory. And the appearance of the Storm stream processing platform has just made up for the shortcomings in real-time processing of the Hadoop processing platform, and has become a new tool to deal with the massive data in the era of big data.
In this paper, we first introduce the large environment of mass network traffic, including the abnormal network traffic and abnormal detection. Then, some related technologies of large data processing are introduced. Subsequently, the traditional detection method of abnormal network traffic is analyzed,pointing out the shortcoming of the traditional detection method,and then we proposed a new detection algorithm based on the combination of Grubbs anomaly detection method and dynamic K-NearestNeighbor algorithm as the algorithm for real-time detection of abnormal traffic, and the rationality and correctness of the algorithm are verified.And then we introduce the abnormal traffic monitoring system in detail,including Kafka message system,Storm stream processing platfbnn and HBase non-relational database, and the application of the algorithm called KNN-Grubbs anomaly detection method in this Storm system framework. Finally, we analyze the experimental data of the abnonnal network traffic detection system.
All of the data were derived from more than 2000 enterprise network daily real flow in some province, After the extraction of the field to get a custom composite session data, and then carried out a fiirther calculate of some properties of composite session data to get the host flow real-time table, so the authenticity and mass of data can be guaranteed. In this paper, all the tests are completed on the Storm real-time processing platform. And the experimental results show that the system can accomplish the task of real-time monitoring of abnormal traffic.
KEY WORDS:real time flow;anomaly detection;kafka;storm;composite session


