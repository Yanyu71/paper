3.1密码集成电路电磁发射源分析
在上一章节中，我们提到CMOS电路的能量消耗分为两部分，一部分是静 态消耗，另一部分是动态消耗卬71。静态消耗是电路在稳定状态下的能量消耗，主 要是由漏电流所决定的，所引起的静态消耗非常小，约占整体总消耗的1%,可 忽略不计。动态消耗主要是开关消耗和短路消耗，约占整体总消耗的99%。动态 消耗主要包括两部分：一部分是动态充放电电流，大约占85%左右；另一部分是 动态短路电流，大约占15%左右。通常情况下，当输入是高电平逻辑1和低电平 逻辑0的时候会引起CMOS电路的不同变化，产生不同的电流。
当匕〃输入是低电平时，PMOS管导通，NMOS管截止，此时电流流过PMOS 管，负载电容G充电，消耗外部能量，如图3-2所示。
图3-3输入高电平时CMOS等效示意图
图3-2输入低电平时CMOS等效示意图
40
当匕〃输入是高电平时,PMOS管截止,NMOS管导通，电流流过NMOS管， 负载电容Q放电，向外释放能量，如图3-3所示。
设R和R'分别代表CMOS反相器更新前后的输入状态，那么输入数据的变 化与电磁发射信号EM之间的关系如下表所示。
表3-1 CMOS反相器电磁旁路信号与输入之间关系
RtR'	电流i	电磁发射EM
0^0	无	无
0-1	有	有
JO	有	有
1-1	无	无
在集成电路中，从CMOS门级层面来讲，旁路信息泄露的大小是由门电路 的翻转状态决定的。从寄存器层面来讲，寄存器是由多个反相器组成的，旁路信 息泄露的大小取决于反相器翻转的频率。
虽然集成电路芯片工作时的电磁发射是有众多逻辑门的参与，但是我们最关 心的是跟密钥有关的相关比特的逻辑门状态情况。对于一个确定的加密芯片而言, 相关比特为与密钥相关的中间值状态，而中间值状态往往存储在寄存器中。如果 将寄存器简化成类似于CMOS反相器的结构，当寄存器中数据改变时便会有变 化的电流产生，从而产生电磁发射。假设第m个寄存器翻转前后的两个状态分 别为Rm和用小 那么由此而产生的跳变VR便可以通过式(3-1)表示
VR = % ㊉ R'm	(3 - 1)
当我们利用CMOS反相器的开关特性时，寄存器状态的翻转往往在很短的 时间内就能完成，那么定义在单位周期内寄存器翻转所产生的电流i可由式(3-2) 得出
i = am0m(Rm ® 敷)	(3 - 2)
式中/n为电流转换系数，系等效简化处理，0m为扇出系数。
