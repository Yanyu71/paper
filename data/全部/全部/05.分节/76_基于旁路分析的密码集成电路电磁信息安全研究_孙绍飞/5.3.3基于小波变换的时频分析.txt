5.3.3基于小波变换的时频分析
时频分析是一种处理时变非平稳信号的技术，主要研究的是信号的频谱随时 间变化的关系，提供了时域与频域的联合分布信息［2旬。小波变换是对傅里叶变换
96
的改进发展而来的一种有效的时频分析方式，傅里叶变换在信号处理领域中应用 广泛，但是傅里叶变换损失了时间信息，在时域中没有分辨能力［25-2刀。然而时域 信息在某些问题中依然具有重要的作用，小波变换可以很好地解决信号在时域和 频域的分辨能力问题。小波变换拓展了信号的傅里叶变换，通过小波基函数的变 换来分析信号中所蕴含的局部特征，在二维情况下能够对信号的方向进行选择, 从而获得了广泛的应用。
小波变换是由某一基本小波函数g(t),也称母小波函数，经过平移T后，然后 在不同的尺度S下与待分析的信号,此处为电磁发射信号进行内积操作。
WT?Q, s) =|j EM(t)W	dt	(5 - 8)
其中，T是控制小波位置的时域平移；S是控制小波宽度的尺度参数。
图5-10小波变换时频分辨率示意图
小波变换的一个重要特点就是多分辨率分析［2叫如图5-10所示。小波变换 对时域分辨率和频域分辨率进行了权衡，在不同的频段拥有不同的分辨率；在时 间相关特征感兴趣的尺度上，它在时域中具有高分辨率，而在频率相关特征感兴 趣的尺度上，它在频域中具有高分辨率。因此，通过小波变换能够更好的获取到 信号中所包含的重要信息。
连续小波变换(ContinuousWaveletTransfbnn, CWT)是原始信号与母小波 函数”(t)乘积后积分的过程〔2叫莫尔斯小波可以有效地将所有其他类型的常用分 析小波包含在一个统一的家族中，能够呈现出多种形式即⑶］。因此，使用莫尔斯 小波作为母小波函数比将所有这些其他类型的函数放在一起提供了更大的灵活 性。此外，简单的频域形式意味着可以很容易地推导出关键属性的解析表达式,
97
因此它被用作母小波函数来对采集到的电磁发射信号进行分析。莫尔斯小波的数 学表达式为
M⑴=，	修3y x do） （5 - 9）
J-8
其中，H（3）为赫维赛德阶跃函数，3为角频率，参数£为阶数，控制低频行为, 而参数Y为族，控制高频衰减。
对于硬件木马的电磁发射信号，我们可以通过连续小波变换将时域的电磁发 射信号转换到时频域当中，然后再进行区分。如果硬件木马的电磁发射信号 EMNt）在时频域的表达式为St0,s）,那么通过连续小波变换可以得到
ST（J. S）= Sg（t, s） + SP（T, s） 4- St（t, s）	（5-10）
其中，Sg（T,S）为标准黄金电路部分电磁发射的时频分量，Sp（T,S）为工艺偏差所引 起电磁发射差异的时频分量部分，Sf（T,S）为硬件木马电路部分所引起的电磁发射 时频分量。
依据上式来进行硬件木马电磁发射指纹的构建，根据电磁指纹的差异来进行 硬件木马的检测区分。工艺偏差并不会对电磁旁路信息的频谱成分产生影响，因 而可以忽略其影响。当集成电路中存在硬件木马的时候，硬件木马会引入新的时 频分量Sf（T,S）;如果引入的时频分量和标准黄金电路的时频分量相同，则在时 频图中二者会出现叠加现象；如果引入的时频分量和标准黄金电路的时频分量不 同，则在时频图中会出现新的成分。通过连续小波变换，既能实现对频域信息的 有效利用，同时又没有损失掉时域信息。
图5-11硬件木马电磁发射时频图
98
通过电磁旁路分析实验平台所捕获的硬件木马电磁发射信号的时频图如图 5-11所示。时频图是作为时间和频率的函数绘制的连续小波变换的绝对值。其中， 横轴表示时间，纵轴表示以对数刻度绘制的频率，通过改变颜色或亮度来显示系 数值。电磁指纹在时域和频域的变化能够在同一幅时频图中获得。
除此之外，CWT还可以看成是一个滤波的过程，仅允许原始时域信号中与 尺度变换后的小波中心频率相近的信号成分通过。其主要思想是通过选定一个中 心频率，然后经过尺度变换和时移得到一系列不同中心频率不同区间的母小波函 数，再分别同原始的时域信号相对于母小波函数区间的某一段进行乘积后积分, 在原始时域信号的固有频率上会有极值出现，极值所对应的频率就是时域信号在 该区间上所包含的频率。可以将其理解为原始时域信号通过不同的高通滤波器和 低通滤波器，过滤掉信号中的低频或高频部分。这个过程会重复很多次，每次都 会从信号中去除对应于某些频率的某些信号部分。因此，经过CWT处理后，电 磁信号中的噪声会更少。
