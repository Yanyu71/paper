4.2.2基于粒子群优化算法的相关电磁分析
基于粒子群优化算法的相关电磁分析(PSO-Correlation ElectroMagnetic Analysis, PSO-CEMA)通过粒子群优化算法和相关电磁分析的结合，将电磁旁 路分析的密钥恢复问题转化为密钥相关系数的寻优问题口刃。每个字节代表解空间 中的一个维度，因此空间坐标系中的每个点都是一个密钥候选解。正确密钥的恢 复就是通过找到多维空间坐标系中最优的点来实现。
相关电磁分析中用汉明距离模型来进行假设电磁发射迹线W的建模刻画口支 从当前状态h变化到下一状态S时的假设电磁发射迹线为
W = a- HD(h,s) + b = a- HW(h ®s) + b	(4 - 14)
通常情况下，s关于力和子密钥x之间存在着一种函数关系
s = g(/i,x)	(4 - 15)
所以，
W =	s) + b = a・HW(h ㊉ g(/i,K)) + b	(4 - 16)
如果我们假设hl, b=0,那么汉明距离模型便简化为
W = HW(h © g(h, x))	(4 - 17)
皮尔逊相关系数用来衡量假设电磁发射迹线和实际电磁发射迹线之间的相 关性口明 在实际运用中，一个拥有N条电磁发射迹线T的集合与N条相关的假 设电磁发射迹线/集合之间常采用如下式(4-18)形式的相关系数来衡量。
Pr.w = I --- I	———	(4 -18)
JnIXiK - (5XiK)2Jn£L % 一 (£匕%)2
为了充分利用密钥中每个字节所包含的有用信息，密钥的所有m个字节被用 于密钥恢复。从当前状态”=(以,后，•一，/)变化到下一状态S =…,Sm)的 汉明距离/次为 m	惟
AW = HD(”, S) = 2 HW(hj ㊉弓)=2 HW (%㊉ g回 芍))	(4 — 19)
7=1	)=1
粒子群优化算法是一种启发式的算法，它几乎能有效地优化各种目标函数或 适应度函数。在电磁分析中，其目标是从密钥搜索空间中寻找到最优的密钥解。 基于粒子群优化的相关电磁分析算法可概括如下：
69
给定适应度函数b（X）为皮尔逊相关系数:
产(%) = Pt,aw =
N^TjAWi-^T^AWj
JneLk — (ELktJniXi"” — (犬】4必)2
(4 - 20)
D维搜索空间QD是密钥的搜索空间，同时也暗示出密钥中包含有D个字 节，K =伙1#2,…，kD］。如果把密钥表示成多维的形式，每个字节的密钥将被看 （x1 = k1
作是搜索空间的一个维度•无2 ：均。因此，每一个密钥候选解都被定义成一个粒
=岫
子，第［•个密钥候选粒子可以表示为Xi =（々1/⑵…，刈D），其速度可以表示为 匕=（%1，%2,…，%））。
为加快收敛速度，我们对标准PSO算法的速度和位置更新方式进行了改进。 密钥候选粒子的速度更新方式按照下式（4-21）进行
Vid = Ojvid + c^Cpbestid - xid） + C2r2（gbestgd - xid） （4 - 21） 其中，（0是惯性权重，其值为非负的。惯性权重3对平衡全局和局部优化性能起 着重要的作用。当3较大时，全局寻优性能较好，而局部搜索寻优性能较差。考 虑到更强的搜索能力，对惯性权重8进行了修正，使其具有更好的收敛速度。修 正后的惯性权重的表达式如下：
iter
3 = 3max - C^max - 3Tnbi） ~~~	（4 - 22）
maxiter
其中/max和必nm是最大惯性权重和最小惯性权重，iter是当前迭代次数，maxiter 是最大迭代次数。为了搜索到最优的密钥候选解，粒子在搜索空间中逐步向最优 密钥位置点移动。
另外，为了获得全局最优值，我们在PSO算法中加入了变异算子。变异算 子用于保持种群从一次迭代到下一次迭代的多样性。它类似于生物突变，变异算 子从初始状态改变多维坐标中的一个或多个位置值。因此，利用变异算子可以得 到更好的解。变异操作会以概率尸m改变某些粒子的空间位置，以避免局部最优 的情况出现。
在改进后的方法中，对于具有较低适应度值的选定粒子，它们将随机地从其 当前位置改变到其他位置以具有更好的适应度值。
X = XxPm
(4 - 23)
为了保证安全性，密码算法的密钥长度通常会比较长。换句话说，在多维坐
70
标系中有大量的空间点存在。例如，AES是一种对称加密算法【161,能够使用16 个字节的密钥来处理数据。一个字节的数值范围是从0到255,因此多维坐标中 将有25616个点。它可能需要大量的初始粒子才能在多维坐标系中找到正确的密 钥点，也可能需要经过非常多的迭代次数之后才能得到正确的密钥点。
图4-5基于粒子群优化的相关电磁分析示意图
因此，我们对粒子群优化算法做进一步的简化处理，通过一种随机的定向路 径方式来得到优化解。以三维空间为例，如图4-5所示，红色的圆点表示初始粒 子以及它们所处的位置，黄色三角形点表示正确密钥K,其坐标位置为Cxbest, ybest, zbest)。
粒子群优化的方向是按照提前设定好的路径进行交替优化，例如粒子先在y 轴上行进，然后在x轴上移动，最后在z轴寻找。换言之，粒子将首先在K(0, y, 0)中找到最佳点K (0, ybest, 0),然后在K (x, ybest, 0)中找到最佳点K (xbest, ybest, 0),最后在 K (xbest, ybest, z)中找到正确的点 K Cxbest, ybest, zbest)。其中x, y, z均是从0到255变化的随机变量。因此，式(4-19)中的汉 明距离被修改为
AW = ^HW (hj ㊉	+ 幺 HWdefault	(4 - 24)
7=1	六t+工
其中，t指代的是定向路径中的当前维度数，m是密钥的字节数，"Wtfefau比被设 置为默认值0,抑或是其他值。
算法4-1给出了基于粒子群优化电磁分析的大致流程。
71
算法4・1基于粒子群优化相关电磁分析
Input:最大迭代次数初始粒子数变异概率%
Output:最优密钥解 best_point
1：	key_points = Initialization(A^)	〃初始化所有粒子
2：	Fitness侬yjjoints)	〃计算所有粒子的适应度
3： (pbest. gbesf) = PickFitness(或夕〃选出局部和全局最优的粒子
4： iter = 0
5： key_right = 0
6： while iter <max_iter and key_right = 0 do 〃循环迭代优化
7：	Update(婕y_points)
8：	Mutation(阿yjpointsJPr^) 〃变异
9：	Fitness(左@joints)
10：	(pbest, gbest) = PickFitness(和y_points)
11：	if Vertification(gZ>e^) = true then
12：	key_right = 1
13：	best_point = gbest
14：	End
15： End
16: return best point
