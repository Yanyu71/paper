3.2.1电磁发射模型建模
密码集成电路的加密模块是由许多逻辑门组成，所以其工作时所发射出来的 电磁波具有一定的群体特性。由于加密过程中明文不断变化所导致的逻辑门的不
41
断跳变和逻辑工作状态的不断变化，致使集成电路工作时的电流在位置和时间上 都呈现不断地变化，对于电磁场的实时探测来说具有一定的随机性，但是因为集 成电路芯片上配有周期载频，密码算法的加密过程又是在重复进行且密钥是固定 的，所以展现出来的随机性也是有一定规律可循的。如果探测时间足够长或者样 本数量足够多，就能够发现其周期性，从而可用于密钥的恢复。
随着微电子工艺的发展，芯片的制造工艺也进入到了纳米的级别，由此可知 集成电路芯片中的电路尺寸也是极小的。由天线理论可知，电流元作为电磁发射 系统最基础的发射单元，一种简洁有效的方法就是采用电流元来分析密码集成电 路工作时的伴随电磁发射，该方法也同样适用于分析集成电路中的封装结构。电 流元通常可以看成赫兹偶极子，将其视作与实际相关的大电流的一段，所以，任 何一个实际的芯片电路都可以先分解成若干连续的电流丝，再将其细分成偶极子 ⑻。芯片工作时的伴随发射电磁场可以通过这些偶极子贡献的总和来求得，如图 3-4所示。虽然伴随发射的电磁场是由偶极子贡献的总和而得，但是仅有相关比 特的等效偶极子才是我们所关心的，可以用来恢复密钥，其他的等效偶极子均被 视为噪声，即图3-4方框中相关比特的等效偶极子才是我们所要求解的，其他的 偶极子可以视为噪声，不做处理。
IIIIIIIIIII
IIIIIIIIIII
图3-4偶极子等效示意图
电偶极子和磁偶极子作为两种最基本的发射单元，实际工程中的众多发射体 都可以通过基本偶极子进行组合来等效以图3-5给出了赫兹电偶极子的示意 图⑪，它是一段物理长度/远远小于波长入的短导线，上面均匀分布有电流/,偶 极子直径忽略不计。在计算赫兹偶极子产生的电磁发射时，一般要先求出磁矢量
滞后位Z,如式（3-3）所示。
A{x,y, z）
e-ikr
--dl
(3-3)
其中，观测点的坐标为（x,6z）,源点的坐标为（£, y', z，），r表示源点与观 测点之间的距离长度，积分线C沿长度/进行积分。上为自由空间波数k=4= A.
3俑彳，4是自由空间的介电常数，出）是磁导率。
42
图3-5电偶极子示意图
因为偶极子的长度］（】<< 入）很短，所以式（3-3）近似为
A « ez里e-加 4nr
“0〃 (e 47r \
2
-jkr\
(3 — 4)
由上式可知，在笛卡尔坐标系中Ax，A），均为零。
在计算电磁场时使用球面坐标系往往比较方便，因此给出笛卡尔坐标系到球 面坐标系的转换网，如式（3-5）：
Ar A® Ae
sin 0 cos 0
=cos 3 cos。 .-sin 0
sin 6 sin (p cos 6 sin 0 cos 0
cos 6 -一 sin。
0 .
Ax Ay
4
(3-5)
依据式（3-5）可求得在球坐标系中磁矢量滞后位的三个坐标分量为
磁场强度目和磁矢量滞后位4之间存在如下关系
1
H = —VxA	（3-7）
Ho
由式（3-6）可知，磁矢量滞后位在0方向上没有分量，故
43
H = e◎
dAri
(孙)一凉
(3-8)
将磁矢量滞后位4代入计算可得
即
Hr = He = 0
0 1
k2 sin0 ———F Ljkr
1 -(Jkry	e-ikr	(3-9)
1 (jkr)2.	e-jkr	(3 - 10)
电场强度为
1
7-Vx H J3£o
k3Ilcos0 2na)£Q
k3 Hsin 9 j 1 j ] 47r3£0 .kr + (fcr)2 (fcr)3]
e-"T
(3 - 11)
因此
(F _fc37/cos0r 1__________L_]e-a
r 2na)£0 L(fcr)2 (fcr)3J
k3 Hsin 9 r i 1 j i ..
9 4n(i)EQ Ikr (kr)2 (kr)3J
& = 0
(3 - 12)
由电偶极子的电场和磁场公式可以计算出近区场的平均功率(流)密度
1 Sav=-Re[FxH*] = O	(3 - 13)
乙
该结果表明电偶极子的近区场没有电磁功率向外输出，所以近区场也称之为 感应场。
电偶极子与磁偶极子之间具有对偶性，依据电与磁对偶原理，可得磁偶极子 的电磁辐射特性。
= 0
Hr =等 cos。匕 + e-ju < 2nr Ikr (fcr)2J	(3 —14)
ISk2 ,	j 1 1
= ——sin 0 -1 + t- + rr A2 e J r
I 47rr	kr (fcr)2J
44
rEr = Eg = 0
[“警'喀+帚…	GE
其中，S为磁偶极子圆环的面积，极为自由空间的固有阻抗。
通过对比电偶极子和磁偶极子的磁场强度公式可知，电偶极子的磁场强度仅 拥有“0分量而磁偶极子有七、周两个分量。用电偶极子来进行磁场的分析相对 容易一些，所以本章主要以电偶极子为例来进行分析，磁偶极子亦可进行同样的 分析。
根据源点至观测点的距离相对于波长X的大小，可将场区分为远区场(kr » 1)、近区场(行<<1)和介于两者之间的过渡区场。
在信号采集过程中，我们通常采用近场探头贴近加密芯片工作的区域，在此 区域中，「《；1即匕(1,该区域属于近区场。因此，仅对近区场内的性质做探 讨。
在近区场中，
111
kr <<： (kr)2 <<： (fcr)3
且
e-jkr 忆 i
因此，在近区场中主要是尚的高次项起主导作用，其余各项可以忽略，故
ilsinG 4nr2
(3 -16)
在密码算法加密的过程中，集成电路的加密模块是由许多“并发”逻辑门开 关组成的，所以总的开关电流须在时域对所有单一逻辑门的开关电流进行叠加而 来。如果已知集成电路芯片表面上的电流分布，便可以对该电流分布进行积分运 算从而得到芯片电路工作时的电磁发射。换句话讲就是集成电路的电磁发射所产 生的电磁场是由所有这些单一逻辑门的电磁场叠加而来，因而探测到的电磁场具 有群体发射的特点。虽然探测到的电磁场是由群体发射而来，但是我们感兴趣的 是相关比特所在寄存器所产生的电磁发射，对于由其他非相关的逻辑门所产生的 电磁发射我们视之为噪声处理。因为所有的加密过程都服务于同一个固定的密钥, 所以密钥也是具有识别性的，通过电磁发射周期重叠的特性便可以获取到密码算 法的密钥。
对于有电流通过的寄存器可以等效成理想电偶极子，电流近似均匀分布，因 此可以将寄存器等效成极小电偶极子。故密码集成电路相关比特所在的寄存器所 产生的磁场W为
45
n	n
”工5 2喏 …) m=l	m=l
现代微电子工艺的发展使芯片的制作工艺进入到了纳米级的水平，芯片的大 小也朝着越来越小的规模发展。相关比特所在的寄存器大小往往在纳米或者微米 的级别，而观测点的距离往往在毫米以上的数量级，加和垢的变化非常微小，可 忽略不计，即5l = r, % = 故可以建立密码集成电路的电磁发射模型为
n	n	n
▽ V1 ilsinO ▽ IsinO ,	,、	，	、
H=	2五=2中小%伊"^%)	(3-18)
m=l	m=l	m=i
