5.3.4支持向
图5-12支持向量与间隔
支持向量机的主要思想是找到一个分类超平面最大化的分隔正负样本的边 缘[32,33],如图5-12所示。这个分类超平面可以通过下式(5-11)来表达
wT - x + b = 0	(5 - 11)
其中，W =(W1，W2,…,Wd)是超平面的法向量；X是输入样本；b是位移项。
如果训练样本是线性可分，能够被超平面正确的分隔开，则有
货+廿+1, %=+1
+ b4一1,	% = -1
99
其中，%是输入样本的标签。使上式中等式成立并且距离超平面最近的样本点被
称为支持向量，两个不同类别支持向量间的垂直距离称为间隔，其值为y =言。 llwll
超平面欲要最大化间隔可等效转化为
1
min 21Mli2	6 — IB)
s.t. + Z>) > 1
利用上式所求得的超平面划分最大间隔的数学模型为
f(X)= wT - x + b
(5 - 14)
因为无法保证超平面在样本空间中能将所有不同标签的样本完全划分开，所 以允许支持向量机在某些样本上出现差错。为此，在式(5-13)的基础之上引入 松弛变量£。
min
s.t.
m
|||W|12 + C^£Z i=l + 6) > 1 -£j > 0
(5- 15)
其中，C为惩罚系数。
超平面的寻找可以视为是一个二次规划的问题，但一个更高效的方法是通过 添加拉格朗日乘子心,由得到其对偶问题来进行求解。其拉格朗日函数为
m
m
r , ,	、 II w II2
L(w, b, a, £, 〃)= --- +
M
W(C -%)与 + { ai(
1. — £1 — %(卬,勺 + 6))(5 — 16)
i=l
其中，> 0, Hi > 0 =
在满足KKT的条件下，对L(w,力,的w, b, £求偏导并令其为0可得
rdL(w,b,a,£,fi)
dw
=w- ) a^Xi = 0
m
w = 2 atytXi
dL(w,b,a, £, 〃)
db dL(w,b,a,£,fi)
mwi=lc
= 0 =
二C 一/一出二0
将上式结果代入公式(5-15)可得
100
m 1mm
max 2修一,W 2 %为%才无『勺
i=l	i=i J=1
3	(5-18)
s.t. 2,佐％ = °
04由(C,i = 1,2, ...,m
对于上述过程，需满足KKT (Karush-kuhn-Tucher)条件
q > 0,出 > 0
为”修)-1 +，>0
%(%〃修)-1 + 幻=0	3	)
V£i > 0,出与=0
如果训练样本是非线性的，也许找不到一个超平面能将其正确的分隔开，此 时需要利用核函数进行特征空间的变换，将非线性分类转换成线性分类问题。也 就是假设原空间汇到新空间冗的映射函数为。@)，那么对于任意的M，XjSX存 在核函数K(x”功满足
K(爸,Xj)=43)70(/)	(5 - 20)
常用的核函数主要有以下几种MP】：
(1)线性核函数：
K(Xi, Xj) = x^Xj	(5 — 21)
(2)多项式核函数：
Kg 可)=(&『/. + r)d,A > 0	(5 — 22)
其中，a、r、d均为核函数参数。
(3)高斯核函数：
= exp(一用看一可『),4 > o	(5 — 23)
(4) Sigmoid 核函数：
K(xbXj) = tanh(双/芍• + r)	(5 — 24)
一般情况下，对于硬件木马的检测分类，我们事先无法确定经过哪个核函数 的映射之后会是线性可分，所以需要依据电磁发射指纹的特性选取合适的核函数。 在实际情况中，如果样本的特征维度比较大，则首选考虑使用线性核函数进行映 射。如果线性核函数的效果不理想，则考虑使用高斯核函数进行映射，然后再考 虑使用其余核函数映射；如果样本的特征维度不是很大，一般首先尝试高斯核函
101
数进行映射。除此之外，对于更为复杂度问题，核函数还可以通过以上几种核函 数经过数学运算组合而得到。
支持向量机的决策函数为
m
/(X)= W i=l
aiytKQx, x£) 4- b
(5 - 25)
综上所述，支持向量机采用结构风险最小化的原则，同时兼顾经验风险；而 卷积神经网络采用经验风险最小化原则，因此使用支持向量机作为分类区分器相 对于标准卷积神经网络具有更好的泛化能力。故将VGG-16网络的softmax层替 换为SVM层来进行硬件木马的检测，并将该网络称之为CNN+SVM网络，其网
络结果如图5-13所示。
K
—HP— 憎ld
AISI5
二 Auoul
Irnood 事I>jlgilol 甲 A=laI I4IAU05
MLEiood
E—s £05
AuluI
图5-13 CNN+SVM网络结构
53.5基于迁移学习的电磁旁路硬件木马检测框架
输出
SYM/softmax
木 马 检 测
信号处理
图5-14硬件木马检测框架
102
日常生活中的很多数码设备都是由集成电路组成的，比如手机、电脑、U盘 等。这些设备存在被植入硬件木马的风险，可能会导致信息的泄露或其他难以想 象的后果。因此，我们提出了一个硬件木马检测的框架来规避风险。硬件木马检 测框架如图5-14所示。主要有三个步骤：信号采集、信号处理和木马检测。
(1)信号采集
信号采集阶段所利用的信息为旁路信息，包括时间、功耗、电磁发射和声音 等不同类型，可以通过对旁路信息进行分析以推断设备内部的状态。电磁旁路分 析是一种很有前途的方法，由于其高效、非接触和高精度的优点在实践中得到了 广泛的应用。电磁发射信号的测量可以通过天线或近场电磁探头来获得。
(2)信号处理
信号处理阶段，运用连续小波变换将采集到的一维电磁发射信号转换成二维 时频信号并进行电磁发射指纹的提取，充分利用硬件木马电磁发射指纹的时域和 频域信息来进行检测。除此之外，连续小波变换也可以看作是一个滤波的过程， 执行时间局部化滤波。时域信号通过不同的高通滤波器和低通滤波器后，信号的 部分高频或低频成分会被滤除。这个过程重复多次，每次都从信号中移除某些频 率成分的信号。因此，经过连续小波变换处理后，硬件木马的电磁发射信号中的 噪声会更少。
(3)木马检测
在木马检测阶段，迁移学习被用来进行硬件木马电磁发射指纹的检测，利用 深度学习在海量数据集上所学到的强大的特征提取能力来对硬件木马的物理特 性进行识别并排除冗余信息的干扰。在迁移学习中使用了两种区分器：softmax区 分器和SVM区分器。先冻结VGG-16网络的部分参数，利用VGG-16网络对硬 件木马的电磁发射时频信号进行指纹特征的提取，然后再输送到区分器中进行硬 件木马的检测分类，最后将分类结果输出。
