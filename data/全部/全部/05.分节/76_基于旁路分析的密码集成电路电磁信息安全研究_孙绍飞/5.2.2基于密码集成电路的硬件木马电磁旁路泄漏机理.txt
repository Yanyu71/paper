5.2.2基于密码集成电路的硬件木马电磁旁路泄漏机理
现代集成电路构造复杂和高度分布协作的特点使植入的硬件木马种类越来 越繁多，物理特性也迥异不同，而且其植入环节、触发方式、攻击目标和实现的 恶意功能等都不相同，很难用一种普适的方法将不同种类的硬件木马检测出来吐 ⑶。数字集成电路的硬件木马一般可以通过组合逻辑触发和时序逻辑触发两种方 式来实现口5」6〕。图5-3展示了组合逻辑木马的一般模型，组合逻辑木马选取电路 内部的n个节点，当这些节点都满足某个小概率事件的时候将触发木马，然后有 效载荷将造成电路的错误。图5-4展示了时序逻辑木马的一般模型。时序逻辑木 马在每一个状态转换之后，如果没有相应的下一个激活向量引导有限状态机向下
一个激活状态转换，那么有限状态机将回到初始状态，使得激活向量重新输入。 在实际应用中，触发节点可以是随机的电路内部节点，也可以是可访问的寄存器 等逻辑单元。
图5-4时序逻辑触发木马
硬件木马电路在功能上可以分为触发逻辑和有效载荷两部分。触发逻辑主要 负责控制硬件木马电路是否处于闲置状态，在触发逻辑被激活之前，木马电路对 原始电路功能没有任何影响。在木马被激活之后，有效载荷将执行木马对原始电 路功能的恶意操作，比如泄露敏感信息或者降低性能等口7，间。硬件木马一般隐藏 在电路中小概率节点状态的集合中或者小概率事件的序列中从而逃避流片后的 集成电路测试。硬件木马不可避免的会造成电路引入面积、功耗和性能等方面的 额外开销，这为旁路分析等检测方法提供了依据。所有的旁路分析方法都需要观 察植入的硬件木马对物理参数的影响，即使木马电路在测试期间没有在电路中引 起能够观察到的现象，但是存在的额外电路也会影响到一些旁路信道参数。
我们在第三章中提到CMOS反相器是数字集成电路的基本单元，CMOS反 相器的电流变化包括静态电流和动态电流。因植入的硬件木马而在电路中存在的
91
额外逻辑会改变电流的特性，消耗额外的静态电流。静态电流具有可加性，可以 用于区分硬件木马电路和标准黄金电路。当测量数百万门级的集成电路的总漏电 流的时候，对于由额外几个逻辑门产生的漏电流效应是比较微弱的，仅从漏电流 的角度来进行检测效果会非常差。当硬件木马被激活时，集成电路的动态电流会 发生比较明显的改变从而增加硬件木马的的检测灵敏度。相较于静态电流，通过 动态电流的变化来检测硬件木马的效果要好一些。
由麦克斯韦第一方程可知，任何电流的变化都会产生相应的时变磁场。因此， 可以通过观察集成电路的电磁发射在非侵入的方式下检测到电路中额外的逻辑 门13〕。参考第三章电磁旁路建模的内容，我们同样也可以采用类似的方法对硬件 木马的电磁发射进行建模，此处详细过程不再赘述。针对不含硬件木马的标准黄 金电路，在时刻/所捕获到的电磁发射信号为EMG(t),其成分主要包括标准黄金 电路运行密码算法时的电磁发射EMg(t),工艺偏差而导致的电磁发射EMp(t)以及 测量噪声EMn(t)[i9,23,因此可以建模为
EMg (t) = EMg (t) + EMp ⑴ + EMM	(5 - 1)
对于包含额外模块的硬件木马电路，所捕获的电磁发射信号可以建模为
EMtQ) = EM。⑴ + EMp ⑴ + EMn(t) +	(5-2)
其中，EMt⑴为硬件木马模块所引起的电磁发射。
一般情况下，测量噪声EMn(t)是一个随机过程，随时间的变化而不尽相同。 依据大数定律可知，当对捕获的大量电磁发射迹线进行平均操作的时候，标准黄 金电路的测量噪声E%(t)和硬件木马电路的测量噪声EMn(t)近乎相等，加之滤波 去噪的操作，可以将测量噪声的影响控制在极低的水平，因此可以忽略测量噪声 的影响。所以，上述两个模型便简化为
EMg ⑴=EMg (t) + EMp ⑴	(5 - 3)
EMt (t) = EMg ⑴ 4- EMp(t) + EM, (t)	(5 - 4)
由于工艺偏差的影响，在时域上对硬件木马的电磁发射信号进行区分存在一 定的困难，因此需要对所采集到的电磁发射信号进行空间变换，使之转换到另外 一个空间中提取电磁指纹后再将EMg⑴、EMp(t)、EMt⑴区分开。例如，将时域空 间中的电磁发射信号转换到频域空间中，利用频域的信息来对硬件木马进行区分。 其中，工艺偏差一般不会对电磁发射信号的频谱分布产生影响，所以工艺偏差项 的影响可以忽略不计，则式(5-4)在频域中的表达式如式(5-5)所示。
介(3)=%(3)+京 3)	(5-5)
92
从式（5-5）可知，频域中含有硬件木马电路的电磁发射方3）主要包含标准 黄金电路部分的电磁发射为3）和硬件木马电路的电磁发射正3）。一般而言，标 准黄金电路和硬件木马电路所引起的电路差别往往工作在不同的频率，其频谱分 布往往不同，可以用于电磁发射信号的硬件木马检测。
综上所述，针对硬件木马检测单一域空间信息不足的问题，可以通过空间变 换来获取更多的信息，结合多种空间不同的信息来对硬件木马进行检测以提高分 类检测效率。
