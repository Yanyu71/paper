4.2.3基于粒子群优化相关电磁分析实验结果
实验过程中，我们聚焦于硬件并行实现下AES加密算法最后一轮的非线性 操作一字节代替，在3.4.2节描述的电磁旁路分析实验平台上，示波器采样率为 500MSa/s,采集了大量的电磁发射迹线来进行基于粒子群优化的电磁分析实验。 其中，实验分析部分是在一台处理器为IntelXeonE5-2620v4,运行内存为64GB 的服务器上进行。
成功率是衡量一种方法性能的有效措施口刀，因此，我们使用成功率来测试不 同参数情况下的性能。成功率被定义为：
SR = Pr{F(勺)=Kc}二
2、｛尸网/田）=Kc[i]] m
(4 - 25)
其中，Pr是成功的概率，依是密钥恢复函数，勺国是猜测密钥的第i个字节, 儿国是第i个字节的正确密钥。
72
粒子群优化算法迭代次数对成功率的影响展现在图4-6中。经过多次实验, 粒子群优化算法的迭代次数少于10的时候，成功率增长的比较快，然后逐渐变 得平稳。当迭代次数达到25左右的时候，正确密钥几乎已经成功恢复，并且处 于稳定状态。实验结果展示出随着粒子群迭代次数的增加，密钥恢复的成功率也 将逐步提高并最终稳定在一个较高的成功率。但是，当迭代次数过于大的时候, 并不能够对密钥恢复提供进一步的帮助。
1.0
0.8
* 0.6 左 盛
0.4
0.2
0.0
0	5	10	15	20	25	30
迭代次数
图4-6成功率随迭代次数的变化
1.0
0.8
*0-6
0.2
0.0
0	10	20	30	40	50	60
初始粒子数目
图4-7成功率随初始粒子数目的影响
初始粒子数目对成功率的影响展现在图4-7中。从图中可以看出，当初始粒
子数目少于50的时候，成功率随着粒子数目的增多而不断提高，直到恢复正确
73
密钥。当初始粒子数目多于50的时候，虽然也能恢复正确密钥，但是在一定程 度上增加了计算量，耗费更多的时间。
针对变异操作所发挥的作用，我们对比了 PSO-CEMA中变异操作的有无对 成功率的影响，实验结果如图4-8所示。从图中可以看出，变异操作对PSO-CEMA 有一定程度上的改进，当带有变异操作的PSO-CEMA成功恢复密钥时，没有变 异操作的PSO-CEMA仍然需要大约1000条左右的电磁发射迹线才能将密钥正 确恢复。
0	2000	4000	6000	8000	10000
电磁辐射迹数
图4-8变异操作对成功率的影响
0	2000	4000	6000	8000	10000
电磁辐射迹数目
图4-9 PSO-CEMA优化单字节密钥和多字节密钥的性能对比
我们同样也对比了粒子群优化算法在优化单字节密钥和多字节密钥时的性
74
能，以验证PSO-CEMA方法的有效性，如图4-9所示。图中红线代表的是多字 节密钥优化的情况，蓝线代表的是单字节密钥优化的情况。从图中可以看出，粒 子群优化算法在优化多字节密钥时的性能要优于单字节密钥的性能，当对多字节 密钥进行优化时，大概需要7000条左右的电磁发射迹线，成功率就能够达到 100%。相同情况下，粒子群优化算法对单字节密钥的优化仅达到90%左右，依 然需要额外的2000条左右的电磁发射迹线才能够达到100%的成功率。
相关系数随密钥字节数的变化如图4-10所示。如果仅有一个字节的密钥被 利用，相关系数的大小约为0.075左右；当所有16个字节都被利用时，相关系 数的大小约为0.25左右。图4-10揭示了相关系数与密钥字节数之间存在正相关 的关系，所利用的密钥字节数越多，相关系数越大。同时也证实多字节的密钥包 含更多的有用信息。由式(4-9)我们可以得到
p2
SNR = —(4 - 26) 1 — 0/
信噪比SNR和|p|之间存在正相关关系，|p|越大，信噪比越高。所以，电磁 分析中所利用的密钥字节数越多，相关系数就越大，信噪比也就越高，从而可以 说明多字节密钥包含更多的有用信息。因此，这对使用多字节密钥来进行电磁分 析具有指导意义。
0.30
0.25
0.20
旦玄会喉踞*某
0.15
0.10
0.05
0.00
0	2	4	6	8	10	12	14	16
密钥字节数
图4/0相关系数随密钥字节数变化
不同方法的性能比较如图4.11所示。从图中可以看出，PSO-CEMA方法最 好，CEMA方法次之，DEMA方法相比于前两个比较差。当密钥被全部正确恢 复的时候，PSO-CEMA方法大约需要4500条电磁发射迹线。在相同电磁发射迹
75
线数目下，CEMA方法的成功率只有70%左右，仍然需要更多的电磁发射迹线 才能完整恢复密钥。当PSO-CEMA方法和CEMA方法均正确恢复密钥的时候, DEMA方法的成功率依旧非常低，依然需要大量的电磁发射迹线才能将密钥恢 复成功。这是因为在DEMA方法中，只有一个比特的信息被利用，其他127比 特的信息都被视作噪声处理，只有极少量的有效信息被利用，所以效率才会比较 低。鉴于DEMA方法的低效率，在本文的后续章节不再考虑DEMA方法的使用。
1.0
0.8
好“6 会
0.2
0.0
0	2,000	4,000	6,000	8,000	10,000
电磁辐射迹数目
图4-11不同方法性能比较
图4-12不同方法成功恢复密钥时所需的最少电磁发射迹线数
从一个攻击者的角度来讲，恢复密码算法正确密钥所需要的电磁发射迹线数 量越少越好。因此，通过采集大量的电磁发射迹线来验证PSO-CEMA方法的有 效性。为了表现PSO-CEMA方法的优越性，我们用正确密钥恢复时所需的最少
76
电磁发射迹线数目来做对比。所有的电磁发射迹线被随机的分成不同的集合，在 每个集合上重复相同的实验方法来对比性能。实验结果如图4-12所示，通过 CEMA方法平均需要7286±1075条电磁发射迹线而PSO-CEMA方法平均需要 6286±859条电磁发射迹线。在相同情况下，PSO-CEMA方法实现了大约13.72% 的改进。无论是从所需的电磁发射迹线数目上还是波动程度上，PSO-CEMA方 法都要优于CEMA方法。
