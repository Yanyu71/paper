4.1.1多字节电磁分析理论基础
在硬件并行的情况下，密码算法的加密操作时往往是同步完成的，密钥的所 有字节都同时参与其中。此时所采集到的电磁发射迹线包含密钥所有字节的信息, 如果此时依然针对密钥的单个字节进行密钥恢复，会对密钥的有效信息利用不足, 从而造成密钥恢复效率低下的问题。因此，本文提出利用密钥多个字节的信息来 进行分析以提高信息利用率。下面先从理论上探究利用密钥多个字节的信息进行 电磁分析的可行性。
针对多字节电磁分析，我们将从微观和宏观两个角度来进行分析。在微观上， 考虑一个使用m位密钥的密码算法，将其处理的二进制数据编码为X = £陶1%2乙其中% = 0或1。所以，针对X的汉明重量为HW(X) =£隔1%。
63
如果X中比特位是独立均匀分布的，那么其平均汉明重量为Hhw = 3,方差为 = p密码算法从当前状态x变化到下一状态y的汉明距离可以通过下式 (4-1)来计算。
HD(X,Y) = HW(X © Y)	(4 - 1)
汉明距离即是从当前状态x跳转到下一状态y时二进制位翻转的比特数目。 如果假设状态六o,那么汉明距离就跟汉明重量相似。因此，hw(x㊉匕)也有相 同的均值f和方差
2	4
按照第二章第2.3.4小节中的汉明距离模型来进行建模，如果汉明距离模型 刻画准确，那么实际电磁发射迹线T满足
T= a-HW(X ㊉ 丫)+ b	(4-2)
当运用相关电磁分析来进行密钥恢复时，皮尔逊相关系数为
Pt,hw =
(4 - 3)
其中，CO"。代表协方差。
因为汉明距离模型是线性模型[9],所以不同变量之间的相关关系可以通过它 们之间的方差来预测。
片=a2a^w + 诏	(4- 4)
在噪声无关的假设下，皮尔逊相关系数便转化为
Pt,hw =
CL '	CLyjTfl
aT y/ma2 +
(4 — 5)
如果汉明距离模型中仅应用密钥的1个独立的比特位，那么其部分相关性也 依然存在
一	(4 — 6)
m
,	_ ayfl _
Pt,hw = I _	==7 = Pt,hw
y/ma2 + 4g
通过上式(4-6)可知，相关系数p：,hw与所使用的比特数M成正比关系，所 用的比特数越多，相关系数越大，所包含的信息量也就越大。
在宏观上，实际采集到的电磁发射迹线7通常包含两部分：一部分是与密码 集成电路中密钥数据紧密相关部分的电磁发射迹线Q,另一部分是与密钥数据不 相关部分的电磁发射迹线N。
T = Q + N	(4-7)
64
当运用相关电磁分析来进行密钥恢复时，皮尔逊相关系数被用来衡量假设电 磁发射迹线〃与实际电磁发射迹线7之间的相关性，二者之间满足如下关系。
|P(T,M)|	= |P(H,Q+N)|
covQH, Q + N)
Jvar(H)var(Q + N)
(4 ,— 8)
_ cov(H, Q) + cov(Hf N)
在噪声无关的前提下，假设电磁发射迹线H与噪声N之间没有任何相关关 系，所以二者之间的协方差为0。
(4 — 9)
理想情况下，对于正确密钥通过电磁旁路泄漏模型而获得的假设电磁发射迹 线H与实际密码集成电路中密钥数据所泄漏的电磁发射迹线Q之间吻合一致， 所以二者之间的相关系数为1。当使用密钥中/个独立比特位时，其相关系数为
Um _ I
|P(H,T)I =
(4 - 10)
在实验单次测量的短暂过程中，信噪比可以看做是稳定不变的。因此，从公 式(4-10)可以看出，所应用的独立比特数越多，对应的密钥字节数也就越多， 其相关系数也就越大，因此利用多字节电磁分析能够提高相关性。
