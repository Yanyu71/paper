1.1研究背景与研究意义
网络通信的发展加速了万物互联(Internet of Everything, IoE)时代的到来， 越来越多的智能手机、智能电视等数字化智能设备走进了大众的生活。与此同时, 智能硬件也在交通、医疗等各个行业方面不断地进行融合，为传统行业注入新的 活力和动力。智能硬件主要由两部分组成：硬件终端和云端。硬件终端主要通过 网络的方式与云端进行连接并进行数据的交互通信，构成“云+端”的形式，从而 拥有云计算、大数据等附加功能价值，方便人们的生活。智能硬件在带来便利的 同时也带来了信息安全的问题，由于智能硬件隶属于网络通信的终端，网络通信 中各种各样的安全入侵也逐渐渗透到了智能硬件的领域，以旁路分析为例，通过 分析智能硬件在工作时无意泄漏的电磁发射、功耗、声音等旁路信息便能获取到 智能硬件中重要的秘密信息，从而造成信息安全问题，带来安全隐患，如图1-1 所示。
图1-1万物互联的信息安全
信息安全问题不仅仅关乎个人利益，更决定着医疗、交通、军事和基础设施 建设等国家命脉产业的命运。2020年IBM安全部门曾发布报告称，数据信息泄 露已经为企业带来的损失高达几百万美元之巨，加之受全球新冠病毒的影响，远 程工作加重了数据泄露，所带来的平均损失已超过400万美元囚。在超过5000万 条的大规模数据信息泄露中，平均损失更是高达3.92亿美元。数据信息泄露的 罪魁祸首主要是恶意攻击,系统故障和人为失误，其中恶意攻击的占比高达52%, 依然是过去五年中最主要的威胁。目前，全球各国正在抓紧部署网络安全机制以 抵御恶意攻击所带来的危害，对数据信息的掌控、利用和保护能力已经成为全球
1
各个国家之间的核心竞争力之一。近年来，我们国家也加大了对信息安全的重视 力度，不断推出各种保护措施以防信息泄露。我国相继出台了各种网络安全法律 以及相应的政策，从法律层面上为信息安全提供保护。比如2019年网络等级保 护2.0标准的实施、2017年《网络安全法》、2020年《密码法》、2021年《数据 安全法》等法律的相继出台，以及《个人信息保护法》的起草规划都展现了我们 国家对信息安全的重视。除此之外，各地政府也正在加速网络空间安全的布局， 积极引导网络空间安全与新兴技术的结合。
智能硬件作为网络空间的重要组成部分，对于信息安全防护发挥着不可或缺 的作用。而集成电路又是智能硬件最为关键的部分，集成电路的安全性与否不仅 决定了智能硬件的安全可靠程度，同时也决定了网络通信的信息安全与否。集成 电路设计的高集成度和全球化分布式协作供应链使得硬件安全问题日益突出。然 而当前国内的微电子工艺技术水平还落后于国外，集成电路对国外的依存程度比 较高。从我国工业和信息化部对全国多家企业关键基础材料的调查结果中可以看 出，绝大部分高端芯片和处理器都要从国外进口。虽然在集成电路的设计环节上， 国内的华为海思、龙芯和中芯国际等企业已经能够做到世界先进水平，但是在14 纳米及以下的工艺上，我国的水平还远落后于国外的先进技术，所以当前依然采 用的模式是“外循环为主，内循环为辅”。这势必会给集成电路行业带来信息安 全的问题，比如硬件木马的植入。硬件木马是对现有集成电路进行篡改或添加恶 意模块，能够在集成电路设计开发的任何阶段植入，常常潜伏在硬件电路当中， 仅在特定的小概率事件下被触发从而造成威胁。最近几年来硬件安全攻击呈上升 趋势，表明集成电路已然成为多方攻击的一个有效切入点，是迫切需要研究和解 决的硬件安全问题。
硬件安全防护的一种重要方式是对数据进行加密，因而就需要密码技术参与 其中。密码技术作为网络空间安全的核心，是信息安全与通信保密的基础。在智 能硬件终端与云端进行数据交流和通信的过程中，通过对数据进行加密以保障数 据的安全性。密码技术最初由战争催生而来，由于保密通信的要求从而得以飞速 发展。1949年，Shannon将信息论引入密码学中凡从数学角度对信源、密钥、 加解密算法以及密码分析进行了详细阐述，将密码建立在数学理论之上，为密码 学的开创和发展奠定了坚实的理论基础。1976年，Diffie和Hellman提出了公钥 密码算法的新思想⑶，成为密码历史上的里程碑。该思想首先证明了在信源和信 宿之间通过无密钥传输进行保密通信的可能性，开创了公钥密码学的历史新篇章。 2000 年，美国的国家标准技术局(National Institute of Standards and Technology, NIST)历时三年经过三轮的筛选和讨论，最终确立新的高级加密标准(Advanced Encryption Standard, AES)算法叫次年，美国政府正式公布将AES作为美国联
2
邦信息处理标准，用于行政部门包含敏感信息文档的保护以进行保密通信。
图1-2保密通信系统模型
保密通信的系统模型是在一般通信系统模型的基础之上加入了加密器和解 密器，从而保证信息能够在传输过程中不能被攻击者读取，有效地解决了信息在 传输过程中的安全问题，其系统模型如图1-2所示。在一般通信系统模型当中， 信源发出信号经过编码调制之后，在普通信道中进行传送，经过信宿的译码、解 码之后获得信息。信息的存储、传送和处理在普通信道中都是按照明文的形式进 行，很容易受到攻击者的窃听和截获。因此，为保护信息的安全，在信息传送之 前先用加密器进行加密将输出的密文进行传送，信宿端收到之后经过解密器解密 之后便可以得到明文信息，从而保证明文信息免遭攻击。
随着密码算法和硬件安全技术的融合，对于硬件系统的信息安全问题也逐渐 关注到密码算法的安全性分析上来。密码算法的安全性分析一般都遵循柯克霍夫 准则以
柯克霍夫准则认为一个系统的安全性不是建立在加密体制和加密算法的保 密上,而是应该依赖于密钥，攻击者可以了解除密钥之外的关于系统的所有细节。
依据柯克霍夫准则，对于密码算法的安全性分析的目标就是从密文恢复出明 文或者根据已知条件恢复出密钥。密码分析是建立在已知密码算法的基础上而进 行的。传统的密码分析大致可以分为两种类型：暴力分析和数学分析，二者均把 密码算法视为一个待求解的数学模型。暴力分析主要通过暴力搜索的方式来得到 密钥，而数学分析主要是通过数学方法来获取密钥。暴力分析的方法主要有三个: 密钥穷举分析、查找表分析和空时均衡分析，虽然通用性比较好，但是比较笨拙。 数学分析主要利用数学方法来发现密码算法的漏洞，并减少暴力分析的复杂度, 主要的方法包括差分密码分析回、代数分析［久相关密码分析网以及线性密码分 析也
传统密码分析主要针对密码算法的数学理论方面，偏重于密码算法的设计安 全性。但是密码算法在数学理论上的设计安全性并不能够代表其在物理实现过程
3
中的安全性。任何密码算法的落地终究是要依附于某个物理平台，而密码算法在 运行时会导致密码集成电路的物理特性发生改变，从而产生信息泄露，称之为旁 路泄露。旁路泄露的信息往往同密码算法的内部运算或内部数据之间存在着某种 关联，能够为密码分析提供额外的帮助。通过旁路泄露来进行密码分析的方法叫 做旁路分析【刈。
旁路分析绕过了密码算法本身复杂的分析过程，通过密码算法在软硬件实现 过程中的旁路泄露并结合统计方法快速恢复出密钥。旁路泄露不仅包括通过被动 方式获取到密码算法的执行时间、功耗、声音和电磁发射等信息，也包含通过主 动方式获取到的中间状态或故障输出。旁路分析的基本框架如图1-3所示。
密码算法实现的基本信息
是否含有防护措施
寻找旁您信道的薄弱点
确定旁络分析模型
优化旁路分析方法
旁第灌案采集及顼处理
图1-3旁路分析基本框架
依据旁路分析基本框架，旁路分析的过程可以分成三个步骤。第一步是旁路 分析评估，在旁路分析之前确认目标密码设备有被攻击的可能性，了解密码设备 所使用的密码算法及其实现架构、是否带有防护措施等基本信息。第二步是旁路 泄露采集，根据已掌握的信息找到旁路泄露的薄弱点进行数据采集并对数据进行 预处理操作(如滤波、降噪和对齐等)。第三步是旁路分析，通过对预处理后的 数据依据所确立的泄露模型进行优化分析从而恢复出密钥。
常用旁路分析类型主要有：
(1)计时分析(Timing Analysis )
主要是利用密码算法在不同的明文和密钥条件下加密时间的差异，通过统计 分析的方法来恢复密钥，常用于非对称密码算法［I1
(2)功耗分析(PowerAnalysis)
主要是利用密码算法在不同的明文和密钥条件下所获得的功耗轨迹的不同， 通过相关性分析的方法来进行密钥的恢复，常用于对称密码算法口久
4
(3)声学分析(Acoustic Analysis)
主要是通过捕获密码算法在集成电路设备运行过程中的声音发射信号来获 得敏感信息从而恢复密钥[问。
(4)电磁分析(Electromagnetic Analysis)
主要是利用密码算法在不同的明文和密钥条件下所捕获的电磁发射轨迹的 不同，通过相关性分析的方法来恢复密钥口引。
(5)故障分析(FaultAnalysis)
主要是利用不同的方式主动使加密设备产生错误的输出结果，通过对比正确 结果和错误结果的分析从而恢复密钥口叫
在上述旁路分析方法中，电磁分析相较于其他旁路分析的方法，不仅不需要 对目标密码设备做任何改动，更加具有隐蔽性，而且还能够在较远的距离探测到 电磁信号，更加具有实用性。
制造装配阶段
测试阶段
图1-4集成电路供应链
电磁分析不仅在密码设备秘密信息的获取上发挥了重要的作用，而且在硬件 木马的检测方面也展现了极大的潜力。硬件木马是密码集成电路物理安全的另一 个巨大威胁，它具有形式多样、隐蔽性好、触发概率低和危害后果严重的特点“6-18]o当前全球化的发展趋势使得集成电路产业遭受硬件木马威胁的情况日益显著, 现代芯片的设计极其复杂，仅单个芯片就达到包含数十亿个逻辑门的规模，如此 复杂的片上系统通常包含相当数量的功能模块，任何一个公司想要单独完成整个 制造过程几乎是不现实的。出于经济因素和产品需求的考虑，就必然需要依赖于 多个可靠性无法保证的第三方。随着半导体工艺的发展，越来越多的分布在世界 各地的可信性无法保证的制造商参与到集成电路的设计和制造的供应链过程中。
5
全球化的分布式协作增加了攻击者在供应链的任何一个环节植入恶意电路的风 险，这已经成为当前集成电路领域新的挑战。集成电路供应链的设计、制造、测 试和部署等各阶段如图1-4所示。开发流程首先根据规范设计寄存器传输级中的 组件。除了内部设计之外，第三方供应商还提供不同抽象级别的IP (Intellectual Property)核。不同的设计组件被集成在一起并使用EDA工具经过多个阶段的综 合和验证，最终生成物理布局。第三方代加工工厂进行集成电路的制造，然后在 下一阶段进行测试、封装和部署，并运往市场。
硬件木马是近些年在集成电路领域新兴的一种硬件威胁方式，主要指集成电 路在设计和生产过程中发生的恶意添加或篡改，抑或是设计者无意留下的缺陷设 计。这种恶意添加或篡改可能发生在集成电路开发周期的任何一个环节，其结果 可能会导致集成电路的功能发生异常、拒绝服务、提供隐蔽信道、泄露敏感信息 以及制造硬件后门对集成电路芯片进程远程控制和破坏，也可能会导致芯片性能 下降，加速老化，降低可靠性等一系列问题。集成电路硬件木马的一般结构如图 1-5所示,主要包含触发木马和有效载荷两部分。触发木马部分类似于传感电路， 用于激活硬件木马，当T1、T2、T3…Tn等特定事件出现时便会触发硬件木马； 有效载荷部分则是负责在硬件木马被激活后执行特殊的功能。除此之外，如果硬 件木马一直处于激活状态，则只需具备有效载荷部分即可，但是这种类型的硬件 木马比较容易被检测到，因而其应用相对较少一些。
图1-5集成电路硬件木马一般结构示意图
硬件木马到目前为止，还没有一个统一的分类标准，但是可以按照不同的规 则从不同的角度对其进行分类口93],并且可能随着新的攻击模式的发展而不断更 新。常见的硬件木马大多可以基于6个特征来进行分类，分别是：插入阶段、抽 象级别、触发方式、负载机制、插入位置和物理特性，各个类别和其子类如图1-6所示。依据硬件木马的不同分类，可以从不同的层面上在集成电路中植入硬件 木马。
硬件木马一般是依据系统的工作原理而实现对底层硬件的精心设计，并且半
6
导体技术的发展使得纳米级关键尺寸和高集成度电路的木马检测变得越来越困 难。相较于传统的软件木马，硬件木马的工作机制多样，设计方法灵活；往往都 存有一个恶意的目的，一旦触发，破坏性强，威胁性高。而且硬件木马电路具有 良好的隐蔽性，能够不被标准的集成电路芯片测试和验证过程所发现。
图1-6常见硬件木马分类
通常情况下，大多数硬件木马的尺寸一般比较小，触发概率极低，以此来规 避检测，从而不易被察觉。硬件木马一旦被触发，便可能对整个系统造成严重的 后果。如果硬件木马被应用于医疗、军事或基础设施建设等重要领域的集成电路 内部，一旦其被激活，就可能会对国家和公民的人身安全造成无法想象的后果。
硬件木马是在原有集成电路基础之上进行的改动，任何改动势必会反映在集 成电路的物理特性上，产生一定程度的改变，而其所产生的电磁发射也会有所差 异，因此，通过电磁旁路分析可以作为检测硬件木马的一种有效方式，能够以非 侵入式的方法检测到其存在，正在逐渐成为硬件木马领域中一种强有力的新兴解 决方案。
万物互联使得越来越多的智能电子设备硬件终端彼此相连，任何智能硬件设 备在工作时都会产生电磁发射，其电磁信息安全问题与我们的生活息息相关，所 以对电磁信息安全的研究更具有应用价值。中国科协也在2020年将防范电磁威 胁和集成电路缺陷检测列为十大工程技术难题之中，足以看出电磁安全和集成电 路的重要性。因此，本文依托该两大技术难题，主要针对密码集成电路的电磁信 息安全问题进行探究，重点研究密码集成电路的密钥恢复以及硬件木马的检测两
7
方面内容，旨在为密码集成电路的检测和分析提供技术支持，提高密码集成电路 的安全防护水平。而且随着信息化的提升，国家安全和人民生活也越来越依赖于 电磁信息安全，电磁信息安全已经成为网络空间安全体系中不可或缺的重要部分, 在国家安全战略的各个关键环节当中都发挥着重要的作用。
