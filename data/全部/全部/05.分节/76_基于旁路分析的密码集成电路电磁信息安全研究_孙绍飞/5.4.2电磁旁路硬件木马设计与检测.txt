5.4.2电磁旁路硬件木马设计与检测
Trust-Hub网站提供了一系列的硬件木马电路基准，旨在提供一个交流的平 台来促进硬件安全可信领域的发展和评估技术，目前已经广泛地被工业界和学术 界的相关研究人员认可和应用的。设计者可以参考该网站所提供的硬件木马基准 电路的实现方式，应用于自己的设备当中来验证硬件木马检测方法的有效性。针 对AES基准电路，该网站提供了 22个基于FPGA实现的硬件木马。这些硬件木 马大致可以划分为两类，其中19个属于敏感信息的泄露，其他3个属于耗尽电 池电量以降低性能。
基于上述两类基本电路，本文利用触发式硬件木马设计了同样的两种不同类 型的硬件木马电路来进行检测。将耗尽电池电量来降低性能的硬件木马称为T1, 将泄露敏感信息的硬件木马称为T2。
根据触发式硬件木马的情况，可以划分为三种状态：
（1）标准黄金电路：密码集成电路中没有硬件木马。
（2）硬件木马未触发：FPGA板包括标准黄金电路和木马电路，但硬件木 马的触发部分并未起作用。
（3）硬件木马激活：FPGA板包括标准黄金电路、木马电路，其中硬件木马 的触发部分激活有效载荷执行恶意功能。
针对硬件木马的不同状态，可以将硬件木马划分为5类：
（1）标准黄金电路状态：标准黄金电路中没有植入硬件木马，所泄漏的电 磁发射信号仅由标准AES加密算法所涉及的逻辑门导致，称此时的状态为T0。
104
(2)降低性能木马的未触发状态：标准黄金电路中植入了降低性能的硬件 木马，但是硬件木马尚未触发，所泄漏的电磁发射信号由标准黄金电路和未触发 部分的硬件木马的逻辑门导致，称此时的状态为T10。
(3)降低性能木马的激活状态：标准黄金电路中植入了降低性能的硬件木 马，并且硬件木马激活，有效载荷部分发挥作用，耗尽电池电量来降低性能，所 泄漏的电磁发射信号由标准黄金电路和已激活部分的硬件木马的逻辑门导致，称 此时的状态为T11。
(4)信息泄露木马的未触发状态：标准黄金电路中植入了敏感信息泄露的 硬件木马，但是硬件木马尚未触发，所泄漏的电磁发射信号由标准黄金电路和未 触发部分的硬件木马的逻辑门导致，称此时的状态为T20。
(5)信息泄露木马的激活状态：标准黄金电路中植入了敏感信息泄露的硬 件木马，并且硬件木马激活，有效载荷部分发挥作用，敏感信息被泄露，所泄漏 的电磁发射信号由标准黄金电路和已激活部分的硬件木马的逻辑门导致，称此时 的状态为T21。
针对上述5种不同情况下的硬件木马电路，将其在密码集成电路电磁旁路分 析实验平台上实现，并对其电磁发射信号样本进行捕获和存储，依据硬件木马检 测框架的流程对所采集到的电磁发射信号进行处理。
