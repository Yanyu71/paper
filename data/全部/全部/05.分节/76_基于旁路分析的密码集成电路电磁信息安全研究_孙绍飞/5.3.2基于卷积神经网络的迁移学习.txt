5.3.2基于卷积神经网络的迁移学习
卷积神经网络(Convolutional Neural Networks, CNN)因在网络中使用卷积 运算而得名，已经在图像处理、语音识别、自然语言处理等众多领域中取得了巨 大成功0〕。VGG-16网络是2014年提出的一种深度卷积神经网络模型，并在 ImageNet比赛中取得了 92.7%的top5测试准确率的优异成绩囱。VGG-16网络 的最大特点是结构简单，利用固定大小的卷积尺寸和池化尺寸，通过卷积层和池 化层的堆叠来加深神经网络的结构从而提升性能。
X1OS
E4AUOU
华 s AUOU NSAUO5 工 AuaI
图5-6 VGG-16网络结构
VGG-16网络的基本结构如图5-6所示，主要是由卷积层、池化层、全连接 层和softmax层堆叠而成。其主要特点是小卷积核、多卷积层、小池化核和多通 道数。
(1)卷积层(Convolution, Conv)
卷积操作是卷积神经网络中最为关键的部分，卷积层主要进行的操作是卷积, 卷积核按照固定步长滑动，并将卷积后的值作为样本输出值，其过程如图5-7所 示，对于二维矩阵的输入/和一个二维的卷积核K进行卷积操作得到输出操作矩 阵的数学表达式为
S(iJ) =。*	= 2 W	- m,j - n) (5 - 6)
m n
其中，i, /和m,几分别为相应矩阵的行数和列数。
94
卷积操作体现了稀疏连接和参数共享的特性，每层神经元都共用一个卷积核 参数与部分上层神经元相连接。
VGG-16网络中卷积层的卷积核大小为3x3。
1,	0	0
Qo	互		1	0
0 xO	1,	1	1
0	0	1	1	0
0	1	1	0	0
4	3	4
2	4	3
2	3	4
图5-7卷积操作示意图
(2)池化层(Pooling)
池化层主要是对卷积后的特征再进一步压缩，通过降采样操作在保留主要特 征的同时去除冗余信息从而降低计算量。常用的池化操作主要是最大池化和平均 池化。以最大池化为例，其池化操作如图5-8所示，取按照固定步长滑动的池化 核所在区域内的最大值作为采样后的输出样本值。VGG-16网络中用的是2x2的 最大池化。平均池化主要是将池化核所在区域内的特征值取均值后作为采样后的 输出样本值。
图5-8池化操作示意图
(3)全连接层(Full Connect, FC)
全连接层属于全局操作，对所有的输入特征进行加权组合后输出从而实现对 全局特征的提取。全连接层的每一个神经元都会与上层所有的神经元进行连接, 每个连接都会有一个权值，同层神经元之间没有任何连接。全连接操作的示意图 如图5-9所示。
95
图5-9全连接操作示意图
(4) Softmax 层
VGG-16网络使用的区分器是softmax函数，它将任意真实值转换为样本概 率，这通常对机器学习非常有用。它对"维输入X=［x/,X2,…，对执行以下变换
其中，e为自然常数。
Softmax区分器的输出总是在［0, 1］的范围内并且总和为1。因此，它们形成 了一个样本概率分布。最大样本概率被视为预测输出。Softmax区分器用概率 来回答分类问题，更具有说服力。
VGG-16网络是通过在ImageNet等庞大的数据集上训练模型而获得的，这 些学习到的参数能够为网络提供了出色的特征提取能力，拓展性比较强，迁移到 其他数据上的时候泛化性能比较好，而且结构简单，因此可以用于提高硬件木马 检测时的分类性能，通过对全连接层的修改使之符合硬件木马分类的情况。
VGG-16网络的输入是固定的224 X 224的二维图像，而原始的电磁发射信 号是一维信号，因此我们需要通过变换将其转换成二维图像，并且调整输入图像 的大小，使之满足VGG-16网络的输入。通过522节的理论分析可知通过电磁 发射信号的时域信息和频域信息能够有效的检测出硬件木马的存在，而时频图将 信号的时域信息和频域信息有机的结合在一起，因此考虑将电磁发射信号经过时 频分析之后的时频图作为VGG-16网络的输入。
