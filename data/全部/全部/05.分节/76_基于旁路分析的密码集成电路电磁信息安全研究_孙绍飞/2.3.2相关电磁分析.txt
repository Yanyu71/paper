2.3.2相关电磁分析
相关电磁分析是最流行的电磁分析方法之一，主要利用密码集成电路电磁发 射对数据的依赖性"叫通过对大量不同数据分组进行加密操作时的电磁发射迹 线来分析固定时刻的电磁发射信号，并将其视为与被处理数据有关的函数，基于 电磁发射迹线恢复密码集成电路中的密钥。相关电磁分析相比于简单电磁分析的 优势在于无需掌握目标设备中加密算法的实现细节便可以获取其密钥信息。除此 之外，即使电磁发射迹线中存在有噪声影响，相关电磁分析也能获取密钥信息。
相关电磁分析通常采用“分而治之”的策略，其一般性步骤如下：
（1）选择所分析密码算法的攻击点，也就是密码运算过程中的某个中间值。 该中间值一般可以通过函数㈤表示，其中。为已经知道的明文或密文，上为 所要恢复密钥的部分位，即子密钥，满足这个条件的中间值方可进行子密钥上的 恢复。
（2）获取密码集成电路的电磁发射迹线。获取密码集成电路运行。次时每 次加密操作的数据d和相对应的电磁发射迹线t,分别记为d=（d1,d2,…,do）和ti =（加，加，…,幻），其中7为电磁发射迹线的长度。所以，采集到的电磁迹线构成 一个2）x7的矩阵T.
T =	^11	112	…	W 121	L22	-	12T tDl	±D2	-	tDT-
（3）计算密码算法的假设中间值。针对每一个假设密钥上值4 =（比左2,…,麻）， 其中K为假设密钥上遍历后的数量，根据给定的d=® d2,...,彰）和密钥假设k =（而…木k）,依据选择函数/（4哥计算出相对应的假设中间值小并构成一个 DxK的矩阵K
vtj = f （4, kj） i = 1,2, j = 1,2, ...,K	（2 - 11）
P的第j列包含了依据密钥假设年计算出的中间值结果。加密过程中使用的 是某个密钥假设上,相关电磁分析就是要找到该值位于中间值矩阵V的那一列，
33
从而确定出正确密钥。
（4）将中间值矩阵0依据旁路信息泄露模型映射为假设电磁发射矩阵 即对每一个假设中间值加依据旁路信息泄露模型映射为一个假设电磁发射值为。
h 12	— h1K'
u _ 九21 入22	— h2K
（5）将假设电磁发射迹线与实际的电磁发射迹线进行统计分析。将每个密 钥假设所对应的假设电磁发射值与每个位置的实际电磁发射迹线进行皮尔逊相 关系数比较，会得到一个K x T的矩阵矩阵K中元素f最大值所对应的假 设密钥便认为是正确密钥。
皮尔逊相关系数的数学表达式为
r..=	2%（%L ♦） .圈,广动 —	盘-12）
（九- 鬲）2 •	（tdj 一 弓）2
其中，后和弓分别表示为列鬲与号的均值。
