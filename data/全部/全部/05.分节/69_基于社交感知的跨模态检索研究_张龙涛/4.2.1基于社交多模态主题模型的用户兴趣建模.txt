4.2.1基于社交多模态主题模型的用户兴趣建模
(1)所提模型
与传统文本建模相同，图像建模中仍然有文档、词、主题几个概念。具体来 说，“文档”指的是待处理的数据对象，它由一组词组成。本节中，文档个数指 的是用户个数，一个用户中文本数据集合与图像数据集合看作用户的多模态文档, 包括文本文档与图像文档；文本中的“词”表示英文单词或中文词，而图像中的 “词”表示图像中的小块；而“主题”表示一个概念，它由一组概念词组成，比 如{音乐、体育、军事……},值得注意的是本节中的主题模型是一种无监督学习 的模型，因此，主题中具体的概念是未知的。对于一个主题模型，一般需要求解 两个非常重要的分布：“文档-主题”分布与“主题-词”分布。其中，“文档-主题” 分布表示文档中每个主题存在的概率，本节中指的是用户兴趣分布，即用户兴趣 属于每个概念下的概率；“主题-词”分布的每一项表示词在主题中的概率。
43
表4-1相关符号与含义
符号	含义
m9m'	不同的模态
u	第u个用户
u\un	第u个用户的好友
a	狄利克雷先验因子，4的超参数
—	狄利克雷先验因子，力的超参数
第“个用户的主题分布
8心力	第a个用户的好友的主题分布
•7	Z umn9 um'n	第"个用户模态文档中采样的第n个词对应的主题
w w , umn 5 um n	第〃个用户犯小，模态文档中采样的第n个词
吒,%	科m'模态文档中词的个数
N	用户个数
©mkOtn'k	m, 模态主题一词的多项式分布
K	主题个数
假设给定N个用户，每个用户都有能够表达自身兴趣的多模态文档2m与 Du„,,加与评分别表文本与图像模态，每个文档分别含有%与周“个词，表4-1描述了相关符号及含义。本节的目标是根据已知的两个模态中的词，利用概率 方法推导出两个分布：“文档-主题”分布，6妙*4、“主题-词”分布由€虾” 与想,G1RK*吃。那么用户兴趣可以表示为两种形式：(a)主题表示法：用一组概 念词来表示用户兴趣。本节中利用“用户-主题”分布矩阵。6皿,*以表示，矩阵的 每一行表示该用户中每个主题存在的概率；(b)关键词表示法：用一组关键词表 示用户的兴趣。对于加模态，可以用矩阵。用右股“”表示，矩阵的每一行表示该 用户中每个词语存在的概率，而矩阵的计算公式可以用图4-4形象表示；同 理，对于小模态，可以用矩阵。”右肽.*%表示。
图4-4 m模态中"用户-词"矩阵
44
下面从两个方面对提出的社交多模态主题模型进行阐述，分别是：多模态
数据建模与社交关系建模。
(a)多模态数据建模。不同于传统的单模态模型LDA,多模态数据建模需要 考虑模态间的关系，不能孤立地对不同模态数据建模,否则会丢失许多有效信息。 在真实的数据集中，多模态数据间的关系并不是严格一一对应的，即不能假设同 一用户中的多模态文档“词”是一一对应的，大多情况下，图像中的“词”不一 定有相应的文本“词”描述。因此，为了有效建模多模态间的关系，应该假设用 户的多模态文档是文档水平对齐的，即不同的模态通过共享的主题关联。对于用 户来说，其兴趣分布是固定的，多模态只是用户兴趣的表现形式，因此，多种模 态数据共享统一的“用户-主题”分布。基于这一假设，利用?表示在两种模态下 的主题分布，即用户的兴趣分布，因此，»可以看作是模态独立的因子，只与具 体的用户有关。此外，由于不同模态中词的表达形式不同，即对于不同模态词的 生成过程是相对独立的。基于以上假设，本章借鉴传统mmLDA模型来对多模态 数据进行建模。
(b)社交关系建模。基于4.1节叙述，在用户兴趣模型的生成过程中考虑用 户的社交关系，可以解决用户数据的噪声与稀疏问题，提高兴趣表达的鲁棒性与 准确性。一般情况下，社交网络中相连的用户有相似的兴趣表达，因此，本章通 过用户兴趣间的相似性来增强用户的兴趣表达。具体来说，首先，根据用户的社 交关系构建一个社交网络G = (KE),其中节点集忆表示所有用户，边集E表示 用户的社交链接。如果用户〃与/间存在链接，那么用户兴趣分布，"与统间的 相似性可以表示为：
(Q „、［exp(-力&㈤,))g(u,u'}>5 0	otherwise
(4-1)
其中，2是平衡参数，5表示设置的阈值，gQ,”)表示社交网络中链接相似性, 相似性越大表示好友的社交影响越大，其计算公式为：
gQ")
|r(»)nr(»')| / 3)UT(/)i
(4-2)
其中，「Q)表示用户优的邻居节点集合，r(〃)表示用户〃的邻居节点集合，H表 示集合元素个数。而/(4,%)为用户〃兴趣分布与优兴趣分布之间的相似性，在 此利用对称KL散度表示[22],相应的计算公式如式4-3所示。
"	e”.)+KL(BU. II e.))
乙
I K	0	fi
=竟(%	+ % Jog(伊))
45
(4-3)
基于上述两方面的考虑，图4-5展示了所提模型的图结构。与LDA相似， 首先产生用户的兴趣分布夕“，然后根据联合分布采样一个词，重复该过程，直到 产生用户的多模态文档。具体来说，首先，产生参数为a的狄利克雷分布4；对 于模态掰，根据联合分布采样一个主题与.，然后根据多项式分布土生成一个词 叱皿，同理，对于模态社根据相同的步骤生成词叫为了方便，本章以。"与 Multi分别表示狄利克雷分布与多项式分布，因此模型生成过程可以表示为：
1	.对TH模态的每个主题，生成词的多项式分布。mk〜。|%)
2	.对租'模态的每个主题，生成词的多项式分布07n%〜。］(,|夕句)
3	.对于用户，根据式4-4联合分布采样主题分布，其中Z为归一化常数。
1	N
p(4M，...,%) = /exp(-4 X /(%%))口。「& | a) (4-4)
4	.对每个用户：
(a)对于m模态文档的每个词wumn ：
i采样一个主题Zamn〜也
ii采样一个词〜也OlOmzumn)；
46
(b)第M模态文档的每个词7n〜：
i采样一个主题&17n〜〜Multi(^z\e
ii 采样一个词％Wn ~	皿W|0m，zum，n)
(2)模型推导
与LDA模型类似，社交多模态主题模型也属于概率图模型。因此，可以利 用collapsed Gibbs sampling方法来学习模型中的隐变量：用户主题分布0 ,每个 模态下主题一词分布服与服…对于多模态文档中的每个词，根据条件概率采样其 主题分配，而条件概率是根据已观测到其他词的主题分配得到的。由于不同用户 兴趣分布的耦合关系，使得计算条件概率非常困难，因此，本章利用经验的主题 分布来推导模型中的隐变量〔2231。对于用户"的根与加，模态中的第〃个采样词， 其属于主题k的条件概率表达式分别如式(4-5)和式(4-6)所示。
0仁加=左|叼囚人,即)℃
EL(a +*)£北优+力宵
•口 exp(y(，“「z,仇。一 y(ou,z=k，4，))
夕(z””“ =左|2’,%工,平疝)3
ZL（a + 〃2）2%（%+*北
II exp（MG，”，/，）-V @,曰，仇））
其中，j♦表示当前采样词叱皿，吟也表示m模态中除了当前采样，词叱皿在主题 k中出现的次数；吧j表示用户〃商多模态文档中除了当前采样，所有词所属主题 为左的个数；儿用户〃除了当前采样的经验主题分布，凡,E为当前词所分 配主题为上时,用户〃的经验主题分布；外为用户的好友的经验主题分布。同理， 可以推导出模态出的相关参数。上述式中的经验主题分布中每一项的计算表达 式为：
其中，〃华表示用户"的多模态文档词中属于主题上的个数。
在吉布斯采样过程中，算法需要不断更新不同模态中词所属的主题、用户所 属主题这几个参数，整个参数的推导过程如算法4-1所示。其中，算法收敛后, 根据式(4-8)与式(4-9)估计出不同模态的“主题-词”分布。
(4+成泮
算法4-1 Social-mmLDA的吉布斯采样过程
Input： social network G =(匕 E)
multimodal documents {(九,D1mMD21n,,%)}
Output： 0 ,落 and 图
initialize氏九夕凡，乩,
Randomly initialize topic Z, calculate 力?,壮)*)» 碟M")
repeat
for u= 1 —>N do
for u' in	do
for m in {肛”} do
forn= \ —>Wm do
for k = 1 f Kdo
calculate p(z四界=k) according to Eq.(4-5) or Eq.(4-6)
end for
sample a topic k for wumn according to p =
n* =雄+1
戏F)=成浮+i
Zumn =卜
end for
end for
end for
end for
update % /3m,4,according Eq.(4-12)、Eq.(4-13) and Eq.(4-14)
until convergence or maximum iteration
A	A
calculate 0,耙 and % according to Eq.(4-7), Eq.(4-8) and Eq.(4-9)
A	A
return仇内备
48
4,+碟泮
(4-9)
经过上述模型对用户兴趣建模后，可以利用主题表示法或关键词表示法来表 示用户，为了将兴趣模型与跨模态检索有效结合起来，本章利用有权重的词来表 示用户。根据前面叙述，不同模态中词的权重可以表示为：
K
Weight^ = 26 限葭
kl wm=\
K Wm, Weight^,) =	瓦/鼠1，
左=1 % = 1
(4-10)
(4-H)
此外，对于主题模型来说，超参数的选择会严重影响模型的性能。对于传统 的LDA模型而言，根据经验，一般取a = 50/K, >0 = 0.01,此时模型收敛比较 快，其中K为主题个数。然而，这些参数对社交多模态主题模型并不是最优的。 因此，借鉴存在的研究Ml,对于模型中的超参数风可以从训练数据中自 动的学习。每次迭代中，固定其他变量，相应的超参数更新规则如下：
N
KE
”=1
6犬(斗摩+073))
|_副=]k=l	.
(%(£(¥ (套)+a)))— 乎(Ka)
(4-12)
a
~ w
凡之£(+(〃•)+a)T(AJ)
k=1 n=A
(4-13)
、
£中之（中（成"+色））-小例用）
〈垃=1
7
色於七（呼碳『）+4）-以4.））
Iw el
K
wm.y^
k=l
(4-14)
（〃犷+乩，））7（服乩，）
、
、
7
7
其中，*（•）是Gamma函数，表达式为乎（%）=旦111（『0））。 ax
