3.5.2启动USRP进程模块
当主控程序通过ZMQ机制接收到迁移发起端发送的“start_usrp”控制指令 之后，程序会跳转到启动与USRP设备进行数据通信的USRP届程的处理模块, 并进行相应的启动处理工作。
首先主控程序会将IBM Server2与千兆交换机相连的网络端口 eth3的ip地址 配置为192.168.10.1,使能够满足与USRP进行通信连接的要求。如果修改成功， 则通过“uhd_find_devices”指令不断探测USRP设备的存在，将进一步试图与 之建立连接；如棄修改失败，则向迁移发起端发送ip地址修改失败的消息，并
45
结束本次处理过程。
当不断的通过“uhd_find_devices"指令探测USRP设备存在的同时，由于 IBMServer2不断的向夕［发錄测指令，这样也能够让交换机更快的“知道"该 Server的ip地址已经改变，使交换机修改该server的ip地址与mac地址的对应 关系。
如果在规定次数内检测到USRP设备的存在，将开始启动USRP进程操作; 但是如果超过规定次数仍没有检测到USRP设备的存在，就将eth3端口的ip改 回192.168.20.2,并向迁移发起端发送USRP进程启动失败的消息，结束此次启 动操作。
在确定USRP设备存在时，主控程序将调用cmdProcess函数启动USRP进程 （此处的USRP进程启动，是完整的包含初始化操作的进程启动，启动过程如 3.2丄2小节所介绍）。在启动结束后，将检测启动USRP进程操作是否成功，如 果启动成功，则迁移发起端发送USRP进程启动成功消息，并成功结束本次启动 处理过程；如果启动进程失败，则先将eth3端口的ip改回到192.168.20.2,然后 再向迁移发起端发送USRP进程启动失败的消息，同时结束本次启动处理过程。
迁移目的端中，启动USRP进程的处理流程如图3-18所示，
图3-18迁移目的端USRP进程启动操作流程
46
