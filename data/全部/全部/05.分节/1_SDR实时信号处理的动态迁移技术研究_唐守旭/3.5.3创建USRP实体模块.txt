3.5.3创建USRP实体模块
当主控程序通过ZMQ机制接收到迁移发起端发送的“make_usrp”控制指令 之后，程序会跳转到创建USRP实体的处理模块，并进行相应面创建处理工作。
迁移目的端中的动态迁移系统的主控程序首先将调用UHD的API接口函数 uhd::usrp::multi usrp::make来创建一个USRP实体。如果USRP实体创建成功， 则将会进行下二步操作，开辟本地的缓存buffer用来存放待发送或者待接收的数 据，然后定义元数据用来存储发送数据或者接收数据的起始位置和错误类型标识。 如果上述各步操作都执行成功，则将会向迁移发起端发送USRP实体创建成功的 消息；但只要上述操作中，有一步操作执行失败，则会终止此次创建USRP实体 操作，不再继续下面的操作，向迁移发起端发送USRP实体创建失败的消息。在 向迁移发起端发送完创建结果消息后，结束此次创建操作。
迁移目的端USRP实体的创建操作具体流程如图3-19所示。
图3-19迁移目的端USRP实体创建流程
