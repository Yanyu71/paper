3.4.2启动实时信号处理相关进程模块
当主控程序接收到标准输入终端输入的控制指令为“DS”时，主控程序会跳 转到启动迁移发起端实时信号处理程序的相关D2D进程和USRP进程的处理模 块，并进行一系列的启动处理操作。
首先修改与交换机相连的网络端口 eth3的ip地址为192.168.10.1,以便能够 与USRP进行数据通信连接。如果修改成功，则可以进行下一步操作；如果修改 失败，则直接结束本次启动工作流程。
当eth3端口的ip修改成功之后，将会调用cmdProcess函数来启动实时信号 处理程序D2D进程。启动D2D进程结束后，将会检测D2D进程是否启动成功。 如果启动成功，则可以进行下一步操作；如果启动失败，则会将之前修改的eth3 端口的ip再修改回192.168.20.2,并直接结束本次启动处理流程。
在D2D进程启动成功之后，然后就开始不断的通过“uhd_find_devices”指 令探测USRP设备的存在。在探测的同时，由于IBMServerl禾断曲向外发送探 测指令，所以也能够让交换机更快的建立起IBM Serverl的ip地址和mac地址 的对应关系，以便能够更快的让网内的设备“知道”自己的存在。如果在规定的 次数内通过“uhd_find_devices”指令探测到USRP设备的存在，就可以建立起 IBM Serverl中的USRP实体与USRP设备之间的数据链路链接；如果在规定的 次数内一直没有检测到USRP设备的存在，则意味着本次启动工作将无法进行, 则将eth3端口的ip修改为192.168.20.2,并同时结束前面已经成功启动的D2D 进程,然后跳出本次启动工作流程。这里的最大检测次数是通过不断测试得出的，
32
定为8次。	-
当确定USRP设备存在并保证可以与之建立通信连接之后，将调用 cmdProcess函数来启动USRP进程（此处的USRP进程启动，是完整的包含初始 化操作的进程启动，启动过程如3.2.1.2小节所介绍），函数处理结束后，将检测 USRP进程是否启动成功。如果USRP进程启动成功，则将打印启动成功报告, 然后创建一个新线程对D2D程序的控制信息进行釆集；如果USRP进程启动失 败，则会先将eth3端口的ip改回到192.168.20.2,然后再结束之前启动的D2D 进程，并结束本次启动处理流程。
在创建的新线程中，动态迁移系统将会每隔10s启动一次采集数据操作，用 来更新系统中用来保存D2D程序控制信息的Control字典变量，使Control中保 存的不同变量对应的参数值保持最新。
迁移发起端IBM Serverl中实时信号处理程序相关进程启动操作流程示意图 如图3-10所小。
33
图3-10迁移发起端实时信号处理程序进程启动流程
