3.4.2HARQ
HARQ (Hybrid Automatic Repeat reQuest)混合自动重传请求，为 FEC 和 ARQ的联合。过多的FEC冗余会降低传输效率，较少的FEC冗余降低传输正 确率，HARQ能够在FEC不能进行成功纠错时使用ARQ重传，兼顾传输效率 与正确率。
D2D通信中，使用HARQ对无线承载进行QoS保证，并补偿快衰落引入 的传输错误。HARQ设计时，考虑最大限度利用LTE已有技术与模块，并针对 二者的差异给出解决方案。
首先将D2D通信环境与LTE通信环境中的HARQ条件进行比较。在LTE 蜂窝网络中，上行使用同步HARQ,其数据与反馈指示间时间间隔恒定，初传 与重传、重传与重传之间的时间间隔恒定[3%由于通信资源由基站集中调度， 可以保持与前次传输相同也可以不同，即使用自适应、非自适应资源分配皆可。 对于D2D HARQ的设计，考虑到D2D使用专用DCCCH,当确认指示
39
ACK/NACK与传输数据间定时恒定，通过SSCA竞争得到数据传输资源的同时 也确定了在冲突域内对ACK反馈信道的接入权，能够满足确认指示与数据传输 间恒定的时间间隔。但DUE作为异构网络的次用户，在重传时，其对应的上一 次调度时使用的通信资源在本次调度中不能得到保证，需要等到蜂窝网络资源 分配后才能在此基础上进行调度。这导致了 D2D HARQ与LTE HARQ的设计 不同。
通过上述分析，并借鉴LTE HARQ的设计思路,提出使用定时反馈的异步、 自适应的D2D HARQ过程，并使用与LTE相同的多进程停等（S/W）协议。“定 时反馈”、“异步”、“自适应”分别指：确认指示与传输数据之间的定时关系确 定；初传与重传、重传与重传时间间隔不定，需要根据竞争到的资源决定，在 数据传输时由随路控制信道进行初传、重传指定；数据重传与之前传输所使用 的资源选择相互独立，需要蜂窝网络资源分配情况后才能决定。多进程S/W协 议利用了标准停等协议的简单性，每个进程负责一个传输块的存储、传输、确 认，由N路HARQ进程并行运行以避免在等待ACK反馈期间单进程不能进行 新数据发送的弊端，增强吞吐能力。
在进行D2D HARQ其余MAC层方案设计前，需要先确定物理层对HARQ 提供的支持，以进行RRM-PHY的跨层HARQ设计。HARQ技术除了由MAC 层提供HARQ实体管理及状态转换、重传时参与MCS选择、确认反馈的传输 外，还需要物理层在基带信号处理层面提供对初传与重传进行增量冗余（IR） 发送、接收合并或对Chase合并（CC）的支持。
物理层HARQ对于IR和CC的支持，主要决定于基带信号处理中的速率 匹配模块。由于D2D与LTE通信使用相同的MCS方案，且文献［31］中规定的 速率匹配模块能够支持对可变长度的传输块通过打孔、重复操作对信道不同资 源量予以适配，故D2D完全复用LTE中的速率匹配模块便可以完成物理层对 HARQ的支持，具体物理层信号处理方案在此不予过多描述。考虑到IR能够提 供更多合并增益，在D2D中，仅使用IR作为HARQ的合并方案，并将最大重 传次数设置为4,、冗余版本（RV）设置为0〜3,以保持与LTE的一致性。
确定HARQ物理层方案后，针对D2D与LTE HARQ的差异给出以下解决 方案：
1.初传与重传控制参数
对于D2D通信中初传与重传可能取得不同的信道资源，考虑如下：RxDUE 物理层HARQ软合并处于速率匹配后、Turbo译码前的虚拟环状缓冲区，如图 3-18所示，必须保证初传与重传时此处数据一致，即原始数据、TBsize不能改
40
变，编码方式由于仅使用Turbo不需考虑，其余参数可以随着使用信道资源量 的不同而变化。
图318物理层数据传输速率匹配框图
调制方式与RB数量的变化体现在信道传输容量上，会得到不同的E （速 率匹配中环状缓冲区中数据的传输长度），冗余版本RV的变化体现在kO （速率 匹配中环状缓冲区中数据传输起始位置）不同，LTE与D2D速率匹配差别如囹 3-19所示。所以，对于同一 HARQ进程的初传与重传控制参数，TBSize不寵 改变，RV由HARQ进程控制，其他参数如资源段起始、资源段长度、发送功 率、调制方式等均由RRM在重传调度时计算得到。
图3-19 LTE与D2D速率匹配差别
2.ACK捆绑
在FDD-LTE中，一次上行PUSCH传输对应一个ACK；在TDD-LTE中， 若一帧中下行子帧数不少于上行子帧数,根据协议中固定模式每一个ACK对应 一个上行PUSCH传输，否则使用ACK捆绑（ACK Bundling）㈣技术。
根据基于SSCA的D2D数据传输流程，TDD网络中D2D资源竞争粒度为 一个无线帧，FDD网络中D2D资源竞争粒度为两个上行子帧。一次竞争传输 流程仅对应一个ACK控制子信道ACK-CCCH,需要在这个信道中反馈其对应 的资源竞争粒度中全部传输结果，所以也需要使用ACK Bundling技术。但与之
41 不同的是，D2D使用控制子信道，其信道资源比LTE中ACK指示传输资源多， 在设计时主要关注ACK指示的对应关系。
对ACK Bundling中需要预留的ACK指示数量做如下考虑。对于TDD模 式而言，一个无线帧中最多能够提供的上行子帧数为6 (TDD Config 0),需要 预留6个ACK/NACK位置。FDD中，竞争粒度为2,所以需要2个反馈位置。
D2D通信中，可能存在竞争到无线资源却不能全部利用的问题。例如，在 TDD Config 1中,一次竞争能够获得四个上行子帧的接入权，但其发送缓冲区 利用三个上行子帧便全部发送完毕，最后一个上行子帧不会进行数据发送。所 以，在接收端存在三种接收情况：
1)D2D数据随路控制信道(DATACTRL：CCCH)正确，D2D数据共享信 道(DPSCH) CRC校验正确，表明传输成功，反馈ACK；
2)DATACTRL-CCCH正确，DPSCH CRC错误，表明TxDUE有数据发送， 但RxDUE接收错误，反馈NACK；
3)DAIACTRL-CCCH错误，无法进行DPSCH解码，此时不能确定是接 收错误还是未发送，默认反馈NACK；
对于TDD模式非UL子帧的预留位置，默认置NACK,由TxDUE HARQ 负责对应进程匹配处理。
