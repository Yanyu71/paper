3.3.3基于能量检测的资源选取方案
每个设备在开始进行邻居发现时会选择这个设备检测到的能量较小的一个 资源块作为发送发现信号的时频资源〔22】，这本质上是一种贪婪的思想。D2D设 备基于这种策略选取有两种可能的结果：一种是这个资源块没有被它周边的设备 使用；另一种是这个资源块有被它周边的设备使用，但是这个资源块中信号相互 的干扰程度很大概率要比其他的资源块中的信号相互的干扰程度小。此外，D2D 邻居发现的信号传输中有时候会受到带内辐射的影响，带内辐射可能会导致远近 效应。例如，UE1与UE3选取了相同子帧的资源块用于发送发现信号，UE1离 UE2的距离要比UE3离UE2的距离近得多，那么在UE2处接收到UE3的发现 信号将严重地受到UE1的发现信号的带内辐射的干扰。
研究人员提出了资源跳跃的方案来减少半双工和带内辐射带来的影响。资源 跳跃是指在D2D设备进入邻居发现流程并已经选取了一个DRB后，在实际的第 一个发现周期D2D设备将使用这个DRB发送发现信号，其他的发现周期UE将 跳跃到与上一个发现周期不同的DRB上发送发现信号，而这个跳跃的模式由映 射函数决定，映射函数根据上一个发现周期使用的DRB在邻居发现资源池中的 时频位置求出接下来的一个发现周期使用的DRB的时频位置。映射函数最好能 够满足一个DRB不会总停留在子帧的中间频段区域的要求，因为这个区域受载 波泄露的影响很大。
在上一节中提到的资源选择冲突的问题在这个方案中也会遇到，资源选取冲 突的设备并不知道冲突的存在，这将导致资源选取冲突的设备间永远无法相互发 现。为了解决这个问题，需要UE进行适时地沉默并进行能量的检测，如果发现 有资源选取冲突的可能则进行资源的重选。
具体的方案描述如下：
（1）	D2D设备的邻居发现流程启动后，UE先监听一个发现周期，检测发 现资源池中的每个DRB接收到的信号的能量。
（2）	对发现资源池中所有的DRBs按照检测到的能量进行排序，在能量值 排在后y%的DRBs中随机地选择一个资源块，在接下来的一个发现周期，设备 将使用这个DRB来发送发现信号。
（3）	D2D设备根据预设定的资源跳跃的函数来决定接下来的每一个发现周
期中使用的DRB,资源跳跃函数的设计有多种，下面是［22］中提出的一种资源跳 跃的函数，N是每个发现周期中发现子帧的个数，上是每个发现子帧中DRB的 个数。，表示发现周期的序号。因此第，个发现周期选择的DRB可以用 （秫（，）/（。）的二元组来表示，其中表示选择的DRB所在子帧的编号 （0 <n（t）<N）, 表示选择的DRB在子帧中的编号（0	“）。公式（3-5）
25
中的®和$分别表示的是在由p生成的Galois域上的乘和加，其中pa=N ,例 如GF（p。） o整数，将通过t mod （p"）和GE（p"）之间的一一映射关系映射到 GF（pa）的一个元素。这种样式的映射函数可以保证两个UE选择的DRB岀现在 同一个子帧的频率最小，这将减小半双工和远近效应带来影响。实践表明即使N 不是一个质数或质数的蓦次方，下面的映射函数也将工作地很好
= I.
/、	（3-5）
心）=丿®（1釦）.
（4）	D2D设备每凡札"，个周期随机地选择一个周期作为沉默周期，沉默周期 中UE不发送发现信号，而是监听发现资源池中所有的DRBs接收到的发现信号。 如果D2D设备选择的DRB上接收到的信号的能量比其他DRBs中接收到的能量 要高，具体来说就是UE会测量所有DRB中接收到的信号的能量，并以测量到 的能量值对所有的DRBs排序，如果所选的DRB接收到的能量比所有DRBs接 收到能量值后y%中的最高值的还要高zdB时,UE会重新从能量值后y%的DRBs 中随机地选择一个资源块。
