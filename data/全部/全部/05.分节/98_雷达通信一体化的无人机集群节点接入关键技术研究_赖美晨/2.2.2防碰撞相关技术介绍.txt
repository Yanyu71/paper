2.2.2防碰撞相关技术介绍
估计滤波器如卡尔曼滤波器、扩展卡尔曼滤波器等常被用作碰撞预测的程序。 其中扩展卡尔曼滤波器是一种最小均方误差估计方法，利用一阶泰勒级数对非线 性系统进行线性化［82】。扩展卡尔曼滤波器具有良好的轨迹预测能力，可以实现最 优轨迹预测，基于上一次预测的偏差和此次输入量不断进行迭代，最终实现收敛 的这样一个过程，工作流程图如图2-3所示。
16
扩展卡尔曼滤波包括两个重要的向量：状态向量X*)和测量向量Z伉)状态 向量用来描述系统动态行为，测量向量代表了某一时刻的测量值。扩展卡尔曼滤 波器使用过程方程和测量方程对状态进行预测，将状态向量滤波值X(幻经由卡 尔曼滤波器估计的值计表示为沁)。假设/(・)是动态模型函数，方(・)是测量模 型函数，/(・)根据k-1状态估计计算时间步长k中的状态，恥)根据预测状态计 算预测测量。状态向量和测量向量有以下表达式1蹈：
Z(k) = h(X{k},k) + Rk
其中Q4和殆分别是过程噪声和测量噪声，并且有Qk-x ~ N(0, of J、
Rk-i ~	。
将/(・)和方(・)对左仇)进行一阶泰勒级数展开，用F(£-1)表示/(•)的雅可
则式(4-1)和式(4-2)可以转换为血］:
X(E) = F(上一 1)X(* — 1) + O£|+<I\T	(2-3)
17
Z(k) = H(k)X(k) + b：	(2-4)
其中①-为外作用项。
关于扩展卡尔曼滤波器算法的详细介绍读者可以参阅文献[82],主要有状态 预测和状态更新两大步骤[82〕：
(1) 状态预测：
用k-1时刻的状态估计k时刻的状态：
X{k\k-\) = F(k\k-\)X{k-\\k-\)	(2-5)
预测误差协方差矩阵：
P(k\k-}} = F{k\k-\)P(k-\\k-\}FT (k\k-\) + Qk	(2-6)
(2) 状态更新：
更新观测向量：
更引—1)=日(引上_1)龙伙比_1)	Q_7)
计算滤波增益：
K(k) = P{k\k-i)HT (k^H{k)P{k\k-\)Hr ©) + &「	(2-8)
更新状态向量：
X(k\k) = X(k\k-\)+K{k-)[z{k)-Z{k\k-\)]	(2_刃
更新协方差矩阵：
P{k\k) = P{k\k-\)-K(k)H(k)P{k\k-\)	(2-10)
无人机的飞行环境复杂多变，在飞行过程中会随机遇到各种情况，因此防碰 撞算法需要灵活应变适应不同的环境，不仅需要躲避静态障碍物还需要绕开动态 障碍物和其它无人机。无人机通常不仅仅局限在一个平面上飞行，需要扩展到三 维空间。RRT算法是一种基于概率采样的搜索方法，通过在规划空间随机采样不 断往安全区域延伸，从而寻找到一条从起点到目标点的路径。RRT算法不需要建 模，非常适合用来解决在三维动态障碍物环境下具有复杂约束的无人机路径规划 问题。
RRT算法通过釆样和增加叶节点数量来生成随机扩展树最终找到一条 从起点到终点的路径，主要步骤包括：构造采样点，找到根节点和扩展节点。假 设初始点和目标点分别为乙和ZG，可以用集合S保存RRT树的节点信息，起点 是RRT树的第一个顶点，将起点乙添加到集合S中。首先RRT搜索树从乙出
18
发，随机生成采样点Z®d，然后在集合S中搜索距离Z”a”d最近的节点Z”e”。在 此基础上，在乙^”与乙如孑的连线上取预先设定的最小检测步长所在的点Z”和。 当Z”酗和Z”边之间的区域没有威胁时，把Z”帥加入到集合S中，可知此时Z”e” 为Z”刑的父节点。如果Z”旳和Z”。"之间存在威胁则重新生成Z®d。重复上述 步骤，直到集合S中存在一个叶子节点到达终点ZG的距离小于使用预定义的最 小检测步长I。最后，从终点ZG出发，找到每个节点的父节点直至起点，依次连 接每个节点，生成从乙到ZG的路径。至此，对于给定的初始状态构造了一棵具 有M个节点的快速探索随机树。
RRT算法的简单示意图如下：
图2-4 RRT算法简单示意图
RRT*算法的过程大体上和RRT算法相同，在RRT算法的基础上增加邻域 最近父节点计算和为邻域节点重新布线两个步骤寻找代价更小的路径，因此可以 获得比RRT算法更优的路径。
RRT*算法生成Z”帥节点之前的步骤与RRT算法完全相同，与RRT算法不 同的是，在生成节点Z”羽之后不会立刻与乙如连接起来，将以Z”刑为圆心，以 预定义的半径作圆作为Z”旳的邻域，寻找在邻域范围内到Z”刊路径代价最小的 节点Znearest •并且需要保证乙帥与的连线中不存在威胁，如图2-5所示。 寻找到Z应帕之后，连接Z和Znearest，Znearest即为Znew的父节点。而后比较 Z”和的邻域中的各点的路径代价与通过Z”旳到达该点的路径代价大小，如果通 过Z”刊到达当前点的路径代价更小，则删去与原父节点之间的连线，将乙”申作 为当前节点新的父节点，重新布线，如图2-6所示。
19
RRT*算法常作为一种基本方法与其他方法相结合以获得更好的性能。本文 将利用雷达和通信信息为RRT*算法提供有效的信息，借助一体化信号识别动态 障碍物和无人机，并且融合感知和通信信息进行碰撞预测确定冲突区域，进行路 径重新规划。
20
