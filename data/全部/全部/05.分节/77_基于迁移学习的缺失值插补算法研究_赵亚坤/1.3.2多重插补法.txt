1.3.2多重插补法
多重插补的方法是Rubin在1978年提出的.后经过多次发展完善，已经是一 个比较完整的理论体系。多重插补基于的缺失机制是随机缺失，更加贴近真实数
据。多值插补缺失值的方法与极大似然类似，其基本假设是缺失数据是随机的。
多重插补算法是利用似然函数估计出待插补的值，再添加不同噪声形成多组插补 值，最终通过某种算法选择出最合适的值。董世杰口4］分别实验了线性回归多重 插补、贝叶斯多重回归和贝叶斯自助线性回归多重插补法，对缺失值插补的结果 进行分析。模拟结果显示，这三种多重插补法显著改善了插补结果。多重插补法 由下列几种常用的方法：随机填补法〔口,趋势得分法”旬，马尔可夫蒙特卡洛法口7］。 下例以随机填补法为例，介绍算法的细节。
随机填补法通过缺失变量与其他观测变量的回归关系来拟合回归方程。假设 为有缺失值的变量，则Lis同其他自变量七，＞2,…，无关系便可以建立回 归模型：
Ymis=WTxX	(1-1)
回归模型的参数W为回归方程的系数，令回归模型的协方差矩阵为0m则 每次采用随机填补法填充过程为：
1)从回归模型的参数W中选择新的参数/ew以及新的协方差矩阵巧nis匕nis，随 后抽取一个服从旌TT分布的随机变量g,计算新的方差：
g
其中~nis是变量bis已知观察到的个体数。然后从标准的正态分布中随机选 取K+1个元素向量S,那么新产生的回归系数为：
*S	(1-3)
2)那么对于缺失值来说，新的预测值为：
Ynew=Wnew*X	(1-4)
3)从缺失变量-is中找到同Ynew最为接近的K个观察值，并从这K个值中选取 一个值作为最终的插补值。
本例假定了数据样本满足正态分布。虽然该假设并不是真实情况，但是可
以通过实验来得出结论，该假设很接近真实情况。
如图1-1所示为多重插补法的流程，总结起来多重插补方法一般分为三个步
骤，填补、分析和综合。接下来分别介绍这三个步骤：
1)针对每个缺失值都采用一个算法预测一套可能的插补值。可以通过预测一个 再添加不同的噪声，也可以预测出一个插补值可能的域；
2)将所有的可能的插补值分别依次插补进去，构建不同的数据集，并在这多个 数据集分别使用同一个分析模型进行分析；
3)根据模型分析的结果，选取效果最好的那一套插补数据作为最终的插补值。
7
图1-1多重插补法的过程示意图
多重插补算法算是对极大似然估计缺失值插补的一种改进，弥补了其几个方 面的不足：
1）多重插补算法采用多次插补一个缺失值，其依据大数据的理论，先验概率对 最终结果的影响将会很小。而极大似然估计需要先验的模型必须正确，否则 将得到错误的结论，比较依赖先验的知识；
2）多重插补算法利用了参数之间的相互关系，比极大似然估计要更加准确。
