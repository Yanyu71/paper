2.3.1AUC
AUC的含义是曲线下面积，这里提到的曲线(Curves)指的是ROC曲线 (Receiver Operating Characteristic Curve) , ROC 曲线是由混淆矩阵得来的。混 淆矩阵是针对二分类问题来得出的。以下用一个例子来解释：
假设有一个任务，预测明天会否下雨，则明天下雨和不下雨为典型的二分类
22
问题。令y=l表示明天会下雨，y=0表示明天不会下雨，则可以绘制如下表格: 表2-5 混淆矩阵表格
真实情况	预测结果
y=1下雨	尸0不下雨
y=1下雨	TP （真正例）	FN （假反例）
y=0不下雨	FP （假正例）	TN （真反例）
如表格2-5, TP表示预测为下雨实际也是下雨的样例数，FN表示预测为不 下雨，实际确实下雨的样例数，FP表示预测为下雨，而实际为不下雨的样例数， TN表示预测为不下雨，而实际也是不下雨的样例数。这四个值就构成混淆矩阵， 我们定义两个变量：
FP
fpr=fp+tn
TP TPR=™
(2-20)
(2-21)
其中，FPR表示，在所有的不下雨中，被预测成下雨的比例，称为假阳率。 假阳率指的是真实为无雨的情况时，有多大概率被预测成有雨。显然，FPR越小 越好。TPR表示，在所有的下雨中，被预测成下雨的比例，称为真阳率。真阳率 指的是真实有雨的情况，有多大概率被预测成有雨。显然，我们希望TPR越大
越好。
0.9
0.8
0.6
二 0.5
0.4	<	——:一
0.3	0』	0.4
0.2 S->---e
0.1 02	0?
0
0	0.2	0.4
0.6	0.8	1
TPR
图2d ROC曲线示意图
二分类模型输出的是预测为正的概率值，其转化成类别标签时需要一个阈值 作为划分标准。阈值的选取会导致分类结果不同，进而导致混淆矩阵不同。在阈
23
值从0到1变化过程中，会形成很多(FPR, TPR)的值，将这些值在坐标系上表 示，所得曲线便为ROC曲线。ROC曲线示意图如图2-4。其中ROC曲线的横坐 标为FPR,纵坐标为TPR。AUC值便为ROC曲线与X轴围成的面积。显然， AUC值越高，ROC曲线更加靠近TPR值为1, FPR值为0的方向。可见AUC 值越高代表结果越好。
AUC计算方法和其定义一样，求ROC曲线与X轴围成的面积。我们计算 每个样本属于正样本的概率并定义为score,算法会将所有样本按照score排序, 则正样本排在负样本之前的概率为AUC值，可知AUC值越大，正样本在负样 本之前的概率越大，则正负样本区分程度就越大，分类算法的性能越好。
在有限样本环境中，我们以频率能够很好的估计出概率值，样本数量越大， 则估计的概率值越精准。令M为正样本的个数,N为负样本的个数。首先对score 从大到小排序，给每个样本定义一个rank值，则将score排名第一的样本对应的 rank值设为N,按照score排名，rank依次递减。正样本中的rank依次相加，最 后减去M-1中两两正样本组合的情况。得到的就是所有的样本中有多少对正类 样本的score大于负类样本的score,然后再除以MXN归一化。使用数学表达式
表达为:
AUC=
Eis positive class rankj-
MQl+M) ~~2-
MxN
(2-22)
23.2 F] score
Fx score,被定义为精确率(precision)和召回率(recall)的调和平均数。其 中精确率和召回率被定义如下：
TP
P-ecisi。片病百
TP
recall=…一丁
TP+FN
其中FP、TP、FN和TN沿用了表格2-3中的定义，则score为:
precision ^recall
F1=2 * -------
precision^-recall
(2-23)
(2-24)
(2-25)
更一般的，Fp score定义为:
F胃=。+乎)*
precision ^recall
6 ^precision) ^-recall
(2-26)
24
