3.1迁移学习缺失值插补算法的构建
在上一章中我们提到，迁移学习有基于实例的迁移学习、基于特征的迁移学 习、基于模型的迁移学习和基于关系知识的迁移学习四种。而相对于实例迁移学 习来说，其他几种迁移学习方法，就通过提取特征的方法，通常用于计算机视觉 和自然语言处理等领域。在本次课题所讨论的表格类型数据中，将外部源数据与 目标数据直接融合在一起训练迁移学习模型,最适合的是基于实例的迁移学习方 法。基于实例的迁移假定源领域的部分训练数据可以通过加权选择之后应用于目 标领域的学习中，源领域训练数据的加权策略是这种技术的关键。该算法主要思 想是，在机器学习插补缺失值算法的基础上，改进了缺失值过多导致的信息不足 的问题。利用迁移学习算法将源数据与数据集中未缺失的变量联合起来，训练一 个插补缺失值的模型，并利用此插补缺失值的模型来对缺失值进行预测填补。
基于实例的迁移学习的缺失值插补算法的主要思想是，引入源数据集来训练 出符合目标数据分布的缺失值插补模型0可以通过减少源数据中不符合本地数据 分布的部分，增强源数据中符合目标数据分布的部分，达到插补缺失值更能够贴 近目标数据集的分布的目的。例如可以去寻找胆固醇高的患者，以其医疗数据来 辅助血糖血脂高的患者填补缺失值。如图3-1为缺失值插补的过程。
27
图3-1迁移学习缺失值插补流程
1）若目标数据X中含有缺失值，则不妨设缺失值所在列为Feat列，则目标数 据X可以根据Feat列是否含有缺失值分为D和C,其中数据集D为Feat列 包含缺失值的部分，C为Feat列不包含缺失值的部分；
源数据s
相交数据si
相交数据C1
相交数据D1
图3-2数据集划分示意图
2）数据集划分如图3-2所示。F1-F5为其他特征列。对于输入源数据集，并查 找源数据集S和数据集D之间特征列相交的部分（图3-2中所示为F1.F3, F4, Feat）,其中对于相交的特征列，源数据集包含该特征列的部分为SI, C 中包含该特征列的为C1；
28
3）将S1和C1的缺失值所在特征列（即Feat列）进行离散化，以便可以适用 于 TradaBoost 分类；
4）使用离散化后的数据集S1和C1输入到迁移学习模型中去，以Feat列作为 标签训练模型；
5）将包含缺失值的数据集D取出相交数据集D1；
6）迁移学习模型TradaBoost预测相交数据集D1的Feat歹U,得到插补完成的数 据集D。此时D中的Feat列是离散值，需要按照离散化之前的标准，将离散 数值恢复成连续的数值。例如，训练时按照120作为血压的阈值将数据划分 为两类，恢复时则按照120以上其他数据的均值和120以下的其他数据均值, 作为两类的恢复后数值。
