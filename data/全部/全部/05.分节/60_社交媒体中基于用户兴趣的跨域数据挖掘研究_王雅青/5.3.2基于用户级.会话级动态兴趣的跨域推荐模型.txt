5.3.2基于用户级.会话级动态兴趣的跨域推荐模型
虽然用户级循环神经网络GRUusr和会话级循环神经网络GRU&、GRU玄都建模 了用户的序列化行为，但GRUusr主要关注追踪用户级的兴趣在所有域中会话间的演 化规律，而GR/s和GR喝s关注每个域中会话内不同行为之间的局部动态性。因 此，本节将两种互补的循环神经网络结合起来，联合建模用户的跨域序列化行为。另 外，用户级和会话级的兴趣表示信息都将传递到模型最后的预测层中辅助输出。因 此，预测代表域d会话中出现的下一个项目的可能性的模型输出值以,“为：
称“ = f(a3，%)	(5-9)
其中，/(•)为指数线性单元(Exponential Linear Unit, ELU)函数。
由于TOPl-max函数磔】能够解决会话型推荐研究中随着采样数增大而产生梯度 消失的问题，因此本文基于TOPl-max函数来构建目标函数。本章提出的模型也可 以采用其他几个基于最大化排序的损失函数进行训练，比如贝叶斯个性化最大排序 (Bayesian Personalized Ranking-max, BPR-max)f201,但是通过实验发现基于 TOPl-max 函数的性能总是比其他的损失函数的性能更好。TOPl-max的优化准则旨使将真正的 目标地得分高于最相关的负样本得分(负样本中得分最高的值)。然后，通过最小化 以下函数可以得到目标函数：
。=I{maxrsj > rsi}	(5-10)
其中，项目i为目标项目，项目j为从域x和y中随机选择的负样本，力了和为针 对项目i和负样本项目j的推荐得分。并将目标项目的分数与所有领域中最相关的负 样本项目的分数进行比较。由于最大化选择。=/{m弊&/〉&/},是不可微的，因此 通过对每个成对损失函数乘以相应的softmax函数o-(rsJ)作为权重，然后进行求和 以不断地逼近目标。利用sigmoid函数近似/{•}<,最终的目标函数如下：
*
^cross ~	X	— %/) + b(「s,j ))
j=l
(5-11)
96
其中，Oj（Gj）	为经过加权处理的成对损失函数，。仁/）为正则化
项，它的作用是使负采样项目的分数趋近于零。
