5.4.1.1基于循环神经网络的跨域短期兴趣模型
本节与5.3节一样都采用基于GRU单元的RNN来捕捉跨域行为中会话内的动态 变化，以克服RNN中的梯度消失问题。为了捕捉不同域中的短期动态特征，将按时 间顺序输入不同域的所有行为数据。
输入层。每个项目的原始输入都是项目的对应索引o利用一个嵌入矩阵E e I 将项目的索引转换为统一的低维实值向量表示，d为项目嵌入表示的维度，N为所有 域中项目的总数。
融合层。由于用户从一个域切换到另一个域时存在跨域切换行为，这使得在建 模跨域动态变化时不可避免地引起一些单域行为间链接丢失的问题，因此本节设计 一个基于乘积神经网络口刀的融合层来合理地恢复用户切换时丢失的短期信息：
8 = [em,n^emjnQb],n = l,...,Nm-l	(5-12)
其中，加代表按时间顺序排列的所有域的会话中当前会话的位置。公咐i%咕 C4 Y im,n e d Yn = V) 7md—I N4、，为当前会话在域d中的前一个邻居会 话的最后的隐藏状态。II为指示函数，由于只有当发生跨域切换时才可能存在链接 的丢失，此处它仅允许在用户行为进行跨域切换时进行融合更新。[•]代表向量的连 接，能够保护不同会话的差异性。6 =心姓门是建慰巡。切/= 1,1,为hadamard 乘积，通过提供更紧密的特征融合以捕捉断开的会话之间交互模式。考虑到跨域行 为的差异性和相关性共存的情况，基于连接和基于乘积的两种融合策略的组合可以 进一步合理地恢复缺失信息。融合层最终可以构建为：
F = ReLU(Wf& + bf)	(5-13)
其中，歹使用ReLU作为激活函数来捕捉非线性特征，叼和与为尸的权重和偏置。
循环层。为了捕获跨域的短期动态特征，利用GRU对会话中的行为依赖关系进 行建模。因此，存在会话中的短期兴趣表示可以通过以下公式进行动态更新：
sm,n = GRU 卡』,1)	(5-14)
其中，5%0 = 5加-1,%—1为前一个会话中的最后一个隐藏状态。
110
