5.4.1.2基于门控神经网络的跨域长期兴趣模型
本节通过建模一组连续的短期兴趣的演化模式，并使用门控结构选择出不同短 期兴趣中最具有代表性的信息，从而构建跨域的长期兴趣表示。同时，增加了一个 跨域兴趣正则化函数，从长期兴趣的角度进一步恢复断开的单域行为间链接。
输入层。首先，利用上一节中已经学习到的一组短期兴趣表示来构建基于会话 级的长期兴趣表示：
-I	I '
8m,n = ^m-Ls ,> …，sm-l	(5-15)
.I	I .
其中，5%芦=£%巴立为每个会话的最后一个隐藏状态。g菽C/X〃代表用户 "的第机个会话中第1个项目位置处的长期兴趣表示。换言之，这是由前"个短期 兴趣表示构成的序列。此外，为了进一步捕捉兴趣演化过程中更多的细节信息，还 构建了基于项目级的长期兴趣表示：
-I	I '
8m,n ~ Sm,n-Le,…，sm,n-l	(5-16)
.I	I .
其中，当时，g嬴将用零向量填充。基于以上两种基于会话级 别的和基于项目级别的表示，最终构建的长期兴趣表示为gm,n =［就“g版/o
门控结构。此处采用了类似于门控线性单元(gated linear unit, GLU)M的结构, GLU主要用在自然语言处理研究中，在预测下一个单词时以控制信息的传播。为了 减少需要学习的参数量，此处将卷积运算替换为内积运算。本章设计的门控结构如 下：
8m,n = 8m,n 凶© 8m,n + %)	(5-17)
其中，勖,。代表内积运算。和与eRg+0为需要学习的参 数。利用门控结构，能够强调真正代表真实用户兴趣的信息，而忽略不相关的部分。
聚合层。利用最大池化(max-pooling)③将长期兴趣表示g叫,映射为一个低维
③在实验中，最大池化的性能优于平均池化(average-pooling),
111
表示：
Pm,n = pooling^ (总5)	(5-18)
跨域兴趣正则化函数。由于长期兴趣比短期兴趣更稳定，并且随着时间的变化 更缓慢，因此两个连续的长期兴趣表示应该是相似的。因此，此处利用一个辅助的 正则化函数，通过最小化跨域行为切换处的两个长期兴趣表示之间的距离来进一步 恢复丢失的长期信息：
Across =工鼠―1,6任 d V ZWi„ € d V " = 1)| |p/_i - Pmj F	(5-19)
其中，Pm,”和P力T分别为当前行为与前一个邻居的长期兴趣表示，它们属于同一个 域do
