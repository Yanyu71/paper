5.4.2基于长短期兴趣的跨域推荐模型
由于BPR-max函数磔1能够解决会话型推荐研究中随着采样数增大而产生梯度 消失的问题，因此本文基于BPR-max来构建目标函数。BPR-max的优化目标是最小 化目标得分高于最大负样本得分(即 5 = maxrj)的负对数概率：
j
^target = ~logP(「i > rnwx)
N
=-log P(5 > rj\rj =	=5)
j=l	(J-ZU J
N	N
=- log £ o(r/)b(_ _ 6)+ . E。(。)。2
j=i	j=i
其中，项目i为目标项目，项目j为从项目集合中随机选择的负样本，N为样本 数，0和rj为针对项目i和负样本项目j的推荐得分。针对非连续的p(o >和 P(0 = %皿)，利用。(为一。)和。/(0)=々/£山1 出进行近似处理。目标函数的最后 一项为正则化项，入为正则化的权重。
短期兴趣和长期兴趣信息都将传递到模型的预测层用于输出。基于此，可以得 出预测当前会话中下一个可能出现的项目的得分rn为：
6 =片+以璃	(5-21)
其中，吟=/(s%“)，偿=/(Pm,")。/(•)为ELU函数。a为调节长期兴趣和短期兴趣信
112
息比例的权重。最后，通过最小化以下公式可以得到最后的目标函数:
L —/侬+
ross
(5-22)
其中，0为超参数，它能够调节预测下一个可能出现的项目的任务和跨域兴趣正则 化之间的比重。在实验中将根据验证集上的性能表现选择合适的超参数。
