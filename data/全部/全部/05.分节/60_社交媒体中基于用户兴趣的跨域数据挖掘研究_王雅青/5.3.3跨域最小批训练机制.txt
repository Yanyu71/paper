5.3.3跨域最小批训练机制
基于文献［3］中提出的用户并行最小批训练机制，本节设计了一个能够满足跨域 场景的有效机制，如图5-6所示，图中以最小批为2举例，斜线填充的框表示域x中 的会话，纯色填充的框表示域y中的会话。首先，针对每个域按用户对会话进行分 组，然后根据会话的时间戳对每个用户所有域内的会话进行排序。接下来，按照时 间戳对每个会话中的项目进行排序。在训练过程中，用户对的第一个会话中的第一 个项目邛」和用户”2的第一个会话中的第一个项目£1组成了模型输入的第一个最 小批。同时，会话中的第二个项目或2和总2组成了对应输出的第一个最小批。然后 将输出用作下一个输入的最小批，以此类推。从图5-4中可以看出，每个最小批中可 能包含了来自两个域的项目，这与只包含同一个域的单域最小批机制不同。在跨域 最小批训练机制中，只有在最小批中出现对应的域d的项目时，才会更新最小批中 相应位置的GRUf的状态。而且，用户的每次点击动作实际上都是用户针对所有域 中的项目做出的选择。因此，该机制从所有域的项目统一选择负样本的方式，保证 了不同域中项目作为候选集的公平性。
