5.5.2同步监测线程同步决策模块
同步监测线程中的同步决策模块相对于通信接收线程中的同步决策模块，在 根据同步搜索得到到的状态标志进行状态决策后，需要加入状态变迁操作122]。 同步监测线程中的同步决策模块的架构如图5- 10所示，该同步决策模块由两部 分组成， 一是状态决策，根据实时状态标志和第四章分析的状态条件，完成上行 状态和下行状态的判定，与通信接收线程中同步决策模块不同的是，首先需要判 定状态标志UE STATE,   这是由于在通信接收线程中已完成同步的建立，因此如 果已与基站建立同步关系，则在同步监测线程中可以完成 UE  同步搜索。若为 Active, 则 STATE UL   为 UE Slave Mode,   若 为Idle, 则之后的判定流程与通信 接收线程中状态决策模块相同。二是状态变迁，在已得到实时状态的基础上，实 时状态已确定的基础上，与当前系统运行状态比较，如若二者相同，则维持当前 系统状态，否则根据状态条件进行状态变迁，并根据状态选择相应Buffer 中 的 同
步搜索结果重新建立同步关系。
49
(C)1994-2022 China Academic Journal Electronic Publishing House.All rights reserved.   http://www.cnki.net
图5-10 同步监测线程中同步决策模块架构
5.3.2中介绍了用于存储 Cell同步搜索结果和 Sync 同步搜索结果的 Buffer 结构，以及对应的结果选择算法流程。由于UE 同步搜索的引入，同步监测线程 中还需新增一个用于存储UE 同步搜索结果的Buffer, 以及与之对应的同步结果
选择算法。
由5.2.3节所介绍的PUSCH Sync Search 同步函数的接口，本方案设计
PUSCH Sync Res 结构体作为存储蜂窝UE 同步搜索结果的数据类型，由于同步
搜索模块会循环24次，因此使用以该结构体为存储类型，大小为24的数组
Sync Res Buffer[24]作为Sync 同步搜索结果Buffer。
表5-11 PUSCH Sync Res结构体定义
名字	数据类型	描述
sync Foffset	int16 t	频偏值
sync Toffset	int16 t	时偏值
UE Power	int8 t	UE干扰功率
UE ID	int16 t	ID号
与 Cell 同步结果选择算法和 Sync 同步结果选择算法不同的是，在得到由
50
(C)1994-2022 China Academic Journal Electronic Publishing House.All rights reserved.    http://www.cnki.net
Stack 层下发的 PUSCH Sync Ctrl  控制信息后，需要首先进行同步选择。即当 PUSCH Sync Ctrl 包含多个UE 信息时，为了提高系统效率，并不对每个UE 都 进行同步，而是根据干扰功率选择干扰功率最大的UE 进行蜂窝UE 同步，并将 结果封装成PUSCH Sync Res   格式存入相应Buffer。 当24次搜索进行完毕后， 再根据 Buffer 中缓存的同步数据，根据出现次数即频率，选择出现频率最高的 UE 作为上行UE 同步源，这样，就选择出了干扰功率最大而出现频率又最高的 UE 用户作为上行 UE 同步源，与其建立同步获取 TA 信息。该方法的过程如下
图所示：
控制信息
功率判定
UE Buffer数据
∵
均值处理
时频偏结果输出
图5-11 UE 同步搜索结果选择算法过程示意
同步监测线程的引入实现了状态机的状态变迁，完成了动态状态机的工作，
至此，整个异构网络中的同步状态机功能已全部完整实现。
