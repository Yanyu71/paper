4.3.2网络状态预测
本文考虑的核心场景是用户不断移动的场景，例如，持有智能终端的用户去 外地旅游，不断地步行或乘公共交通工具从一个区域移动到另一个区域内，这期 间可能会出现频繁的蜂窝无线通信网络（2G、3G和4G）间的切换、蜂窝无线 通信网络和WLAN的切换、WLAN间的切换甚至个域网络与以上网络之间的切 换。在移动的过程中，用户可能一直使用手机应用（如导航、观看视频、即时通 讯等等）。在移动过程中，目前的情况是用户在每一次网络切换时都会出现几秒 钟的网络中断并可能尽力重连时的丢包，这非常影响用户体验。本文就致力于让
40
用户在不断移动的过程中，始终保持最优的连接方式，并且整个过程中切换时无 缝的，极大的提升用户体验。
对于无线网络状态的粗估计，原理如下：当WiFi在一定的时延门限下无法 交付数据分组时，将调度数据到蜂窝移动通信网络进行传输以保证传输质量。主 要的考虑是当WiFi网络差的时候，等待重传会引发时延变长，一旦出现丢包， 由于在不断移动的环境中，网络不稳定，所以会很大概率的出现重传失败。因此, 在这种情况下，通过丢包率低的蜂窝网络进行传输能保障用户体验。在这一预测 机制中，选择时延门限是非常关键的一步，需要在良好的应用性能和移动蜂窝网 络的负载中找到平衡。假定移动节点正连接到具有良好状态的无线局域网，则该 节点很可能是在一定的时间段内都保持该连接而不进行切换。反之，当移动节点 当前正连接在一个网络状况不好的网络（如小区边界，WiFi边界等）则因为信 号弱或者丢包，需要切换到其他网络上，最差情况是不断地在几种网络间进行来 回切换，用户无法使用网络。我们通过仿真来研究连接的状态，如图所示，对于 不同的连接时长下预测网络的真实状态的正确性进行了试验，并给出了与实际场 景相比的误差。
我们的仿真系统包含可能影响网络性能的各种如衰落，噪声，随机干扰，网 络阻塞等。仿真场景包括了 30个无线路由器（AP）和10个的TD-LTE的基站 组成的异构无线网络。在进行仿真过程中，通过不断发送数据包来检测其连接状 态进而预测其网络状态。这种设置使得我们能够平稳的分析不同位置和时间段内 分析WiFi或LTE的可用性。
图4-4.用来预测在测试平台的状态和实际状态的时间段之间的相对平均误差。垂直条
显示在均值左右95%置信区间。
41
图4-4表明，如果该预测是基于20秒连接时间，预测精度是低的，预测误 差是接近25%。另一方面，当预测是基于50秒保持连接，该预测误差小于10%。 当增加保持的连接的时长，预测的误差并没有提升。因此，我们选用保持50秒 连接状态来以定义网络的状态。
状态检测器连续地观察在WiFi和LTE接口的信号状态。当该网络接口保持 连接超过50秒，则认为网络状态良好即(g,l),添加该路径到可用路径集S中； 当该网络接口保持连接但低于50秒，但网络状态有变好的趋势，其网络状态为 (b,t)；其他情况下，该网络状态较差，表示为通过状态检测器来对附近 的路径进行一个初筛选，排除处于。,1)状态的路径，得到状态较好的路径集合。
