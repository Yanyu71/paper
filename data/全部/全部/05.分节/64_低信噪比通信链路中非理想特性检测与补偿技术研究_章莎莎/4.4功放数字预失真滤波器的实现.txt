4.4功放数字预失真滤波器的实现
本节介绍数字预失真滤波器的FPGA实现，主要是记忆多项式的数字预失真滤 波器的关键操作，包括硬核乘法器的调用和求取输入数据的平方根。
(1)硬核乘法器
许多系统的FPGA实现都需要调用乘法器，硬核乘法器就是Xilinx Xtreme DSP
59
核心构成部分，本实验室项目MIMO SC-FDE的某些环节也调用了乘法器，无需过 多地占用FPGA的逻辑和路由资源，其组成结构如图4-10。根据数字预失真滤波器 的具体实现参数配置乘法器，图4-11是具体的IP core配置界面。
图4-11乘法器IP core的配置界面
60
硬核乘法器的仿真结果如图4-12所示，乘法器的计算时间是一个时钟，用户可
在IP core中添加流水线，最佳选择是三级流水线。
图4-12乘法器IP core的仿真波形
(2) CORDIC算法实现
数字预失真滤波器的具体实现需要调用CORDIC的IP core,可实现多种复杂运 算，如坐标旋转、三角函数、反三角函数和求平方根等，这里我们需要依赖CORDIC
算法实现求平方根的运算，具体配置界面如下图4-13。
图4-13 CORDIC算法的IP core配置界面
具体实现代码的仿真结果如下，延迟18个时钟后，可以得到输入数据的平方根 值。
61
图4-14 CORDIC算法仿真结果
(3)数字预失真滤波器顶层模块测试
实际仿真实现时，我们仿真固定源信源，作为仿真模块的输入数据，进行 MODELSIM仿真至跑出最后的输出数据，写入文本文件，与MATLAB运算结果进 行对点，使实现与仿真的运算结果一致。数字预失真模块的逻辑资源列表如下表4-2o
表4-2 FPGA资源使用情况
资源名称	使用量	总量	使用率
Slices	3520	455040	1%
LUTs	3511	227520	2%
lOBs	349	600	58%
RAM/FIFO	4	416	1%
BUFG/BUFGCTRLS	1	32	3%
DSP48E1S	52	576	9%
(4)硬件系统测试结果
实际调试中，对单载波频域均衡系统进行测试，信源经过发射端编码调制之后， 通过网口采数，并用MATLAB得到未经数字预失真处理的频谱图4-15,在发射端增 加数字预失真模块，通过网口采数和MATLAB绘制得到经过DPD非线性修正的频 谱图4-16,比较两图可知，发射信号频谱的扩展边带得到矫正，频带利用率提高， 数字预失真模块的线性度有一定的改善，从而验证了硬件设计的正确性，同时有力 证明数字预失真算法在低信噪比MIMO SC-FDE系统中的良好性能。
62
-4	-3	-2	-1	0	1	2	3	4	5
Frequency(Hz)	x107
-5
图4-15没有数字预失真滤波的发射波形频谱图
一 一 一 一 一 一 一 一 一 7 一-5 50 505050 50-1-2
(ZH、UJcop)A±±su9a-B」o(Dds」9M0d
4	5
x107
-4	-3	-2-10	1	2	3
Frequency(Hz)
图4・16有数字预失真滤波的发射波形
63
