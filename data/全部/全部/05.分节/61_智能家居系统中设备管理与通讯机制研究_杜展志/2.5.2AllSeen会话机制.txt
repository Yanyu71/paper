2.5.2AllSeen会话机制
AllSeen总线附件内可以同时注册多个总线对象提供多项服务，为了能区分同一 个总线附件上的各个服务，AllSeen设定了联系端口号来区分同一个总线附件上的各 个服务。服务通过总线附件将消息转发到路由进行广播操作,在AllSeen服务框架中， 服务通过申请的WKN名称通过总线附件进行广播操作。在传送消息时，这个名称 会被转换为底层网络结构的unique名称。从而确保消息被传送到正确的总线附件。
同理，AllSeen在连接服务时需要提供一个完整的信息传输规范来详细指定连接 网络的详细参数。AllSeen中服务地址的半连接表达形式如下：｛session options （会 话选项），bus name （总线名称），session port （会话端口）｝。其中会话参数选项决 定了数据以何种方式传输。在IP网络中，这个参数的选项可能是“基于消息的”、“非 结构化数据”或“不可靠的非结构化数据”的。总线附件所申请的well-known名称 用于定位服务。AllSeen中也有总线附件内部传输点的概念，在AllSeen中，这被称 为会话端口，会话端口只在给定的总线附件内起作用，与推断底层接口和对象的方 法一致，连接端口的值可以从总线名称中推断出来。
为了与服务进行通信，客户端也必须实现半连接，客户端的地址也是采用相似 的方法实现的。｛session options （会话选项），unique name （唯一名称），session ID （会话ID） ｝o会话并不要求客户端也向总线请求一个well-known名称，直接提供 总线分配给总线附件的唯一名称即可。由于客户端也不会充当会话的终点，所以， 它们也不提供会话端口，在建立连接时会给客户端分配一个会话ID。在会话的建立 过程中，这个会话ID会返回给服务端。AllSeen会话的建立过程就相当于TCP的连 接创建过程，服务端通过预设端口进行连接，在连接建立后，客户端则会使用一个 临时的端口进行通信。值得注意的是，在服务端和客户端总共有两个会话选项，因 而，在会话建立初始的时候，它们会被分别视做服务端可以支持的会话选项和客户 端可以提供的会话选项，会话创建过程便包括协商会话中实际使用某一会话选项的 这部分。一旦会话形成，客户端和服务端的半连接就会被联合描述成唯一的AllSeen 通信路径：｛session options （会话选项），bus name （总线名称）,unique name （唯一 名称），sessionID （会话ID） ｝。在会话建立过程中，在客户端和服务端进行相互通 信的后台程序也会形成一条逻辑总线。
28
AllSeen会话分为单点会话和多点会话两种类型必，2久其中单点会话为点对点的 连接，多点会话则支持多个设备或是应用在同一会话中进行通讯。会话都是通过一 个特定的端口来创建的。不同的端口允许单点或多点通讯的拓扑结构。如图2-21所 示，左边A和B都通过端口 1和S直接进行端到端的通讯，也就是说，形成了两个
