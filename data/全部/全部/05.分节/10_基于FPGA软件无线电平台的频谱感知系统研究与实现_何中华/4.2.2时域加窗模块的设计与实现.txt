4.2.2时域加窗模块的设计与实现
时域采样的单次时间间隔即时间采样周期，其长度的倒数对应频率分辨率的 大小，所以两次釆样之间的间隔越短，频谱分辨率就会越高。FFT转换对应的分 频谱分辨率为采样时间的倒数，即1/t。在实际的釆样中，为了节省资源的需要， 会尽可能减少釆样的次数，而这就意味着降低频率分辨率，而频率分辨率降低将 会导致一个很严重的问题——栅栏效应El。
假设采样的总个数是N,那么有采样的频率=1。=采样周期N/t的倒数，对 于频域有釆样频率=(l/t)*No当釆样长度t正好为整数倍n个输入信号T的周期 时，频域的频率分辨率为1/nTo此时，频域n个点正好能得到输入信号的频率 点所对应的幅度值。而对于总釆样时间不是输入信号T的整数倍周期时，如果不 加窗加以处理，就可能出现频率泄露，这就造成了栅栏效应。栅栏效应就好像透 过栅栏观赏风景一样，被栅栏挡住的那部分频谱是看不到的，只能看到缝隙也即 频率釆样点对应的那部分频谱，这样就很容易导致有某一部分的有用频谱会被无 意中漏掉，而这部分被滤掉的频谱能量会扩散到其他频点，甚至扩散到带外。
Blackman-Harris Window
1 -
0.8
0.6
0.4
0.2-
oL
0	1000	2000	3000	4000	5000	6000	7000	8000
图4.12布莱克曼哈里斯窗时域响应
硬件的能力是有限的，实际中无法做到无限地提高采样率。如果存在某个窄
42
带信号，其带宽小于频谱分辨率时而且正好处在栅栏挡住的那部分时，就会出现 栅栏效应。而这个窄带信号的功率扩散到临近的频点，造成频谱扩散，如果这个 窄带信号的功率很大会导致严重的带外扩散。窗函数可以有效减少频谱能量的泄 露，可采用不同的截取函数对信号进行截断，这个截断函数就是窗函数，布莱克 曼窗主瓣比较宽，同时它的旁瓣又很小，虽然频谱分辨率不尽人意，但是它的幅 度识别精度表现优异，所以这里我们引入布莱克曼哈里斯窗来解决栅栏效应引起 的问题，布莱克曼哈里斯窗时域响应如图4-12所示。
图4-13时域加窗模块硬件实现结构图
表4-6时域加窗封装模块接口信息
Name	Port Width	Direction	Description
rstn	1	I	输入复位信号，低电平有效
elk	1	1	输入时钟，运算处理时钟，200MHz
s_axis _tvalid	1	I	AXI-Stream Slave接口输入valid信号，为1表示 对应数据为有效数据，为0表示数据无效
s_axis _tready	1	0	AXI-Stream Slave接口输出ready信号，为1表示 当前设备空闲可接收数据，为。则表示设备忙碌
s_axis _tdata	32	1	AXI-Stream Slave 接 口输入 data 信号，位宽 32bit,
输入为降采样滤波器处理后的数据
m_axis _tvalid	1	0	AXI-Stream Master 接口输岀 valid 信号，为］表 示对应输岀数据有效，为0表示对应数据无效
m__axis _tready	1	1	AXI-Stream Master 接口输入 ready 信号，为 1 表
示下级设备空闲，为0表示下级设备忙碌
m_axis _tdata	32	0	AXI-Stream Master接口输出data信号，加窗处
43
理之后的数据，低16bit实部，高16bit虚部
\	.		 ■	，一，......	.		"_ 匚
时域加窗模块的硬件实现结构框图见图4-13,图中可以看到在硬件实现中， 此模块主要完成一个乘法功能，将输入数据与对应的加窗系数进行一个乘法操作, 时域窗系数存储在ROM当中，有一个ROM地址发生器模块来维护ROM读取的 地址变化，乘法完成之后，输出数据位宽是36位，对输出数据做定点化处理之 后，经过一个缓冲FIFO输出给下一级，接口采用AXI-Stream。此模块完全流式 处理，不需要额外的控制信息。
表4-6展示了时域加窗处理模块的接口信号信息，输入接口与输出接口均采 用AXI-Stream接口，输入侧是降采样滤波器模块的输岀数据，经过时域加窗处理 之后，经过FIFO缓冲釆用AXI-Stream Master接口输出tQ数据。valid和ready信 号保证成功握手后正确传输数据。
