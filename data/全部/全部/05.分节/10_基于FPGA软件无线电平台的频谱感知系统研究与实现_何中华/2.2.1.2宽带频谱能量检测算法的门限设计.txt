2.2.1.2宽带频谱能量检测算法的门限设计
门限设计的优劣直接关•系着频谱能量检测算法迭代运算结果的准确性I”】,如 果门限的值设计的过于偏低，会导致很多纯噪声信道被错判为忙碌/占用信道， 相反，如果设计的过于偏高，又会导致很多能量值并不太高的授权用户通信信道 被错判为纯噪声的空闲信道。前者的错判会降低空闲信道的利用率，而后者的错
10
判会干扰影响主用户(授权用户)的正常通信。文献［17］中研究的成果表示提高 能量检测算法性能最重要的方法就是降低漏检率和虚警率之加权和。文献［18］［19］ 中指出了常见的门限设计准则，包括恒虚警概率准则(CFAR)、恒检测率门限准 则(CDR)和最小错判概率准则。
恒虚警概率准则［2。】是指期望能量检测的判决结果的虚警率小于等于一个性 能指标当，由于没有授权用户信号出现时，宽带信号的判决统计量服从均值灵和 方差a：/N,的高斯分布规律，可以得到虚警率门限写的情况下的恒虚警率门限， 见公式(4-8)所示。
Kh,CFAR = Q ' (Pf )-CFw/+ Crw	(2-8)
恒检测率门限准则SI是指能量检测的判决期望对信号检测概率小于等于一 个性能指标即漏检率小于等于马。当有授权信号时，宽带信号的判决统计 量服从均值(氏+E)和方差(b：+E)2/N,的高斯分布规律，可以得到此时的恒漏检 率门限满足公式(4-9)。
yth2 = Q~l (Pd) •码• (SNR +1)/网 + (SNR+1) E	(2-9)
而在宽带频谱感知的场景中，由于存在不同频段的授权用户的信号能量不同 导致不同频段的信噪比等参数不同，漏检率和虚警率对判决结果的性能均有较大 的影响，且孰轻孰重视场景不同会有不同的变化，所以以上的两种门限设计准则 对宽带频谱能量检测迭代算法都不太合适。而基于先验信息全盲的条件下，综合
考虑釆取最小错判概率准则比较适合本文场景中的宽带能量检测算法。 采用最小错判概率准则能达到的错判率门限最小值为：
0,
其中,
B=2b；(l + r)
一 (2 + r)
:坪血(上次1 + ,))
Ntr(2 + r) rj
并且,
根据以上的能量检测场景信号模型，提出图2-4所示的噪声估计和能量检测 联合迭代的算法。
——	1限
图2-4噪声估计与能量检测迭代算法流程图
由上图可知，算法的第一步是初始门限的设置，初始门限的设置取决于对噪 声能量的估计，因为对于采样信号没有任何的先验信息，利用经验公式来进行初 始门限的选取：
c
Vlh,i = — mean{y(n^
上式表示初始门限等于N,次釆样求平均后计算岀的各个频点平均能量再乘 以一个乘法因子C,对本文的超宽带应用场景C 一般在［1, 3］范围内取值。
算法判决模块会根据初始门限或者上次迭代计算的门限对频带内所有频点
的频谱能量检测值进行判决，低于门限的被判决为噪声，高于门限的被判决为信
号。通过对被判决为噪声的频谱能量检测统计量求平均，得到噪声平均能量的估
计值'河见式(2-15),而同样对被判决为信号的频谱能量检测统计量求平均，得到
有用信号的平均能量(包括噪声的在内)估计值见式(2-16) o由式(2-15)和式
(2-16)可以计算得出噪声的平均能量和有用信号的平均能量，进一步计算可以
得到频谱占用率、信道空闲率和整个超宽带频带内的平均信噪比信息㈣，这些信
息会被门限计算模块利用重新计算门限值。每次迭代都会计算出当前迭代运算周
期内计算出的门限值，相邻两次的门限只差小于一个特定小的设定值时，迭代运
算就会收敛，算法运算终止，从而得到最终的能量检测结果。
= \INtmean\Tk \Tk<Vth,\<k<N}	(2-15)
= 1/Ngan{Tk\Tk>Vlh,\<k<N}	(2-16)
12
