3.2.5数值分析与仿真
本节中，我们将通过相应的实验仿真结果来对迭代分组阈值q稀疏算法的3 个方面进行实验分析：（1）图结构权重参数分析。。的取值会影响联合图结构的 构造，极端地来讲，如果e = 0,那么联合图结构C的估计将严重依赖于有向图 结构B,如果0 = 8,那么联合图结构C的估计将严重依赖于无向条件依赖图结 构C,因此，单独基于GTG或CDG联合图结构的构造是不可靠的，我们需要确 定一个最佳的取值空间合理地构造联合图结构；（2）收敛性分析。分组阈值q稀 疏惩罚是在梯度下降迭代过程中，对每次迭代所得的解使用分组q阈值进行筛 选，将筛选后的解作为下一次迭代的起始解。在323已经证明了这一过程的收 敛性，这里将通过实验仿真的方式来验证其迭代过程的收敛性；（3）稀疏惩罚分 析。在非凸非光滑的优化问题中，可能存在多个局部最小点，都不是所需的全局 最小，即使是一些商用非凸问题的估计器中，大多数都不能区别是局部最优解还 是全局最优解，因此这个问题将归结于选择合适的惩罚形式。本实验主要对小
“办+，2”、人、“"+不'、SCAD五种不同的稀疏惩罚进行对比分析。
在此之前，我们需要对稀疏网络图模型B和Q的构造、以及多元时间序列的 生成做相应的描述，以及对评价指标做相应的定义。图结构B的稀疏规则是给定 图结构B的任意节点3其稀疏度服从二项分布B（n,p）,也就是节点与节点之间 边的权重以概率p出现，其对应的权重值服从高斯分布N（O,1）,为了保证系统的 稳定性，对图矩阵B进行特征分解，判断最大的特征值是否小于1,如果大于1, 对图矩阵B进行尺度缩小操作。图结构口的构造与图结构B的稀疏规则设计类 似，但是还需要添加两个约束条件：对称和正定。对称很容易满足，判断矩阵的 正定性可以使用Chollesky分解,如果存在下三角实矩阵L的对角线元素为正数， 那么矩阵是正定的，如果不存在，可以稍微增大矩阵对角线元素的值，继续使用 Chollesky分解判断正定性直到矩阵满足正定为止，最后再对矩阵对角线上的元 素值归一化。根据上面的规则，生成了一个网络大小为P=40的图结构B和Q, 每个网络中有两个子网络，每个子网络的稀疏度是0.1,如图3-3和图3-4分别 为相应的生成图结构矩阵形式与网络形式，在两张图中，左边的图表示图结构B, 右边的图表示图结构。，从图中可以看出他们有相似的网络结构，为联合图结构
30
的构造提供了便利。
True B	True Omega
图3-4生成图结构的网络形式	,
根据图结构生成一阶高斯马尔科夫过程时间序列，初始时刻序列为无。= randn(l, P),根据 xt+1 = Axt + et, et -N(0, fl-1)生成相应的时间序列 Xi，%2, ...xn,由于噪声是多元高斯分布的随机噪声，为了保证时间序列的稳定性 可以选取第1000时间点以后的时间序列。将样本数据进行分割，70%的数据长 度作为训练样本，20%的数据长度作为验证样本，10%的数据长度作为测试样本。 最后对生成的时间序列进行标准化处理珀=(%一可)/肉i = 1,2 ...n； j = 1,2 ...p,弓和目是图结构中每一个节点的时间序列的均值和方差。
评价指标的定义，联合图结构C的作用是检测出共有的边并筛选孤立的节 点，因此侧重于考虑模型的相合性，并且在第四章中图结构还将作为聚类的相似 矩阵，因此注重考虑图结构中有权重的位置的正确性，而那些没有权重的位置如 果被误判为1可以看做是噪声，在聚类时可以通过一定的办法抑制，这里作为评 价指标的参考。定义正确率PR = |{(ij)：% = 1冏=l}|/|{(i,j)： Cij = 1}|,也就 是图结构有权重的位置被正确预测的概率。Pmiss = 1-PR为相应地错误率，即
31
图结构中有权重的位置被遗漏的概率。
（1）图结构权重参数分析
在仿真中，设置样本大小n=50,最大迭代次数乡=le3,误差容忍率（c = le -3,每个网络包含两个大小均等的子网络，每个子图中B和Q的稀疏度为（Pb，Pa）， 在不同稀疏程度（Pb，Pa）下的改变图结构的权重参数中，重复运行50次。图3-5（a） 是网络大小p=80的PR对比图，图3-5（b）是网络大小p=160的PR对比图，横坐 标是权重参数中以2为底的对数值。纵坐标PR是图结构B和Q中各自有权重的 位置被正确预测的概率值除以2o
0.65 ,-上_一 _ _	:	_	-	- --- -	------	-----
0	2	4	6	8	10	12
log 体）
图3-5不同网络模型下的对数权重参数log@）与正确率PR关系图
从图3-5中可以看出，在图结构不同的稀疏图案下，1。8（0）的值在［2,6］之间 PR的值相对比较稳定，当log（4））的值大于6时，PR值急剧波动下降，这严重依 赖于图结构。，也间接地说明了对单独使用CDG估计的图结构进行阈值q筛选 得到的稀疏图结构的正确率，要比使用联合图结构C估计的图结构进行阈值q筛 选得到的稀疏图结构的正确率要低。当log（4）的值在0到2之间时，如果图结构 B和Q的稀疏度相等或者图结构Q的稀疏度比较大时，即它们有相似的稀疏图案 或者B的连接结构要比C的连接结构稀疏，log（a）的值在［1,4］之间，联合图结构 加入了Q的信息，使得在这两种情况下仍然有相对稳定且较高的PR值，而如果 图结构C的稀疏度比较大，即Q的连接结构要比B的连接结构稀疏，联合图结构加 入了。的信息，会变成噪声其干扰B估计的稀疏图案的正确性。因此，如果我们
32
设定的B没有较强的稀疏能力，使用联合图结构会干扰整个估计的性能。由于Q 是对称正定性，一般地，(Pb<Pq)，Q没有B的稀疏能力强，使用联合图结构可 以有效地检测出他们共有的边并筛选出孤立的节点，从而提高整体的正确率PR 值，另外，实验表明在联合图结构的权重参数log"))也不能过大，在我们的线性 一阶高斯马尔科夫过程模型中取值为［2,6］比较合适。
(2)收敛性分析
在仿真中，设置样本大小n=50,网络大小p=40。网络的稀疏概率0.25,图 3-6(a)是阈值q=0.2下的损失函数值变化图，图3-6(b)是不同的阈值q下错误率 Pmiss的变化图，图3-6(c)是不同的阈值q下迭代收敛终止所需的迭代次数。
10000
(a)
5000
从图3-6(a)中可以看出，在单次迭代阈值q=0.2下，使用交替梯度下降法， 并且使用阈值q对每次迭代求得的图结构进行阈值筛选，并作为下一次迭代的初 始解这一过程中损失函数的值是收敛的，图3-6(b)可以看出阈值q的收敛性，也 说明了使用阈值q筛选图结构邻接关系的合理性。当阈值q到达0.35以上时， 错误率Pmiss呈现收敛状态，也就是为了保证图结构中有权重的位置被正确预测 的正确率，可以适当地提高阈值。当阈值q为0.9时，图结构邻接矩阵中几乎有 90%的位置上都有值，不难理解真正的图结构中有权重的位置被正确预测概率很 高，但是这样导致图结构中许多没有权重的位置被错误的置为1，我们把它当作 噪声，为了减少噪声的干扰，在不影响正确率的情况下适当的进行阈值筛选降低 噪声的干扰。当阈值q降到0.35以下时错误率急剧增加，当网络过于稀疏时， 会影响图结构中有权重位置被正确预测的概率。图3-6(c)可以看出，阈值q设置 为很小时，设定的网络过于稀疏，会增加迭代收敛的次数，从而增加了计算的复 杂度。因此选择合适的q值,可以在不影响正确率PR的情况下适当地降低噪声。
(3)稀疏惩罚分析
33
在仿真中，设置样本大小n=50,最大迭代次数乡=le3,误差容忍率（c =他一 3,每个网络包含四个大小均等的子网络，在不同的稀疏惩罚2。、“2。+ 12”、。、 “卜+）"、SCAD下,改变网络大小40,80,160,重复运行50次。如图3-7所示， 在使用不同的惩罚时需要进行参数调整,本仿真提前产生一个n=1000的验证集, 所有的正则参数调整在这个独立的验证集上进行，参数调整利用网格搜索在一定 范围内使得模型在验证集上的BIC最大为最佳参数。但是在，o + G”惩罚中， 为了提高效率，并没有运行二维网格搜索以寻找最佳的的参数，而是每个T1在网 格｛0.5暝,0.05日,0.005限｝,限是最优岭参数，寻找人（n）最小化交叉验证误差，然 后将入固定为最优值，然后寻找最优的T1最小化交叉验证误差。
图3-7不同的网络大小下的稀疏惩罚分析
图3-7仿真对比了稀疏网络图结构的5种不同惩罚函数阈值估计的错误率。
L离散非凸惩罚P（t;入）=X/2 • 1忤。对应的阈值®hSQ =	h凸惩罚
P（t;入）=人|国|对应的阈值：
= s^n（t）（|t| -A）l|t|>a	（3-23）
'1 + %"非凸惩罚P（t；入,n）=/产+ |击I/。对应的阈值：
（o, |t| < 入
入,n）=（上，用 > 入	（3-24）
凸惩罚P（t；人,"）= .
'人间|, ??2t2+A2 、24~~，
Itl < —
e：对应的阈值: iti>4
— eta
34
(	0,	|t| < A
0(t;X,r|)=卜一	4 W \t\ < A + A/t]	(3-25)
(卷，|t| > a + 入m
H|t|,	0 < |t| < 2
(|t|2-2?Mlt|+A2)
SCAD非凸惩罚P(t;入，n)= <	布奇—	"W |t| <娠对应的阈值:
”史，Itl > M
(	0,	|t| < 加I
0(t;A，n)谢九⑴ E「sg鸣皿 < |t| < a	(3-26)
I	I?
I	t, |t| > A
匕凸惩罚使用经典的LASSO估计，尽管LASSO会根据偏差矫正lasso estimator选择参数入，但是由F木文知阵X是马尔科夫过程时间序列，存在共线 性问题，受限于变量选择的不•致性，导致错误筛选的概率很大，尤其是在网络 大小p很大而样本大小n不变时、错误率急剧上升。'4 + G"凸惩罚是在k惩罚 的基础上对估计系数做了不同权重的修正，但是通过权重带来的改进往往是有限 的，尤其是在预测一些相关的问题，所以它的性能只比匕稍微好一点。非凸SCAD 是匕的变体，其阈值函数中当0 W 1.阈值形式退化成4。“3元)，接近于，。惩 罚，其性能跟，。一样在变量选择方面有先天的优势，此外，其在迭代初始点为零 并且在网络规模p很大时性能也好。2。非凸产生于受限制的ML估计问题，在零 点不可微分的部分，将估计系数强制惩罚为0,从而达到稀疏解，在变量选择中 做的很好。从图3-5中可以看出非凸'4+ %”使用参数人和参数T]不仅可以同时 进行变量选择而且还可以收缩系数，在稀疏恢复并且在大规模网络情况下有明显 的优势，其中，。部分处理共线性问题并且自适应各种噪声，同时，o部分，比，1凸 函数罚执行更强稀疏惩罚。毫无奇怪，非凸惩罚需要更多的计算时间，但是我们 使用阈值估计并以一定的概率进行筛选其计算速度是可以接受的。
