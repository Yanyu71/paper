4.2.2聚类数K的确定
根据谱图理论，在无向非负权重图中，对拉普拉斯矩阵L进行分解，特征值 为0的个数K对应着图结构中连通图的个数。假设K=l,即图是全连通图，f是 特征值为0的特征向量：
2
0 =尸4=2上1也/（力一力）	（4-1）
叫,是权重，非负。如果要想上面等式的和为0,那么所有的卬〃•（方-方）必 须为0,因此如果两个顶点巧和好相连，那么那么/的值在所有的顶点上 必须是常数，这些连接的顶点在图中形成了一个路径。因此，如果一个图只由一 个连通集元素组成，那么L的特征矢量基中只有一个常矢量为1,对应的特征值
38
为0。现在考虑K=4,也就是一个图中有k个连通图，不是一般性，假设顶点的 顺序是按照他们属于哪个连通集元素的位置排序的。在这种情况下，相似矩阵有 块对角形式，相应的L也是块对角形式：
£=r - j （4-2）
每个子块乙是L对应的第，个子图的元素，那么L的谱也是由各个子块及的 谱组成。L对应的特征矢量是〃的特征矢量，在其他块的位置为0。每个〃是一 个连通图的拉普拉斯矩阵，且只有一重特征值为0的根，对应的特征矢量在第z 个连通集上是常数。因此L的特征值为0的个数对应着图连通的个数，对应的特 征矢量是连通集元素的指小矢埴。因此，如果我们要判断一个图中连通的个数或 可以聚类的个数，可以观察期为特征值为0的个数，或者看其对应的特征矢量是 否是常矢量。
受特征值和特征向量的启发，可以利用特征值距离来确定聚类数K。我们的 目标是选择合适的K,使得特征值入1，…,儿非常小，而4+i相对比较大。也就是 说，在正常有噪声干扰下，我们不可能得到特征值的K重根，我们希望特征值距 离& -七+i|越大越好。在联合图结构估计出的C可以看作顶点与顶点之间的相 似程度，通过寻找2的拉普拉斯矩阵的最大特征值距离|儿-4+/来确定聚类数 Ko
而r可能受噪声影响，使得।儿一4+ii的最大值不明显，庆幸的是，我们可以 通过阈值q筛选来控制图结构的稀疏度从而控制图结构的噪声干扰。因此，聚类 数K的算法如下算法2,聚类数K的确定通过控制分位数q,使用分组阈值q算 法（GTQ）下得到联合图结构估计G然后计算其拉普拉斯矩阵的特征值及相邻 特征值之间的差|4-4+il，最大的特征值差对应的聚类数K,就是当前阈值q 下的最佳的类数K,调整不同的阈值q,观察特征值及聚类数K的变化情况，直 到聚类数K变化稳定为止。
算法2联合图结构谱聚类聚类数K确定算法_____________________
自动确定聚类数K的谱聚类算法__________________________
Input：数据矩阵X, Y,阈值q, GTQ算法 Initialization： q=0.9
While q>0:
1）使用GTQ算法，得到联合图结构C;
2）将C作为相似矩阵，计算归一化拉普拉斯矩阵L;
3）计算L的特征值，按其降序排列入2的…2
4）计算特征值差 gi，g2,	其中段=7-4+1，
5）计算 K,找到& = 4li+1 > 3 令6 = [g2,…，gm]，K = argmaxG;
39
更改q值，q = q —△,重复上述操作，直到达到稳定的q值为止;
Result：聚类数K
