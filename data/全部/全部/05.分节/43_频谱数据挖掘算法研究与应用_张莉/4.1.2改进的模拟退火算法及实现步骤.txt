4.1.2改进的模拟退火算法及实现步骤
耦合模拟退火算法（Coupled Simulated Annealing, CSA）借用耦合局部优化 法的思想优化模拟退火算法。为了实现各个模拟退火过程的相互耦合与信息共 享，该算法提出耦合接受概率函数的能量和状态等信息，通过逐渐匹配接受函数 与耦合项来引导CSA算法得到全局最优解。CSA的耦合项是当前各个独立SA 状态相应能量的函数。CSA算法融合了所有SA算法的信息能量来完成各个SA 算法的优势互补，即提高CSA算法优化效率又保障参数的拟合精度。
CSA算法用于寻找组合优化参数（正则化参数/、特征加权向量7祢）的过 程包括参数组的产生和接受过程[27】。其搜索的步骤为：
第一步：初始化。初始状态,初始温度T,每个T值得迭代次数￡, 并且计算初始参数组（外,叫。）对应的S折交叉验证得到的损失e°, e°的计算与 3.2节中的cosf的计算相似；同时记录e°为当前最优的姐，对应的（爲,imp。）记 录为当前最优参数组合如° ；
第二步：对k = },2,...,L做第三步至第六步；
第三步：产生新超参数其中一组参数乂产生过程如下
J, =xi.+￡i,xl^0,yi^Cl	（4-1）
其中。表示可能的超参数域，0表示当前超参数的集合x,e9J = l,2,.../,0u。， 〃为耦合的SA数量。易为随机变量，通常选取弓的分布为：
8（&,，九）<-七311（"（尸一0.5））7；,尸日0,1]	（4-2）
其中7；?是*时刻生成温度，k为T的调整次数。即参数以的具体表达式为：
又=玉+tan（?r（r —0.5））*	（4-3 ）
由上式可知，义的分布受约取值得影响，n越大，则乂分布范围越广；反之，随 着"的较小，则乂范围变小，而寻优过程向最优值靠近。所以温度更新规则为 Tk=T0/k -
第四步：计算新的参数组（y,i冲）对应的S折交叉验证得到的损失e，。
第五步：如果满足 时，则接受作为新的当前可行解，即 （7o=/mpo=imp，,e° = e） 如果e' <e0,e' <be0,则记录e，为当前最优的阮（），对应 的（/,7冲'）记录为当前最优参数组合如°;否则如果则以一定的概率被 接纳为当前解。
参数被接受的概率由温度厂。值的大小控制。广。取值越大，则拟合效果表现 较差的参数组的接受可能性越高，参数组的分布范围加大，有助于算法跳出局部 最优超参数；反之，随着温度广"数值的下降，拟合效果较差的参数组被接受可能性降低，表明算法渐渐收敛到全局最优超参数。接受温度的更新规则为 啧=咪* exp(-上-1),其中77是k时刻接受温度。
单一的模拟退火算法超参数的接受几率为』而耦合模拟 退火算法将多个独立的模拟退火算法的接受概率耦合，其接受可能性函数表示为 & (& x, ->j;) , xi,yj e Q ,其中耦合项#是所有参数组｛x,｝］对应损失函数e的 计算函数，其计算式为：月冴［e(x)e(X2),...,e(X")］,其中e(x“)表示第”组参数 的损失值。通过变化耦合项及接受可能性函数，可以组合出多种的耦合模拟退火 算法，本例中参数组的接受几率函数及耦合项函数分别选为：
' f - max(e(Xj))［、
A*0，x,—N)=min l,exp 	釋	 Ip	(4-4)
第六步：判断是否满足终止条件，即最小的损失值此。是否已经达到可以接 受的范围，如果达到则输出最优参数组合奶。及对应的损失值屜。，结束寻优过程; 否则判断在一个生成温度4下，参数组的迭代次数是否达到上限，如果没有则返 回第三步继续寻优过程；如果达到上限则判断上是否大于乙，如果没有则返回到 第二步继续寻优过程，如果达到上限，则输出则输出最优参数组合如。及对应的 损失值施°,结束寻优过程。
