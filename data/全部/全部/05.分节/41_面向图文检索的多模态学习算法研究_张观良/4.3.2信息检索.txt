4.3.2信息检索
本节的多模态模型是基于自然语言模型，因此其损失函数不再是分别面对图 像特征和文本特征。图像的特征是用于影响文本预测下一个单词的概率，没有明 确的文本特征。为了能够使得该模型也可以用于信息检索，同样需要定义图像与 文本之间的相似性。在自然语言模型中，困惑度(perplexity)是用于评价该模型 预测下一个句子程度的好坏［17］：
log? C(吗” | x) = -￡:￡她2 P(吗=/| %_”x)	(4-10)
N wb?
其中辎：”_1表示1到n-l个单词，其序列长度为N。遍历整个序列得到的概率负 对数平均，则是困惑度。假如正确单词的概率越高，说明模型性能够好，其困惑 度则越小。因此给定一个长度为N的句子，从图片数据库中检索图片时，将图 片特征代入，根据式(4-10)得到每张图片对应该句子的困惑度。因为正确的图片 会指导语言模型去预测更好的单词，所以其困惑度更小，从而完成信息检索任务。 例如给定”There is a dog.”,猫和狗的图片在预测前3个单词时，预测概率会相似， 但预测关键字”dog”时，狗的图片得到概率会比猫得到的概率高，从而区别出猫 和狗的图片。这种方法的缺点非常明显，在给定一个句子时，需要遍历整个图像 数据库，计算每个句子对应图片的困惑度，无法建立索引进行加速。
当给定图片，对文本进行检索时，同样需要计算图片与所有句子的困惑度， 但不同于文本数据，整个数据库的图像特征是可以预先计算的，相似的图片之间 特征也相近。假如给定一张有狗的图片，那么可以利用这张图片的特征，通过特征之间的相似性计算，找到数据库中相似图片。搜索方法可以先根据图像特征建 立索引，获取前k张图片。在前k张图片中，各自都会有相应的描述，此时请求 的图片再与这些描述一起计算困惑度，从而检索到文本结果。
