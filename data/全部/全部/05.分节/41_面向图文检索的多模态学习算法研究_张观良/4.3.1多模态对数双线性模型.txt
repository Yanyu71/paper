4.3.1多模态对数双线性模型
在2.3.2节中介绍了对数双线性模型(Log-Bilinear Language, LBL),该模型基 于RBM模型进行改进，利用上下文特征去预测下一个单词的特征。目前许多研 究都通过在自然语言模型中，引入图片特征来生成图片的描述，例如［11］中，在 短时记忆循环神经网络(Long Short-Term Memory Recurrent Neural Network, LSTM-RNN)中，引入了图片特征。因此本文也通过向LBL模型中引入图片特征， 对自然语言模型进行扩展。
steam
图4-1多模态对数双线性模型
引入图片特征的方式受［25］的启发，对图像特征进行转化后作为自然语言模型中的偏置项，根据式(2-25)可以得到预测特征：
昌艺以.	(4-7)
*是第i个单词的词向量，求和是对前1到n-1个单词求和。加入偏置向后得到：
M—1
方(4-8)
i=\
其中x是图像特征，C(‘)是图像的转换矩阵，使得图像特征与文本特征处于同一 维度，模型结构如图4-1所示。根据式(2-25),得到能量函数：
E(W"；Wi："t，x)= -洛“	-寿“	(4-9)
P(t=，|wg,x)的形式与式(2-26)一样，将能量函数代入即可求出。模型是 以受限玻尔兹曼机为基础，因此训练依然使用CD算法。
