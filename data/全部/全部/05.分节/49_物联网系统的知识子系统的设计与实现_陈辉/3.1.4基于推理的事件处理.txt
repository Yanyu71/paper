3.1.4基于推理的事件处理
结合前面的分析，用户的推理目标在前端定义完成之后，会通过HTTP请求的形式 到达后台服务器。因此，我们需要根据HTTP请求参数生成目标对象。此目标对象包含 领域信息、推理范围、推理约束等信息。领域信息主要包括订阅的事件主题，主要用于 事件的订阅。推理范围则是指推理涉及的范围信息，对应了知识库中的知识实例。推理 约束则是目标参数以及相应参数的数值约束，其中参数约束主要包括最大值约束、最小 值约束、均值约束、比例约束等等，对应了相应的计算函数算子。通过目标解析，将用 户推理目标进行处理，最终会成为SMT理论求解器中的一阶逻辑表达式，并生成相应 的推理对象，一个推理对象对应一个一阶逻辑表达式。当推理请求中包含多个推理目标 时，需要生成多个推理对象，每个推理对象负责推理一个推理目标。
本模块的主要子功能包括推理目标转化功能、推理对象生成功能、事件推理功能以 及结果处理功能。用例图如图3-4所示：
图3-4逻辑推理用例图
在实现了事件接入的功能之后，需要将事件进行转化处理。结合前面的分析，对于 每一个新来的事件，为了拿到与事件相关的领域信息，需要分析事件自身携带的信息。 因此，需要提前对事件进行建模，釆用事件模型来描述事件包含的各个字段信息，包括 事件发生的时间、地点、环境等信息。利用这些事件信息描述，可在事件到来时将事件 转化成事件对象。图3-5是事件转化用例图。	“
因为目标推理需要有一定的推理范围，只有在推理范围内的对象才被推理，而不在 此范围内的事件则不被考虑，因此需要利用已有的知识来判断事件是否在推理范围之内, 这就涉及到范围包含的概念。范围包含的关系可在本体模型中定义好，通过将定义好的 本体知识转化一阶逻辑形式，然后将事件映射的知识对象与目标知识对象同样转化为一 阶逻辑表达式，并利用推理判断事件是否属于目标推理的范围。如果是则继续处理，如 果不是则将事件对象和转化生成的知识对象销毁，这样不仅可以过滤无用事件，同时可 以为系统节约内存，从而提高事件的处理性能。范围推理用例图如下所求：
如图所示，对事件进行范围推理之后，如果一个事件经过包含推理证明属于某推理 对象的推理范围之内，则将事件对象和事件对应的知识对象一起交给推理对象进行推理, 同时更新推理结果，并将推理结果存储到设计好的数据库中，以便后续结果展示时获取。
