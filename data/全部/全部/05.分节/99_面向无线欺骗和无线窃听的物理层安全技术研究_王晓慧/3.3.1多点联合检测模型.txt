3.3.1多点联合检测模型
根据RSS的定义和上一节系统模型分析，RSS可表示如下：
26
RSS = P- PL,	(3-8)
其中P为发射功率，P厶为信号传播过程中的路径损耗功率，将(3-1)代入上式得 到：
RSS = P — K 一 10a(6>) log(d/d°)-申⑹，	(3-9)
采集的m个连续RSS样本表示为：
RSS = [RSS】，...，RSS：,…,RSSml	(3-10)
其中，
RSSi =P-K- 10a(6>i)log(di/d°) -0(0)	(3-11)
其中，由于RSS样本可能来自GCS或MA,所以，P为GCS或MA的发射功率， 仇为第i个样本点GCS或MA对UAV的仰角，心表示第i个样本点GCS或MA 到UAV的距离，a⑹)是第i个样本点对应的路径损耗指数，2⑹)是第i个样本点 对应的阴影衰落。由于UAV已知GCS的空间位置，因此可计算出路径损耗功 率,再结合GCS的发送功率可计算出与m个连续RSS样本对应的来自GCS的RSS 理论值，记为RSST，表示如下：
RSST = [RSS】丁,..., RSS( T> ••-1RSSff^ y],	(3-12)
其中，
RSStr = PG-K- 10a(牡 G)log(d“/do)，	(3-13)
其中，PG为GCS的发射功率，O.G为第i个样本点GCS对UAV的仰角，表 示第i个样本点GCS到UAV的距离。
为了描述所提方案的性能，定义漏检率表示UAV将来自MA的信号判决为 来自GCS的概率，即，实际接收来自MA的相邻RSS变化率和来自GCS的RSS 理论值变化率一致的情况下，实际接收来自MA的RSS和来自GCS的RSS理论值 的差值小于等于最佳误差阈值的概率，最佳误差阈值是UAV与GCS开始通信 前设置好的。根据条件概率理论，漏检率(Probability of Missed Detection Rate, Pmd)的数学表达式为：
Pmd = Pr{|/?SS；- r — RSSj M| < 厶,V/|(RSSi T — RSS—T) *
(RSS： M - RSS— M) > 0,Vi},	(3-14)
其中，j & J =	iEl = {2,3,-,N}, N表示每次检测的样本数，RSSjy
和RS》_M分别表示第丿•个位置来自GCS的RSS理论值和实际接收来自MA的RSS, RSSi T和RSS—T分别表示第i^i - 1个位置来自GCS的RSS理论值，RSSi M和 RSS— M分别表示第i和—1个位置实际接收来自MA的RSS。其中，厶表示最佳 误差阈值，通过UAV和GCS预先模拟通信，结合虚警率性能确定。
27
虚警率指的是无人机将来自GCS的信号错判为来自MA的概率，即，实际 接收来自GCS的相邻RSS变化率和来自GCS的RSS理论值变化率不一致，或者 实际接收来自GCS的RSS和来自GCS的RSS理论值的差值大于等于最佳误差阈 值的概率。根据概率理论，虚警率(False alarm rate, Pfa)的数学表达式为：
Pfa = Pr{\RSSj：r 一 RSSj G \ > L, ||(RSSi T — RSS—』*
(RSSi G - RSS^ Q) < 0,3i},	(3-15)
其中，RSSj T. RSSi T和/?SSi_i_T分别表示第八i和i - 1个位置来自GCS的RSS理 论值，RSSj G、RSS「和RSS—_G分别表示第八i和i-1个位置实际接收来口 GCS 的 RSS。
由式(3-⑷和(3-15)可知，最佳误差阈值越小，漏检率越小，但同时UAV 容易将来自合法GCS的信号也误认为来自MA,导致虚警率越大；反之，漏检 率越大，虚警率越小。为了使所提方案在保证虚警率较小的情况下表现出更好检 测效果，最佳误差阈值的确定方法如下：
首先，UAV根据收到来自GCS的RSS,再结合GCS和自己的空间位置 路 径损耗模型等先验知识，计算来自GCS的RSS理论值，再求出两者之间的茅值。 找出收集的样本中差值最大的，记为误差阈值上限厶F，误差阈值下限为0,因此， 最佳误差阈值的取值区间为［0,厶F］。
然后，根据误差阈值的取值区间，令当前误差阈值为厶F/2,根据式(3-15) 计算虚警率，如果当前误差阈值下的虚警率远小于可接受的虚警率范围，则误差 阈值的取值区间缩小为［0,厶F/2］，否则，误差阈值的取值区间缩小为［厶F/2,, 一般虚警率小于0.01属于可接受范围。重复上述过程直到虚警率大概为0.01, 记录此时的误差阈值。
最后，根据虚警率大概为0.01时的误差阈值，再进一步增大误差阈值的设 置精度，利用上述思路最终确定最佳误差阈值。
