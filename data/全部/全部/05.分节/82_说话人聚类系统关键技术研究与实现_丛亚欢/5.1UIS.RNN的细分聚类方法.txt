5.1UIS.RNN的细分聚类方法
28
说话人聚类问题的难点之一就是未知说话人具体数量，例如常见的聚类方法 k-means,谱聚类等，聚类数量的估计的准确度直接严重影响着聚类结果的表现。 此外，在其他语音研究方向中，说话人数量也是重要的先验信息，如语音分离等 任务，很多分离算法中，说话人的数量直接决定着语音分离的质量，因此很多研 究假设已知说话人数量，以此减小问题的复杂程度。然而，在实际的应用中，更 多的是未知说话人数量的情形下的应用场景，由此说话数量估计问题成为单独的 研究领域，此外类似问题还包括overlap的检测等。
传统说话人聚类方法再聚类之后，会根据结果进行边界调整，称为 resegmento Resegment常常能达到提高聚类结果准确度的效果，是基于传统方法 的说话聚类系统中的常见结构之一。然而，在基于深度学习的网络说话人聚类方 法uis-mn中，系统决策时并没有resegment环节。本人实验研究中发现，预先估计 说话人数量，并对说话人聚类应用resegment能够提升聚类结构的准确度。
本文在说话人数估计的任务中，分析当前主流的网络结构和当前的说话人数 量估计方法，提出了将multi heads attention的GST结构应用于说话人数量估计任 务中，获得了比baseline更好的性能，因此可作为预处理模块，估计说话人数量, 用于说话人聚类问题，增加说话人聚类问题的先验信息。结合基于音频的说话人 数量方法GST的基础上，在uis-mn的beam search决策过程，使用GST估计说话人 数量，并作为beam search决策的先验信息，进行再聚类操作。
图5-2聚类细分resegment
此外在多模态的实验中，使用基于人脸检测的说话人数量估计作为uis-mn的 再聚类依据，也获得有效的结果提升。因此对于多模态的聚类任务，本文所改进 的uis-mn系统能够利用说话人数量信息提升聚类的结果。
类似于说话人聚类的语音数据处理步骤，Resegment的实现方式为将原始语 音信号提取MFCC特征，直接作为说话人数量估计模块GST的输入，由于GST网 络支持变长数据的数量估计，因此对不同长度的语音都可以预测其所包含说话人 数量k。uis-mn的聚类过程中beam search执行uis-mn的每的说话人维持一个人
29 RNN网络生长，不同说话人之间维持不同的RNN,因此每一个RNN状态代表着 一个说话人，而根据第三章介绍，RNN的输出结果是类别的均值，因此可用视为 i亥类的类中心，不同的RNN的hidden时间交错，对应输入信号的随时间变化的说 话人身份。因此beam search在计算损失函数的同时维持着多个RNN状态，用于 记录当前时刻的说话人聚类结果和聚类状态。在已知说话数量的前提下，本文提 出在uis-mn的在线预测过程中，一旦当前RNN状态个数大于说话人数量k时，执 行resegmento具体执彳亍方式：
1, 计算当前RNN的均值之间的MSE loss,用于衡量不同类别的距离；
2, 对于MSEloss最低，即类别最接近的两个RNN状态之间，执行resegment 进行预测的类别结果合并，直到当前剩余RNN状态数量不再大于说话人 数量估计值：匕
本文实现了online方式的resegment,在beam search的决策过程中，既避免了 聚类数量多于限定类别数量造成的聚类误差，又在online形式的resegment的过 程中避免了聚类的误差累积，因此提高了聚类的准确度。其效果如图5-2所示， 当在说话人聚类的过程中，发现聚类的类别数超过预先估计的说话人总数，触发 resegment,对类的RNN状态下的均值计算MSE损失，合并其中损失值最小的类 别，损失值表明了不同说话人类中心的距离，直到类别数小于等于预先估计的说 话人总数。
此外，根据模型的结果于时间说话人数量估计的准确度，可设定beam search 的RNN状态数量阈值为可调参数，由此避免对说话人数量估计结果的绝对依赖, 避免了其带来过大的误差。本系统支持该方式，但由于说话人数量估计模块GST 在当前数据集的表现已到达较高的准确度，因此为了较少系统的复杂程度与调参 过程，本文的说话人聚类系统中并没有使用该参数方式，直接使用GST的结果作 为触发在线预测过程中的resegment^节的触发条件。
