4.2基于GST模型的说话人数量估计方法
GST (global style tokens)方法是解决语音合成中风格控制算法，由Yuxuan Wang等人在2018年提出［49］。它们生成的软可解释的“标签”可用于以新颖的方式 (例如，变化的速度和说话方式)控制合成，而与文本内容无关。它们还可以用 于样式传递，在整个长格式文本语料库中复制单个音频片段的说话样式。在针对 嘈杂的，未标记的发现数据进行训练时，GST会学习将噪声和说话人身份分解为 因数，从而提供了通往高度可扩展但功能强大的语音合成的途径。GST生成的 embedding也可以看作是一个外部存储器，用于存储从训练数据中提取的样式信 息。参考信号在训练时引导存储器写入，而在推理时引导存储器读取。
此外，GST作者还使用style embedding作为特征，通过线性判别分析对噪声 和说话人进行分类。结果表明，对于噪声分类，GST达到99.2%的准确度。对于 说话人分类，将TED视频ID用作真实标签，并与i-vector方法进行比较，这是目前 说话人验证系统中使用的标准表示形式。对于此任务，测试仪包含431个说话人。
22
在训练和测试短话语(平均持续时间3.75秒)的同时，可以看至!!GST与i-vector具 有可比性，作者推测，GST有可能应用于说话人聚类方法中。此外值得说明的是, GST直观，易于实施，当对语音数据进行训练时，GST模型会产生可解释的 embeddingo尽管GST最初被设计为模仿说话风格，但却是发现数据潜在变化的 通用技术。原论文提出GST可以应用于受益于可解释性，可控制性和鲁棒性的其 他问题领域。
图 4-3 GST (global style tokens)模型结构
本文受上述方法启发，将GST模型结构应用于解决说话人数量估计任务，提 出可以支持变长语音输入的说话人数量估计方法。较基于CountNet的只支持固定 长度的输入模型，更适合语音非固定长度的数据特性。
本文使用GST的输出style embedding作为说话人数量的潜在特征，这些 embedding可用于描述不同说话人数量下特征。随后将style embedding输入 softmax进行分类概率表示，最后使用交叉爛损失函数作为训练目标。结果表明 GST模型学会了将各种噪声和说话者数量因素分解为单独的样式标记。GST模型 包括三个部分，reference encoder, style attention, style embedding o 如图 4-3 所示。
整个信息流经模型如下：
(1) .首先reference encoder ,Skerry-Ryan et al., 2018在［48］论文中提出的参考
编码器将可变长度音频信号的韵律压缩为固定长度矢量，我们称其为参 考嵌入 (reference embedding)。
(2) .参考嵌入传递到样式标记层，在这里它用作注意力模块(attention)的查
23
询（query）向量。此处，注意力学习参考嵌入与一组随机初始化的嵌入中 的每个令牌之间的相似性度量。我们将这套嵌入（也称为全局样式令牌, GST或令牌嵌入）在所有训练序列中共享。
（3）.注意模块输出一组组合权重，这些组合权重表示每个样式标记对编码参 考嵌入的贡献。我们将GST的加权总和（我们称为样式嵌入，style embedding）传递到最后的分类层，计算类别概率。
下面对上述三部分进行详细介绍。
