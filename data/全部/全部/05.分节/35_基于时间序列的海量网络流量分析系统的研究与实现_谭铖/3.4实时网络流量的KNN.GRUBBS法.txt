3.4实时网络流量的KNN.GRUBBS法
由上两节的介绍，我们了解了 KNN回归算法及GRUBBS检测法。本文采 用了 KNN检测法的思路，通过定义一个距离规则来计算各个样本点的距离，再 选取离待测样本最近邻的K个样本去对待测样本进行一个分类验证卩6】，验证该 待测样本最终是归入正常值类别还是异常值类别。验证算法采用3.2.1介绍的 Grubbs检测法，将待侧值人为规定为可疑值，并以前K个样本数据当做一组正 常样本数值，判定待侧值是否为异常值。而且，为了适应实时的需要，该K个 最近邻值是动态的，随着待侧值的不断更新变化而变化，保证了异常值判定算法 的准确性，提高了准确检测异常值的成功率。
本文成功实现了将KNN回归算法及Grubbs检测法结合到一起并成功运用到异常流量检测中去。本文将网络流量数据按时间序列分割，每10MIN统计一 次流量数据，并加以处理。此即每小时有6个点数据，每天即144个数据点，且 严格按照10MIN的时间维度排序。此时网络流量数据就可以看做是时间序列。
取合适的K值，将当前值*心与前K个值一起，用Grubbs法判 别此值是否为异常流量值。此前提为前K个值均为正常流量值，不存在异 常流量数据。若判定mk为异常数据，则将x，5标记，当检测xm 时，其参考 值依旧为即将k从后续计算中剔除，此时K个值不做更新。 若判定xs为正常值，则检测xm时，其前K个参考值为x，+ i,x，+ 2,?",X5, 即此时X5 + I参与后续计算，并将工，剔除于后续计算。可以将此K值看成一个 长度为K的窗口。若判别值为正常流量值，则窗口滑动一个时间单位。若判别 值为异常流量数据，则窗口不变检测下一个值。因为此方法需要K个值均为正 常流量值，以此为前提。若K个值中有异常值，则检测效果可能会不理想，甚 至可能将后续正常值都判别为异常值，即失真。而当判定数据前不足K个正常 值时，则有多少正常数据就用多少数据计算格拉布斯值，并判定。整个算法的流 程图如下。
图3-2 KNN-Grubbs算法流程图
