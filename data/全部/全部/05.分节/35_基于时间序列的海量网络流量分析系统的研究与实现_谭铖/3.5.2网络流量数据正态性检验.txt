3.5.2网络流量数据正态性检验
在将KNN-Grubbs算法引入网络流量异常检测前，需对网络流量进行正态性 检验。关键在于如何选取样本。实验所用数据为某局域网的总流量数据。考虑到 算法的特点，需要保存前K个状态来实现对K+1状态的计算，且状态随着K的 变化而实时更新，因此不适合多线程算法，而如果用单一线程来计算的话，无法 体现Storm分布式流计算的计算速度，对单一的Bolt压力也较大。并且，用网 络总流量直接用该算法进行计算时，发现局域网的网络总流量曲线比较多变，并 不具有典型特征。可能是由于对于单一局域网来看，其用户数较整个流量群来说 还是很少，因此流量曲线的随机性比较大。对这样的局域网做正态分布，发现并 不是特别符合正态分布。
本文中，从另一个方向进行考虑。用户流量可能每个时间序列之间起伏较大, 但是将一个小时内的流量相加，并用本月30天的同期数据进行比较的话，可以 发现流量数据相对稳定，且呈现一定的规律性。下面两张图分别取自某局域网某 个月的按小时统计的流量曲线。如3-3图为9点-10点的月同期曲线图，可以发 现，整体来说，整个流量在该范围内呈现平稳性。对此月同期数据进行Q-Q图, 发现整体数据点都分布在疔x附近，说明该样本数据很可能服从正态分布。对该 样本进行K-S检验，结果如图
某局域网内9点-10点的流量曲线图
表3-1某局域网9-10点月同期总流量K-S检测表
本 Kolmogorov-Smirnov 检验
某局域网9点至
10点流量数据
数字		31
正态参数師	　　平均值	23958219.1935
标准偏差	1983073.61868
最极端差分	　　绝对	,109
正	.087
负	-.109
检验统计		.109
渐近显著性	（双尾）	,200c-d
a.检验分布是正态分布。
b.根据数据计算。
c.Lilliefors显著性校正。
d.这是真正显著性的下限。
由表3-1可见，渐进显著性（双尾）为0.2,大于0.05,说明该月同期总流 量数据样本确实符合正态分布。因此，用Grubbs检测异常值是非常合理的。
另取一个时间段检测，如图3-5显示，为某局域网月同期23-24点的总流量 数据图。可以发现，除了 3月16日有一个明显高峰外，其他值都比较平稳。而 该高峰过于大了，基本是其他样本数据点的十倍，因此可以认为该点为异常数据 点。当把该样本数据点去除后，再对样本数据作Q-Q图，可以得到图3-6。可以 发现，数据点也基本在尸x附近，并没有特别偏离的数据点或者数据点群。对该 样本数据进行K-S检测的结果如表3-2,可以发现,其渐进显著性（双尾）为0.053, 也是大于0.05的
图3-5某局域网某月同期23-24点总流量曲线
某局域网23至24点流量数据的常规Q-Q绘图
图3-6某局域网某月同期23?24点总流量Q-Q图
表3-2某局域网23-24点月同期总流量K-S检测表
本 Kolmogorov-SmiHiov 检验
某局域网23至
24点流量数据
数字	30
正态参数或 平均值	27816338.0333
标准偏差	11739732.45385
最极端差分	绝对	.158
正	.158
负	-.072
检验统计	.158
渐近显著性（双尾）	.053。
a.检验分布是正态分布。
b.根据数据计算，
c.Lilliefors显著性校正。
