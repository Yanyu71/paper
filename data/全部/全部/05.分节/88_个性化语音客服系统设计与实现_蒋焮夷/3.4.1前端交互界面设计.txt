3.4.1前端交互界面设计
前端交互页面是整个系统启动后执行的起点，也是最后执行的终点，承担了 和用户交互完的任务，需要做到简洁易用，与后端分离且连接通信，完成数据传 递、语音和文字消息显示或播放、录音转文字的功能。模块的整体功能设计如图 3-6所示
图3-6前端显示设计图
在设计时将前端交互的界面分为了文字输入框，工具栏和显示框，其中，文 字输入框接收纯文字的输入；工具栏主要包含清空对话（或者叫重启对话），选 择输出音色（本文除了基本的标准音色外还特别训练了周星驰及本文作者本人的 声音音色）以及语音的输入（通过调用前端的语音识别库转换为文字输入）；显 示框负责显示文字类型或语音类型的信息，进行渲染显示，模拟生活场景中常见 的显示方式，包含头像，气泡框，位置区分等细节，整体显示达到自然清楚便于 阅读的目标。具体的设计如下
•文本输入框：接收文本输入，为了减少不必要的更新，在输入时候不对 页面节点进行改动，只有当回车键按下时候触发一次更新，并使用异步请求方式 将输入文本传递给后端，同时将输入信息存储在前端列表型数据结构中，在触发 更新时，显示框读取列表结构将新输入内容展示在页面上，其基本模式如图3-7
26
所示:
图3-7输入框组件执行逻辑图
•信息显示框：类似于一般聊天软件的显示框界面，包含文本和语音消息 的显示，用户消息和机器人回复的区分，主要在感知到前端列表存储结构中的内 容变化触发了页面节点更新时，进行重新渲染更新，基本的样式如图3-8所示：
你好啊
— :;1……I $
你好,
请问有什么需妾帮 忙的瞬？
图3-8前端显示框基本样式图
其中包含基本的匿名人物头像、机器人头像、扬声器等图标样式和气泡对话
框样式，通过遍历列表结构中的信息显示在界面上，所以列表结构中的每条数据
27 应包含是用户还是机器人消息的区分，属于文本消息还是语音消息的区分以及文 本消息对应的消息文本信息和语音消息对应的语音文件url信息。同时语音消息 需要支持播放和暂停功能作为基本的控制。
•选择工具栏：的工具栏部分包含三种基本工具类型，清空对话按钮、选 择音色输出以及语音录入和修正工具，其基本的样式原型图如图3-9所示：
男声 女声
垂严 周星驰 作者本人
我要点f決饭
■■■■Mi
图3-9前端工具栏基本样式图
其中清空按钮只是将列表存储结构中数据清空，触发重新渲染时会让显示框 无数据显示，音色选取列表通过与后端进行交互得到可选择的音色信息，点击选 择后信息存储在前端，不立即对后端模型进行改变，采用懒加载方式。音色录入 工具在前端调用麦克风录入语音消息并调用前端的语音识别模块将语音信息转 换为文字信息并生成输入框可以进行语音识别后的文本修改，最后修改后的信息 会添加到列表存储结构中触发新一轮更新。
