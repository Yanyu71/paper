3.3模型选型
结合3.2小结介绍的系统总体设计以及第二章介绍的各个模型，本节将详细 介绍系统模型选型和设计。本章主要包含词向量模型的选型、RasaNLU自然语 言理解模型选型、语音声码器MelGAN声码器模型以及WaveFfow声码器模型以 及传统算法选型。同时在进行各个模块的具体设计前介绍了使用的数据集情况。 3.3.1 Rasa NLU P^eline 构建
RasaNLU P feline模型采用链式结构完成整体NLU模块的训练。具体包含：
1）	基础词向量模型：主要完成输入文本的预处理，包含分词和向量化。
a. SpacyNLP词向量预训练模型：预训练的词向量模型已经使用了大量的 文本语料进行训练，具备很丰富的向量化能力且提供分词和向量相似度比较等功 能，釆用预训练的词向量模型能够满足大部分需求将文本中词汇较准确的转换为 向量。但特定场景的语义理解不够精准。
b. 自训练的词向量模型：采用自训练的监督模型能够更好地支持特定使用 场景词法语法，在数据量足够时能够更加精准适配，但需要大量的训练数据来完 成词向量模型的训练。
2）	实体提取器：用于提取实体过程中的实体识别。
a. CRFEntityExtractor实体提取器：通过定义一个模型，接受Sapcy预训练 模型中词向量部分来向量化的结构输入，然后通过观察句子中目标词的文本特征
22 以及周围单词来识别实体，可以是前缀、后缀、目标单词的大小写，如果是数字 等，还可以用此模型的POS标记功能。CRFEntityExtractor将令牌作为输入，提 供一个输出（句子有哪些实体，是什么样的实体，对预测的信心如何），该输出 直接添加到NLU模型。
b. Spacy Entity Extractor实体提取器：spacy模型除了词向量生成外还带有实 体提取器，但是该实体提取器中实体的命名结构和实体跟模型训练时候的标注紧 密相关，不利于自定义扩展，但好处是不需要再参与复杂的训练，默认情况下利 用已知的POS和其他功能在训练示例中定位实体。
3）意图识别器：意图识别器能够识别一句话中的用户意图，为后续对话处 理提供意图信息。
a. KeywordlntentClassifier关键字匹配意图识别器：将训练数据的整句话都 作为关键字，去搜索用户说的话。因此写配置数据的时候，仔细设计那个训练数 据很重要，关键字不能太长，这容易匹配不上意图，也不能太短，缺少意图的区 分度。其匹配模式较为死板不够灵活不能发现相同语义的不同表达，但比较简单， 易于构建。
b. DIETClassifierDIET 模型：Dual Intent and Entity Transformer 的简称，解 决了对话理解问题中的2个问题，意图分类和实体识别。DIET使用的是纯监督 的方式，没有任何预训练的情况下，无须大规模预训练是关键，性能好于 fine-tuning Bert,但是训练速度是bert的6倍。输入是用户消息和可选意图的稠 密或者稀疏向量。输出是实体，意图和评分。DIET体系结构基于两个任务共享 的Transformero实体标签序列通过Transformer后，输出序列进入顶层条件随机 场（CRF）标记层预测，输出每个Token成为BIOE的概率。完整话语和意图标 签经过Transformer输出到单个语义向量空间中。利用点积损失最大化与目标标 签的相似度，最小化与负样本的相似度。
c. SklearnlntentClassifier意图识别器：采用SVM支持向量机来做意图识别， 该支持向量机采用了网格搜索来进行优化，该意图识别器可以利用预训练的 Spacy模型中的词向量化特征器SpacyFeaturizer,在结构和训练耗时上比 DIETClassifierDIET意图识别器有较大优势，且充分利用了已有资源。
结合第一章的项目背景分析和本系统的技术背景，基于本项目自训练语料数 据不足以支撑庞大的词向量模型监督训练和实体提取跟训练文本紧密联系，本文 选用Spacy的中文词向量预训练模型作为基木词向量模型来将文本转换为参与 训练和预测的词向量，同时本文的应用场景下，实体的提取跟预训练模型中的实 体标注出入较大，参考Rasa框架官方推荐和结合小数据集的特点，本文选用 CRFEntityExtractor作为实体的提取器参与整体NLU的训练和预测，结合训练耗
23
时以及和前面词向量模型配合的需要选用SklearnlntentClassifier作为意图识别器 模块。
