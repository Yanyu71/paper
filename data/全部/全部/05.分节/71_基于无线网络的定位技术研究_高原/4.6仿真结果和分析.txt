4.6仿真结果和分析
理论上，如果得知估计误差的PDF或CDF就可以完全确定估计器的性能特 性，但很难得到它们的闭式解。通过蒙特卡洛仿真的方法可以得到经验的CDFo 经验CDF是指从某一样本的测量得到的分布函数。经验CDF是一个阶跃函数， 在每一个样本点处都会产生跳变。在某一给定的参数下，某一变量的经验CDF 的值为小于或者等于该数值的观测样本在样本集所占的比例。相关定理证明，经 验CDF依概率收敛于CDF,因此可以视为对CDF的估计。为了方便地对不同算 法进行横向比较，实际上本文采用了从CDF得到的一些性能指标而不是经验 CDF本身。
估计算法的性能可以从精度和效率两个方面来考察。精度是指估计结果和实 际结果的接近程度，而效率是指估计结果的离散程度。一个理想的估计算法应该 是精度和效率两方面都比较高。这里首先定义误差，本文的误差定义为估计结果 和实际结果的差的绝对值，即绝对误差。为了反映精度，本文采用了经验CDF的 某分位值作为性能指标,称为“％x的误差”，其定义为所有误差样本中大于或等 于总体中最小x%的误差样本的最小值，即经验CDF中不小于x%的第一点。这 里x取80代表大多数的样本能够达到的精度。为了反映效率，这里采用方差来 说明估计误差的离散程度。上述指标，均是越低越好，x%的误差越低，说明精度 越高；方差越低，说明效率越高。
考虑一个随机估计算法，即将时延随机地，均匀地估计为时延搜索窗的任意 值。这种估计器不会利用输入信号的任何信息，可以作为一个性能的基线。如果
47
上述估计算法的精度比该随机估计好，则说明算法是有效的。容易计算，在本章 的仿真场景下，这种随机估计算法的80%的误差是54个采样点，即108Ts。
首先考察信噪比对各估计算法性能的影响。因为PRS子载波的功率为1,这 里表示每个子载波上的信噪比。图4-2和图4-3展示了 80%的误 差和方差关于纥/N℃的关系，这里子帧数凡=30, PRS带宽N0=50。通过图 4-2可以看出，在-6到12dB的范围中，所有算法的精度均高于随机估计算法， 因此都是有效的。对于MDL-MUSIC方法,其精度会随着的提升而提升。 当EsINoc高于9dB时,MDL-MUSIC在所有算法中提供最高的精度,约为0.2Tso 当瓦在-6到3dB时，遍历法的精度高于两步法，但大于3dB后，其精度 不如两步法。可见,遍历法在较低瓦/N℃时，可以提升精度,但瓦/N“较高时， 提升不明显。说明在较低及/N℃时，遍历法中LS估计得到的训练信息提升了多 径数估计效果；在较高纥/ 时，遍历法估计多径数目的正确性反而有所下降， 可能是MMDL算法本身引起的。当瓦/N℃在一6到6dB时，SIC-DFC算法的精 度比SIC-FC的要高，说明了提出的方法能够有效利用多个快拍，带来性能的提 升。当纥/N”更高时，两种算法的精度相当。提升不明显可能是由于这时影响精 度的主要原因已经不再是噪声，而是SIC-FC算法本身的误差引起的。因为每一 次迭代中估计结果的误差会被引入下一次估计中。当EJN”.足够高时，如大于 9dB,所有算法的精度提升有限。从图4-3中可以看出，月/%,的提升会带来所 有算法效率的提升，并且当£/N或足够高时，各算法的效率提升也有限。MDL-MUSIC的两步法和遍历法的效率相近。在6dB以下的中低瓦/底时，SIC-DFC 算法的效率要高于SIC-FCo
«-।---H------B-----B----r-B----S-i----D-
(匕①
£,/N“(dB)
图4-2 80%的误差关于信噪比
口 WLM-MSampleg
口 MM-MSamples
口 SDFC-MSamples
g SFC-1 Sample
^CLastMean-MSamoles ”.TCThr-MSamples
口 TC-1 Sample
48
600
500
400
200
100
_ 300
0
-10	-5	0	5	10
及/M/dB)
15
图4-3方差关于信噪比
接下来考察PRS带宽对各估计算法性能的影响。N肾 表示了 PRS所占的
RB个数，其小于系统总RB数。更多的PRS带宽会带来更大的系统开销，从而 降低用户的数据调度。图4-4和图4-5展示了 80%的误差和方差关于N优的关
系，这里氏/N8 = 4 , N. = 30。从图4-4可见，MDL-MUSIC算法和SIC-DFC算 法都需要一定的陪，当不满足该要求时，精度较低，满足该要求时，精度较高， 但继续增加N察对精度的提升并不明显。MDL-MUSIC遍历法和SIC-DFC算法 至少需要20RB,而MDL-MUSIC两步法至少需要30RB。从图4-5中可以看出， N肾的增加会提升各算法的效率，对SIC-DFC算法和SIC-FC算法的提升比较 明显，对其他算法的提升不太明显。
(1) ①
n黑,
图4-4 80%的误差关于PRS带宽
49
最后考察子帧个数对各估计算法性能的影响。M表示参与估计的子帧个数, 因为仿真中每个子帧只利用了其中的一个OFDM符号,子帧数也等于快拍数。 更多的PRS子帧会带来更大的系统开销，降低用户的数据调度，也意味着更长 的响应时间。图4-6和图4-7展示了 80%的误差和方差关于Ns，这里耳/ = 4 , N/=50。从图4-6可见，当子帧数满足一定要求后，更多的子帧对精度的提升 有限。MDL-MUSIC两步法至少要求20子帧，遍历法要求30子帧，其他算法在 满足30子帧后也能有稳定的性能。从图4-7可见似的规律，故不再赘述。
「1) ％09@)」oi=。
图4-6 80%的误差关于子帧数
MLM-MSamples MM-MSamples
—H- SDFC-MSamples
-TCLastMean-MSamples
TCThr-MSamples
50
120
100
80
40
20
目前没有研究指出多径信道中的时延估计的CRB,在AWGN信道中CRB 可以作为多径信道下CRB的一个下界RI。本文通过仿真比较了误差的方差和该 CBR,可以看出它们之间仍然有着较大差距，见表4-3，这里耳/N8 =8 ,	=50 ,
忆=30。
表4-3 AWGN-CRB和方差（单位：Ts?）
AWGN-CRB	MLM- MSamples	MM- MSamples	SDFC- MSampIe	TCLastMean- MSamples	TCThr- MSamples
0.000074	0.1222	0.0005	1.8841	1.1389	0.1270
除了研究算法的性能，还需要考察其复杂性。对于如手机等智能终端，能量 消耗是一个主要限制，因此这里仅考虑时间复杂性。因为得到算法的时间复杂度 关于问题规模的函数关系比较困难，为了简便起见，从时间复杂度的渐进上界的 角度来看，并且假设计算时间主要由乘法和加法运算消耗。MDL-MUSIC方法因 为涉及到矩阵分解，求逆等操作，因此其渐近上界是导频数量的立方的同阶无穷 大，即O（N；）。SIC-DFC方法和SIC-FC方法涉及频域相关函数的计算，渐近上 界是导频数量平方和搜索窗长度乘积的同阶无穷大，即O（N：N”）。而其他算法涉 及时域相关函数的计算，渐近上界是符号长度平方和搜索窗长度乘积的同阶无穷 大，即OWN.）。渐近上界反映了算法的复杂度随问题规模增加而增加的量级， 但不能反映在确定规模下的复杂度。这里列出了在本文仿真平台下，执行各算法 消耗的时间。表4-4展示了在不同下各算法的平均每个流程的计算时间， 其中N债=50,『=30。
表4-4平均流程计算时间（单位：s）
MLM- MSamples	MM- MSamples	SDFC- MS ample	SFC- 1 Sample	TCLastMean- MSamples	TCThr- MSamples	TC- 1 Sample
13.9544	0.9570	0.0435	0.0085	0.8631	0.8629	0.0312
51
可以看出，利用多快拍的算法复杂度高于利用单快拍的算法，因为涉及到多 快拍平均。此外，基于频域相关的算法如SIC-DFC和SIC-FC的复杂度低于多子 帧的传统时域相关算法和基于噪声门限的时域相关算法。MDL-MUSIC遍历法的 复杂度是最高的，MDL-MUSIC两步法和基于噪声门限的时域相关算法接近。利 用多快拍的算法中复杂度最低的是SIC-DFC算法。
综合上述仿真结果，可以看出当信噪比足够高时，MDL-MUSIC方法能给出 对比算法中最准确的估计。MDL-MUSIC遍历法在中低信噪比的情况下比两步法 的精度更高，在高信噪比的情况下则不如两步法。SIC-DFC算法相比SIC-FC算 法，在中低信噪比下精度更高，这是因为它可以利用多个子帧来提升性能。另外， 在所有的多子帧的算法中，SIC-DFC算法的复杂度最低。
结合第二章所描述的测量精度要求，这里对PRS传播时延估计问题作以总 结。对于传播时延误差要求，这里认为是RSTD要求的一半。因为本文的研究只 考虑了单天线的情况，而且只利用了每一个PRS子帧中的一个OFDM符号，因 此这里不考虑对子帧数的要求。对于不同SNR下的参考小区PRS时延估计精度 要求，在本文的数据模型和仿真假设下，在50RB的PRS带宽和30子帧下，基 于噪声门限的时域相关方法能够满足要求；在信噪比有所改善时，提出的MDL-MUSIC方法和SIC-DFC方法也能够满足该要求。信噪比足够高时,MDL-MUSIC 方法能够给出最为准确的估计结果。在满足要求的所有多子帧算法中，SIC-DFC 方法的复杂度最低。基于噪声门限的时域相关和SIC-DFC都依赖于预设的门限 值，而MDL-MUSIC方法不需要这样的门限值。在实际实现中，具体采用哪一种 方法，需要综合考虑到噪声等级，误差和复杂度等因素。
