4.1.1NLOS基站判断方法
惯性导航器件主要包括：加速度计、陀螺仪。其中加速度计根据牛顿第二定律， F = ma得到物体的加速度，对加速度积分后可得到物体的运动速度，二次积分后可得到 物体的位移；陀螺仪在重力力矩的作用下快速旋转的轴方向即是物体运动的方向。因此， 我们可以通过积分的形式，从惯性导航器件中读取到物体的运动状态参数。现阶段，惯 性导航器件已经成为5G移动设备的标准配置，这为复杂环境下导航定位问题又提供了一 种解决思路。
图4-1相邻两个NLOS位置点信号传播路径
图4-1表示一种典型的单基站NLOS情况示意图，A点和B点分别表示两次位置相邻 的定位服务请求，C表示提供定位服务的单基站。在没有障碍物遮挡的理想情况下，线 段AC和BC表示LOS信号传播路径，此时对应的角度和时延估计参数分别为q, 02,叶， 2;而现在由于障碍物的遮挡，基站与终端之间不能够建立起信号的直接传输，只能依 靠散射体的散射，所以两次定位请求信号的实际传输路径为脳'C和BBC,对应的角度 和时延估计参数分别为切，g, r；, r20心纫表示通过加速度计测量得到的两次请求之 间的位移距离。
接下来根据基站C和两个位置点A、B的几何关系，计算A、B两点的距离。
■当A、B两点处于LOS环境时，根据基站C估计得到的角度时延参数G，
&2, I 4 ,可得A、B两点之间的LOS距离dLOS如下：
dLOS = J卅+ 厅 一2M*COS（0 -0J	（4-1）
■当A、B两点处于NLOS环境时，根据基站C估计得到的角度时延参数0；,
0；, 片，可得A、B两点之间的NLOS距离d皿os如下：
dNLOS = J*+§2-2T^*COS（&2-切）	（4-2）
在LOS场景下，定位误差来源主要包括角度和时延的估计误差&帀和金，即：
°严久冏+&5	（4-3）
°2=&2嗣+°2,帀	（4-4）
尸1=4泅+体”	（4-5）
r2^h.real+r2,err	（4-6）
在NLOS场景下，定位误差来源不仅包括角度和时延的估计误差，还包括非视距误 差0”加和仏s，即：
（4-7）
&2+0,”加	（4-8）
36
图4-2相邻两个位置点信号传播路径可能情况
因此，仅仅通过threshold和2*5的大小只能判断出A、B两个位置点的信号状态相 同的状况，当出现A、B两点的视距或非视距情况不同时，需要增加额外的约束参数。由
37
于受到障碍物的遮挡，信号需要经过其他物体的反射，从而绕过障碍物才能到达终端或 基站，显然在该过程中，非视距给信号传输距离的估计带来了正偏差，角度偏差可能为 正或负。因而，可以通过额外比较连续两个位置点之间的信号传输距离差。(单位m), 从而对每个位置点的信号状态做出判断。
综上，最终得到单基站条件下NLOS基站的判决策略：
threshhold > A.*3,	B都为LOS
threshhold < 2*5且：—斤〉A为LOS, B为NLOS
threshhold < 2 * 6且0 < q — q < 4, A、B都为NLOS
threshhold < A*3, r2-r{ <0, A为NLOS, B为LOS
