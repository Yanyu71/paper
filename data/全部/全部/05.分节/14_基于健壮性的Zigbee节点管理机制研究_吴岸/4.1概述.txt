4.1概述
Zigbee协议作为一种低成本低功耗的短距离无线协议，被广泛的使用在各类应用场 合。攻击抵抗能力成为影响网络健壮性的一个重要因素。由于协议栈较为简单，对称密 钥的保管决定了 Zigbee网络的安全等级。整个设备是开放信任模式：通信协议栈的不同 层和运行在单个设备上的所有应用相互信任。这种开放信任模式允许在同一设备的不同 层次结构之间重复使用同样的密钥材料，默认为通信设备任意两层之间为信任关系，只 考虑在不同设备之间实现端到端的安全。
Zigbee联盟和许多研究者已经在安全方面做了很多改进，但是对于网络的前向安全 仍然没有足够的重视。而Zigbee网络节点通常是低成本制造，抵抗物理破解抵抗力差。 一旦节点被攻击方获得，很容易破解存储在节点芯片内部的密钥资料。而目前的Zigbee 协议并未为节点的密钥管理作出的完善的规定。离网节点在离开网络期间，仍保有当前 网络的相关密钥资料，而Zigbee网络并不能监控离网节点的状态。一旦攻击者通过物理 破解或者其他方式获得离网节点内部存储的密钥资料，即可利用这些资料窃听消息甚至 伪装成离网节点重新加入网络。因此本文从节点管理的角度出发，考虑节点在离开网络 时的密钥管理机制。
在本章我们在前文利用LEACH算法构建的簇型网络的基础上，进一步提出了一种 基于Zigbee层次网络的密钥管理机制。这套机制包括网络密钥的更新和应用链路密钥的 删除两个部分。通过这两个步骤能有效的提高离开网络节点的密钥泄漏造成的危害。同 时验证该套密钥管理机制的性能，结果表明该套密钥管理机制的确能够在低网络开销的 情况下提升网络的安全性。
