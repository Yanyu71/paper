3.3.1多因子簇头选择算法
每个循环中，未被选为过簇头节点的节点将会参与新的簇头节点的选举过程。具体 过程为：每个传感器节点生成一个大于0小于1的随机值。根据公式计算出当前阈值， 将随机生成值与阈值相比较，小于该值，则节点当选为簇头节点129］。阈值计算公式见式 3-10阈值一定，节点产生随机产生选择值，因此每个节点成为簇头节点的概率相等。 而实际上，由于节点在簇内距离不同，节点通信量不同，将会导致节点剩余能源出现差 距。而在一个簇内，如果节点剩余能源本来就较少，再被选为簇头节点会进一步增大能 耗，很容易导致节点能量耗尽从而失去功能。一旦簇头节点失效，整个簇通信将会瘫痪。 因此应该避免剩余能量少的节点被选为簇头备选节点。同时由于非簇头节点发向汇聚节 点的数据都由簇头节点转发。因此簇头节点应该尽量位于簇的拓扑中央位置，即与其他 节点的通信距离最短，可以节约整个簇的通信能耗。改进后的阈值计算公式如下：
16
E (r)
n v 7 x p
E
—	/GG
l-px[rmod(^/)]?
0,其他
其中Emax为当前簇内节点剩余最高能量。En（r）为在第r轮中还没被选作簇头节点的 节点当前剩余能量。在新的阈值计算公式下，节点阈值会随当前节点的剩余能量而改变。 剩余能量高的节点阈值大，被选为簇头节点的概率更高。
在节点进行完阈值匹配后，出现一批备选节点。计算当前网络平均能量E（r）o
硏，）=2鸵（「）	（3-3）
其中N为当前簇内节点数量。如果备选节点剩余能量小于而，抛弃该节点。
计算备选节点与其余簇内节点的通信距离。设节点位置坐标为（X,,匕），备选节点 平均通信距离以（〃）计算公式如下：
八（〃）=x,）2 +（kt）2,〃el	（3-4）
(3-5)
其中丄为备选节点集合，£>_.（〃）为备选节点到簇内任意节点，的距离。
比较各备选节点距离，按距离远近排序，距离越近的节点优先当选为簇头节点。
