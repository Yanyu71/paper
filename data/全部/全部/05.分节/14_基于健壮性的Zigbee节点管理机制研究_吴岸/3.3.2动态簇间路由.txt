3.3.2动态簇间路由
Zigbee网络的节点发送数据能耗计算公式受节点距离影响，有自由空间模式和多径 衰减模式两种。当短距离发送时，采用自由空间信道模型；长距离发送时，采用多路径 衰减模型災）。网络通信的能量消耗公式为：
E^(d) = k • Eelec	(3-7)
该类层次网络通信的能量消耗为：其中发送数据能量消耗ETx(d)为发送*个比特 所消耗的能量。该能量跟距离Q有关，刁0为阈值距离。当d m"°时，发送模型为自由 空间发送模型，放大电路能耗系数为牛能量消耗与距离的平方成正比。当d^dQ时， 发送模型为多径衰落模型，放大电路能耗系数为能量消耗与距离的四次方成正比。 Eelec为发送和接受电路处理每个比特所需能量。
从上式中可以看出，能量消耗是和节点距离的指数次方成正比的。长距离传输的能 量消耗远大于短距离传输。而LEACH协议假设所有的簇头节点都需要直接向汇聚节点 转发收集到的数据，故远离汇聚节点的簇头节点的能量消耗将远大于靠近汇聚节点的簇 头节点，更容易耗尽能量。因此可以利用靠近汇聚节点的簇头节点剩余能量相对较多， 将簇头节点直接与汇聚节点通信改为多跳通信，利用近距离节点进行二次转发。在一定 程度上减少了边缘节点和中心节点之间的能量差距，对整个网络的节点进行能耗均衡， 延长了网络生命周期。
假设*聚节点的坐标为(X,,匕)。根据公式3-4,簇头节点到汇聚节点的距离为 ds(«) = yl(Xtl-Xs)2+(Yn-Ys)2 ,将/(〃)与阈值距离刀o比较，根据公式3-6计 算每个簇头节点发送数据到汇聚节点能量消耗：
点0)]-*姦我+虹寫0,,一星)4 + (匕_匸)4 + 2(¥一七)2化—匕)2](-)
计算整个网络的平均汇聚能量消耗：
2%叵(〃)]
琮 0S) =  	 (3-9)
n
当簇头节点发送数据到汇聚节点的能量消耗大于整个网络的平均能量消耗时，节 点采用多跳的方式传输数据。节点将本簇的数据发送给离自己最近的单跳簌头节点，山 单跳簇头节点转发数据至汇聚节点。
