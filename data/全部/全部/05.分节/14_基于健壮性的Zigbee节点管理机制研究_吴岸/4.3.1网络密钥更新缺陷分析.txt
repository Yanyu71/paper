4.3.1网络密钥更新缺陷分析
一般来说，当节点离开网络后不应该再对网络中传输的数据具有任何的处理权限。 整个网络的广播信息和NWK层信息都是通过网络密钥进行加密。然而现有Zigbee协议 并未在节点离开后更新整个网络的网络密钥。而所有的广播帧都是利用网络密钥进行加 密，一旦攻击者从离网节点处获得了网络的当前活动网络密钥，将能够窃听或者堵塞网 络。因此在节点离开当前网络后就立即更新整个网络的网络密钥能够有效的提高整个网
24
络的前向安全。然而网络密钥的更新是通过对全网广播网络密钥更新帧和密钥切换帧来 完成的。一旦网络规模较大，这些密钥更新广播帧在网络中的洪泛就将消耗大量的网络 资源，同时还可能会导致网络的拥塞。因此本文提出了一种基于层次网络特点的一种新 的网络密钥更新机制。该机制能够在消耗较少的网络资源来完成整个网络的网络密钥更 新，从而提高网络的安全。
