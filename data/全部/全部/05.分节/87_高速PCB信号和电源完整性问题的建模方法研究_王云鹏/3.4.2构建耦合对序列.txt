3.4.2构建耦合对序列
对于每一个Para〃创集合，其存储的是可能存在耦合的平行线段，逐一査询 其所存储的seg信息属于哪条网络，将这部分网络保存为新的临时网络集合，记 作nettempo需要注意的是，可能存在一个Paralle陳合中包含了同一网络中的多 条线段的情况，其解决方案是如果此时nettemp已经存储了一遍这条网络，再遍历 到与该线同网络的线段则直接跳过，并在Seps集合中将该条seg删除，即临时网 络集合内不存在重复的网络，存储临时网络集合的作用一方面是对平行线集合进 行筛选，另一方面将线段平行的关系映射为网络之间的耦合关系。
由于Parallel^合中存储的是整片PCB电路板中所有的平行线段，因此必然 存在许多物理距离较远或在不同层叠的线段，这些线段虽然平行，但也不能形成 耦合对，因此需将可能构成耦合对的线段筛选出来。当已知一条线段的首尾两点 的坐标时，其所在直线方程的两点式方程可以写为公式3-13,其中(兀人)和化卫) 分别为起始坐标和终止坐标。两根平行线之间的距离可以由公式3-14计算，其 中 A=(h —论)，B=(XI-X2), C=(«X2-$XI)。在 PCB 电路板的布线阶段，3W 原则是设计人员所遵循的基本原则，因此如果假设当线间距小于3W时两线发生 耦合，则可能会造成许多耦合对的遗漏，因此可以将筛选条件设置为4倍的线宽。 当线的中心间距小于线宽的4倍时，则认为两条线之间可能互为耦合对。该方法 需要对Parallel^合中的每两条seg都进行一次计算，其时间复杂度为O(n2)o
(3-13) (3-14)
依据计算出来的线距，Parallel集合中的元素的关系可以用有向图来表示. 集合中的每一条线段对应有向图中的每一个顶点，有向图的边和权重表示为集合 中两点之间的距离关系。由于串扰是两条传输线之间的相互影响，每一条线段既 有可能是诫击线，也有可能是受迫线，因此每个顶点的出度命入度都为n~l,其 中n为顶点的个数，即该有向图为全连接图，并且每两个节点之间都存在两条边, 即双向连接，一个简单的双向全连接有向图如图3-9所示.双向连接之间的边上 的权重均为两条线段之间的距离，但由于不同线段的线宽存在着不同，因此在进 行倍线宽判定时存在着判定结果的差异。
圈3-9线段集合的双向全连接有向图
在双向图中，每一个顶点内包含着该条线段的线宽信息，由顶点A指向其 他顶点的边上的权重为其与其他顶点之间的距离。当该距离小于4倍的线宽时, 则认为这两个顶点所对应的线段为一对串扰对，其中A为攻击线，指向的顶点 为受迫线，串扰对序列可以用公式3-15来表示，其中sepl为攻击线，seg2为受 迫线。
Crosstalkco =	(3-15)
对于双向全连接图中两线之间的中心距离大于4倍线宽时，则认为攻击线对 受迫线的影响较小，则此两条线不构成串扰对，公式3-15可以写为公式3・16的 形式。
Crosstalkco = {"f	(3-16)
