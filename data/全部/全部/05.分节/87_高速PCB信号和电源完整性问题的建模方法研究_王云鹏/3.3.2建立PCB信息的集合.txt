3.3.2建立PCB信息的集合
在印刷电路板中，传输线都是从有源器件管脚（包括电源）流向另一个有源 器件管脚（包括地），有源器件指消耗电能并进行信号输入和输出的器件，因此 读取PCB信息的第一个阶段是获取有源器件名称清单，该信息可以通过Altium Designer中装配输出。在编写代码时，一般近似认为当管脚（Pin）值大于3时， 该器件为有源器件。
在获取有源器件名称后，可以实现构建有源器件管脚的集合，将该集合记作 activej)ins,其中每个管脚记作active_pino首先按照器件名称在PCB文件中检 索出所有的有源器件管脚，将该管脚中的位置信息以(X,Y)的形式保存。然后在 有源器件的IBIS模型文件中根据关键字检索到器件管脚的封装电容和上升/下降 时间等信息，因此activejpin的数据格式如表3-1,也可以用公式3-5来表示。
表3-1有源器件管脚格式
横坐标
纵坐标
寄生电容(pF)
上升/下降时间(ps)
active jpin = [X, Y, value, dv/dt]	(3-5)
在印刷电路板中，为了电路的导通与去耦，除了有源器件以外，还有大量的 如电容、电感、电阻和开关等无源器件，无源器件管脚的集合记作passivejpins, 其中每一个管脚记作passivejpin»在读取PCB文件时，一般近似认为当管脚(Pin) 值等于2时，该器件为无源器件。无源器件管脚的存储也可以分为两步，第一步 根据无源器件清单在PCB文件中｛REF｝部分查询到相应的器件名称，第二步根 据器件名称在(Net｝部分根据器件名查找到管脚对应的相关信息，每条 passive_pin序列里包含"器件名称Reference "、“管脚名称Name坐标信息(X,Y) ” 和“器件值Value”三个部分，每一个器件都有两条序列。passivejpin的数据格 式如表3-2,也可以用公式3-6来表示。
表3-2无源器件管脚格式
器件名称
管脚名称
坐标信息
器件值
passive jpins = [Name, Number, X, Y, value]	(3-6)
除了器件以外，在印刷电路板中，走线是最主要的部分。印刷电路板的走线 可以分为两种，一种是直拐型，形成一个尖锐的倒角，另外一种是弯曲的平滑曲 线，弯折处呈现为一个弧线形。经过研究发现，前者可以由存储在文件中的许多 段线段经过“首尾”拼接得到，后者的圆弧占用的存储空间较大，因此改为用连 接弧线两端点的直连线来代替。走线的集合记作Segs,其中每一条走线记为seg, 需要注意的是，这里的一条线段序列并不是一条完整的走线，而只是其中的一部 分。每条seg序列里包含了 “起始点坐标(绻血)”、“终止点坐标(X2,Y2)\ “线段 所在层Layer”(用阿拉伯数字代替层的名称)和“线宽Width”。seg的数据格式 如表3-3,也可以用公式3-7来表示。
表3-3线段的数据格式
33
左横坐标
左纵坐标
右横坐标
右纵坐标
所在层
线宽
seg = [leftco, rightco, layer, width]	(3-7)
在PCB拓扑结构中，过孔常常是会被忽略的一部分。过孔的集合名记为 Vias,其中每一个过孔记为via。根据上文描述的过孔类型，在存储过孔信息时， 需要根据其封装P将过孔的开始层和结束层读取出来。每条过孔序列里包含了 “坐标信息(X,Y)”、“开始层”和“结束层”三个部分，via的数据格式如表34, 也可以用公式3-8来表示。
表3-4过孔的数据格式
横坐标
纵坐标
开始层
结束层
