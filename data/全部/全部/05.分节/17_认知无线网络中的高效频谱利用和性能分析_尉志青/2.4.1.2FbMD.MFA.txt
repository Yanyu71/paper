2.4.1.2FbMD.MFA
FbMD-MFA算法主要分为以下几步：
1）离散化处理
把整个区域等分为NxN个矩形，其中# =	左为正整数。获取所有矩形
中心点的坐标。因为矩形已经分得足够小，可以认为矩形里任意点的无线电参数
79 和矩形中心点的一致，即矩形中心点代表了整个矩形。也就是说，这里的矩形是 最小的处理单元，在本章中称为“像素”。定义一个二进制变量M｛RAT„xiy)表 示在坐标(x,*)是否有RAT；:
1如果在(x,*)检测到RAT,
0如果在(x,y)没检测到RAT,
利用上述的表达，在(x,y)处将所有RAT对应的二进制变量按照如下方式组 合，即得到一个刻画坐标(x,y)处无线电参数的变量［2-10］：
T
］(xj)=£M(R47；,x，V)x2'T	(2-114)
/=!
其中T是RAT的数量，每个像素中心点的无线电参数值，3,力被存储在一个 NxN的矩阵Gra里面，矩阵Gra可以近似描述整个区域上每一个点的无线电参 数。注意到1(x，X)是0到2『的整数。
2)算法参数
算法有三个主要参数：误差下限，最短边长和存储不合格栅格的栈。
误差T7次.•记为＜7血。定义一个栅格的无线电参数误差(Radio Parameters Error, RPE)为：
N
/E = l - max｛性｝	(2-115)
J Np
其中N,是在该栅格内特征为*的像素的数目,Np是该栅格内像素的数目。 如果一个栅格的"E小于仁晌，就认为这个栅格是合格的，这意味着这个栅格 内部的无线电环境是近似纯净的。
最短边长:记为e响。最短变长定义了最小栅格的边长，上文提到的像素可 以作为最小栅格，但是为了控制栅格的数量，最小栅格要比像素大一些。如果一 个栅格的边长小于。响，它也是合格的，不管时E满足不满足要求，这意味着这 个栅格不能被进一步划分了。
存储不合格栅格的栈：记为stack。这个栈存储不合格栅格。在每次迭代，从 stack出栈一个栅格，将出栈的栅格二等分，得到两个新栅格，其中合格的栅格 存到数组mes方中，不合格的栅格入栈到stack再进行下一次迭代，直到血以 为空迭代结束。
3)算法描述
在算法FbMD之后，参数相同的栅格仍然存在，所以FbMD之后再执行栅格 融合算法(Mesh Fusion Algorithm, MFA)效果更好，如果不用MFA,单独的 FbMD也是可以实用的。
80
如果两个栅格是可融合的，它们不仅在地理上相邻，还有相同的无线电环境。 一个栅格的无线电环境是由大多数像素的特征决定的，这个特征进一步定义为栅 格的特征，即公式（2-6）。两个栅格融合即把两个矩形融合成一个矩形。栅格 ［如乂汪况］和［x3,y3;x4,y4］被融合为栅格［minX”min汁;max知max"］。如果 mesh,和次偷九是可融合的，本文标记此关系为"mes九o mesh}."。
算法2-2描述了 FbMD-MFA算法，其中栅格用对角顶点的坐标表示，一开始 整个区域也这么表示，因为它是第一个“不合格的栅格图2-15示意了栅格划 分操作，其中栅格［x},yi-,x2,y2］被划分为如下两个栅格：
算法2-2 FbMD-MFA算法描述
第一部分：基于分形的栅格划分（FbMD）
初始化，e响为一个合适的值 stack <-整个区域，mesh <- 0
while stack 非空 do
栅格m JKstack出栈
分割m，得到两个更小的栅格使，務2 .
for 7 = 1 to 2 do
if初j.合格then
将rrij添加到数组/Mgs方
else
将 m,添力少到栈S〃冰
81
end if
end for
end while
第二部分：栅格融合算法(MFA)
得到栅格数目A, labels true
while label do
label <r- false , z ,得到 mes^
while / < Zdo
丿-1 while j < Z do
if meshj o mes^ then
将mesh.和mesh.融合
更新数组mesh, label <r- true
end if
j = j+l
end while
1 = i + l
end while
end while
4) FbMD算法分析
栅格划分算法FbMD可以用二叉树表示。如图2-16所示，其中栅格1是整 个区域，是第一个不合格的栅格，栅格1被划分为栅格2和栅格3,其中栅格3 合格，栅格2不合格，因为算法要迭代地划分不合格的栅格，保留合格的栅格, 所以保留栅格3,划分栅格2,如图2-16所示，栅格2被划分为栅格4和栅格5o 重复上述的迭代，直到整个区域被划分为合格的栅格，如图2-16的右图所示。
根据算法FbMD,这棵二叉树有如下性质：
定理2-18：只有一个孩子的栅格不存在。
证明：根据算法FbMD,如果栅格合格，它不需要被分割，于是没有孩子; 如果一个栅格不合格，它需要被二分，于是有两个孩子，所以只有一个孩子的栅 格不存在。
#
定理2-19：二叉树上第I层的栅格的面积是S, =S/2‘，其中S是整个区域的 面积。
82
证明：第，层的栅格被二分了，次，所以面积是S/2' .
图2-16基于分形的栅格划分
定理2-20：设第/层合格栅格的数量为K,,则有Z：K,2」=1,其中N是迭 代的次数(层数)。
N
证明：因为所有合格栅格的面积和是整个区域的面积，所以有Ek，=s ,
/=!
又根据定理2-19,有§=S/2',于是：
N	a	N昭
YK —=	= l	(2-117)
心	z	/=1丄
就得到了定理2-20。
#
定理2-21：合格的栅格是二叉树的叶子节点。
证明：根据算法FbMD,合格的栅格是不能再分割的栅格，即没有孩子的节 点，就是叶子节点。
定理2-22：如果二叉树有N层,那么合格栅格数量的下界是N+1,上界是2"。 证明：根据定理2-20,有：
N V N 紆 1 N
(2-118)
/=!匕 /=! z 乙 i=l
于是有
N
(2-119)
83
这是栅格数量的上界，下面求下界。记二叉树上有两个孩子的栅格的数量为 n2,没有孩子的栅格的数量为/。根据定理2-18,有一个孩子的栅格是不存在 的。根据二叉树的基本性质，有等式％=沔+ 1，并且注意到，一旦一个栅格被 分割，％就增加1。于是，为了让％减小,就要减少分割操作的次数。在每一层 （每次迭代）分割一次是最经济的操作，于是一层产生一个有二个孩子的栅格, 就有"2=N,于是”0=0 + 1。根据定理2-21,合格栅格的数目即是％,于是得 到了合格栅格数目的下界。
