4.3改进的滑动窗算法
上一节所介绍的频域同步方案中，滑动窗每次滑动的距离为N,若只用一个A序列， 则在某些情况下滑动窗内有效数据不足，导致峰值无法超过门限，因此4.2节中介绍的 方案增加了一个A序列以保证某个滑动窗中一定会包含A的全部信息。保证至少有一 个滑动窗包含A序列的全部信息的方法有两种：第一种是4.2节的方法，增加一个A序 列;另一个方法是将滑动窗每次的滑动长度由原来的FFT长度N减小为CP的长度Mo 由于滑动窗每次滑动的距离为M,可以保证某一个滑动窗的起始点在CP之中，从而保 证该滑动窗内包含全部的A序列信息。针对这种方法，唯一需要解决的问题是该方法要 求FFT模块能在M点的时间内完成FFT处理，从而实现系统的流水线处理。本小节将 对第二种方法进行理论推导。
首先，改进方案的同步码字将比4.2节方法的同步码字短，仅由CP与A序列构成。 其帧结构如下。
CP A	Data
图4-11本文算法同步头结构
其次，改变滑动窗的滑动距离，每次滑动窗移动CP的长度M点。
假设接收端的釆样序列为双〃)，在本地保存的为A序列的共辗傅里叶变换H(〃)。 假设CP的长度为M, A的长度为N。滑动窗的长度为M。
定义互相关函数P(〃)如下：
P(tM + ri) = IFFT(FFT(r(tM + «))・ FFT{c(ri^,n = 0,1,...,7V-1	式(4-19)
其中表示接收到的序列，c("表示本地序列是A的共轴序列。M为CP的长度, I为自然数是滑动窗的标号。
对每一个2取：
SQ) = max \P{tM + «)|2	式(4-20)
n
即，取一个滑动窗中互相关值最大处的幅值。
31
pH) = index(S(t),\P(tM + »)|2)	式(4-21)
夕。表示滑动窗中峰值所在位置。
定义测度函数如下：
岫)=
另 ipw+”)r	式(4-22)
n=0
当M的值为1时，测度函数如图4-12所示，当M的值为CP的长度时，仿真时使 用的A是长度为256的Chu序列，CP长64,测度函数的仿真如图4-13所示。
当滑动窗起始点位于CP中时,滑动窗内包含A序列全部信息，仅有相位上的区别。 而通过FFT/IFFT变化后，相位上的区别表现为峰值位置的偏移，因此根据改进算法得 到的测度函数数值大小不会有区别，他们之间唯一的不同是以。。下面将A序列取为长 度256的Chu序列，CP长度为64进行仿真计算进行说明。图4-12是测度函数，表4- 1是当滑动窗起始与CP中时的峰值位置函数p(0»
表4-1滑动窗偏移对应的峰值位置
k	峰值位置
64	64
63	63
62	62
• . •	.•.
2	2
1	1
0	0
表4- 1中表示的是滑动窗起点在CP中时，包含CP点数对峰值结果的影响。从表 中可以看出，当k=0时，滑动窗内的数据包含的数据就是A,则峰值位置将出现在。时 刻。当k=l时，滑动窗内的数据位[A(255),A(0:254)],峰值位置出现在1时刻。其他分 析类似。但是当k=64时，峰值位置为64,.此时，会有两个滑动窗存在大小几乎相同的 测度函数，在理想情况下，通过同步判定算法可以找到后一个k=0的滑动窗，但是在加 入噪声的干扰情况下，很可能只能找到k=64的滑动窗，即使如此，还是可以根据该位 置找到A的起始位置。因为如果某个超过门限的测度函数的峰值位置函数的值为64, 那么可以推断出该滑动窗一定是包含全部CP的滑动窗，因此下一个滑动窗k将等于Oo 只需要设计合适的门限规则，就可以判断出正确的同步位置。
下面分析，当滑动窗内不包含完整的A序列的时候，峰值大小的变化情况。
32
图4-12逐点移动测度函数
仿真时，在同步头之前有一段长度为256的0值，这样才能从波形变化中看岀测度 函数值的变化规律。从图中可以看岀，当滑动窗起始位置逐渐增加的时候，测度函数的 值逐渐变大，当滑动窗起始位置位于CP当中时，会岀现一段峰值平台。但是由于滑动 窗的滑动长度为CP的长度，最后岀现的峰值情况会如下。
图4- 13按CP移动的测度函数
从图中可以看出，当滑动窗按CP的长度进行滑动时，将不会岀现峰值平台，而是 会产生以及比较尖锐的峰值。在此过程中一定会出现峰值最大点，并且峰值点左右附近 的值都比较大，虽然不存在误判峰值的可能性，但是存在峰值点左边或右边的值大于峰
33
北京邮电大学工学硕士学位论文
值点值的情况，在这种情况下，找出的同步位置是会出现偏移的。但是频域同步方法不 仅在峰值上具有递增关系，在峰值位置上也同样具备递增关系。如当一个滑动窗内完全 包含A序列信息时，假设它的峰值位置为X,则该滑动窗的前一滑动窗峰值位置一定是 x+M,后一滑动窗峰值位置一定是x-M。因此利用此特性，可以方便的从数据流中找出同 步码字的位置。
设计如下的同步判决准则，满足以下两个条件时认为系统同步：
1、	相邻的五个测度函数的值满足M1<M2<M3>M4>M5。
2、	M3的值大于测度函数门限。
与之对应，设计出如下的同步位置搜索方法：
1、	如果M3的位置为n (0-63),则从出现峰值的滑动窗的第n个点开始输出。
2、	如果M3出现的位置为n (64-127),则从出现峰值的滑动窗的下一滑动窗的第n 个点开始输出。
3、	如果M3出现的位置为n (192-255),则从出现峰值的滑动窗的前一滑动窗的第 n+64点开始输出。
以上的同步码字定位准则将准确的找到同步码字的起始位置，进而找到有效数据的 起始位置。
