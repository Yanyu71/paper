2.2.1线性均衡器
一般而言，均衡使用的训练序列要求是一个频谱分量非常“丰富”、与噪声类似的序 列，这样的频谱成分能够对信道各个频点的响应都进行估计，从而保证估计的信道接近 实际信道。在二进制系统中，多使用伪噪声PN序列作为训练序列，而在现代的通信系 统中，更多的是使用恒包络零自相关（CAZAC）序列卩6〕。一
横向滤波器是最常用的一种均衡方法，结构如图2-2所示
图2-2横向滤波器
图中的横向滤波器为普通的滤波器结构，它有2N个延迟单元、2N+1个抽头系数 和一个加法器。它的输出为相应抽头系数与经过相应延迟之后的输入的乘积之和。对均 衡器输出影响最大的是抽头系数，如果要完全模拟实际信道的传输特性，就需要一个无 限长的滤波器，这在数字系统中往往无法实现。由于实际信道传输具有距离当前时刻越 远，产生的影响就越小的性质，可以将无限长的滤波器截断，让截断的滤波器尽可能逼 近实际情况。假设有2N + 1个抽头，其系数分别为叱w，…，%,。均衡器的输 出贝荷等于输入x（盼与抽头系数叫的卷积，表达式如下：
y(k)= Z x(k-n)wn,k = -2N,.	：,2N,	yi — —N,…,N	　　　式(2-4)
其中，k=0	±1, ±2,...表示对连续时间序列的釆样，n用于表示对当前釆样点的
采样偏移和滤波器系数的下标。矢量y、w和矩阵x的定义为
~y(-2N)
y =	7(0)	w =	　w0		　　　式(2-5)
・(2N)		一 Wn 一
'x(-N)	0	0			　0	0	'
x(-N + l) x(-N	)	0			　　* •
X =	　　x(N) x(N-l) x(N-2)	• • x{-N +1) x(-N)	　　　式(2-6)
0	0 "	0		. •	x(N) x(N-l)
0	0	0		..	　0	x(N)
则 y、w、	K的关系可以表示为
y = xw			　　　式(2-7)
如果x是方阵，并且它的行列向量的维数都等于矢量w的维数，那么由下列方程可 解得w :
w = x_,y	式(2-8)
求解这个方程组的常用方法有两种：一是确定性方法，称为迫零法(zero-forcing)； 另一种是统计方法，称为最小均方误差法卩刀。
迫零法x由时间序列的釆样值组成，它是无限长的。首先对时间序列进行截断， 只保留2N+1个元素，这样得到的x将是行列均为2N+1的方阵。将x代入式(2-8)得到 2N+1个方程联立的确定性方程组。迫零法通过选择｛叫｝的数值，使得码间干扰失真的 峰值畸变最小，以迫使均衡器输出信号在期望采样点两侧各N个釆样值为零。利用公式 来表示这一过程：
[ 1,SO
y(k) = \	式(2-9)
八 [0/ = ±l,±2,...±N	X )
在实际系统中，滤波器的长度取决于信道产生干扰的程度，即最大多径时延。而随 着系统传输速率的提高，最大多径时延会增大，滤波器的抽头系数也会随之增加。从上 面的分析可以看出，迫零算法忽略了信道的加性噪声，简化了推导过程。但在实际的传 输信道中加性噪声始终存在，而且在实际情况中，信道传递函数的幅频特性很可能在某 个频率出现很大的衰减，甚至出现传输零点。由于均衡器需要对信道进行补偿，它的传 输特性需要与信道特性相反，所以均衡器在信道传输频域深衰落的地方需要有很大的增 益，当存在加性噪声时，这个增益就会放大噪声，导致系统信噪比下降，影响系统性能。
最小MSE法 迫零算法基于的准则是峰值畸变最小准则，另一种通过最小均方误差 (mean-square error, MSE)准则求出的抽头系数仇｝的方法称为最小MSE (MMSE) 法。均方误差的定义是均衡后数据与发送数据差的平方的数学期望。MMSE方法的推导 过程如下，将式(2-7)两边同乘以乂丁得
xTy = xTxw	式(2-10)
可以写为
Rxy=Rxxw	式(2-11)
其中，Rxy = xTy被称为互相关矢量，Rxx=xtx称为输入含噪信号的自相关矩阵。 在计算的时候，由于x是未知的，因此Rw和也是未知的，但是如果发射端发送」 个已知信号作为x,那么可以根据接收端得到的y,求解出职于电，然后式(2-11)两 边同时乘以Rx『可以得到抽头系数：
w = Rxx'Rxv	式(2-12)
在使用迫零算法的过程中，由于需要乘以X」，所以x必须是方阵。但求解最小均方 -误差解的时候，乘以的是Rxx 1,只需要貝心是方阵即可。
