3.4.2.2VCFR信道估计算法的基本处理流程
基于VCFR拓展频域加窗的信道估计算法其处理流程框图如下：
图3-6 VCFR信道估计处理流程框图
现对改进的基于VCFR拓展的信道估计算法处理流程进行详细叙述：
a)使用本地导频信号获得LS信道估计，长度为N“.
VCFR信道估计算法的基础是LS估计。通过LS信道估计器可获得LS估计的 输出
Hls(k) = ^ = YkR； = Hl!+nk,k= 0,-}-Nac	(3-40)
b)在频域添加一定比例的虚子载波频域冲击响应
A
假设添加的VCFR长度为Ny由H«(k)的左右边界处的信道冲击响应值，产 生一个线性的虚频域信道冲击响应。并将虚频域信道冲击响应添加在认《)左右 A
两侧，得到拓展后的信道冲击响应Hcxp颂如(k),添加的虚频域信道冲击响应由下式 子给出，
牝颇(«) = Hlx 3加)+余(院(0)-念,(&.))/=0,1... Me T	<3-41)
30
其中Nac表示实际使用CFR长度，Nvc表75添加的虚子载波长度。
VCFR拓展过程可按如下图所示：
图3-7 VCFR拓展过程
经过VCFR拓展后的频域信道冲激响应可以表示为:
N
CO丄…零一1
NN N
左=竽号+1…号+ & + 1
N
k = &*N ,•* + N -1
2	4 ac	〒 VC 1
c）频域加窗处理
频域加窗处理有助于信道信息能量集中，同时对添加的虚子载波进行平滑滤 波。在文献［7］中讨论了多种窗函数，其最后采用的窗函数表示如下：
k-M — NgM 一 Nac +1, • •— 1
但是通过分析，发现这种窗函数在信道冲激响应边缘有个跳变，如下图3-8所 示，这不利于信道估计。
本文采用的是一种升余弦窗函数，其表示如下：
31
2〃« + 0.5一"“『；心)
N*c + N"
两种窗函数幅值响应图如下:
图3-8窗函数幅值响应对比图 经过频域加窗平滑之后的，其结果可以表示如下：
HWin (左)=H expand (左)=	— l	( 3-45 )
d)对加窗后的做M点IDFT,获得时域信道冲击响应CIR
经过VCFR拓展之后，CFR的点数由Ng变为M, M为N”与添加的虚信道 冲激响应Me的和。加窗处理之后需要通过一个离散傅里叶反变换将频域信道冲激 响应编程时域的信道冲激响应，其表达式如下：
A	A
hwin (k) = IDFT	《=0,1 …Nac + Nvc — 1	(3-46 )
e)时域去噪处理
采用差异化去噪策略完成去噪步骤之后，CFR用加次表示，去噪过程数学表
达式如下：
32
力=0,1 …Lequcp_ex _ L and h win	> Threshold 1
k = (Nac + Nvc) -Lequcp_ex,…(Ng + Nvc) -1
A / \2
and hwin\k\ >Threshold!
others
差异化去噪过程将在下一小节3.4.23中进行详细说明。
f)去噪后的CIR做DFT转换，在频域去除窗，去除添加的VCFR
去噪处理后，需要将CIR变回频域，并去除之前加窗函数影响，完成DFT转 换，并去除窗后，可表示为：
Hdewin(k) = DFT^hdeno(^)^-］, k = 0,1-■■ Nac + Nvc-I (3—48)
完成去窗操作后，去除两侧添加的VCFR,即得到最后的频域信道冲激响应估 计值。
