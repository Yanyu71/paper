5.1梯度相似性测量
有很多方法可以获得图像的边缘信息，比如边缘检测算法DR,局部梯度法等等。 结构相似性方法提供了一种有效实用的测量图像之间相似性的思路。通过寻找一种 合适的梯度算子来求取图像的梯度信息。
由于大多数文献中采用的三阶梯度算子比较简单，本文釆用了一个五阶的梯度算子，描述如下:
「0	1	0	-1	O'		■ 0	　0	　0	　0	0_
0	3	0	-3	0		　1	　3	　8	　3	　1
gl =	0	8	0	-8	0	g2 =	　0	　0	　0	　0	　0
0	3	0	-3	0		-1	-3	-8	—3	-1
0	1	0	-1	0_		_ 0	　0	　0	　0	　0_
其中，gl, g2, g3, g4来源于文献参考文献 Image quality assessment based on gradient similarityo gl是水平梯度算子，g2是垂直梯度算子，g3和g4为对角线方向的 梯度算子。
假设/(X)为一副图像，x图像中任意像素点，GM(x)为最后的梯度幅度图，则 GM】(x) =^(gl*I(x))2+(g2*I(x))2	(5-1)
GM? (x)=J(g3*I(x)y +(g4*I(x)y	(5-2)
GM(x)=max{GM| (x),GM, (x)}
其中，”*”代表卷积算子。
用以上的过程分别应用到带参考的HDR图像和待评价的LDR色调映射图像。 但是，色调映射图像势必会改变局部的强度和对比度，直接对比局部梯度的方法不 可取。需要把局部梯度幅度值进行适当的转换，分别令从高动态范围图像与经色调 映射转换的低动态范围图像提取得到的对应的块分别为x和y表示。假设未修正的高 动态范围图像所对应的梯度幅度图和低动态范围图分别为GMh，GMi，则局部梯度幅 度相似性度测量数学表达形式为：
其中GM“x)是经过修正的高动态范围图像所对应的梯度幅度图，GM；(x)是经过 修正的低动态范围图像所对应的梯度幅度图。匕是为了维持公式稳定的常量。下面 讨论变换原则，变换的两个主要约束条件为：第一，高动态范围图像与低动态范围 图像块区的信号强度差异不应该受到它们的信号强度的影响，比如会出现它们的信 号显著性都超过了阈值或者它们的信号强度都没有达到阈值。第二，算法应该减小
50 受到某张图像的信号强度尤其显著而另一张图像的强度尤其不显著这种情况的影响。 将局部标准差GM(x)进行非线性映射，以区分分辨信号强度的显著度，进而得 到GM，(x)的值。经过这种非线性映射之后，过于显著的信号强度值被映射成了 1而 不显著的信号强度值被映射成了 0,而其中的信号则有一个0到1之间的平滑的取 值。因此，这种非线性映射与对比度的视觉敏感性有关"I。实际上，人类视觉系统 对于对比度的检测并没有固定的门限，根据相关对人类视觉系统的研究发现这种检 测概率是随着观察物体的对比度的变化增加的。经过心理物理学进行的实验，构造 出了信号强度检测概率心理测量学函数模型。心理测量学函数图像呈现为一个S形， 感知门限-般被定为检测概率的50%o而使用的函数形式为：
P(s)=爲』二咬[-dx	(5-5)
式中P即为检测概率密度，S为正弦刺激函数的幅度，压为调制阈值，虫为控制 检测概率变化斜率的归一化分布的标准差，而比值：
k =頒	(5-6)
可以粗略认为k是一个常数。而k的取值一般是2.3至4之间，而当k = 3可以 使得假警报量达到非常的小。
而调制阈值门限乌的倒数经常用来量化视觉对比敏感度，视觉对比敏感度是一 个与空间频率有关的函数，即对比度灵敏度函数。并通过如下对比度灵敏度函数方 程与不同心理实验中获得的数据进行匹配：
A(f) ? 2.6[0.0192 + 0.114f]exp[—(0.114/')11]	(5-7)
/即为空间频率，且此函数是归一化函数，因此仅提供了跨越整个频谱的相对灵 敏度。实际上这个值需要通过使用一个常量入来进行缩放以匹配心理数据并通过如下 公式来进行缩放；
1
W)= W)-	(5-8)
所以，在假设在纯正弦信号刺激下基于对比度敏感度测量值计算出了阈值。为 了将此结果转换为使用信号标准差的信号强度测量值，需要考虑有对比度以及平均 信号强度的信号幅度尺度，在幅度和正弦信号的标准差之间有了一个据的因子。可 以得到基于信号标准差的阈值计算式可以表示为：
5 = 7^(7)	(5'9)
?为平均强度值，并且：
"=%	(5-10)
定义GM (x)与GM' (%)之间的映射为：
GM，(x) =		fa exp —M3)，dx (5-11)
I 7 面。GM(x) J-8 F 26如3)	'	,
它们的值都是?()至1之间，0代表完全即为微小，而1代表极为重要。
局部梯度相似性得到的结果就是一个反映整体图像结构保真度变换的图。假设 观察距离是32周每度，这样就能无损展示16周每度的信号，因此为了使对比度敏 感度函数获得最佳维度测量效果时使用16周每度作为空间频率参数。空间频率参数 应用在接下来更精细的维度分别就是8, 4, 2, 1周每度〔27】。
最后，图像梯度幅度相似性值gscore的计算公式为：
]M	b
gscore=—^SGM(xj)	(5-12)
M j=i
其中，b决定着灵敏度，i是图像中的第i个像素，M是一副图中所有的像素
图5-1色调映射图像和其对应的各自的梯度幅度图
图5-2修正后的梯度相似度
