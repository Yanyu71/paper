4.4.7合并所有记录
这一步是算法中的重点，借助图论的思想，用 MapReduce 实现了对整个文件取并集，完成了属于同一自然人的所有虚拟身份的合并。对上一步的输出结果进行取并集，得到的结果形式是文件的每一行的所有虚拟身份对应同一使用人将在下一章对此同人关系传播算法的实现进行单独详细的介绍
1)输入数据
步骤4.4.6的输出结果，数据量约为3.5GB
2)输出结果
这一步所得到的输出结果并不是真正的最终结果，下一步会对这一步的输出结果进行分析验证然后再做相关的处理，下一步骤会有相关说明，但是最终的结果形式是不会变的，如下所示:
如输出结果图4-13 所示,每一行记录中的所有虚拟身份即属于同一使用人，为了保护公司以及个人隐私，我们对敏感的信息进行了特殊处理(用*号代替)并且，在图 4-13 中进行特殊处理的虚拟身份是我们已知企业所用的邮箱，这样我们可以对分析出属于同一使用人的结果的正确性进行验证。对照分析出来的结果，然后询问该邮箱使用人的其他虚拟身份看是否吻合，经验证统计分析出来的结果正确率达 90%以上。
