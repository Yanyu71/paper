4.2.2小目标实例增强策略
数据集得到扩充后，检测过程中需要的小目标实例随之扩充，但相应的非目 标背景内容也会随之扩充。小目标实例在整个数据集中所占的比例仍保持不变。 本节提出的小目标实例增强策略不仅能够扩充小目标实例的数量而且能够增加 小目标实例在整个训练样本中所占比例。本节提出的小目标实例增强策略是基于 目标掩膜(Mask)信息提出来的。具体来说，复制小目标实例的掩膜，然后将该 掩膜粘贴到同一图像中的其他位置。
小目标能够匹配到的anchor极少，通过复制小目标的掩膜并粘贴到图像中 的其它位置，从而在训练过程中有更多的anchor与小目标正匹配，这样能够改 进小目标在RPN训练期间损失函数中的贡献。图4-6展示了所提出的小目标实 例增强策略是如何在训练中增加匹配的anchor数量。
44
图4-6不同尺寸的anchor与ground truth匹配示意图
图4-6 （a）是一个anchor示意图；（b）是一^小目标所对应的anchor, —共 只有三个anchor能够与该小目标配对，且配对的IOU也不高；（c）是将小目标 的掩膜粘贴到同图像的其它位置后anchor的匹配情况，同一张图像中的小目标 实例变多，匹配到的anchor数量也就变多，则此小目标被检出的概率也就变大。 对于COCO数据集来说，图像的标注信息里有目标的掩膜信息，所以在COCO 数据集上进行小目标实例增强时只需保证两点要求：1）在复制时，只考虑未被 遮挡的小目标，因为使用有遮挡区域的不连续目标实例会使图像失真；2）在粘 贴时，要确保小目标掩膜不与任何现有的目标重叠且不超出图像边界。具体算法 流程如图4-7所示：
COCO数据集上基于掩膜的小目标实例增强效果如图4-8所示，左图为原始 图像，右图为复制网球掩膜并随机将其粘贴到图像合适位置：
