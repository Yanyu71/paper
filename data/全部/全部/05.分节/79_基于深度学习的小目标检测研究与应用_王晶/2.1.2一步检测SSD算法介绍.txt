2.1.2一步检测SSD算法介绍
一步检测算法的主要思路是均匀地在图片的不同位置进行密集抽样，抽样时 可以采用不同尺度和长宽比，然后利用CNN提取特征后直接进行分类与回归, 整个过程只需要一步，所以其优势是速度快。但是均匀密集采样的一个重要缺点 是训练比较困难，主要原因是正样本与负样本的分布极度不均衡，导致模型准确 度比两步检测算法略低。SSD是一步检测算法的典型代表，其整体框架如图2-3 所示。
图2-3 SSD整体框架
SSD输入一幅图片(300x300),先将其输入到预训练好的分类网络(VGG- 16)中来获得不同大小的特征图。针对VGG-16,这里稍作了一些改动：图2-3 中Conv6和Conv7代替了 VGG-16的FC6和FC7,并且不再包含Dropout层和 FC8o 然后抽取 Conv4_3、Conv7、Conv8_2> Conv9_2> Convl0_2> Convll_2 层 的特征图，分别在这些特征层上面的每一个点构造K个不同尺度大小的先验框 并分别进行检测和分类，一步生成多个预测框。最后将不同特征层获得的预测框 结合起来，经过非极大值抑制(Non-Maximum Suppression, NMS)〔3口方法来抑 制掉一部分重叠或者不正确的预测框，生成最终的检测结果。
可以看出SSD采用CNN来直接进行检测的同时，增加了两点改进：
(1)、采用多尺度特征图用于检测。CNN网络一般前面的特征图比较大， 后面会逐渐采用stride-2的卷积或者池化来降低特征图大小，SSD采取的方法正 如图2-4(b)所示，底层比较大的特征图和高层比较小的特征图，都用来做检测。
图2-4单层特征图预测和特征金字塔预测对比图
在SSD中如果有多个目标框(ground truth),每个anchorC原文中称作default box)会选择对应到IOU最大的那个ground truth□ 一个anchor只会对应一个
10 ground truth,但一个ground truth都可以对应到大量anchor。原论文中认为仅仅 靠同一层上的多个anchor来回归，远远不够。因为有很大可能这层上所有anchor 的IOU都比较小，用这种anchor来训练误差会很大。原论文将VGG-16的最后 两层全连接改为卷积层并额外增加四个卷积层来构造网络，通过同时对六个层级 上的anchor计算IOU,就能找到与ground truth的尺寸、位置最接近(即IOU 最大)的一批anchor,高层特征anchor覆盖范围大可以检测大目标，低层特征 anchor覆盖范围小可以检测小目标。
(2)、Anchor尺寸设计。YOLO通过网格划分的方式，每个小格只预测一 个回归框，当目标物体存在重叠度较大，或者目标物体较为密集时，YOLO存在 较大的漏检。Faster R-CNN中的anchor思想能够很好地解决这一问题。与Faster R-CNN的不同的是，SSD在不同尺度的特征层上都生成anchor,每个层级上的 anchor尺寸又有相应的设计。anchor尺度(默认为正方形)的计算方法如公式(2- 1)所示：
Sk = smin + 警-響(k -l),ke [l.m]	(2-1)
m — 1
其中tn表示不同尺度的特征层数量，原论文中为6, s诚“是最底层的anchor 尺寸，这里使用的是0.2, Sjnax是最高层的anchor尺寸，这里使用的是0.95。
