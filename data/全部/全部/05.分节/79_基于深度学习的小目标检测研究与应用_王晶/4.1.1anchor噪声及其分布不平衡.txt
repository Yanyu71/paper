4.1.1anchor噪声及其分布不平衡
(1) anchor划分引入噪声
理想状态下,如果一个anchor和groundtrutli的IOU=1,那么这个anchor为 正样本；如果IOU=0是负样本。但是中间的那些应该怎么分配类别呢？从第三 章可以知道，现在常见的方法是卡阈值，IOU高于0.5即为正样本，低于0.5为 负样本，然而这并不是一种最优的策略，毕竟把一个IOU=0.55的anchor当做正 样本会引入一些噪声。图4-1展示了图像中的anchor及其分类标签示例。
(a)	(b)	(c)
Negative	.	. ■	Poshive
图4-1图像中的anchor及其分类标签
36
之所以说划分anchor正样本和anchor负样本的启发式方法会引入噪声，是 因为对于所有目标，无论其类别、形状、大小等，阈值都是手动选择和固定的。 例如，对于不规则形状的目标，具有高IOU的anchor可能包含背景噪声甚至包 含其他物体，如图4-1中的卡车上的绿色汽车和笔记本电脑前面的狗。另一方面, IOU较小的anchor可能仍然包含重要的线索。例如，图4-1中包含长颈鹿头的 anchor将被视为负样本，但它包含识别长颈鹿和定位长颈鹿的有用外观信息。这 种划分正负样本集合的方法，会导致用于训练分类分支的标签是带有噪声的，样 本噪声大，学习困难，将产生较大的损失。因此，当使用像2.2.2节中提到的OHEM 或Focal Loss这样的重采样方法来解决问题时，噪声也会被相应放大。
(2) anchor样本不平衡
在传统的anchor类别划分过程中，通常根据anchor与ground truth的IOU 范围划分其类别，本章使用的划分依据如图4-2所示：
图4-2 anchor样本划分依据示意图
图4-3展示了 anchor样本的4个具体类别，其中红框为ground truth□依据 上述划分依据可以推断出：按正负样本分类，负样本将远远多于正样本；按简单 困难样本分类，简单样本将远远多于困难样本。
图4-3 anchor样本分类
37
以图4-3输入网络训练为例，调整图像大小为256x256,经过了 VGG-16特 征提取网络后，特征图尺寸为16x16, anchor的尺寸共计9种，那么总共有 16x16x9=2304个anchoro根据置信度得分初筛得到2000个anchor,而该图中仅 有一个待检测目标，会有大量的anchor标注为负样本。极少数的正样本中，简单 样本所占比例更是微乎其微。
香港中文大学多媒体实验室李教授团队Do】认为正负样本数不同不是影响检 测算法性能的本质问题，产生本质影响的问题是简单困难样本的分布不均衡。更 进一步，每个样本对模型训练的实质作用是产生一个梯度用以更新模型的参数, 不同样本对参数更新会产生不同的贡献。简单样本的数量非常大，它们产生的累 计贡献就在模型更新中有巨大的影响力甚至占据主导作用，而由于它们本身已经 被模型很好的判别，所以这部分的参数更新并不会改善模型的判断能力，也就使 整个训练变得低效。
