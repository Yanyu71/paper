4.1.3VLAD计算
VLAD是基于传统的BOVW的改进，是一种非概率模型下的Fisher Vector,其 示意图如图4-2所示。
图4-2 VLAD编码示意图
VLAD的计算过程如下：
(1)使用k-means聚类训练样本码书。
挑选K个样本作为初始化的聚类中心。
对于每个样本，计算离他最近的聚类中心，并把该样本划分到该类下，并计算各 个样本与其最近的聚类中心的距离和
34
厂这Z（Xj-从，	（式4-12）
7=1 X产， 重新计算每类样本均值作为聚类中心
从=2马	（式4-13）
重复2,3过程直到距离和V不变
（2）对于新的样本点x进行VLAD编码
%=	E（X1-c“）
xsuchthatNN（x）=Cf	（式 4-14）
其中，c,表示第i个聚类中心，为表示样本x的第j维，D为总维度数。 （3）对样本集合｛/）｝的编码结果进行平均
N
%工吧	（式4-15）
n-l
其中N为样本集合数，匕？为第n个样本的VLAD编码结果中第i类下的第j维, 为最终编码结果第i类下的第j维。
（4）对结果进行12归一化
*甘皆	（式4-16）
/=1 7=1 '
VLAD相对于Fisher Vector的变化有如下几点：
（1）在距离的度量上，使用了 L2距离，而Fisher Vector则是以高斯模型产生该 样本点的概率度量样本点到聚类中心的距离，由于VLAD没有使用高斯函数，使得 距离的计算上速度回远高于Fisher Vectoro
（2）在聚类方法上，使用了 k-means聚类，而Fisher Vector使用混合高斯模型 类进行聚类。VLAD划分类别是以最近的聚类中心作为样本点划分依据，其聚类方法 对于球状样本簇的拟合效果较好，而混合高斯模型能够更好的拟合狭长型的样本簇， 这也是混合高斯模型在理论上具有的优势。但混合高斯模型假设之一便是样本簇的产 生符合高斯分布，而在实际应用时往往样本点不一定完全符合这一假设，这使得两者 在聚类方法上互有优劣。
0<3）在特征表达上，Fisher Vector对各个高斯模型系数的偏导由于所占维度少，
35
对于距离的度量几乎没有贡献，主要的信息集中于对高斯模型均值的偏导和对高斯模 型标准差的偏导，其中对于均值的偏导可以表示为样本点与各个聚类中心差值按照到 他们的距离作为系数进行分配的结果，而对标准差的偏导并没有特别直观的解释。而 VLAD的特征表达则要简洁的多，只向其最近的聚类中心分配样本点与其的差值，这 样形成了更为稀疏的表达，且特征维度仅有Fisher Vector的一半。
