5.3.1多媒体事件检测流程
本文进行多媒体事件检测流程如图5-1所示。其中红色的虚线表示训练阶段独有 的，普通的实线表示训练阶段和测试阶段共有的。
训练阶段：
(1)训练视频被解码并采样出视频帧；
(2)通过卷积神经网络提取出密集局部特征，即帧级别特征；
(3)先根据训练视频的帧级别特征先进行样本均值、方差统计和PCA投影矩阵 的计算，再使用归一化和PCA降维进行处理；
(4)先根据预处理后的帧级别视频训练VLAD编码所需码书，再进行VLAD编码 和归一化，得到视频级别特征；
(5)用训练视频的特征训练SVM分类器。
63
测试阶段：
(1)测试视频被解码并采样出视频帧；
(2)通过卷积神经网络提取出密集局部特征，即帧级别特征；
(3)对帧级别特征使用归一化和PCA降维进行预处理；
(4)对预处理后的帧级别特征进行VLAD编码和归一化，得到视频级别特征；
(5)对测试视频特征用已训练SVM分类器进行相关事件的类别预测，得到置信 度。
svm模型
图5-1多媒体事件检测框架流程图
频别征 视级特
在训练时，训练集的CNN特征和VLAD特征均会被存储于硬盘上,PCA和VLAD 的训练样本均由自适应的方法进行选取，PCA投影矩阵、VLAD码书、SVM模型被 存储于硬盘上。
在测试时，读取存储于硬盘上的PCA投影矩阵、VLAD码书、SVM模型，然后 对输入视频进行特征提取、特征融合、类别预测，这样只有测试视频的VLAD特征 和类别预测结果存储于硬盘中。如果有多模型融合的需求，存储在硬盘上的多个模型 提取的VLAD特征将直接用于多模型融合，以避免重复计算。
整个框架是一个任务提交式的结构，在指定训练集、测试集、基本参数后，框架
64
的三个部分一一特征提取、特征融合、类别预测均以中间结果的生成完整与否来判断 是否需要继续执行任务（若对应的中间结果已生成完整则会跳过当前部分），而每一 部分将根据指定的训练集和测试集和已存储的中间结果进行剩余任务计算，还需执行 的任务将被根据指定的线程数进行切分并分配到多个线程执行任务。此外，若有个别 视频数据存在的读取失败的情况，框架将会给出警告后并跳过，不影响其他任务的执 行。
