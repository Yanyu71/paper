4.2.2基于LSTM的多媒体事件的时空表示
我们用LSTM单元替换RNN单元可以搭建一个简单的LSTM网络。该网络由一 个输入层、一个输出层和一个隐层组成，LSTM单元构成了隐层的神经元节点，而输 入层节点到隐层节点和隐层节点到输出层节点之间以全链接形式完成。
本文按照图4-7所示的方式来训练LSTM网络，一个视频的帧级别特征按时间顺 序作为一个输入的mini-batch,在训练时，对于同一个mini-batch下不同样本的输出， 用视频的标签作为其每帧监督信息进行训练；在测试时，对于同一个mini-batch下不 同样本的输出求平均，作为这个视频的预测标签。在每个视频序列输入完成后，将每 个LSTM单元的记忆单元清空，保证每个视频的特征序列在训练时LSTM单元接收 到的信息没有来自其他视频的。
图4-7 LSTM网络训练示意图
LSTM网络在训练时一般使用固定大小的Mini-batch进行训练，对于视频采样的 帧数大于Mini-batch大小的情况，本文采用居中截取一段视频帧的方法；对于视频采
48
样的帧数小于Mini-batch大小的情况，本文采用将视频从头开始重复取样直至补齐的 方式。
本文将视频的帧级别特征序列输入后LSTM单元的状态作为多媒体事件的时空 表示。由于LSTM网络中已包含了对事件的分类器，在进行多媒体事件检测时，本 文直接采用将网络输出层的概率分布平均的方式作为发生相应事件的置信度。
