3.3.4终端检测算法效果
图3-4 IPID终端检测验证结果
图3-4是根据本文提出的终端检测算法所描绘出来的IPID轨迹，检测的目 标网络是一个拥有15部网络设备的网络，从图中可以看出，共检测出13条轨迹， 经验证，当时网络中的有2台终端在检测时间段内未进行网络通信。可见，终端 检测程序准确的描述出了活动主机的实时网络通信状况。
观察图3-4可以发现，终端轨迹大都比较平滑，这主要因为检测啊络为一办 公网络，由于网络配置或者网络用户自身不太会有使用视频等大流量的网络应用 需求，同时，由于这类网络用户具有非常接近的行为方式，导致，最终检测到的 终端轨迹有聚集、相交的现象出现。从而形成了图3-4的IPID轨迹特征。
在网络终端通信的IPID轨迹的检测、分析过程中发现，实际网络中的用户 上网行为，并非一个线性的状态，部分网络终端的网络具有突发性的特征，这就 导致了部署网络监控模块无法获取足够的关联信息，不能把来自于同一终端的数 据归类到一起。部分终端因为与外网通信过少，导致了检测无法获取足够的数据 包，来判定该终端的存在。
通过检测建立的终端IPID轨迹中可以发现网络中的终端在各个时段中的活跃 情况：终端IPID轨迹的数量代表着存在网外通信的网络终端的数量，轨迹的斜 率代表终端网络通信的发送IP报文的速度，斜率越大，发送IP报文的速度也就 越快，反之则越慢，据此可以推断出终端的网外通信的繁忙程度，这些都是对网 络中终端的网络使用情况的富含价值的反映，对网络应用的审计具有重要的意义。 进行网络应用审计时，比照检测建立的终端IPID轨迹反映出来的信息，可以对 审计结果进行相互印证，增加审计结果准确性。
本文提出的终端检测算法对Windows系列的操作系统实现较好的检测效果， 如前所述，由于不同终端操作系统之间对IP报文的标识号(Identification)字段 的实现方式的不同，可能导致上述算法存在误差的可能。同时在实际检测过程中 发现，如过网络中存在Linux系列、Android或IOS等操作系统，检测结果会产 生较大的偏差。如果需要对网络中的终端进行准确标记，还需要借助其他的方式。 其中，检测网络通信中携带的Cookie的信息,TCP初始序号(ISN, Initial Sequence Number)检测等技术都是比较准确、有效的检测方法，在未来对网络终端的检 测研究中可以考虑增加其网络流量信息，对检测算法进行改进、优化，提高终端 检测算法的准确性，增加终端检测算法的适用范围。
