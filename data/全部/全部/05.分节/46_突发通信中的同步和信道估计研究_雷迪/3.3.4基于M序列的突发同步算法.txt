3.3.4基于M序列的突发同步算法
同步头生成
本系统以DS-BPSK信号作为同步头。为了便于DSP处理，本论文设计的单载 波短波通信系统选择长度为2*的具有良好自相关性的大M序列(最长线性移位寄 存器序列)代替m序列作为同步码，系统选择的大M序列周期为1024,码片速率 为2. 4kchips/s；同步码重复4次后，经过滚降系数为0. 25的根号升余弦滤波器后， 用1500Hz的载波进行BPSK调制。
扩频调制	BPSK
输入比
1024位M序列
发生器
图3-17同步头生成原理图
系统采用的大M序列生成方法为直接构造法，其构造方法利用了大M序列的
特征多项式为本原多项式的原理，在长度为2*-1的m序列中插入一个全0状态可 以得到对应的长度为2*的大M序列。实际系统应用中，已知m序列的线性反馈函 数九(])=% +弓》+°2孑+ ...+勺寸，则对应大M序列的线性反馈函数表达式为 fM (x) =CQ+ CjX + C2X2 H 1- CnXn + x^x2 ■-瓦 _i，它由 九(x) = % + C]X + c2x2 H— + cnxn 和最小项可舄…瓦相加得到。基于上述原理的M序列发生器逻辑框图3-18所示:
本系统中，M序列特征多项式为/(x) = l+jr3+xIOo
同步头捕获
接收端首先对接收到的数据分段，每段长为一个m序列持续时间；每段数据 送入并行检测器中的一路，与载波相乘后，经过根号升余弦滤波器；输出信号与 本地经过升余弦滤波器后的M序列做循环相关，若出现相关峰值，则捕获到同步 头。
由数字信号处理理论可知，N点信号的时域相关可通过N点FFT变换等效为 频域各复数值的点乘，再通过N点！FFT变换，得到时域滑动相关所对应的所有N 点结果。
对于接收序列x(n),其中”	其FFT变换结果为：
黄 0)=时7即))	(3-27)
其中k = 0,，、N-l。现假定本地同步序列为x(n),对应的FFT结果为：
X(”) =序7(x(〃))	(3-28)则时域相关可以用下面的频域处理方式完成：
j/(n) = 7FFT(con/.(^(?))-^(?))	(3-29)
当接收序列利时为所期望的同步序列时会出现相关峰值，其峰值同样受系 统频偏影响，为此需要进行基于试探的频偏估计。可以通过彳的谱线循环移 动，完成频率分辨率整数倍频偏的试探。对于经FFT分辨率整除后的剩余频偏, 可以通过对接收到的信号必时乘以频率分量成血"来消除。其中，"为频率细 搜索步长。
图3-19同步头搜索框图
本系统中，M序列的码片速率为2.4kchips/s, M序列周期为1024，可以计 算出每个M序列的持续时间7 = 1024/2400 = 0.4267s,则FFT的频率分辨率 戶=1仃=2.3438压。将京0)向左向右各循环移位14次，就可以探测 ±32.8125压的频偏。FFT谱线循环移位的频偏探测后，有可能残留最大 772 = 1.1719压的剩余频偏，设置频率细搜索步长域= 03Hz ,向左向右各搜索 4次，消除残留频偏。
进行频率细搜索时，不需要向左右两边进行搜索。可以根据频率粗搜索的结 果，确定频率细搜索的方向。在完成粗搜索后，可以得到频率与相关峰值的对应 关系，如图3-20所示：
图3-20	不同频率对应的相关峰值
记最大相关峰值对应的频率位置为pos,比较posT与pos+1对应的相关峰值, 可以确定频率细搜索方向。计相关峰值数据为peak,如图3-20中的情况， peak(pos +1) > peak(pos -1),知精确的频率ff'l./ G [pos, pos + 1],即细搜索方 向为右；反之，若peak ( pos +1) < peak ( pos -1),细搜索方向为左。特殊地，当 pos在边界的情况：pos在左边界，细搜索方向为右；pos在右边界，细搜索方向为 左。
基于同步头相关峰值的信噪比估计
通过估计接收到的同步头的功率，结合同步头和传输数据固定的功率比，计 算出接收到的传输数据的信噪比。
假设传输信道是有增益的AWGN信道，信道模型如下：
= 7??x(z)+ 叩)
其中y(z)表示接受到的信号，表示信道增益，工(!)表示发送的信号，"?)表示 加性高斯白噪声。令z(〃)为本地同步头与接收序列互相关的结果，z0(n)为本地 同步头自相关的结果，其中〃 =0为相关峰值出现位置，则信道增益的估计值片可 由下式求得：
(3-31)
估计岀信道增益后，信噪比可由下式求出： /?-P
SNR =——￡
P
4系统已知，月可由统计方法求得。具体做法是：对接收信号进行分段，每段
0.5s；分别求每段的功率；取功率最小10段的平均值作为噪声功率4。
