3.2.4MP算法
MP算法由文献[2]提出,是进行OTFS信号检测常用的非线性检测算法之一。 在OTFS系统中，接收信号可以表示为
y = H,x +w
其中y、x和w都是MNx\维的复向量，分别代表延迟多普勒域接收信号、发送 信号和零均值加性高斯白噪声矩阵。w的方差为^2。x所有取值的集合为C,共 有0个值，例如发送的是QPSK符号，贝lJ2 = 4o比是MVxMV维复信道矩阵， 其中元素记为HXa,b}, a,b = {l,2,3,...,MN},根据式(2-27)(2-28)可以确定信道矩 阵的各个元素值。假设无线信道总共P条整数径，则无论使用的是矩形滤波器还
是理想滤波器巴中每行每列中只有p个非零值。因为H,是尺寸为MNxMN的矩 阵，每行每列有个值，而PwMN ,故瓦是稀疏矩阵。可以利用矩阵稀疏性 设计低复杂度检测算法[2〕。令9(a),a = 1,2,3,...,MN和畑b =	分别表
示索引集中第。行第b列具有非零元素的索弓I，有»(a)| = "@)| = P。在OTFS系 统中，发送信号和接收信号间的关系可以建模为稀疏连接因子图，其中有个 变量节点x和阿个观测节点y。每个观测节点y[a]与尸个变量节点 [x[6],fee5(a)}相连，每个变量节点x[刃与P个观测节点{y[a],a e 相连。使 用联合最大后验概率(MAP)检测规则估计发送信号，则有
x = arg max Pr(x | y, H)
对于每个元素有
x[6] = arg max Pr(x[^] = c - \ y, H) CjeC
=arg max 丄 Pr(y | 兀[b] = c ., H)
CjeC Q	3
-arg max n Pro⑷ k®] = Cj,H)
MP算法具体过程如下[2]。
消息从观测节点觅O]传到变量节点X0]:
26
y{d) = x[b]H[a, b\+ 工 x[d]H[a, d] + w[a]
de&(a\d^b
其均值可以计算为:
Q
xa = L工阴匕対砸间
dw9(Q\dHb j=\
其中"•)是一个指示符函数，如果参数中的表达式为true,则其值为
Oo
决策更新为：如果计" >严,
x［/)］ = arg max p(li}(cXc = =2,3,…,MN
Cj eC
仅当当前迭代比先前的迭代可以提供更好的估计时，才更新传输符号的决策。
MP算法设置了停止迭代条件。当满足以下任意条件时,MP算法停止：泸)=1； 沪)</)_£,其中r为第，次前的某次使於［为最大的迭代；达到设定的最大迭 代次数。第一个条件发生在所有符号都收敛的最佳情况下。如果当前迭代提供的 决策比先前迭代的决策更糟糕，则第二个条件对于停止算法很有用【44］。
