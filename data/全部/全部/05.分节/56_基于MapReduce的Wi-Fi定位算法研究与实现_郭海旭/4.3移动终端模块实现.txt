4.3移动终端模块实现
在定位系统中，移动终端的任务有两个：一是采集并上传数据至服务器，二
41
是下载并显示定位结果。因此，移动终端需要建立两个功能模块分别实现数据采 集和结果显示功能。
移动终端首先要根据实验要求在本地加载实验用的电子地图，记录并存储已 知AP节点的坐标。然后根据室内空间的大小规定采集数据的量，根据实验环境 的复杂程度不同，可以适当增加采集次数。当然，为了采样数据能够有效地反映 出Wi-Fi信号的特点，采集的次数越多越好【网。
由数据采集模块接收的数据包括AP点坐标、位置标识符、所有AP的名称 以及环境中所有采样点中每个AP的Wi-Fi信号强度。这个功能模块是整个系统 建设中工作量最大的部分。系统的建立伴随着大量的数据生成，因此采集后的数 据需要全部上传并在服务器端进行备份，以便后续系统的调用。数据采集的流程 如图4-12所示。
开始
设置当前位置坐标和位置标识
检查手机Wi-Fi状态
扫描当前Vi-Fi信号
存储Wi-Fi数据 ------q-------否
是
图4-12数据采集流程图
结果显示模块以图形化的方式将结果直观地表现出来，因此显示界面需要展 示实验区域的二维地图和预测结果的位置。如图（4T3）所示，终端界面设计了“开 始”和“停止”两个按键分别执行定位和停止定位并返回结果的操作，结果将以
42
栅格地图上的红色方块的形式呈现，圆环则表示目标有可能处在的位置的范围。
图473结果显示模块图
