3.2.3算法流程
这一小节对模型的训练策略进行介绍，首先随机初始化稀疏自编码器，网络 权重随机初始化方法采用文献［39］提出的Kaiming初始化方法。然后对稀疏自编 码器进行预训练，预训练的目的是增强稀疏自编码器的特征表征能力，训练数据 采用源域数据£＞s和目标域数据优化目标是最小化参考式(2-17) o预训练完可 以从编码器输出潜在特征表示疋和X,训练后的网络权重表示为念。预训练的目 的是为了使网络获得更好的初始化参数，使训练中的模型更快收敛。
在完成SAE的预训练过程后，进行整个SAE-LSTM网络的训练。首先使用 比初始化SAE-LSTM网络结构的特征提取层，然后使用公式(3-2)作为损失函数
24 进行模型的训练。由于模型是基于神经网络的，所以采用mini-batch随机梯度下 降法，只在batch之间进行分布自适应，而不是对整个数据进行分布自适应。整 个模型的输入是有标签的训练数据集和无标签的测试数据集，两个数据集提前进 行了工况的划分，即两个数据集都包含了多种类别并进行了标注，在训练过程中 对相同类别进行域自适应。
整个算法的伪代码为:
算法DAMOC：
Input:
D$,Dt：源域和目标域输入数据
Vs：源域标签
r：源域工况类别标签
◎：目标域工况类别标签
c：源域和目标域相同工况的类别标签
比:稀疏自编码器(SAE)参数
0m：整个网络(SAE-LSTM)参数
“：学习率
1：利用预训练两层SAE
2：更新 SAE 参数：es^-os- KdJsAE^.D^/de,)
3：初始化整个网络(SAE-LSTM)参数，其中SAE部分采用比初始化
4： repeat
5： 将输入到网络中，在SAE层之后得到源域和目标域潜在特征 表达：/和加，利用相同工况的类别标签c可以得到砒和砒
6:	使用MMD和式(3-5)计算得到的自适应权重血计算/和加之间的距
离工ScMMD(碣號)
7： /通过后接全连接层的LSTM得到预测结果Y^.edict,最终的损失函 数为：Jm = 10SS(ys,y；redG)+E21PcMMD(號，战)
8： 对网络中参数进行更新：Om^em- K&Jm/dOrn)
9： until 收敛到最小
Output：剩余使用寿命预测模型f
25
