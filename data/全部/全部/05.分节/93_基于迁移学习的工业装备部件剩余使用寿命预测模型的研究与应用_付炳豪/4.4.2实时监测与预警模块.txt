4.4.2实时监测与预警模块
实时监测与预警是整个运维系统的核心模块，本文设计的运维系统采用的模 拟数据为轴承公开数据集，实时监测模块的首页面如图4-9所示。上半部分是当 前设备的整体概况，包括机组总数、运行机组、停用机组，分别用三种不同的颜 色标记，圆框里面的数字为机组数。下半部分的柱状图显示了当前运行机组的设 备故障情况，即每个机组里的正常运行设备数和故障设备数。
实时监测模块首页中的运行机组圆框为button按钮，点击切换到设备选择页 面，如图4-10所示。在设备选择页面，用户可以选择机组和相应机组下的设备， 点击确定后进入设备监测页面。如图4-11所示，设备监测页面显示了当前设备 的状态，包括剩余使用寿命、重要参数、特征趋势图。当预测的剩余使用寿命低 于设置的阈值时，绿色的数字会变为红色的故障提示。设备的剩余使用寿命是利 用封装好的算法进行实时预测，然后显示在页面。采用的剩余使用寿命预测算法
45
为本文提出的算法，经过API封装步骤后直接调用。
当前设备：1号轴承 剩余寿命：160
工况参数
方差
最高值
最低值
X振动
当前工况
:X振动
图4-11设备监测页面
剩余使用寿命预测算法调用流程如图4-12所示，首先RUL预测算法在本地 进行构建和训练，采用Python语言，训练完成后可使用joblib将训练好的模型 保存为本地的.model文件。保存完成之后，将.model文件上传到PHM平台。通 过平台返回的API在小程序端进行直接调用，用于设备的RUL预测。同时，用 户在第一次调用平台API之前，需要在平台上进行身份认证来获取API身份信 息，根据返回的apiKey和apiSecret来获取access_token, access_token即小程序 每次调用API的身份认证信息。微信小程序通过监测页js文件中的wx.request向 服务器发送post请求来进行算法的调用,参数url即为PHM平台封装的API, 同时在请求时需传递用户access_token。调用API对当前数据进行预测的RUL结 果会存入云数据库中，数据库中每条数据的result字段即为模型预测结果。
数据预处理
'获取API身'
. 份信息
微信小程序
1
测试后上线
图4-12运维监测平台RUL预测算法调用流程
47
当预测的RUL低于阈值时，当前状态改变为故障模式，并发出预警，进行 工单派发。数据获取利用wx.request进行调取，每次监听页面对于机组的选择, 利用回传的FANid传入函数进行数据调取，调取成功后存入数组，然后再进行 工况参数表格渲染。报表功能的获取数据方式与数据展示部分相同。数据显示页 面的时间显示是利用了，微信的timefbnnat进行获取和显示的。
