4.2.4改进算法仿真结果分析
本文中，对于S&C算法和改进算法的仿真流程由下图4-10给出:
图4-10对S&C算法和改进算法对比仿真流程图
如图4-10所示，发送端发送的bit数据流经过QPSK调制、快速傅立叶反变 换后到时域上，此时再插入循环前缀CP和训练序列，然后进入时变多径高斯白 噪声信道。接收端，将接收信号去掉CP后，分别使用两种不同的算法对去掉 CP的接收信号进行频偏估计与补偿，此时将两种算法频偏估计得到的频偏值进
40
行存储，并且和信道中插入的频偏值进行比较，计算CFO—MSE。补偿后的信号 数据分别存储在两个不同的数组里。将两组数据分别进行快速傅立叶变换到频域, 解调后得到还原后的bit数据。此时，用还原后的bit数据和发送端的bit数据流 进行比较，计算误比特率BERo
该仿真中，使用的OFDM符号长度是1024bit,多径信道的多经路数是6, 每条路径的多径衰落分别是0、-6、-10、-14、-20、-26dB,多径延迟分别是0、 1、2、3、4、5,其中循环前缀CP的长度是可变量，范围是0:1:6,信噪比SNR 也是变量,其变化范围是0:5:80dBo该方针平台分别从两个方向来模拟信道环境， 分别是CP的长度和SNR的大小。其中CP的长度用来模拟信道中信号间干扰ISI, SNR用来模拟在相同ISI干扰条件下两种算法在不同信噪比条件下的性能表现。
同样的，两种算法的性能表现也使用两个重要参数来衡量，其一是信号经过 还原后得到的bit数据的误比特率BERo其二是在频偏估计与补偿阶段，得到的 频偏数值和信道中插入的频偏数值计算而出的频偏估计值方差CFO_MSE。其计 算方法已经在上述文字中给出。
图4-11不同cp长度下的BER
图4-11的仿真曲线的仿真环境是SNR=60dB,多径路数为6,循环前缀CP 长度在。到32之间变化，频偏4=0.01〜0.1之间随机变化。仿真思路是通过改变 CP的长度来引入符号间干扰ISI, CP长度越短信号间干扰越强。两条曲线是在 不同的CP长度下，计算得到的误比特率BER绘制而成，实线和虚线分别表示 经典S&C算法和改进算法得到的结果。如图所示，经典的S&C算法的BER随 着CP长度的增加而减小，最后在CP长度达到25左右时曲线趋于平滑，因此我 们可以看出，经典的S&C算法对于CP长度比较敏感，较长的循环前缀可以带 来更好的性能，最佳的CP长度是25。与之相反，改进算法对于CP长度并不敏 感，其仿真曲线在一定程度上趋于平稳,BER在ICT*附近变化，并无太大波动。 两曲线在CP=14的位置相交，这说明在CP长度小于14的时候，改进算法还原
41 得出的信号更加准确，CP大于14的时候经典的S&C算法能够得到更加准确的 还原信号。
图4-12与图4-11是在相同信道环境下进行的仿真。该图是从CFO_MSE角 度进行的分析，如图5-7所示，我们可以看出，在不同的CP长度条件下，经典 的S&C算法频偏估计的方差随着CP长度的增加而减小，改进算法却不如经典 算法那么敏感。分析其原因，是因为改进算法舍弃了训练序列的前四分之一和后 四分之一序列，这样就算在CP长度过短，引入符号间干扰的前提下，也不会对 频偏的估计产生太大影响。这在仿真曲线中表现出来，是对CP变化的不敏感性。
下图4-13和4-14是在CP=20,多经路数为6的条件下，SNR从0~50dB变 化的BER仿真曲线，其中实线表示S&C算法，虚线表示改进算法。可以看出， 在.SNR小于30dB时，误比特率接近50%,即还原信号基本等同于随机信号， 和发送信号相关度趋近于零。在SNR达到50dB的时候，经典S&C算法误比特 率低于0.01%,而改进算法误比特率在0.1%左右，明显高于经典算法。观察整 体曲线走势，可以看出随着SNR的增加，两种算法的误比特率都是下降趋势， 但是明显经典的S&C算法下降幅度更大。这说明在没有符号间干扰ISI的前提 下，只要SNR相同，改进算法性能就弱于经典的S&C算法。
42
图4-13 BER在不同SNR条件下的变化曲线
下图4-14与上图4-13仿真条件相同，两条曲线描述的是CFO MSE的走势， 可以看出，在SNR为0~80dB的条件下，改进算法的频偏估计准确度都弱于经 典S&C算法。这也印证了上述结论。
图4-14CF0_MSE在不同SNR条件下的变化曲线
除上述曲线外，我们还可以釆用信号星座图的方式来更加直观的展现算法在 还原信号方面的性能。下图4-15是接收信号去掉CP后进行DQPSK之前的仿真 结果：
43
图4-15在不同ISI干扰条件下经典S&C算法和改进算法的星座图
观察上图4-15 a、b,我们可以看出，星座图a的分离度更佳，接收信号点 紧密围绕着星座点周围，距离判决边界有一定距离，在判决过程中发生错误的概 率较低。与之相反，星座图b效果较差，可以看出在没有ISI干扰的条件下，改 进算法的还原信号距离星座点较远，有些点可能已经越过了判决边界，使得判决 结果出现错误。由此可以看出，在CP长度大于多径信道径数，即没有信号间干 扰(Inter-Symbol Interference, ISI)的前提下，经典的S&C算法在信号还原的过 程中，性能表现相比于本文中改进的算法要优秀许多。也就是说，本文改进的算 法不适用于没有ISI干扰的信道环境。然而，在图4-15 c、d中我们可以看出， 图c的星座图中信号点的分布更加不规则，图d的星座点反而要强于图c。不难 看出，虽然引入了较强的ISI干扰,但是图b和图d中星座点受到的影响并不大， 而图a和图c中星座点有了较强的变化。这是由于本文中提出的基于S&C算法
44
的改进频偏估计算法更加适用于具有较强ISI干扰条件的信道环境。这与上文中 推断出的结论相符合。
综上所述，通过对经典S&C算法和改进算法的仿真，我们可以看出改进的 算法更加适用于有符号间干扰ISI的信道环境。
45
