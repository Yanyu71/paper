4.1.2基于插入导频的迭代算法仿真结果分析
OFDM系统中，经典的基于导频的频偏估计算法是一种在频域进行估计的 算法，也就是说这种算法是在信号去掉循环前缀CP,进行FFT变换之后才进行 频偏估计与补偿。这种算法的基础原理是在频域上插入导频序列，用来在接收端 估计频率偏移。迭代算法是在这种算法的基础之上再进行一次频偏估计与补偿, 改善了所得结果。
图4-2 OFDM信号时域模型
在上--节中，我们可以知道接收端接收到的信号是：
*(n) = exp [/(2n -Af -[n +Ng +	+ Ng)] • ?)] [hm(n) * xm(n)] + wm(n)
所以，我们可以得到
ym-M = exp ｛丿｛2n -Af-[n + Ng + (m- 1)(/V + %)] . T)] [hm^n)
* xm_i(n)] + Wm_i(n)
在此，我们暂时不考虑高斯白噪声，那么可以用第m个符号和第m-l个符 号的导频推出频偏的数值应该是：
(P = 2nA/T[n + N_g + m(N + N丿)]—2nA/T[n + N_g + (m- 1)(N + N_g )]
=2efT(N + N _g)
=arctan (I m[Y_(m - 1)A * (k) Y_m (k)])/Re[Y_(m - 1)A * (k) Y_m (k)]
31
上式中，由于发送信号中插入了导频序列，而导频序列原本在各个符号中的 相应位置处是完全相同的复数值，但是由于信道带来的频率偏移，在接收到的信 号处，这一本应该同值同相的导频序列发生了变化。我们则可以利用这一特性对 两个导频序列进行共辗相成，这样就得到了相移。
在此，我们假设频偏数值为0,那么有：
“ _ <P N
J1~2nN + Ng
为了提高对频偏估计值得准确性，我们在信号频域对每个符号都插入多个导 频，形成导频序列。这样通过多次计算取平均的方法，降低估计值与实际值的偏 移。若使用四组导频来计算频偏值，那么估算结果可以如下表示：
Af =(妨 + Af2 + Af3+ #)/4
这样可以大大降低频偏估计值和实际数值的方差，但是估计结果在仿真过程 中依旧不太理想，还有可提升空间。为此我们提出了在插入导频序列算法的前提 下，通过多次迭代来提高算法的准确性。
这里我们通过仿真平台，在信道的多径路数相同、频偏数值相同、CP长度 相同、高斯白噪声相同的情况下，对经典的利用插入导频的方法进行的频偏估计 和本文提出的迭代算法进行了比较。仿真平台中，OFDM符号的子载波一共有 512个，DFT长度是512, 一共设置了 6条多径，高斯白噪声通过信噪比来调节 强弱。每个OFDM符号长度是2000,其中中插入了 4个导频，循环前缀的长度 是8o
这里我们将迭代算法和经典的插入导频进行频偏估计的算法，在相同的仿真 平台下进行了仿真。接收信号在去掉CP后的星座图结果如下图4>3、4V所示, 在相同的SNR=40的条件下，分别在不同的归一化频偏条件下进行了仿真。图 4-3中，归一化的频率偏W = 0.1,偏移量在0.01以内。而在图4-4中归一化 的频偏0 = 0.01,偏移量也是0.01以内。对比图4-3和图4-4中采用相同算法 的仿真图可以看出，较大的多普勒频率偏移会引起更大的误码率，即星座图中点 分布较散。由于星座图内星座点之前的分区相对来说较为明确，我们可以判断, 经典导频算法和迭代算法基本都可以正常的恢复岀原始数据，只是在误比特率上 可能有所不同。
32
图a经典算法星座图
图4-3经典算法和迭代算法仿真结果星座图对比f«FO. 1, SNR=40dB
通过观察4-3中a、b两幅图可以看出，经典算法的星座点比较散，更加偏 离理想的星座点，而迭代算法的星座图点比较密集，这说明通过迭代算法恢复出 来的数据比经典算法恢复岀来的数据偏离量更小，还原的更加准确，误码率更低o 该方针平台中，信道环境是多径信道，模拟了六条路径的情况，加入了 AWGN 信道，即高斯白噪声，信噪比SNR=40dB,此信噪比条件下信号属于高信噪比条 件，实际的还原效果较好。引入了多普勒频偏，归一化后的频偏琨在0.1左右 变化，偏移量在0.01以内。图a、b分别使用经典的插入导频的方法和迭代一次 的方法进行频偏估计，估计出来的频偏值和原始频偏值进行方差计算后，再通过 频偏矩阵补偿到接收信号中。
j♦ 接收僧号
'1^*- JEf *	-
9 W W 整♦•曩獄 » 归 m n “
图a经典算法星座图图
图4-4经典算法和迭代算法仿真结果对比f™<=0. 01, SNR=40dB
上图4-4是在归一化多普勒频偏fnd在0.01左右变化，偏移量小于0.01时仿
33
真所得到的结果。对比图4-4的图a和4-3的图a可以看出，在多普勒整体频偏 数值偏小的结果下，星座图的散点更加集中，还原出的数据更加接近发送数据。 对比图4-3中的a、b我们可以看出，迭代一次的算法得到的信号还原的更加准 确。这一结果和图4-4中得到的结论相符，即使用迭代算法还原的信号更加准确。
在图4-5中，我们仿真了随着归一化频偏琨的变化（0.01-0.1）,直接插入 导频进行频偏估计与补偿的算法和迭代一次进行频偏估计与补偿的算法的误比 特率BER （图a）,和频偏估计值和实际值的方差CFO （图b）。在此之后，我们 又希望得到随着不同信噪比SNR变化，两种算法的实际频偏估计情况，于是仿 真了在SNR由弱到强变化过程中（4dB〜40dB）,两种算法的误比特率BER变化 曲线和频偏方差CFO变化曲线。这两种性能指标可以形象的表达出频偏估计算 法的实际估计性能，作为算法优劣判断的标准。
仿真中我们要把迭代算法和经典的插入频偏的频偏估计算法经行比较。上图
4-5中，我们分别从几个不同角度来判别算法的优劣性，除图中标识出来的变量
外，其他信道环境参数保持一致。仿真平台中，OFDM信号有512个子载波,
34 多径信道的多径路数是6,循环前缀CP的长度是8,插入了 4个导频序列，并 且引入了 AWGN信道高斯白噪声。其中，图4-5 a、b两幅图的横坐标是插入的 频偏环c、d两幅图的横坐标是信噪比SNR。比较的两个参数分别是误比特率 BER和频偏估计均方误差CFO_MSE。其中BER使用下面公式计算得出：
ErrorBit
BER = -_—
TotalBit
上式中，ErrorBit表示发送信号通过信道后，在接收端经过处理后得到的还 原信号和发送信号不同的比特数量0 TotalBit表示所有发送信号的比特数量o BER 用来评价信号还原的准确度，该参数数值越小说明信号还原度越强，效果越好。 与此同时，图中的CFO用下式计算得出：
*=1方。2(。- C/O2(i)]
"MS"—切丽_
其中1=10,传输了 10个OFDM信号做参考，所以有10个估计出来的频偏 量cf。，eft)表示在信道中实际插入的频偏数值。CFO_MSE即频偏估计值和实际 值频偏值的方差，用来衡量频偏估计的准确性。该参数值越小，说明频偏估计值 越准确。
图4-5a中，是在固定SNR=40dB的条件下，通过改变均的大小来比较迭代 算法和经典插入导频的频偏估计算法的BER,其中归一化的频偏4变化范围在 0.01-0.1之间。由于此时信噪比较高，循环前缀CP的长度也足够覆盖掉多径信 道带来的符号间干扰，所以此时频率偏移成为了误比特率上升的主要因素。可以 看出，随着频偏的加大，两种算法得到的误比特率曲线都有所上升，即频偏増大 会引起更高的误比特率。图4-5 a中，实线表示的是迭代算法，虚线是经典算法， 可以看出，虚线在整个曲线周期里都高于实线，也就是迭代算法的误比特率低于 经典的插入导频的算法。所以，信号经过迭代算法补偿还原后得到的序列和发送 序列匹配更加理想。图4-5 b中，是在固定SNR=40dB,频率偏移均不断变化 (0.01-0.1),最终得出的频偏估计方差CFO_MSE的仿真曲线。图中实线表示迭 代算法，曲线表示经典算法。可以看出，迭代算法的频偏估计的方差大多数情况 小于经典算法，也就是说迭代算法一般情况下，频偏估计的表现优于经典的插入 导频的算法。这也从另一方面印证了迭代算法在高信噪比条件下，性能表现是由 于经典算法的。
图4-5c是在固定均后,SNR逐渐变化得到的两种算法的仿真曲线，其中SNR 变化范围是4-40dBo实线表示迭代算法随着SNR变化的BER变化曲线，而虚 线表示的是经典的插入4个导频的算法的BER变化曲线。如图所示，我们可以 看出在SNR较低的情况下，两种算法的BER接近于0.5,即还原得出的序列和
35
发送序列基本没有什么关系，完全是随机信号。随着SNR的增加，传输符号受 到高斯白噪声的影响越来越小，我们可以看出信号的BER在逐渐变小，也就是 说还原得到的接收信号越来越准确，最终在SNR=40dB的时候达到最小值在3.4% 左右。观察两条曲线，可以看出在SNR较低的时候（SNR在4~20dB区间），两 种算法的区分度并不大，分析其原因，可能因为此时高斯白噪声的干扰起到了主 要作用，低信噪比使得频偏估计得出的结果并不重要。与此相反，在SNR较高 的情况下（SNR在25-WdB区间），这时候由于信噪比较高，AWGN信道带来 的高斯白噪声已经不能起到主要作用，频率偏移在信号还原过程中成为了第一阻 碍因素。此时可以明显看出，频偏估计更加准确的迭代算法比经典的插入导频的 算法可以得到更加精准的数据。即在SNR足够高的情况下，迭代的算法比经典 的插入导频的频偏估计算法表现更加岀色。图4-5d中，是在固定均条件下，SNR 有4dB逐渐增加到40dB的CFO_MSE仿真结果。该曲线表示出两种算法在不同 的SNR条件下，频偏估计准确性的表现。其中实现表示迭代算法，虚线表示经 典算法。如图所示，在SNR较小的情况下，此时由于高斯白噪声引起的干扰是 主要影响因素，两种算法基本上无法正确估计出频偏值，此时频偏估计方差接近 于无穷大。然而随着SNR的增大，我们可以看出两种算法的频偏估计方差都有 了不同程度的下降。其中，迭代算法下降曲线的斜率更大速度更快，而虚线代表 的经典算法明显慢于迭代算法。可以看出，伴随着SNR的增大，迭代算法的性 能表现更好。
通过以上仿真分析，我们可以看出：无论是用信号还原的准确度来衡量算法 的优劣，还是用频偏估计的准确度来衡量算法的优劣，迭代算法的性能指标和表 现都优于经典的插入导频的算法。在此由于时间原因，尚未对迭代两次以上的方 法进行公式推导和仿真分析。
