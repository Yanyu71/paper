3.3频率同步算法在LTE下的实现
根据上文对各种频率同步算法的介绍和LTE的帧结构特点，我们分别选取 LTE的主同步序列PSS进行粗同步和小区参考信号RS进行细同步的联合估计实 现其频率同步算法及其仿真。由于在车辆通信的高速环境下，影响LTE同步性 能的主要因素是多普勒频移，因此给出的算法在利用PSS进行粗同步的基础上, 又采用在帧结构中离散分布的参考信号进行了频谱细估计，以适应并跟踪由多普 勒频移引起的时变信道。
对于LTE的主同步序列，由于其由Zadofif-Chu序列组成，具有良好的自相 关性以及循环移位特性，如图3-3所示，良好的互相关性，恒包络，低峰均比， 傅里叶变换后仍未ZC序列等特性，适合在时域利用PSS的相关性对其频率偏移 进行粗估计。
图3-3主同步序列的相关性
24
根据主同步序列的性质，借用P.H.Moose的算法，我们将一帧内的两个PSS 序列做归一化的互相关，根据式（3-3）我们得到LTE一帧内的频率粗估计，我 们将得到的频率粗估计值作为一帧内所有OFDM符号的频率偏移，得到统一的 频偏补偿因子并作初步的补偿；在此基础上，根据LTE无线帧中小区参考信号 的插入方式，如图2-5,以及式（3-5）,在LTE的一个子帧内，做一次频率的细 估计，根据式（3-5）,我们可以得到以下参数：两个含有导频的相邻OFDM符 号间的间隔D为7, OFDM符号中总的子载波数7V为300 （仿真时我们采用的是 5MHz带宽的LTE系统，故在频域上有25个RB）, OFDM符号中两个导频之间 相隔的子载波数M为6, OFDM符号中导频的个数、为50。由于LTE的一个 子帧中有两组这样的参考信号，即第一个时隙和第二个时隙的第一个OFDM符 号以及它们的第五个OFDM符号，因此在计算细估计时我们采取了两种方法， 一种是将一个子帧内的两组估计结果求平均作为整个子帧的频率细估计，另一种 方法是将第一组的结果作为子帧的第一个时隙的频率估计，将第二组的结果作为 子帧的第二个时隙的频率估计。对于我们提出的基于主同步序列和小区参考信号 的频率联合估计算法，我们的仿真结果如图3-4所示：
图3-4 PSS和RS联合频偏估计算法仿真结果
从图中我们不难看出这样的结论：如果我们只利用LTE的主同步序列做粗估 计，其性能仅比不做频率估计的结果好一点点；在频率粗估计的基础上利用小区 参考信号再做一次细估计，索统的性能将显著提高，误码率大大降低；在粗估计 的基础上做频率细估计，采用第二种方法的性能比第一种要好，即将一个子帧内
25
的两组频偏估计结果分别作为一个时隙的频偏结果比将两组的结果做平均得到 的系统性能要好。
以上仿真结果我们是在MATLAB环境中按照3GPP TS36.211 （Release 9版本） 协议规定搭建的LTE下行链路基带系统仿真平台，如图3-5所示。其中数据帧格
图3-5 LTE仿真平台框图
如图3-5,发送端模块主要包括：星座映射模块、层映射和预编码模块、资 源映射模块（含导频插入）、IFFT模块、添加循环前缀模块。接收端包括去循环 前缀模块、FFT模块、信道估计和信道均衡模块、解星座映射模块。整个MATLAB 数据链路详细仿真参数如表3-1所示。
表3-1 LTE下行链路仿真参数
参数名称	　　　　参数取值
系统带宽	　　　　5MHz
子载波间隔	　　　　15kHz
调制方式	　　　　QPSK
子帧长	　　　　　1ms
CP	　　　Normal CP
每个时隙OFDM符号	7
IFFT/FFT	　　　　　512
有效子载波数	　　　　　300
天线模型	　　　　　SISO
仿真数据	1000 帧
仿真时釆用的信道是两径莱斯信道加上多普勒频移，利用matlab自带的 rayleighchan函数，其中一条径为延时为0的直射径，多普勒频移利用九=
C 仿真车速得到。设车速为60km/h。
如图3-6所示是该联合估计算法，即利用主同步序列在一帧内做粗估计的基
26
础上利用参考信号在一个时隙内做细估计，在不同的移动速度下的仿真结果，分 别选取了 60km/h> 120km/h和180km/h三种不同的速度进行仿真，从中我们可 以看出：不同的运动速度会影响算法的性能好坏，随着运动速度的提高，算法的 性能会有所下降。
图3-6不同速度下联合估计算法的性能仿真图
从上面的仿真结果及分析可知，所提出的频偏联合估计算法能够有效提高系 统的性能，并且在车辆通信的高速环境下具有较好的性能。但是由于算法所限， 其所能估计的频偏范围有限，精度不够高，在后续的研究中还需要进一步的完善。
