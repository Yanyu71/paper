3.2.2噪声和稀疏度自适应感知的卡尔曼迭代算法
A.噪声自适应感知的卡尔曼迭代算法
考虑第＞1时刻对应的时间窗内信号的卡尔曼滤波过程(3-3 a)中，根据又t推 出预测状态文；，预测系统噪声为：
v?="A 成	(3-5)
v.可以作为第左时刻估计出的观测噪声。根据观测噪声协方差矩阵定义:
r, = E[n,-nA.T]
利用前左_ 1帧预测的噪声对本帧的噪声协方差进行如下估计:
(3-7)
若噪声变化缓慢，A取较大值时，C*将以很大概率收敛于观测噪声的协方 差矩阵，即：
(3-8)
将(3-5)带入(3-8)可得:
(3-9)
易得
根据【26］中的卡尔曼滤波器可知
(3-11)
将(3-6) (3-11)代入(3-10)得:
即:
(3-12)
至此，(3-12)式给出了观测噪声的迭代估计表达式，接下来推导系统噪声估 计表达式。根据(3-2X3-4)式有：
板
q「=e[W]
(3-13)
卡尔曼滤波过程中无法精确直接得到歸，只能通过其估计值&来估计Q,得 到Q,这里定义为：
人—	A	—	A
^ = Xk-@Xk_}=Xk-Xk
Q=旦虹?引
(3-14)
回到(3-9)式,结合(3-3 d)有:
RS-A" (yt-AtXi)TK； K*C..K； =E[(Xt-X；)(Xt -X；)T] = Qt
k,c,.k；=E
X*?Xj+K(n-A*Xj)
=
至此得到了 Q的估计Q:
Q*=KA.K；
(3-15)
这里估计的Q是非对角阵，而【26】己经通过仿真验证了将系统噪声视为独立 同分布零均值高斯随机变量的集合，也就是Q取对角阵能得到更好的收敛效果, 实际上本文通过仿真也验证了Q取对角阵时收敛效果更好。这里对得到的Q进 行近似对角化处理，只留下Q主对角线上的元素，求出主对角线元素的均值，该 均值视为系统噪声的方差令：
食	0)
Q =
、°	尻
至此，(3-12)(3-13)式分别给出了 I；, Q的估计表达式；(3-3)式给出了卡尔 曼滤波步骤；(3-1)(3-2)式给出了状态转移方程和观测方程。这五个式子组合起来就可在未知噪声协方差的情况下获得基于噪声和稀疏度自适应感知的卡尔曼迭 代算法NAKF,描述如下：
算法 3-2:NAKF
输入：=0,1,2...
初始化：k = 1,随机选取X0,Q0,I^,S0 = 0
预测文；
X =做一「
预测k* , *,噪声协方差阵Qk, rk
K*=P*"A/ + f\J ；
q  	 K C K^t -主对角线元素取均值
k2	0，
Q =
、°	朮
更新文后耳
Xk=Xk+Kk（yk-AkX；）-,
X,=supp（XJ^;
P,=（I-K,AjP,
=左十1.回至U步骤1
说明：supp（文Qk表示将文*的频谱按模值大小降序排序，取前K个值对应下
标位置的集合。
B.稀疏度自适应感知的动态调整策略
注意到NAKF算法仍然需要已知稀疏度K,下面给出稀疏度K的自适应估 计算法。
假设稀疏信号的稀疏度K满足K < N/2?, NAKF算法在卡尔曼滤波中每次只取能量排在前K的项，将其它频谱位置值置零。假定给定初始的K = N/2, 只要通过迭代过程逐步自适应调整K,使其收敛到真实的稀疏度即可。
设置初始值K = N/2 ,也就是将从卡尔曼迭代方法得到的N点频谱按能量降 序排序，取前K个位置作为预测有信号的频域支撑集，记为集合将剩余的N-K 个位置记为集合館，将集合禺中的频域位置频谱置零，该过程为频域截断。由于 系统噪声豢近为零均值高斯白噪声，在AWGN信道条件下的观测噪声则是标 准的高斯白噪声。从频域观测，没有信号的频点只存在噪声，这些噪声的幅值将 随着时间窗的滑动而在较大的范围内波动。如果观测的时间窗够小，流信号的频 谱支撑集变化会很缓慢，有信号的频点对应幅值会稳定地以较大幅度大于频域噪 声幅值的均值常数倍，为了减小噪声由于误差而落入§的概率，该常数系数取值 需大于1,实际仿真中取了两倍或多倍。这样，在某一帧内频谱截断时有信号的 频点位置以接近1的概率落入集合S,,记该概率为〃 T1;而只有噪声的频点落 入集合S。的概率较小，记为若从单个时间帧分析来确定信号支撑集的位置显 然误差将极大，因为只有噪声的位置有一定概率被错认为是有信号的位置，因此 联合考虑多个时间帧的支撑集来解决问题，某只有噪声的频域位置直落入§的 概率将以指数形式衰减，而有信号的位置在若干次中均落入S,的概率依然较大。 连续考察N。个时间帧，那么某个只有噪声的频域位置N。次截断中均落入§的概 率为：
pe =脊 依概率’他合适> 0	(3-16)
而某…直存在信号的频域点在N °次截断中均落入集合月的概率为：
P? = E > Pn >()5》P,	(3-17)
记
p,=X(l</《N)	(3-18)
n,表示第/个频点在N。个连续时间帧中判决落入集合§的次数。
设定合适门限，门限以上的频域位置可认为极有可能存在信号，若该频率位 置尚未加入到支撑集§则将其加入§；门限以下的则视为噪声，若门限以下对应 的频率位置已存在于§中则从§中剔除。
设定接近0.5的合适的门限久,，令：
§ = suppQ>q)	(3-19)
(3-19)式提供了支撑集随着时间帧的滑动动态更新的方法。由于相邻的若干 时间窗内频域噪声分布的随机性和信号分布的相对稳定性，通过若干次的迭代& 将以很大概率收敛到真实的支撑集。收敛时§集合中元素个数即稀疏度K。将该 稀疏度自适应的方法结合NAKF算法使用即可在未知稀疏度和未知噪声的情况 下重构出原始信号，详见如下的SEBP算法。
算法 3-3:SEBP
输入：y)t+i，A)t+1,0,^ = O,l,2...
初始化：k = 1,随机选取Xo,Qo,I^,So=0
k = N2,NMh
while(k < No)
根据K = N/2执行NAKF算法；
k = Zr + 1 .
根据第k-N0+\次到第4次恢复结果预测支撑集S'
根据更新的k执行NAKF算法；
0=箫(1眾《叫
S = supp(孔 > pth);
K = length(S).
k = k + 返回步骤2。
说明：length^)表示计算集合§中元素个数。
C.仿真结果及分析
仿真实验模拟了频域稀疏的宽带流信号，在总共N个子带宽内随机选取K 个产生随机幅度的正弦或余弦信号，叠加后作为模拟的信源信号。基于AIC采 样结构进行数据压缩采样，下采样率取R ,单个窗口的观测维度取M=N/R,对 应奈奎斯特速率窗长度为N。文献〔18】已证明了 AKF算法与OMP算法、SGP等 算法相比，有抗噪声性能好，在高下采样率R、低观测维度M下仍能工作的优点。 本文在AKF的基础上，在相同实验条件下比较AKF、OMP、理想卡尔曼滤波和 本文提出的NAKF、SEBP算法的性能。
仿真中信源稀疏度为K = 10,为保证频率分辨率不变，固定N=500o所有 仿真结果是1000次仿真结果的平均值。定义第上帧重构信号的相对误差指标为：
其中，X*为第上帧的真实频谱，而X是采用某种算法重构出的频谱。定义 信噪比SNR为每一帧内信号与噪声功率的比值，改变信噪比SNR = 10dB , 5dB , 在不同的R、M组合下分别对各种算法的性能进行比较。
仿真结果如图3-1所示。其中，OMP对应曲线为已知稀疏度K,釆用逐帧正 曼滤波恢复效果。AKF曲线是文献㈣中釆用的自适应卡尔曼滤波方法重构 效果，该算法前提是己知稀疏度K和噪声协方差矩阵。NAKF曲线是未知噪声协 方差阵时的恢复效果，SEBP曲线是本文提出的未知噪声协方差阵和稀疏度K时 的恢复收敛效果。
R=5,M=100,SNR=10dB
OMP -*-ldeal-KF -AKF +NAKF 令 SEBP
41
800
600
s
200
R=10,M=50,SNR=10dB
LIJWIAI
OMP
-Ideal-KF
AKF
NAKF -SEBP
(b)
R=20,M=25,SNR=10dB
2.5
2
山0)切
0.5
200	400 ,	600
800
1000
(c)
R=20,M=25,SNR=5dB
0	200	400	600	800	1000
(d)
图3-1 NAKF、SEBP算法与相关算法性能比较
从图3-l(a)可看出，在R=5,M=100的条件下，由于下采样率较低，且在信 噪比条件较好(10dB)时，OMP和AKF均能较好较快地收敛到理想卡尔曼滤波 效果，而NAKF算法由于需要通过迭代来感知噪声，因此收敛较慢，但最终收敛 效果也很好。SEBP算法需要自适应感知噪声协方差和稀疏度，收敛速度稍慢, 但好于NAKF算法，其原因是NAKF在算法开始阶段就按照给定的稀疏度K滤 除了大量的认为是噪声的部分，但由于未知噪声协方差矩阵，卡尔曼迭代滤波初 始阶段支撑集感知有很大的误差，迅速大量滤除大量噪声的方法并不是最优的， 逐步降低预测的稀疏度并最终收敛到真实的稀疏度更为合适，这正是SEBP算法 的做法。因此在高信噪比条件下，SEBP算法虽然未知稀疏度，却能获得比NAKF 更好效果。
保持信噪比10dB不变，提高下釆样率R到10、20,分别如图3-1(b), 3-1(c) 所示。R的提高使得OMP和AKF算法均失效，无法收敛到较低的误差范围内。 而NAKF和SEBP算法仍能收敛到接近理想卡尔曼滤波的结果。原因是OMP算 法在每一帧内单独恢复信号，当下采样率很大时，逐帧恢复的测量点数较少，重 构的精度自然急剧下降。而AKF失效则是因为将噪声协方差矩阵视为固定不变, 在下采样率r较低的情况下还能重构信号，但R提高到一定程度则该算法失效。 可见与AKF相比，NAKF和SEBP可以进一步降低采样率。
将信噪比进一步下降到5dB,且提高R到25,恢复效果如图3-l(d)所示。该 图证明了在较低信噪比条件和大压缩比例条件下，NAKF和SEBP仍能很好工 作。在苛刻的条件下,SEBP要在噪声未知的情况下准确估计稀疏度的难度增大， 这使得SEBP与NAKF的恢复性能几乎无差异，二者的收敛效果远好于OMP和 AKF算法。这证明了本文提出的NAKF和SEBP在抗噪声性能方面有一定的优势。
D.自适应算法总结
本部分在［26】提出的稀疏流信号的卡尔曼滤波重构算法基础上，分析了其存 在的问题并提出了解决方案。提出噪声自适应估计和稀疏度自适应动态调整的压 缩感知算法。与AKF、OMP等算法比有以下优点：在未知系统噪声和观测噪声 时自适应估计其协方差矩阵；未知信号稀疏度的先验知识条件下动态估计感知稀 疏度；重构效果较好逼近了理想的卡尔曼滤波结果，且拥有较好抗噪声性能，在 高压缩采样率和低信噪比下仍能较好工作；SEBP与NAKF算法通过状态转移来 预测和纠正输出重构信号，算法复杂度较低。但SEBP和NAKF均存在收敛速度 较慢的问题，如何加快收敛速度是未来研究的要点。
