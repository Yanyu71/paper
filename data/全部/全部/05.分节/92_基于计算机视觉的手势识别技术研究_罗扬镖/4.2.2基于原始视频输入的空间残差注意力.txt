4.2.2基于原始视频输入的空间残差注意力
注意力机制并不属于一种具体的机器学习算法，而是属于一种算法思维或者 方法论，它没有严格的数学公式定义。基于深度学习的注意力机制用于表征神经 网络对于输入数据特定位置的信息关注，在手势识别应用中则表现为对手部及其 手势图像帧的关注。本章针对手势识别应用中的时空注意力模型进行改进，在基 于时空多尺度特征融合模型的基础上提出将时空注意力机制放置于手势视频输 入侧用于提取原始视频中手势的关键信息，并将注意力加权处理过的手势视频送 入下一级的时空多尺度融合分类器中进行识别，其流程如图4-1所示
图4-1基于时空注意力机制前置的手势识别
空间注意力机制结构设计：在二维图像领域，空间注意力是最早应用的注意 力模型，具有最广泛的使用场景，在图片描述任务中，Kelvin Xu等人将空间注 意力机制应用于二维图像上［殉，定位图片中实体的空间位置，以方便机器模型描 述实体间的位置关系。空间注意力机制常使用普通的卷积神经网络作为其注意力 结构模型，Fei Wang等人于2017年提出了其二维图像领域中的残差注意力模型 结构国】，论文指出传统的注意力机制方法可能导致机器学习的特征遭到实质性 的破坏，例如已学习到的图像特征在经过与注意力权重矩阵相乘后导致特征效果 变差，机器学习特征提取将严重依赖注意力神经网络结构的稳定性。二维残差注 意力网络结构如图4-2所示，其包含两条特征提取支路，主路完成对图像特征的 提取，例如内置的卷积神经网络、Inception®】、ResNeXt®】等神经网络结构。辅
下采样
图4-2残差注意力网络
助支路为注意力权值计算模块，采用U形网络结构先将二维图像空间特征压缩， 提取到深层次的图像特征后再对其进行扩张，得到与主路特征图大小相同的注意 力权值矩阵，再与主路特征图进行像素级相乘得到网络的注意力特征，通过残差 结构与主路的特征图相加获得残差注意力特征，其计算公式如式4-1所示。其中， H(x)为残差注意力网络的图像特征结果，M&)是与主路特征图大小相同的注意力 权值矩阵，F&)为主路提取的二维图像特征，X代表二维特征图的像素值。7和c 分别代表了图像所具有的空间及通道维度。该残差短接的注意力方法避免了注意 力模型训练前期的不稳定因素对模型造成严重影响，保证了主路特征提取的可靠。
H.c(x) = (l+M.c(x))^F.c(x)	(4-1)
在二维残差注意力神经网络结构的基础上，本章设计了用于视频数据处理的 空间维度注意力结构，用于对视频中的每一帧进行独立的数据处理，实现手势视 频的空间关注。用于手势视频数据处理的空间维度注意力结构如图4-3所示，将 视频数据在时序维度上展开，形成连续帧图像组成的手势序列，利用残差注意力 网络对每一帧图像进行并行化处理，上支路表示残差注意力网络结构中注意力权 值矩阵的计算，采用U型网络结构。在获得图像序列的空间注意力权重之后使 用S型激活函数将输出限制在［0,1］区间，保证了注意力权值矩阵的物理意义。 最后通过重塑函数将图像序列重塑为三维视频结构，与下支路短接的原始视频输 入相加，得到本章空间注意力模块处理的视频数据。
池化	池化	上采样	上采糕
输入一~ »肖莖块一* 一＞盛差统：〉一＞ 我墓块一務誉块一＞〈►喪着块’”早一辛一》输出
图4-3手势;a频数据处理的空间维度注意力网络
本章基于时空多尺度特征融合网络的空间维度注意力数据处理应用于0均 值规范化后的手势视频，代替手势识别中的手部检测流程，而将手势的时空特征 提取交给更擅长的手势时空多尺度特征融合网络。其中，空间维度注意力网络的 残差块设计为二维残差卷积神经网络结构，其结构如图4-4所示。
图4-4空间维度注意力网络残差块结构设计
其中，图中的in和out分别代表了残差块整体结构的输入通道数和输出通 道数，使用该通道数作为其内部二维卷积网络的卷积核数目，以此来改变卷积块 的输出通道数。其内部的三个卷积网络分别设置了 1x1, 3x3和1x1的卷积核大 小，其步长均设置为1。另外，在残差网络结构中若短接支路与残差块最后输出 的通道数不一致，将使用1x1的卷积核改变其短接支路的输出通道以匹配特征 提取支路输出。本章空间维度注意力网络中的前4个残差块输出通道数设置为 64,最后一个残差块的输出通道数设计为3以匹配视频短接支路的输出。
