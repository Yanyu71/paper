2.1.2功率时延分布基本概念
CSI (channel state information)
PDP (power delay profile)
图2-1频域上的CSI可以通过IFFT转化为时域上的PDP
如图2-1所示，时域上的PDP由频域CSI通过逆傅里叶变换(Inverse Fast
Fourier Transform, IFFT)计算得到。CSI 对应的 PDP 为：
h(t) = Sn=l 一 Tn)，	(2-3)
其中，§(•)为狄克拉脉冲函数。由于无线信号的多径效应，Wi-Fi信号由发送端到 接收端会在时间域上产生色散，也就是Wi-Fi信号经过不同的路径传播后，到达 信号接收端所需要的时间会产生差异。PDP表征了无线信号在时间域上的色散， 使得我们能够使用PDP描述多径信道特征，因此PDP在基于Wi-Fi的行为感知 领域同样得到了广泛的应用⑷】。在室内多路径环境中，具有更高时间分辨率的 PDP可以更准确地检测到目标的行为变化。在IFFT中，时间分辨率定义为：
AT = ¥，	(2-4)
其中，公为时间序列的窗口长度，N为IFFT中使用的数据点数。AT值越小，时间 分辨率越高。样本频率可以表示为t43][44]：
=寻	(2-5)
通过公式(2-2)、(2-4)、(2-5),可以推出:
(2-6)
图2-2利用CSI得到的PDP的时间分辨率是由信号的带宽决定的
由公式(2-6)可以得到，由CSI计算得到的PDP的时间分辨率是由Wi-Fi信 号的带宽决定的。如图2-2所示，显而易见，更大的带宽带来更高的PDP分辨 率，这更容易消除由微小活动引起的细微的多径信道变化。因此，大信道带宽对 于细粒度Wi-Fi行为感知应用至关重要。然而，一方面，在Wi-Fi网络传输系统 中，单个信道的带宽只有20MHz或者40MHz,这限制了系统的感知性能；但另 一方面，Wi-Fi信号的总带宽是足够大的，因此可以通过快速切换多个信道，在 很短的时间间隔内从多个相邻的Wi-Fi信道获得CSI,然后通过汇聚这些信道的 CSI,将Wi-Fi信号带宽扩展为这些相邻信道的所有带宽。
图2-3利用信道切换和信道聚合，扩展Wi-Fi信号的有效带宽
如图2-3所示，随着信号带宽的扩大，Wi-Fi信号的分辨率也会相应地变高。 因此，本文设计了一个用于Wi-Fi行为感知技术的感知分辨率提升机制，通过多 信道快速切换及聚合算法，把Wi-Fi信道的带宽扩展为可切换信道的全部带宽, 提高Wi-Fi信号分辨率，提升行为感知系统的感知精度。
10
由公式(2-1)所示，原始CSI数据包含幅度信息和相位信息。Wi-Fi环境中 目标的行为变化改变了无线信道的多径特性，这些变化能够体现在CSI的幅度 和相位上。因此，CSI幅度和相位可以用于提取与目标行为相关的特征。
图2-4 CSI幅度受目标行为的影响：(a)静态环境，(b)目标产生某种行为。可以使用
CSI幅度的方差来检测某个行为的开始和结束
如图2-4 (a)所示，当环境是静态时，CSI幅度接近于一条平稳的直线；如 同2-4 (b)所示，当Wi-Fi环境中，目标行为发生变化时，CSI幅度随着行为变 化产生相应的震荡曲线，能够根据曲线的波动过程推断某个行为的开始和结束。 正因CSI幅度曲线与Wi-Fi环境紧紧关联，常用CSI幅度来表征目标行为变化。 常见的方法是计算出CSI幅度的不同阈值，如方差、平均绝对偏差(MeanAbsolute Deviation,MAD).有限差分等，用来确定目标的状态。这种基于阈值的方法广泛 应用于基于Wi-Fi的行为感知【切〔46］。
如图2-5所示，与可以直接使用的CSI原始幅度数据不同，商用Wi-Fi设备 获得的原始相位分布随机。在真实的Wi-Fi系统中。接收的相位信息经常因为误 差源(如硬件和软件错误)产生一些噪音。
根据文献[47][48],计算出CSI第i个子载波的相位值&^为：
ZCSIt = ZCSk + 2nTs+ 27Tt + y + n, (2-7)
其中，NTS/j为第i个子载波的真实相位值，心和几分别是OFDM符号的总长度 的和数据符号的长度，△/■是载波频率偏移(Carrier Frequency Ofifset,CFO), «是 由公式(2-8)计算得到的采样频率偏移(Sampling Frequency Offset, SFO),『和 厂分别是发射端和接收端的采样时间，％是时域样本中的时间偏移，N为IFFT中 所使用的数据点个数，y为锁相环(Phase Locked Loops, PLL)中的振荡器相位偏 移，为接收端的加性高斯白噪声(Additive White Gaussian Noise, AWGN )。
2^1 (2-8)
s T
Wi-Fi网卡的三个天线具有相同的载波和采样时钟频率偏移、采样时钟时间 偏移[48〕。因此，第i个子载波的相位差可近似表示为：
LZCSI, = L^CSIt + Ay + An,	(2-9)
其中，3是常数相移的差，如是高斯噪声。根据文献[48], Ay是同一个网卡的天 线之间的时间常量，它不会因为目标行为改变CSI相位信息。与CSI相位相比， 去掉CFO、SFO和时间偏移后的相位差更加稳定。由图2-5 (a)可知，当空间环 境是静态时，相位差在静态环境中保持在一个稳定的水平；由图2-5 (b)可知， 当环境中有目标活动时，相位差就会出现波动。因此，可以通过相位差来校准原 始相位，验证了本文的推导。
Raw phases	Phase diHitetices
图2-6 极坐标中的CSI相位和相位差
12
图2-6在极坐标中绘制了原始CSI值，其中包含幅度，相位和相位差信息。 可以看出，相位分布在0。到360。之间，相位差分布在65。到90。之间。相比原始相 位，得到了校准后的相位差分布更为集中。
图2-7信号传播的额外距离可以由AoA计算得到
在本文的实验中，两个相邻天线之间的距离设为入/2,其中入是Wi-Fi信号波 长。令$为第i个子载波的AoA,表示第i个子载波信号到达天线时的角度。如图 2-7所示，到达第一个天线与到达第二个天线相比，Wi-Fi信号传播了额外的一 段距离，该距离差Ad：可以近似为：
入
Adf =		—
2 cos 0i
这段距离差Ad：会引起一个相位差：
— 2nAdi
A
可以计算出第i个子载波的AoA值：
Bi = cos-1
7T
多个子载波的AoA值包含了多径信道中信号的丰富信息，既包括环境中静 态路径的信息，也包括目标行为变化引起的信息。虽然CSI的相位受到多个误差 源的影响，但是相位差相对稳定，因此本文利用相位差得到的AoA值来准确区 分包括目标位置在内的相关信息。
