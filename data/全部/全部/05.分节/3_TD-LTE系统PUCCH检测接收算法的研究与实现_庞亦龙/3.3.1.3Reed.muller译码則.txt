3.3.1.3Reed.muller译码則
信道质量指示CS1采用的是（20, A） Reed-Muller编码方式，相当于不完全的（32, A） Reed-Muller编码方式，这里A的长度由CSI的比特数确定，和CSI的比特数一致。 编码基序列由表3-6给出，从编码基序列可以看出，表的第一列是一个全1序列，而表 的第二列到第六列是长度为32的Walsh码一部分，由长度为32的Walsh码打掉12个 比特形成，表剩余的七列是7个基本的掩码序列。
表3-6 Reed-muller编码基序列
i	ML
0	Mi,!	Mi.2	Mi3	Mi,4	Mi,5	Mi,6	Mi,7	Mi.8	Mi.9	MiJO	Mi. 11	Mi,12
0	　1	　1	　0	　0	0	0	0	　0	　0	　0	1	1	　　0
1	　1	　1	　1	　0	0	0	0	　0	　0	1	1	　　1	　　0
2	　1	　0	　0	　1	0	　0	1	　0	1	　1	1	　　1	　　1
3	　1	　0	　1	　1	0	　0	0	　0	　1	0	1	　　1	　　1
4	　1	　1	　1	　1	0	　0	0	　1	0	0	1	　　1	　　1
5	　1	　1	　0	　0	1	　0	1	　1	　1	0	1	　　1	　　1
6	　1	　0	　1	　0	　1	　0	1	　0	　1	　1	1	　　1	　　1
7	　1	　0	　0	　1	1	　0	0	　I	　1	0	1	　　1	　　1
28
表3-6 Reed-muller编码基序列(续上表)
i	Mi,
0	Mi.l	Mi.2	Mi.3	Mi,4	Mi.5	Mi,6	Mi.7	Mi,8	Mi,9	MiJO	MiJl	Mi,12
8	　1	　1	　0	　1	　1	0	0	　1	0	1	1	1	　　1
9	　1	　0	　1	　1	　1	0	1	　0	　0	1	1	1	　　1
10	　1	　0	　1	　0	0	1	1	　1	　0	1	1	　　1	　　1
11	　1	　1	　1	　0	　0	1	1	　0	　1	0	1	　　1	　　1
12	　1	　0	　0	　1	0	1	0	　1	　1	1	1	　　1	　　1
13	　1	　1	　0	　1	0	1	0	　1	　0	1	1	　　1	　　1
14	　1	　0	　0	　0	　1	I	0	　1	0	0	1	　　0	　　1
15	　1	　1	　0	　0	1	i	1	　1	　0	1	1	　　0	　　1
16	　1	　1	　1	　0	　1	1	1	　0	　0	1	0	　　1	　　1
17	　1	　0	　0	　1	　1	1	0	　0	　1	0	0	　　1	　　1
18	　1	　1	　0	　1	　1	1	1	　1	　0	0	0	　　0	　　0
19	　1	　0	　0	　0	　0	1	1	　0	　0	0	0	　　0	　　0
要进行FHT输入的序列必须是2的幕，而(20,13) RM译码器的输入为长度20的 双极性序列，所以在交织处理之前，先将长度扩展到32,即在序列高位添加12个0；
译码输入比特由bob|b2b3---b|7bi8bi9扩展为棚1)山2毎"七2购(^31，后12位为0。
Reed-muller译码的算法步骤如图3-10所示：
图3-10 Reed-muller译码步骤
1)经过软判决之后软比特信息要进行交织处理，输入码子高位添加12个0,使得 长度变为32。编码矩阵M,是在(32,11) RM编码序列的基础上，打掉一部分比特， 然后对处理后的序列增加两列掩码序列所构成。扩展为32位之后，将输入码字进行与
(32,11)相同的交织处理，即将输入码字的顺序由bOb1b2b3...b29b3ob3l变换为b3ibob2O b| b2 bii bj 64 622 bs b& b?3 b? bg by b?4 bi9 b?5 bio bn b】2 如 b26 坛 b. b?8 b” b〕7 也8 b?9 b3° 同时 也对掩码序列进行交织处理。
2)消除掩码影响处理，7个掩码序列的线性组合可以产生27=128个掩码矢量，每 个掩码矢量的长度都是32,这些掩码矢量分别与接收码字相乘后(交织处理后的码字与 交织后的掩码矢量分别相乘)，其中一个掩码矢量与发送组合相同，从而消除了掩码部 分的影响，只剩余M1-M5对编码序列的影响。
3)M,-M5编码序列都是Walsh码，这些序列的32种组合正好是哈达玛矩阵的行向 量，可以利用IFHT来求相关值，得到128*32的相关值矩阵。
以8阶沃尔什一哈达玛变换为例，其快速算法快速哈达玛变换(FHT)及逆快速哈 达玛变换的蝶形图如图3-11所示：
29
图3-11 8阶IFHT与FHT蝶形图
4)搜索相关矩阵中的绝对值最大数，其行号就对应为bitl-bit7,列号对应bit8-bitl2o
5)bitO则根据绝对值最大数的符号来确定，正号则译为0;负号译为1。
设计(20, A)译码器是需要用到3个矩阵，一个矩阵存储128个掩码矢量，为128*32 矩阵，一个存储快速哈达玛变换之后的输出矩阵为32*32矩阵，一个为快速哈达玛变换 之后取绝对值的矩阵，同为32*32矩阵。
PUCCH格式2/2a/2b的13位CSI的Reed-muller译码结构可以由图3-12表示：
根据符号确定
