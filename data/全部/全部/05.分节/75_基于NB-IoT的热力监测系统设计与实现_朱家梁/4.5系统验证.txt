4.5系统验证
基于NB-IoT的热力监测系统的验证原型分为一下几个部分：第一部分为 NB-IoT设备的低功耗验证，即基于DPM的低功耗解决方案效果验证；第二部分 为NB-IoT设备消息重传机制验证，该部分包括在嵌入式端的消息重传机制以及 系统服务端的命令下行，通过定义事件要求NB-IoT客户端设备重传消息；第三 部分为服务端对消息处理效果的验证，仿真模拟服务端接收到大量来自NB-IoT 客户端发送的消息，主要从系统平均响应时间以及服务端I/O的吞吐量这两个方 面对服务端的消息处理效果进行有效验证。
4.5.1	设■功耗ME
按照4.3章节的基于动态电源调节技术的低功耗方案描述，将其应用到现行 的硬件系统当中，经过实验测定，该低功耗方案在实际工作中的电流如表4-1所 Z]\ O
表4-1基于动态电源调节技术的低功耗方案电流表
工作状态	电流大小i/mA	持续时间Vs	备注
配置阶段	15-20	20	每次通电只需要经历 一次即一直工作
NB-IoT模组正常工 作并且发送数据	130-140	5	监测到硬件系统的异 常震动，唤醒MCU及 NB-IoT模组，调用通 信进程发送数据
发送完毕后MCU进 入停止模式，NB-IoT 模组进入IDLE状态	43-45	10	数据发送完毕之后，通 信进程进入IDLE状态
系统全部进入低功耗 状态	0.32		全部模块处于休眠或 低功耗模式
按照上表中呈现的实际数据，可以计算在应用基于动态电源管理的低功耗算 法后，该物联网终端设备的实际功耗情况。一般情形下物联网终端设备是没有异 常震动报警信息产生的，多数情况下处于低功耗状态，供暖期每隔2h发送一次 数据确认状态，非供暖期每隔一天发送一次数据确认状态，设备功耗的计算过程 如下：
48
P（设备常态）=0.32ma*24*60*60s=7.68ma - h
P（发送数据周期）=135ma*5s+44ma*10s*=0.310ma • h
P（供暖期一天尸7.68ma • h+0.310ma , h*12=11.40ma , h
P（非供暖期一天）=7.68ma • h +0.310ma=7.99ma • h
PL年尸7.99ma , h*243d+l 1.40ma , h * 122d=3332.37ma , h
根据上述计算，理论上该装置一年的耗电量在3332毫安时左右。同应用基 于状态的低功耗算法之前相比，可以有效降低系统功耗达到35%。实验使用的电 池组电量为12000毫安时，经计算该装置可有效工作3年以上。
