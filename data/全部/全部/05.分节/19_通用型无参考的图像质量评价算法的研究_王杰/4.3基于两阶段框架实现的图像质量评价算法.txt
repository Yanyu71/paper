4.3基于两阶段框架实现的图像质量评价算法
由以上分析可知，精心设计、提取的Contourlet域提取的自然图像特征能有 效的表征图像失真程度。但是我们不能保证，对于每一种失真类型，特征对应失 真程度的变化完全一致。因此，我们改进基于MVG模型的全局框架算法，釆取 折中的两层框架方法。首先通过提取的特征向量，对图像失真类型进行分类，判 断其属于每一种失真的程度。在进行失真分类时，釆用了使用径向基核函数
(Radial Basis Function ,RBF)的v-SVM[31]分类器。然后计算每种失真类型的评 价分值，最后加权得到图像的质量评价分值。用概率p来表示每种失真类型的失 真程度，这里我们只考虑五种失真类型：白噪声失真、高斯模糊失真、JPEG2000 压缩失真、JPEG压缩失真、FF失真。对于每一种失真，釆用v-SVR学习特征 到质量的投影关系，然后利用v-SVR"回归模型预测相应的每种失真类型的评 价分值。算法的计算公式如下：
Q=£p*qi	(4-3)
其中i=l,2,...5表示五种失真类型的下标，&和％分别代表不同失真类型的 占比和分值。
49
算法的框架图如图4-5所示。
图4-5基于两阶段框架的Contouriet域NR-IQA算法
算法流程如下：
1、	首先对图像进行Contouriet变换，按照第三章中的方法提取图 像自然场景统计特征。
2、	使用选取的特征利用多分类SVM分类器（SVM算法只能进行二 分类，多个二分类SVM分类器基于投票可以实现多分类），对图像进行分 类，得到图像属于各种失真类型的概率。需要特别指出的是，对于选定的训 练图像集和测试图像集，该算法虽然通过一个分类器将图像分为5种失真类 型。但我们并不是认为各个失真类型是相互独立的，相反的是，我们认为这 些类别都一定程度上相互覆盖。比如说，JPEG压缩失真除了块状失真外， 也表现了一定程度上的模糊失真。因此，我们的目标并不是严格的将图像划 分为某种类型，而是表明某种失真类型在图像中所占的程度。某种失真类型 的程度越高，则由SVM分类器给出的概率值越高。该算法中，我们釆用由 径向基核函数（RBF）构成的多分类SVM得到一幅图像属于各个失真类型 的比例。在训练集上通过训练我们得到SVM分类器的两个参数（C,r）印】， 训练过程中釆取5-折交叉验证法。
3、	通过第二步训练出来的SVM分类器，我们可以将一幅图像划分 到所属的失真类型。接着，我们再次利用之前提取的特征向量来计算图像在 该种失真类型下的质量评价分值。我们利用libsvm工具包中的支持向量回归 器（SVR）进行回归。对每一种失真类型，我们通过学习特征向量到图像质 量分值之间的映射关系学习到相应的SVRo当给定一张待评测的失真图像 时，失真类型相对应的SVR根据特征向量给岀相应的质量评价分值。只要
50
属于训练集中的失真类型，都可以得到该失真类型下的质量评价分值。每一 个SVR,我们通过参数（C,r,v）决定。和第二步中的学习SVM的方法相同, 对（C, r）我们釆取5-折交叉验证法。而v釆取默认值0.5,因为v值的改 变对结果改变不大。
4、	利用公式4-3对步骤二和步骤三的结果分别进行相乘最后加和， 得到图像最后的质量评价分值。
这样，我们得到了一个基于Contourlet域的自然图像统计特性的两阶段框架 下的通用型无参考图像质量评价方法。通过在LIVE数据库上进行测试，对图像 分类的正确率为84.3652% （均值为84.3652%,方差为2.9804%）。我们选取了 一种通常用于对照的全参考算法：PSNR,几种比较的先进无参考算法：BIQI、 BRISQUE与本文提出的算法进行了性能比较。利用基于两阶段框架算法进行仿 真实验，以各个失真类型下的客观质量评价分值为横坐标，以实验库中相应图像 的DM0S值作为纵坐标，做出散点图并进行拟合的曲线结果如图4-6所示，图 中的拟合曲线是在PLCC取中位值时的测试结果。需要特别指出的是，ALL类 型是由JPEG2000、JPEG、WN、Gblur、FF五种类型的失真图像组合成的，可 以检验算法对各种类型失真图像质量评价的综合性能，后文中直接使用。
⑴All
图4-6两阶段框架客观质量评价分值与主观DMOS值对比的散点图
表44 4-5和表4-6分别给出了 RMSE、PLCC和SROCC的仿真结果，表 中分别列出了五种失真类型分别单独作用下的仿真结果，以及包含所有失真类型 的整体性能参数。
表4V RMSE均方根误差
JP2K	JPEG	NOISE	BLUR	FF	ALL
PNSR	8.2834	9.8265	3.2476	10.0246	8.1582	10.2831
BIQI	13,8621	17.2308	5.4573	9.5932	17.3543	16.3227
BRISQUE	9.1386	10.2791	3.8152	8.2106	9.5738	8.9632
Proposed	7.5205	10.0326	4.7935	4.6833	10.2451	8.8401
表4-5 Pearson线性相关系数（PLCC ）
JP2K	JPEG	NOISE	BLUR	FF	ALL
PNSR	0.8265	0.8617	0.9548	0.7724	0.8479	0.8242
BIQI	0.8642	0.7571	0.9536	0.8925	0.7345	0.7826
BRISQUE	0.9394	0.9255	0.9674	0.9596	0.9021	0.9271
Proposed	0.9281	0.9017	0.9133	0.9689	0.8932	0.9022
表4-6 Spearman等级相关系数（SROCC ）
JP2K	JPEG	NOISE	BLUR	FF	ALL
PNSR	0.8796	0.8563	0.9676	0.8174	0.8865	0.8178
BIQI	0.8415	0.7814	0.9721	0.9284	0.7561	0.7740
BRISQUE	0.9367	0.9215	0.9719	0.9512	0.8895	0.9365
Proposed― 0.9210	0.9207	0.9277	0.9655	0.9012	0.9197
总体来说，BRISQUE算法性能最佳，本节提出的算法次之，BIQI和PSNR 算法相差不多。具体来说，本算法针对Blur模糊的性能优越，PLCC和SROCC 高达0.9689和0.9655,均高出BRISQUE将近1%。在JPEG、JP2K和FF失真 上性能与BRISQUE不相上下，在WN失真上，稍逊于BRISQUE算法。可以说 该算法达到了同目前成熟的无参考算法性能不相上下的性能，而且大大优于全参 考图像质量评价算法PSNR,属于一种新型的无参考图像质量评价算法，该算法 与人眼的视觉感知有良好的一致性。
将实验结果同第一节的全局框架算法进行对比可以看出，釆用两阶段框架 后，算法性能得到提升，尤其是针对JP2K失真、JPEG压缩失真和FF失真相比 于原有的全局型质量评价算法性能得到大幅提升。在JP2K失真上PLCC上提升 约5%, SROCC提升约7%；在JPEG压缩失真上PLCC提升不大，SROCC提升 约6%；在FF失真上PLCC提升约7%, SROCC提升约10%。整体上来说，釆 取两阶段框架后，算法性能也得到很大程度上的提升。由此可见，两阶段框架算 法对不同的失真类型釆取训练不同的回归器，使得算法性能得到一定程度的提 升，但是这是以更高的计算复杂度为代价换取的，而且该算法加入了训练阶段。 可以根据不同的场合在两种算法中进行选择，当需要更高的准确性时，我们可以 牺牲一定的复杂度选取两阶段框架算法；当需要更高的实时性时，我们可以牺牲 一定的算法性能选取全局框架的算法。
