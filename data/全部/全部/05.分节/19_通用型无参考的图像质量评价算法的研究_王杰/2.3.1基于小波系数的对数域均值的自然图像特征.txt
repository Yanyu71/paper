2.3.1基于小波系数的对数域均值的自然图像特征
图像处理中常用的小波变换是一系列滤波器，滤波系数等于离散小波变换函 数。一幅图像经过小波变换后得到两部分：粗糙部分和细节部分，其中低空间频 率成分即为粗糙部分信号；而高空间频率成分则为细节部分信号。粗糙部分信号 可以继续进行小波分解得到介于粗糙部分和细节部分之间分辨率的信号，最终得
到多个不同尺度不同方向的子信号。具体实现过程为：图像经过行高、低通滤波 并下釆样后，被分解为两个频段L和H,分别对应低频和高频，然后再经过列高、 低通滤波并下采样，最终被分解为LL, LH, HL, HH共4个子图。其中LL代 表图像的近似部分，LH, HL, HH代表图像的细节部分，分别表示图像的水平 频率分量、垂直频率分量和对角频率分量。两级小波分解示意图和示例如图2-3、 2-4所示，为增加可视性，图2V中图像分解后的细节系数经过了缩放。
原始图像	L	H	　　LL】	HL,	ll2	hl2	　　HL】
lh2	hh2
LH]	HH】	LH】	　　HH】
图2-3图像小波分解示意图
图2V图像小波变换示例
自然图像小波系数的对数均值统计特性描述为自然图像的小波系数均值在 对数域内随尺度增加而近似线性递减3】。图2-5给出了该统计特性的示意图。为 简便起见,在同一尺度内的水平方向和垂直方向相近的能量值只需要保留一个。
18
图2-5(a)为四级小波变换后的子带编号示意图，图2-5(b)为图2-4中图像的对数 均值统计特性示意图。
图2-5自然图像小波系数的对数均值特性示意图
当图像失真后，失真图像的对数均值统计特性，相对于原始图像的特性发生 了变化，小波系数均值在对数域内随尺度增加不再呈现近似线性递减的规律。图 2-6为图2-4中图像在各种失真下的对数均值统计特性示意图，其中每种失真均 有多个失真程度，红线表示自然图像的子带系数均值的近似直线。
由图2-5可以看出，不同的失真对图像的不同频率部分影响也有所不同，但 每种失真下的变化仍然是有章可循的。比如，JPEG压缩失真、高斯模糊、 JPEG2000压缩失真、快速衰落失真都会或多或少地模糊图像。模糊减少了图像 的边缘信息，对图像的边缘和纹理区域影响较大，而对平坦区域影响较小。这些 变化并不会改变图像近似部分的小波系数幅值，但是细节部分的小波系数幅度明 显降低。而经过白噪声污染的图像，随机的噪点增加了图像的细节分量，使得图 像的细节部分即大尺度子带内的小波系数幅度明显增加。并且失真得越厉害，这 种畸变表现得越明显。仔细观察图2-6(b)还能发现JPEG失真的大尺度子带系数 比其余失真的大尺度子带系数降低的少，这是因为JPEG失真中的块效应给图像 带来的伪结构增加了图像的细节信息，抵消了一部分模糊在高频子带上的效用。
19
n(subbands)
(a)JPEG2000
((-。-)也。1)負躍
((-。-)琨。1)日蜀
3	4	5
n (subbands)
(b)JPEG
n (subbands)
(c)WN
(d)GBLUR
n (subbands)
图2-6不同失真类型的图像的对数均值统计特性示意图
自然图像小波系数的边缘概率分布统计特性描述为自然图像的小波系数的 边缘概率分布可用 GGD (generalized Gaussian distribution)建模。GGD 概率密 度函数的形式定义为：
(2-1)
式中，卩、尸分别为小波系数x的均值、方差，而/控制分布的形状。且
by
2r(i/r)
(2-2)
(2-3)
r(x) = j^x~'e~,dt x>0
(2-4)
其中形状参数/用于控制GGD的“形状”。例如，当"T时，GGD即为拉 普拉斯分布，7 = 2时，GGD为高斯分布。图2-6为相同方差不同形状参数的GGD
分布函数。
Statistics of hoc: subband wavelet coefficients
%■, ORG: '*eriance=28.85, shape-paramater=O.32
JP2K: \eriance=254.85. shape-parainater^O.SS
■JPEG: ^eriance=287.42. shape-paramater=0.55 WN: veriance=413.55. shape-paramater=O.74
'—*FF: ^ariance=0.12, shap»-paramater= 1.7
—*=—GBLUR: veriance=2.11, shape-param at er=O. 46
<b>不同失真下的图像的小波系敬的边缘柢 率分布及其《»«垫套敎
图2-7相同方差不同形状参数下的GGD
当图像失真后，失真图像的小波系数边缘分布统计特性，相对于原始图像的 特性发生了变化，但依旧可以使用GGD进行建模。图2-8为LIVE图像库中的 某一图像在不同失真类型下的某一子带系数的分布情况。2-8(b)为2-8(a)中的图 像的一层小波分解的水平子带HL的小波系数的边缘概率分布。为增加可视性， 2-8(a)中的失真图像只取原失真图像的一部分。
(a)从左上到容下依次为；敵始,JP2K, JPE&
袍，FF, GBiimm像
21
ORG: \^riance=28.85, shape-paramater=0.32
JP2K: variance=254.85, shape-paramateRO.38 十 JPEG: \^riance=287.42, shape-param at er= 0.55
WN: \ariance=413.55, shape-paramater=O.74
FF: variance=0.12, shape-paramater= 1.7
—GBLUR: wiance=2.11, shape-paramater=0.46
图2-8原始图像及失真图像小波系数边缘概率分布统计特性对比
从2-8(b)可以看出，不同的失真使小波系数的边缘概率分布产生了不同的变 化，各失真下GGD的模型参数迥异。并且由于选取的图像白噪声污染比较严重, 可以看出在所取子带的所示频段内，该图像的小波系数概率分布表现出了白噪声 信号的高斯平稳性，小波系数的边缘概率分布几乎趋近于平坦。但是，即便是此 种情况，依旧可以使用GGD建模。
基于以上理论，曾凯等［36】人提出了基于Wavelet域对数均值统计特性的无 参考型自然图像质量评价方法。该方法的大体框架图如下所示。
图2-9基于Wavelet域的对数均值统计特性的质量评价框架图
对输入图像进行小波分解后计算出各子带的对数均值族如(1理2 C|)。由于 无失真图像的斜率近似相同，且失真对较小尺度子带的影响较小。故在训练过程 中，利用较小尺度子带(不包括最小尺度子带)的Sm(log2|C|)进行直线拟合 得到直线的近似斜率。在测试过程中，步骤如下：
1)对输入图像进行小波分解得到不同尺度的子带的小波系数G,其中下标' 表示第，个子带；
2)计算各子带(不包含最小尺度子带)的对数均值"。"(1理2 1弓1)；
3)利用训练得到的近似直线斜率和较小尺度子带的族^0°g21GI)计算截 距，并拟合出一条直线。输入图像所参考的原始图像较大尺度子带对数均值的预 测值就是拟合出的直线在较大尺度子带位置上所对应的值，记为
Mean(log21 月 |).
4)将每个大尺度子带内实际值族颌。理2 IGI)减去预测值诙m(iog2 IE I) 的差值，分别乘以权重最后相加求和计算出的结果就是图像质量的评分值：
N
0 = »方
/=!
N
=£叫 x (Mean(log2 \P,. |)-Afea»(log21C, |))
J	(2-5)
其中=1，，N表示所选择出来的N个大尺度子带序号，叫为权重系数，在 最小化客观质量分值和DMOS值之间差异的训练过程中得出。
另外，由于自然图像的小波系数的对数均值在Wavelet域内随尺度增加并非 完全线性变化，在尺度大的地方会有些下降。该算法给每个子带计算偏移量 必弓以补偿部分偏差，并将实际预测值修正为：
Mean(log2 | Pt |) =Afean(log21 PUne i + offset, |)	( 2_6)
其中，Z是根据较小尺度小波系数拟合出的直线预测计算得到的尺度序数 为i的子带对应的数值，必％表示尺度序数为i的子带的偏移量，通过由自然 图像构成的训练集训练得到。
基于Wavelet域对数均值特性的质量评价方法，评价失真图像质量的关键在 于对未失真图像大尺度子带系数均值的预测和补偿。从以上分析可以看出，基于 机器学习的训练主要用在大尺度子带系数均值的补偿和子带质量的权重计算上， 并且，仅在子带质量的权重计算上运用到了需要主观分数的有监督训练。通过适 当的设计，该方法可以很容易地被改进到无监督训练或者非基于机器学习的方法 上，如文献"I。
23
