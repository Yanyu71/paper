2.3.3基于小波域的隐马尔科夫树模型的自然场景特性
Matthew等人在文献四］中利用小波域的隐马尔科夫模型来捕获自然场景图 像的非高斯特性、延续性和尺度间的相关性。对于自然图像，其小波系数的边缘 分布具有非高斯性，不同尺度系数间具有相关性。这种相关性正好符合Markov chain的特点，加上小波系数的结构符合树形，因此在这些基础上正好可以利用 隐马尔科夫树(HMT)进行建模。
在HMT模型中，小波系数和马尔科夫立案中的隐状态成 对应关系，小 波系数依其隐状态呈条件分布。通常，隐状态分为“大”状态和“小”状态，并 且假设每一种状态对应的观测值符合高斯分布。其中“大”状态可以理解为该小 波系数属于边缘等能量较大的区域，而“小”状态表示小波系数属于能量较小的 平坦区域。但“大”状态对应的系数幅度值不一定大，而是服从一个均值为零、 方差较大的高斯分布；而“小状态”对应的小波系数幅度值也不一定小，而是服 从一个均值为零、方差较小的高斯分布。这就相当于使用二状态高斯混合模型
(Gaussian Mixture Model, GMM)对尺度内的小波系数进行建模。高斯混合模型 由每一状态的概率质量函数及其对应高斯密度函数的均值和方差组成，可以很好 地描述小波系数尺度内的相关性及其边缘分布的非高斯性。
为了描述小波系数尺度间的相关性，HMT认为父系数与子系数的隐状态之 间服从马尔科夫链的关系，即子系数的隐状态只与父系数的隐状态有关。父状态 通过两者关联的如公式2-9所示的转移矩阵跳转到子状态：
WS,S L,S 一
4=縉留	(2-9)
_气/9① 与,Q(i)_
L,S  	 1  	 S.S S,L  	 1  	 L.L S,S
其中，弓次)-1-臥(i),气前-If河)。气岡的意义是小波系数父系数较小
uL,L
的条件下该系数也较小的条件概率。我们称 和"为更新概率，它们表示 状态之间转化更新的概率。为了简化模型，该方法简单假定在四叉树上没有相互 连接的状态之间没有相关性。
因此，隐马尔科夫树模型不仅能够对系数的非高斯特性进行建模，同时也对 各个尺度系数间的相关性进行建模。
研究表明自然场景统计特性在频率分布上与人眼视觉感知的响应之间存在 对数关系。与在小波域的隐马尔科夫树模型中，这种对数关系就表现为图像的
“大”方差(Large SIgmma, LSI)和“小”方差(Small SIgnima, SSI)幅度在对 数域内沿尺度线性递减的关系。图2-3中给出了无失真图像的LSI和SSI在对数 域随尺度的变化情况。我们对512x512的图像进行8层小波分解，可以看出，随 着尺度的增加自然图像的对数域小波系数均值近似线性递减。
25
模糊程度不一样的高斯模糊图像所对应的HMT模型中LSI和SSI值在对数 域随着尺度递增的分布情况不同。图像收到模糊失真影响后，边缘细节变得模糊， 但对于没有什么轮廓的纹理区域则几乎不造成影响。基于小波域的HMT框架下， 相应特性的表现为在表示低频信号的小尺度内LSI和SSI幅度几乎不变，而在大 尺度内，由于提取的是高频信号，LSI和SSI幅度趋于减小’并且失真得越厉害， 幅度的变化程度越大。对于其他类型的失真，LSI和SSI统计特性也会随失真程 度的不同而发生变化。因此，我们可以利用这些特性来量化图像质量的失真程度 得到图像的客观质量评价值。
基于上述分析，可以发现没有受到失真影响的自然图像在小波域内，以尺度 作为横坐标，LSI和SSI为纵坐标的直线近似斜率相同。而对于失真图像而言， 失真得越厉害对小尺度上的LSI和SSI并不造成多大的影响，而在大尺度上的子 带内偏离原始图像的程度的大小随着失真程度的增大而增大。因此可以考虑利用 这些差异不大的LSI （或SSI）值并结合原始的LSI （或SSI）分布的斜率来估计 原始的LSI （或SSI）分布，然后与失真图像的参数值进行比较，估计图像的质 量。Gao等人据此提出了一种以小波域的隐马尔科夫树模型为基础的无参考图像 客观质量评价方法，通过失真导致的LSI和SSI的变化程度来评价图像的质量。
需要指出的是，无失真图像的尺度分布并不是绝对线性的，在大尺度的某些 地方会有些偏移，通过引入偏移量的方法进行调整，该偏移量的先验值从训练中 得到。
通过在LIVE数据库上对该算法性能的测试，发现该算法对多种失真都取得 了不错的评价效果。这也说明了，通过选择更加匹配的图像统计模型，有可能构 造出性能更优的无参考图像质量评价算法。此外，在该算法中，只考虑了 HMT 模型的方差与图像质量之间的关系，对于其他参数并未进行充分考虑。如果能够 分析岀HMT模型其他参数随图像失真的变化情况，并构建模型学习到这些特性， 应该可以进-步提升算法的性能。
