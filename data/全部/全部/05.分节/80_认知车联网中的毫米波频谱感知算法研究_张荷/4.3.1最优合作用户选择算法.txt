4.3.1最优合作用户选择算法
图4-2为用户选择示意图，在进行合作用户选择时需要考虑毫米波的方向性 特点以及车辆的移动性。首先，由于毫米波的波束方向性特点，地理位置距离近 的认知用户不一定处于同一个授权用户的波束范围内，同时认知用户对授权用户 的波束方向未知，因此需要针对此特点设计适用于毫米波的合作频谱感知算法。 其次，车辆的移动性会导致某些认知用户即使处于同一授权用户的波束范围内， 由于移动速度、方向等差异也不适合进行合作。根据以上两点的考虑进行最优用 户选择算法的设计，针对第一点毫米波波束方向特性的考虑，利用不同认知用户 感知结果的相似性可以判断认知用户是否处于同一个授权用户的波束范围内：针 对第二点车辆移动性的考虑，基于车辆的移动性参数，对群移动相似性进行建模, 与周围用户移动性模式相似度越高的用户越适合参与合作。
39
图4-2合作用户选择示意图
首先，参考文献［12］对认知用户相似性的表示，根据认知用户感知信号计算 皮尔逊相关系数：
Sim(i,j)=恭了( 4-3 ) 其中巧和》表示用户i和用户/的感知信号，越大则表示用户，和用户/ 的感知信号相似度越大，即越有可能处于同一授权用户的波束范围内，因此适合 进行合作。
然后，使用车辆速度、方向等移动性参数表示与周围用户移动性模式的相似 程度。文献［57］定义了总空间依赖值(Total Space Dependence) TSD, 7SD越大 表示此用户与周围用户的移动性模式相似度越大，为便于理解，本文将7SD称为 “群移动模式相似度”。用户，的73Q计算方法如下：
M
TSD(i) = £SD 匕 j)	(4-4)
J=I
其中SD(i,j)为用户i和用户/的移动性模式相似度，砂的值为用户i与周围用 户的移动性模式相似度的和，M为周围用户的数量。SD(i,j)的大小与用户Z和 用户/的移动速度、方向有关，计算方法如下：
SD(iJ) =	* SR(i,j)	(4-5 )
其中RD(iJ)和S12QJ)分别表示用户Z和用户j的相对方向和速度比率：
血血 J) = cos(0(/)—0(f))	(4-6)
40
SR(i,j) =
其中目，(-;r,〃)分别表示用户i和用户/的移动方向，片,片分别表示用户「和 用户/的速度。
基于以上分析和计算，已经获得了两两用户之间的感知信号相似度
以及每个用户的群移动模式相似度7ISQ。本文中进行合作用户选择的原则为在 移动性模式小于某一门限的前提下使得合作用户的感知信号相似度最大化，目的 是选出那些移动性模式相差不大且位于同一授权用户波束范围内的认知用户。于 是建立优化模型如下：
max V u 出 jSint(i,j)
s.t. uTSD(i)SMob,i = \ M
M	(4-8)
2叫SK
i=l
“产{0,1}
其中气=0时表示不选择用户i , «,.=1时表示选择用户i , Mob表示移动模式相似 度的门限值，K表示参与合作的用户数量的最大值。
这是一个非线性0-1规划问题，是NP困难的问题，为解决这个问题，本文 采用自适应遗传算法(Adaptive Genetic Algorithm, AGA)进行求解，与标准遗 传算法相比，自适应遗传算法收敛速度更快，并且计算成本较低。自适应遗传算 法的自适应能力主要体现在能够根据适合度值自适应地改变交叉概率E和突变 概率匕。当群体倾向于停留在局部最优时(也就是群体适应度集中，多样性比较 差时)交叉概率好和突变概率匕增大，并且当群体在解空间中较分散时(也就 是群体适应度分散，多样性比较高时)交叉概率£和突变概率匕减小。使用自 适应遗传算法求解此优化问题的过程如下：
(1) 初始化种群，种群中每个个体的染色体序列为［知绥，•••，“»；
(2) 计算适应度：将种群中每个染色体序列代入适应度函数/以计算适应度;
(3) 选择：在当前种群中选择适应度高的染色体；
(4) 交叉：根据交叉概率交换种群中一对染色体的相应基因区段，其中自适
应的交叉概率计算如下: 其中九为种群适应度的平均值，九g为种群适应度的最大值，A„A2<1.0 是控制参数。
(5) 突变：根据突变概率随机改变染色体的值，其中自适应的突变概率计算 如下：
其中他血9.0是控制参数。
最后得到［«,*,<,...,«/!为参与合作的最优用户组。
