3.3系统结构设计
ACS的总体设计思路是通过对可执行文件进行分析与抽象，得出相应格式的 矩阵，此矩阵能够反映此样本的行为特征，此矩阵即为对应样本的签名。然后将 此签名同签名数据库中的恶意家族签名进行对比，通过图相似性匹配算法得出与 特定恶意家族的相似性，再根据训练集中样本的相似度区间将此样本进行划分, 得出检测结果。训练集数据进行反汇编整理生成API调用矩阵，结合恶意与非恶 意文件得出能够有效识别恶意文件的API调用权值矩阵，这一矩阵就是本恶意家 族的签名(signature)o理论上，生成的签名能够有.效区分本家族变种和非恶意文 件。具体又可以分为两步，即数据预处理和图相似性比对。系统的总流程图如下
如图3-1所示，ACS系统的执行流程如下：输入可执行文件，然后进行数据 预处理得到库函数调用矩阵和权值矩阵，分别将两个矩阵同签名数据库中的恶意 家族签名进行比较，执行图相似性比对子过程，最终得到判定结果。
本系统使用的数据库为MySQL,开发语言为python,开发环境为Eclipse,辅
24
助开发工具有IDA Pro、PEiD,开发的操作系统为32位win 7系统。另外，本系统 使用的训练集的文件格式均为exe可执行文件。
