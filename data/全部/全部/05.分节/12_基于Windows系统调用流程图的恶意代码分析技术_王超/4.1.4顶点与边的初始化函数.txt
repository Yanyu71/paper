4.1.4顶点与边的初始化函数
顶点与边的初始化函数主要用来对一个样本的子函数调用的函数调用图和 每个子函数的控制流图进行初始化。其实现函数是edge_vertexlnit()o其实现流 程是：首先初始化边的入度出度以及边的源顶点和目的顶点；然后获取样本文件 的边和顶点信息；之后将边信息和顶点信息融合存储值数据库中。其流程图如下:
初始化边
信息
初始化顶点
信息
获取样本的边
信息
获取样本的
顶点信息
/ 格式化的边信 7
/ 息与顶点信息/
图4-6顶点与边的初始化流程图
由于本文所讨论的恶意代码检测方法的匹配算法并非直接将恶意样本 进行匹配，而是需要将其进行预处理，所以ACS系统首先会将恶意样本进行 预处理，处理结果即为一个128*128的矩阵，以Netsky恶意家族为例，下 表即是对Netsky家族处理所得的矩阵。
45
表4-9 Netsky家族的权值矩阵的子矩阵
表4-9为Netsky恶意家族的权值矩^^的子矩阵,其中行列中的数值与二元 组映射码相对应。例如53表示类型码为13,操作码为0的二元组(13*4+1=53), 依此类推，即可得到恶意家族的完整权值矩阵。
