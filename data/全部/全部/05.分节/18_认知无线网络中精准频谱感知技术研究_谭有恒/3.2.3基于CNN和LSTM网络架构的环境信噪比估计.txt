3.2.3基于CNN和LSTM网络架构的环境信噪比估计
基于观测信号半自适应釆样的频谱感知技术的一个关键问题是环境信噪比 的准确和实时估计。为此，本文提出了基于CNN和LSTM网络架构的环境信噪 比评估方法。
需要注意的是，经典的信噪比估计方案精度较低，从而降低了频谱感知的检 测性能。虽然［91］和［92］大大提高了基于CNN模块的估计精度，但［91］和［92］的 输入数据是一维的，没有考虑信号与噪声的相关性。本文提出了一种基于［92］的 二维CNN和LSTM网络结构，并考虑了 CNN及LSTM层数对检测性能的影响。
图3-2展示了所提出的信噪比估计方案的网络结构。将接收到的远程信号进 行框化，并通过Toeplitz变换转换为二维信号。然后，CNN用来提取深度特征， LSTM提取时间序列特征。最后，将提取的特征通过全连通层进行组合，得到估 计的信噪比。
图3-2.基于CNN和LSTM的环境信噪比评估网络架构.
假设接收端观测信号y(n)的长度为L,帧长为R,则二维Toeplitz矩阵表示为
'%(〃)…*(〃)、
y(n)=	:	:	,	(3-30)
由〃)…阪(心
其中yi«(n) = yR1(n)为相邻接收信号的相关性。
然后，将CNN应用到卷积核大小为3X3,卷积步数为1的二维Toeplitz矩 阵中。Toeplitz变换的主要目的是获取信号序列的相关性，以便将更多的特征加 入到网络中。卷积核的共享权重表示为w(n),卷积后的输出矩阵为
y(n) = g(w{n)y{ri) + 6(h)).	(3-31)
35 其中；(•)为CNN的激活函数，w(n)为卷积核参数，b(n)为偏差。需要注意的是， 由于整流线性单元(ReLU)的收敛速度快及可避免的梯度爆炸和梯度消失，本 文将其作为激活函数。此外，为了避免可能的特征丢失，在CNN网络中去掉了 池化层。
本文使用LSTM提取输入信号序列的多维特征，包括深度特征和时间序列 信号的特征，以获得更高的信噪比估计精度。定义当前输入，LSTM的最后输出 和最后的单位状态为死_i，0_i和Ct_io LSTM的输出及其对应的单位状态分别 表示为0和G。
从图3-3可以看出,LSTM模块主要包括遗忘门、输入门和输出门三个部分。 遗忘门决定了前一时刻G_i的单位状态保留到当前时刻G的程度。输入门决定当 前有多少输入死可以保留到当前单位状态％，而输出门决定当前有多少单位状态 G可以用作输出S。
图3-3. LSTM模块的结构(包括遗忘门、输入门和输出门)
具体来说，LSTM模块主要包含6个过程，如图3-3所示。
1)遗忘门左的输出可以描述为
括g(旳兩+小丄+垢	(3-32)
其中町为遗忘门的输入权值，赤为如_1的权值，切为相应偏差。
2)输入门丄的输出可以表示为
L=gW 爲+ S + bj)	(3-33)
其中，响为输入门的输入权值，岭为的权值，加为相应的偏差。
当前输入G的单位状态可以写为
36
G=Wih(K 幻 + 卩cUi+b,
,,.sinMx) ex - ex
tanh(x)=	=
cosh(x) ex+e~x
式中应；，此为相应权重，尻为偏差。
3）定义输出G的单位状态为
4）输出门的输出可以表示为
其中，M为输入门的输入权值，*为0_1的权值, b°为相应的偏差。
5）当前LSTMS的输出可以表示为
Ut =ottanh(Ct)
