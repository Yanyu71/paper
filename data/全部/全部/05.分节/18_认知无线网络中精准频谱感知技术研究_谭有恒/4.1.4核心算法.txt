4.1.4核心算法
图44.系统模型.
本节讨论了使用深度卷积生成对抗网络的数据增强方案，提出了一种改进的 深度卷积生成对抗网络方案。所提出的深度卷积生成对抗网络基于python3.7、 pytorchl.5机器学习库。
a.数据生成
本小节生成原始训练集和测试集，其中正交频分复用信号［98］为初级信号, 瑞利衰落［99］为传播信道。抽样协方差矩阵的大小为10x10x2。本文所采用的多 天线系统的天线数为M=10o真彩色图像的通道号为3,其中釆样协方差矩阵的 通道数为2 （实部和虚部），第三个通道设为零矩阵。矩阵大小取决于多天线系 统的天线数。
在数据生成过程中，生成8个数据集，随着2dB步长，信噪比在-10dB到 2dB之间变化。每个数据集分为两个部分，％和用。对用，部分分别采样实部 和虚部，得到3000组数据。每组数据包含2个矩阵并且釆样点为N=1000，则每 组数据可以表示为10X1000X2的序列矩阵。根据公式（4-7），计算每个数据矩 阵的抽样协方差矩阵，得到3000组双通道抽样协方差矩阵。之后，这3000组数 据随机排序并转换为真彩色图像，其中第一通道的真彩色图像是第一个通道的采 样协方差矩阵，第二个通道是零矩阵，第三通道是第二通道的采样协方差矩阵。 最后，将前1000组作为测试集中用部分的数据，最后2000组作为原训练集中 此部分的数据。
针对用部分，对其进行与％部分相同的数据操作处理。得到了用部分的
1000组测试集数据和2000组原始训练集数据。
52
图4-7.在信噪比为2dB时％和耳的真彩色图像
图4-7为得到的信噪比在2dB下为和出 情况的真彩色图像，其中左图对 应月0情况，右图对应仏情况。从图3-7中可以看出，除了对角线外，%情况 下的颜色都很暗，说明对应的双通道采样协方差矩阵的值很小。而在情况下， 图像的颜色是不均匀的，有一定的混沌，这说明对应的双通道采样协方差矩阵值 也是混沌的。
b.数据增强
在此小节中，基于经典深度卷积生成对抗网络方案对采样数据进行了增强， 釆样数据增加了一倍，每个信噪比下的图像从4000幅增加到8000幅。
在图4-8中，展示了迭代训练的损失，其中G表示发生器，D表示判别器, 训练周期数为16。从图4-8中可以看出，当运行到第10个循环时，梯度激增造 成了较大的损失。因此，如何有效地减少丢失，决定了数据增强的质量。
图4-9展示了卷积核初始权值对模型训练的影响，将均值为0、方差为0.02 的高斯分布调整为均值为0.05、方差为0.02的高斯分布。图4-9表明，增加初始 权值均值会降低训练速度和训练梯度。
53
图4-10.均值初始权值为0.05时82次训练结果.
图4-11.均值初始权值为0.02时82次训练结果
图4-10和图4-11分别展示了初始权值均值为0.05和0.02时的训练结果， 其中左图为原始图像，右图为深度卷积生成对抗网络生成的图像。由图4-10和 图4-11可知，初始权值均值越小，生成的图像质量越好。可以看出，初始权值均 值影响着模型的收敛速，初始权值均值越大，模型收敛速度越慢。但同时，也可 以获得更多有用的信息。
C.改进的深度卷积生成对抗网络
根据上面的讨论，增加初始权值的平均值会降低训练梯度。然而，它牺牲了
生成的图像质量。本节针对上述问题提出了改进的深度卷积生成对抗网络方案。
图4-12.初始权值均值为0时梯度激增前后的运行状态
梯度激增前后D（G（z））的变化如图4-12所示，其中初始权值均值均为0。
根据图4-12,当梯度激增的时候，生成网络及判别网络的损失函数同时增大，同 时 £）（%）及D（G（z））均为 0。
下面将网络参数初始化权重的均值调整为0.08,得到如图4-13所示的损失
函数变化情况。
图4-13.均值为0.08时的loss
可看出，生成网络出现梯度爆炸的问题。查看更加详细的梯度爆炸前后的网
络状态，其结果如图4-14所示。
图4-14均值为0.08时梯度爆炸前后运行状态
从图4・14可以看出，当梯度爆炸发生的时候，生成网络损失函数突增，同 时判别网络损失函数突减。此时，判别网络可对生成图像做出正确判决，而生成 网络跟不上判别网络的变化。本文对该算法进行改进，训练两次生成网络，对应
55
1次判别网络的训练，同时初始化权重均值调整为0.06。
经上述调整，网络训练loss如图4-15所示。
图4-15算法第一次调整梯度爆炸前后运行状态
根据图4-15,判别网络无法区分生成图像与真实图像，并且判别网络损失函 数突增，而生成网络损失函数降为0。可以看出，此时生成网络的变化大于判别 网络。因此，需要对网络进行进一步优化，即
当D(G(z)) > 0.95时，判别网络额外增加3次训练。
但是，第二次调整收效甚小，依然出现了同样的梯度爆炸问题，只是将梯度 爆炸的时间略微后延了一些。如图4-16所示，在第22个训练循环出现梯度爆炸,
而调整之前是在第19个训练循环出现梯度爆炸。
图4-16.算法第二次调整梯度爆炸前后运行状态
第二次调整出现的问题与第一次一样，然而D(G(z))直接从0.4左右跳变到
1,难以判断其间出现什么问题，所以要进一步降低进化速度来发现问题。于是
进行第三次调整：将卷积核初始化权重的均值调整为0.2o此次调整后的运行过 程中依然会出现梯度爆炸的问题，只不过，梯度爆炸的时间后延了很多。如图4・
17所示。
图4-17.算法第三次调整梯度爆炸前后运行状态
根据图4-17,可以得出，在D(G(z))> 0.5时，梯度爆炸很快出现，于是对判
别网络再加一个约束：当0.5 < D(G(z)) < 0.95时，对判别网络额外训练2次。 并且在约束之外，做出调整：在每一个训练循环中，一次生成网络训练对应2次 判别网络的训练。第四次调整的运行状态如图4-18所示。
56
图4-18.算法第四次调整梯度爆炸前后运行状态
第四次调整使判别网络变化大于生成网络，以至于生成网络的损失函数变得 很大。同时也观察到当D(G(z))V 0.19时，梯度爆炸很快出现，于是对生成网络 增加一个约束：当D(G(z)) < 0.19时，对生成网络额外训练1次。此次调整的运
行状态如图4-19所示。
图4-19.算法第五次调整梯度爆炸前后运行状态
第五次调整运行的后期出现梯度爆炸，依然是生成网络的进化太过落后于判 别网络。而在D(G(z))< 0.08时，梯度爆炸很快出现。很明显，0至0.19这个范 围依然很大，需要更加的细分，同样0.5到0.95这个范围也需要细分。
在此点上，两个网络都将崩溃。基于此种情况，提出了一种调整方案，如表
4-1所示。
表4-1.深度卷积生成对抗网络的调整方案
D(G(z))	Emergency option
Emergency action of judgement network	0.5 <D(G(z))< 0.65	2 extra training times
0.65 <O(G(z))< 0.75	3 extra training times
0.75 <Z)(G(z))< 0.85	4 extra training times
0.85 <O(G(z))< 0.95	5 extra training times
D(G(z))> 0.95	6 extra training times
Emergency action of judgement network	0.14 <Z>(G(z))< 0.19	1 extra training time
0.10 <D(G(z)) <0.14	2 extra training times
0.07 <D(G(z))< 0.10	3 extra training times
57
1200
图4-21.初始权值均值为0时改进的深度卷积生成对抗网络loss
图4-20和图4-21显示了当算法运行到第40个训练循环时，改进的初始权 值均值为0的深度卷积生成对抗网络结果和改进的初始权值均值为0的深度卷 积生成对抗网络损失。可以看出，己生成的图像能够达到临界并非真相。此外， 从损失函数的角度来看，自第100次训练以来，发生网络和判别网络也表现出了 明显的向上和向下的抖动趋势，即对抗性进化。同时，可以得出初始化参数权值 的均值从0.2变化到0,加快了模型的收敛速度。
