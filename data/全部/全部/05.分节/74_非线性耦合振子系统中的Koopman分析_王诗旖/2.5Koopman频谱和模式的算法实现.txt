2.5Koopman频谱和模式的算法实现
假设有相空间的一系列点（工1，*2，--e）
1,2,-,m,然后构造两个数据矩阵：
y
，一组m个可观测量幻（久）,/=
=(% 0),92 0)，…,9皿(0)=
'giOo) 9101)
(尤…)
比(%。) ••• 史后) •••
。2(苍1-1)…
(2-36)
9m (&-1)
9m(X。) 9^01)
/giM
y1 = (g'iO),g‘2(%)，…,g'm(x)) = j
\giM
02Ol) ••• 0n(Xl) g2(>2)••• gm(x2)
。2(/)…gm(.Xn)
(2-37)
y和y'的每一列都可以看作是不同函数在给定点上的离散值。因此n的取值 应该足够大以确保获取到足够多的点来表示这些可观测函数。这两个数据矩阵丫 和V'都是Koopman算符的有限维表示，并且满足：
况丫 = 丫'
(2-38)
计算结果是由系统的动力学决定的，截断数m的取值取决于每列之间的正 交多少。然而，之后会看到在矩阵中，靠近的列互相之间非常接近，所以每一列 之间的相关性非常大，在这种情况下，为了保证数值计算的稳定性，将SVD应 用到数据矩阵上来获取最相关的信息，接下来将详细说明SVD是如何应用的。
首先将数据矩阵V分解：
在上式中，都是正交矩阵，E将非负的奇异值在主对角线上按从大到小的 秩序排列。U的每一列可以视为新的基函数，V的每一行是新的坐标，通过奇异 值的大小按照基函数的重要性划分。奇异值的大小与能量在相关维度的重要性有 关。通常，前10%甚至前1%的奇异值就已经包含了超过99%的信息。因此，使 用前k个奇异值和相关的左右奇异向量就足够了。在本文中为了确保重要的信息
20
没有丢失，保证所有选择的奇异值都大于10-6。
在新的域下，新的坐标P和P都是kxn维矩阵。新的Koopman算符负的表示 满足：
曳乎=Y'	(2-40)
通过上式可以获得本征值不和本征向量”，满足：
负 Wi == 1,2,…，k	(2-41)
回到在原始域，(pi = UWj。
选择合适的基函数是一个非常关键的问题，这直接关系到是否能够捕获更加 方便使用的主要动力学特征。类似于广泛应用于不同边界条件的微分方程求解, 可能的基函数选择包括：高斯基，多项式基，傅里叶基。然而，最优的选择总是 需要根据动力系统和感兴趣的性质来决定。过去基函数的选择是定义在子空间的 性质比较好的函数。在非线性系统，轨道通常被限制在一个子流形上，在该流形 上可以定义有效的基函数。例如，矩阵U的每一列就构造了这样一组基。在文章 跃］中，通过将dmD应用到Hankel矩阵可以获得Koopman算符的本征值和本征 函数。Hankel矩阵由时间序列延时嵌入构造形成时俗刀。本论文使用这种方法来 计算Koopman算符的本征值和本征函数。
具体构造如下，对于给定的时间序列(曲,刈,％2,…,工”…)，构造如下两个 Hankel矩阵因〕：
(2-42)
(X1	X2	... xm \
?	?	;■ ?+】)	(2-43)
H和H'的每一列可以被当作是定义在n个离散点々),…1T上的方程，通 过上述的算法,k个Koopman算符的本征值和相对应的本征函数(4,/)	»
通过将Hankel矩阵投影到本征函数上，可以获得Koopman模式叼：
a12	alm\
?呼••• a-2m \
ttfci an2 …anrnJ
21
=2储％3%	(2-44)
在Koopman算符的实际应用中，基函数的选取至关重要，好的基函数得到 的本征函数可以更好的去刻画系统的运动。所以这里有一个难点就是对不同的系 统需要根据对系统不同的理解选取不同的基函数，对大多数非线性系统来说，如 何选取好的基函数是十分困难的。Koopman算符的每一列都可以看作是一组函 数。如果是无限维度的，那么一个函数就可以了，稳定的情况下，希望能够抓住 系统的主要模式，因为维度有大量的冗余，真正的自由度还是比较低的。所以对 于一条稳定的轨道，不用轨道的全部数据，通过一定的数据取样，选取一组好的 基函数，可以给系统一个很好的特征表示。函数即可以看作是可观测量，好的特 征可以大大的简化对系统的描述。
本论文将Koopman应用到哈密顿系统的非线性耦合振子模型中，该模型是 一个哈密顿系统，哈密顿系统也是一种广泛存在的动力系统，哈密顿方程的特殊 性质赋予了这些系统不同于其他系统的性质。本论文使用延时嵌入法构造Hankel 矩阵来近似Koopman算符，利用基于SVD的DMD算法得到Koopman算符的 本征值，本征函数以及Koopman模式，目的是提取出主要的Koopman模式以及 其与bifurcation的关系。
