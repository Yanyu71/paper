5.3.2用户信道状态自适应的功率分配算法
在可见光MU-MIMO-OFDM系统中利用空间维度调光可以使信号直流偏置 工作在动态区间的中心附近，因此能够最大限度的提升信号的电功率。与此同时, 在接收端由于每个用户的信道条件有所不同，在发送端在光功率限制条件下根据 不同用户的信道状态合理分配信号电功率，可以有效提升系统在不同亮度下的通 信容量。根据5.3.1小节的分析，JPASD方案将在将模拟一空间协同调光基础上 进一步联合功率域资源，通过自适应用户功率来提升系统在不同亮度条件下的系 统容量。为了确定用户的功率分配向量%，本节设计了一种集中式的用户功率 分配算法，根据不同用户的信道状态对系统信号电功率进行比例缩放，然后分别 对每个用户进行功率分配，从而避免某个信道增益较高的数据流占据过高的功
率，保障用户整体的通信容量。
基于文献[200]的分析，可以将用户J的通信速率下界近似表示为：
R/=；logI/学，	(5-18)
其中，△='为固定常数。 271
基于(5-3)式，发送端需要完成功率分配和预编码，可以等效地将预处理矩阵 M,表示为：
Ms = [W] w2 ...wA.]g'2	(5-19)
其中，＞i = "g(皿，…,％])为用户/的功率分配矩阵，用于控制用户)每条数据 流的电信号功率。接下来，系统全部K个用户的通信容量可以用数学公式表示 为：
A 2
C = max log I + A —(5-20) m	a~
其中，A由全体K个用户等效信道矩阵的奇异值组成
88
(5-21)
对于给定的调光等级人可以由(5-10)式和(5-11)确定系统所需的工作LED数 目和信号的直流偏置。相应地，系统电信号功率可以近似表示为/=黑(4题)2。 接下来，需要在研究在光功率限制条件下的最大化系统容量的功率分配矩阵(I, 这一问题可以用数学公式表示为
C = max—log I+A
(5-22)
st. 'trace(巧)(MSD)2
在单用户MIMO系统容量优化问题中，传统的基于注水(Water-Filling, WF) 公式的功率分配将全部K个用户的信道奇异值A.组成矩阵A ,并依据A进行功 率分配。
但是由于不同用户的信道状态差别很大，奇异值的大小各有不同，这种传统 的分配技术，会使得信道条件较好(A)较大)的某个用户的数据流分配到较多 的电功率，从而使信道增益较小的用户难以实现足够的通信容量，影响了用户之 间的公平性。本小节设计了用户信道状态自适应的功率分配算法，在发送端首先 依据不同用户的信道状态对总功率%，即进行比例缩放，从而确定相应地电功率 与，然后对不同的用户分别进行功率分配。
首先，在发送端利用获取的信道状态信息，依据用户等效信道矩阵的奇异值
= ,用户j电功率的缩放因子可以定义为
(5-23)
相应地，用户/的电信号功率为弓=叼%。接下来，可以将光功率限制下的用 户功率分配问题数学表示为
Nrj
s t £ trace (4图)=叼为sd
(5-24)
其中，q表示用户/的信道容量，均为用户/的功率分配矩阵。上述问题是一个
凸问题，采用朗格朗日乘子法可以对它进行求解。最终可以求得与的元素分别 为：
1	a1 % i )
其中，町=/卜力"+(不亲］为用户/的注水平面。
基于以上分析，本小节所提用户信道状态自适应的功率分配算法可以在算法
4中如下表示：
算法4用户信道状态自适应的功率分配算法设计
1：输入：调光等级〃，激活工作LED数N“，信号幅度Mjpasd ,系统电信号功率P”，asd。
2：利用TAS-MMSV算法确定亮度〃条件下的工作LED集合S
3：基于(5-2)式，计算用户)的等效信道矩阵A,.和功率缩放系数枚,
4：利用(5-24)式，依据Aj完成注水功率分配计算用户功率分配向量
5：将全部K个用户的功率分配向量组成功率分配矩阵：
N =	(5-26)
输出：用户功率分配矩阵
