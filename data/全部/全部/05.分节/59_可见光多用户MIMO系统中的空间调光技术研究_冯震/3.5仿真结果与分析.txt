3.5仿真结果与分析
如图3-8所示为本章节所考虑的MU-MISO-OFDM系统仿真模型，在天花板 上布置了由10x10的LED阵列组成光源，室内分布2个用户，系统采用采用 4-QAM调制，子载波数目为1024。同时我们建立了三维坐标系，原点。(x,y,z) 位于地板的中央，LED阵列和用户PD的坐标都是他们的几何中心相对原点得到 的。LED阵列垂直向下分布在距离地面1.75米的平面上，2个用户的PD垂直向
51
北京邮电大学工学博士学位论文
上分布在地板上。如图3-9所示，用户1固定不动，用户2分别位于P1和P2两 个位置。主要仿真参数列举在表3-1中。
高度3m
LEDs
长度4m
图3・8仿真模型图
天花板
- 10x10
y患
木浦4m
/ P2 (1.51.5.0 湃 / / / Pl 警(0.5,0.5,0) /
z / z z / / J用户1 /季(・ 1.5,- 1.5,0) / /	0 用户1 用户2
----------------->
宽度4m
图3・9用户分布示意图
52
表3-1仿真参数
参数	数值
房间尺寸，LxWxH	4mx4mx3m
LED阵列位置，（羽y,二）	(0, 0, 2.5)
用户数目，K	2
用户的PD数目	2
LED数目，N、	100(10x10)
LED动态区间，	[0,2]
光集线器的折射系数，〃	1.5
半功率角，①1/2	60°
接收PD面积，A	1 cm2
接收机半视场角，	80°
收发平面之间的高度差	1.75 m
PD的调制带宽，B	100 MHz
在仿真中，我们采用如图3-9所示的用户分布情况，其中用户1位置固定在 （-1.5, -1.5, 0）,用户2可在P1或P2位置移动。需要说明的是，在仿真中没 有对比数字调光技术，这是由于在MIMO系统中，采用数字调光需要解决同步 问题从而显著增加了用户设备处理的复杂度［194］。我们分别考虑了以下四种方 案：（1） SD-MMSE：激活不同数目的LED用于空间调光并且MMSE预编码矩 阵由工作LED的信道矩阵Hs得到：（2） SD-ZF：激活不同数目的LED用于空 间调光并且采用ZF预编码；（3） AD-MMSE：调节直流偏置用于模拟调光并 且激活全部N,个LED进行MMSE预编码；（4）： AD-ZF：调节直流偏置4用于 模拟调光并采用激活全部N,个LED进行ZF预编码。需要说明的是在两种模拟 调光方案中，亮度为100%时直流偏置=（，+，）/2,从而最大限度地保障通 信性能。
首先我们将验证和对比不同的调光方案对用户的削峰噪声的影响。由于LED 动态区间的限制，当直流偏置过高或过低时会发生LED的饱和以及削峰，从而 会引入谐波或造成信号的交叉调制UK在SD-MMSE和SD-ZF中，直流偏置固 定在动态区间的中点To,因此我们将AD-MMSE和AD-ZF在100%亮度等级下 的直流偏置定为To。在其他亮度等级下，AD-MMSE和AD-ZF的直流偏置均低 于To,相应地会引入底部削峰失真。根据Busgang理论，可以将每个LED上的 信号削峰噪声建模为一个0均值、方差为b菰的高斯变量，b如可以表示为
53
aclip=ax ｛尸-尸2 +0(4)4 -0⑷力+ 口-以4速］
+。(4)彳-［。(4)-。(4)	0-47)
+口-。(4)］4+创4)4『｝
其中，b：=tr(WsWf)/",代表信号电功率，0(x) = exp(-x2/2)/疡为标准正
态分布的概率密度函数，尸=。(乙)-。(4)为信号的衰减系数，可以由Bussgang
理论得到。。(x) = JJexp(-d/2)/缶*为互补累计分布函数，-//)/q
和4 =(4 - 4)/q分别表示归一化的底部和顶部削峰参数。给定用户P的削峰噪
声可以由预编码矩阵折算后等效地表示为：
2	=. 戊即
clipyp	1	|2
最终，由(3-16)和(3-48)式，可以将用户p的SINRp表示为:
IIh^wJI2
SINR =-------------------
+£8nH+4p,p
(3-48)
(3-49)
601.6001.
图3-10 SD-ZF和AD-ZF方案中用户2的削峰噪声随调光等级变化曲线
根据(3-48)式，本节在图3-10中分别比较了 SD-ZF和AD-ZF方案中用户2
54
的削峰噪声随着调光等级的变化曲线，削峰参数7避分别设为3dB和5dB。需要 说明的是，SD-MMSE和AD-MMSE的用户削峰噪声-调光等级曲线可以通过相 同的方法得到。可以发现，AD-ZF方案中用户2的削峰噪声随着调光亮度的增 加而减少，而SD-ZF方案中用户削峰噪声几乎不随〃的变化影响。在以上两种方 案中，%=5dB条件下的削峰噪声低于% =3dB,这是由于信号的削峰程度降 低，系统的削峰噪声减少。
10	15	20	25	30
信噪比[dB]
图3-11不同亮度等级下SD-ZF和AD-ZF方案的BER性能曲线
接下来，图3-11分别在用户2固定在P1,亮度等级为30%、50%、70%、100% 的条件下比较了 SD-ZF与AD-ZF方案的BER性能。可以发现当亮度等级低于 100%时，SD-ZF均能获得比ZF更优的BER性能，例如当『70%时，为了达到 BER=10-3的门限,SD-ZF和AD-ZF所需的SNR分别为25dB和29dB,因此SD-ZF 可以获得4 dB的SNR增益，这是由于SD-ZF将信号直流偏置固定在10,通过 改变LED的数目实现调光，从而可以有效减少AD-ZF调节信号直流偏置所引入 的削峰噪声。同时，当亮度等级为100%时，SD-ZF和AD-ZF的BER曲线重合, 这是由于在该亮度下，SD-ZF和AD-ZF均激活全部的LED工作并将系统信号偏 置设为动态区间的中点，因此可以实现相同的BER性能。此外，随着亮度等级 从30%增加到100%, SD-ZF和AD-ZF的BER均逐渐降低，这是由于在SD-ZF 中工作LED的数目随着亮度升高而增多，由(3-28)式可知，其系统速率将不断增
55
大；而在AD-ZF中，信号偏置与亮度等级成正比，随着亮度的升高，时域信号 幅度不断增加，可以实现更高的SNR。
图 3-12 不同亮度等级下 SD-MMSE, AD-MMSE, SD-ZF 和 AD-ZF 方案的BER性能曲线
同时，图3-12在用户2固定在P1、亮度等级分别为70%、100%的条件下比 较了 SD-MMSE和AD-MMSE, SD-ZF和AD-ZF方案的BER性能。可以发现， 当〃 =100%时，SD-MMSE和AD-MMSE的BER曲线重合，在这种亮度等级下， SD-MMSE和AD-MMSE的工作LED数目和信号的直流偏置相同，两种技术都 是利用全部的工作LED组成的集合完成预编码，因此具有相同的性能。同理， SD-ZF和AD-ZF在当『100%亮度下也具有相同的BER性能。同时在低亮度条 件下，SD-MMSE比SD-ZF具有更低的BER,这是由于MMSE预编码能够更好 的实现系统MUI和噪声的平衡，提高用户的SINR。此外，随着亮度等级的降低, 可以发现SD-MMSE和AD-MMSE的BER都会升高，这是由于基于(3-41)式， SD-MMSE方案的均方误差会随着工作LED数目的减少而增大，导致其在低亮 度条件下的BER升高；而AD-MMSE的直流偏置随着亮度的降低而减小，导致 信号的幅度降低，信号功率下降，从而BER性能变差。同时，在不同的亮度条 件下，SD-MMSE 均比 AD-MMSE 的 BER 更低，例如当 BER=10-3 时，SD-MMSE 和AD-MMSE所需的SNR分别为18 dB和23 dB,可以获得约5 dB的SNR增益。
56
这是由于SD-MMSE采用了基于空间维度的调光,有效避免了对信号直流偏置的 影响，从而降低了系统的削峰噪声。
10°------1-----1-----1------	：	：—
—0—AD-MMSE 10dB
-♦ -SD-MMSE 10dB
[0-4 -----1-----1------1-----'-----1------1-----
0.3	0.4	0.5	0.6	0.7	0.8	0.9	1
调光等级7;
图3-13SNR分别为10dB和lldB时，场景A中（用户1固定，用户2在P1位置）SD-MMSE、
AD-MMSE, SD-ZF和AD-ZF方案的BER性能随调光等级变化曲线
接下来，为了进一步综合比较SD-ZF、AD-ZF、SD-MMSE、AD-MMSE的 BER性能随调光等级变化的关系。如图3-13所示在用户2固定在PK SNR分别 为 10 dB 和 11 dB 的条件下绘制了 SD-MMSE、AD-MMSE、SD-ZF、AD-ZF 方 案的BER曲线。需要强调的是，对于空间调光方案（SD-MMSE和SD-ZF）,当 调光等级ri降低时工作LED数目随之减少并利用发送天线选择算法确定最优的 工作LED集合；对于模拟调光技术（AD-MMSE和AD-ZF）,当调光等级〃降低 时直流偏置随之降低。可以发现，以上几种调光技术的BER都随着〃的增加而 降低，这是由于增加LED数目可以提升空间调光技术的性能，而直流偏置的增 加可以提升模拟调光技术的有效信噪比。此外，SD-MMSE和SD-ZF方案的BER 曲线更为平坦，这是因为发送天线选择算法可以利用发端CSI和工作LED的选 择分集来补偿由于调光所带来的通信性能的损失。相比之下，模拟调光技术的 BER性能更容易受调光等级变化的影响。
57
NH'sdql树盘运
1
0.3	0.4	0.5	0.6	0.7	0.8	0.9	1
调光等级4
图3-14 SNR=10dB、场景A (用户1固定，用户2在位置P1)条件下，空间调光和模拟调 光技术的可达频谱效率随调光等级变化曲线
接下来，我们研究了空间调光和模拟调光方案在SNR=10 dB、用户2固定 在P1时系统的频谱效率。基于香农公式的系统频谱效率上界可以由用户端的 SINR得到：
K
£log(l+SINRj	(3-50)
P=1
基于(3-49)和(3-50)式，图3-14绘制了空间调光和模拟调光方案的可达频谱效率 随调光等级变化的曲线。如图所示，SD-MMSE和SD-ZF方案的频谱效率分别高 于AD-MMSE和AD-ZF方案的频谱效率。这是因为相比于模拟调光，空间调光 可以有效的消除OFDM信号的削峰噪声并提升接收端的SINR,从而使得频谱效 率得以提升。此外，空间调光技术的频谱效率随着调光等级的增大而升高，这是 由于工作LED数目的增加可以提升系统的性能。同时，SD-MMSE和AD-MMSE 方案分别获得了比SD-ZF和AD-ZF更高的频谱效率，这是因为MMSE预编码 可以提升接收端的SINR,改善系统的频谱效率。
58
图3-15调光等级为70%、场景B (用户1固定，用户2由P1向P2移动)条件下，空间调 光和模拟调光技术的BER随信道不确定性系数的变化曲线
最后，我们验证了实际信道中CSI非理想条件下的系统性能，如图3-15所 示，我们固定调光等级〃 = 70%,用户1处于静止状态，用户2从图3-9所示的 P1移动到P2o在用户2的移动过程中，用户之间的位置发生变化导致用户PD 之间的相关性发生改变。在实际可见光通信场景中，CSI通常由接收端检测然后 通过上行链路如RF或者红外反馈到发射端。信道估计中的量化误差和噪声将导 致CSI的不确定性，可以表示为：
H = H + AH	(3-51)
其中，AH表示信道不确定矩阵，它的元素是方差为其独立高斯变量。如图3-15 所示，我们绘制了信道不确定性对空间调光和模拟调光技术BER性能影响曲线。 在仿真中，我们定义了归一化的信道不确定因子：
j = |")『/一.K)	。-52)
可以发现，随着％.，从10-5增加到10°,由于预编码矩阵不能够完全消除MUI 导致接收端SINR降低，空间调光和模拟调光技术的BER性能均不同程度的变 差。同时，当用户2移动到P2位置时，系统的BER性能相比于用户2在P1位 置得到了改善，这是由于用户距离变大降低了信道相关性。除此之外，当
59
4律,>10「2时，空间调光技术相比于模拟调光技术的BER明显变大，这说明空 间调光需要准确的CSI来确定最优的工作LED,其性能更容易受到信道不确定 性的影响。
