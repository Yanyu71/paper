3.4.1SD.MMSE调光方案
SD-ZF方案能够利用ZF预编码完全消除可见光MU-MISO中的MUI并保障 系统在不同亮度的通信性能。但是由于可见光信道的相关性较高，相邻两个用户 PD与工作LED之间的信道增益会很相似，造成信道矩阵对应的两行非常接近。 在这种情况下，采用ZF预编码会显著地放大信道中的高斯噪声，从而降低用户 的SINR。特别是在低信噪比条件下,可见光MU-MISO系统中的噪声将取代MUI 成为影响系统性能因素，从而严重影响用户的SINR,造成较大的通信性能损失。 为了实现噪声和MUI之间的平衡，本节将研究基于MMSE预编码的空间调光 (MMSE Precoding based Spatial Dimming, SD-MMSE)方案，可以增强可见光 MU-MISO系统在低SNR条件下的鲁棒性。同时本节针对MMSE预编码设计了 最小化MSE的发送天线选择算法，从而保障系统在不同亮度的通信性能。
通常，MMSE预编码矩阵可以数学表示为：
―初=Hh(HH“ +，I)t diag([/4,J)	(3-34)
其中，H是由工作LED阵列和用户PD组成的信道矩阵，/表示接收端的加性 高斯噪声，可以通过信道估计的方式获得并通过上行链路反馈给发送端。
图3-6 SD-MMSE方案流程框图
SD-MMSE将MMSE预编码与空间调光相结合，从而有效改善SD-ZF在低 信噪比条件下系统通信性能受限的问题。SD-MMSE方案的原理框图如图3-6所 示，具体包含MMSE预编码和发送天线选择两部分。首先，根据(3-21)式定义的 归一化调光等级力 可以得到系统所需的工作LED数目：
n,= rjN,	(3-35)
47
由于不同用户与发送端工作LED之间的距离各不相同，信道衰减相差很大。 CSI可以通过在发送信号中插入导频序列采用频域信道估计的方式获得，然后通 过红外或射频通信的方式反馈到发送端。为了提高系统在不同亮度下的通信性 能，需要在发送端将充分利用CSI通过天线选择算法确定最优的工作LED集合 S,且满足接下来在发送端，双极性的用户信号向量s = [y，…,『将依 据工作LED集合完成MMSE预编码，预编码矩阵可以表示为：
N"MSE =H?(HsH"l)diag([g，…,(3-36) 其中，Hs由用户PD和工作LED集合构成的信道矩阵。随后，预编码信号将叠 加LED的直流偏置，用于驱动LED工作，具体可以用数学公式表示为
K
X = WmuseS + d = Z W丹+ d	(3-37)
其中，吗eC”凶表示用户./的预编码向量，＜! = 4,..//是一个小维的直流偏置 向量，将每个LED偏置在动态区间的中点/。，从而最大限度地降低信号的削峰 噪声。最后，经过LED电-光转换后的可见光信号将通过工作LED发送给不同 用户。
