3.4.2最小化系统均方误差的发送天线选择算法
在基于MMSE预编码的MU-M1S0系统中，通常难以直接得到由于发送天 线选择带来的系统速率损失的闭式解。已有研究和仿真结果表明，通过最小化系 统的均方误差也可以实现系统速率的最大化，采用这种方式可以得到与直接求解 相同的系统速率性能0331。因此为了提升基于MMSE预编码的可见光MU-MISO 系统在不同亮度下的通信性能，本小节设计了最小化系统MSE的发送天线选择 算法。
通常，可见光MU-MISO系统中接收端的MSE可以用数学公式表示为：
338)
其中，3表示接收机的后验MSE。根据文献[132]的分析，我们可以将亮度等级 为〃时系统的MSE表示为：
5(S) = tr[(aI + HsH(1	(3-39)
其中，H,为系统中的工作LED和用户PD共同组成的信道矩阵，a = l/SNR表 示固定的常数，可以通过信道估计的方式获得并经由射频或红外等上行链路反馈 给发送端。相应地，在给定亮度等级条件下最小化系统均方误差的工作LED集 合可以表示为：
48
5op/=nuntr[(«I + HsHf)-1]	(3-40)
为了衡量空间调光对系统均方误差的影响，需要首先比较在给定亮度条件下 系统的MSE与100%亮度下系统的MSE,然后分析如何选择最优的工作LED集 合来提升系统在不同亮度下的性能。
假定系统调光等级为〃时的均方误差为6(〃)，此时系统均方误差与调光等级 为% =100%时均方误差的差值可以表示为：
当⑺=5⑺—_(%)
「	( h L 厅 1	(3-41)
=	HfAs.
其中，As.=(al+HSH^)-1, S = S'-S, S，为初始100%亮度条件下全体的LED 集合，S为亮度等级〃时的工作LED集合，且满足网=4。根据文献[132]中的 引理2,可以证明 方(力〉0,即随着调光等级〃的降低系统的均方误差相比于 起始状态不断增加。因此，为了最小化调光过程中LED数目变化对系统均方误 差的影响，需要尽可能地降低不同亮度下的系统的MSE,换而言之就是要降低 由于工作LED数目降低带来的MSE升高，最优的工作LED集合用数学公式可 以表示为：
S°pt =呼 min 8 何)=arg min 阮 ⑺| ,\S\ = tjN,	(3-42)
基于以上分析，本小节设计了最小化MSE的天线选择算法用来提升系统在 不同亮度条件下的通信性能，该算法采用迭代的方式每次从全部LED集合中关 闭一个LED,直到剩余的工作LED数目为耳。在每次迭代过程中，需要通过算 法来确定一个需要关闭LED序号，使得最小化剩余工作LED的多(力最小，从 而降低系统在该亮度下的MSE,相应地可以将当(〃)简化为单个LED的形式：
IKaJI2
匕⑺=吉志	。-43)
需要关闭的LED序号可以用数学公式表示为：
arg min dD (r) = arg min 4都	(3-44)
，	，	l — h, Ashr
基于以上分析，所提的最小化系统均方误差的发送天线选择算法可以在算法 2中如下表示：
49
算法2最小化系统均方误差的发送天线选择算法设计
1：输入：％=汹，S={1,2,...,%},网=乂，凡=[4为…即], As，=(aI + %H：；
2： while \S\ > nt do
Ilh^AJI2
3：	确定要除去的LED序号：m = arg min—~~节---，其中rwS；
r l-h^A5hr
4：	更新矩阵：As = A$ + Ash齐As ；
IfAsh对
5：	更新工作LED集合：S - S - {m}；
end while
输出：剩余的LED集合S和Ws = H,(HSH^ +〃1[ diag([从，…〃J)即给定亮度 n下的工作LED集合和对应的MMSE预编码矩阵。
