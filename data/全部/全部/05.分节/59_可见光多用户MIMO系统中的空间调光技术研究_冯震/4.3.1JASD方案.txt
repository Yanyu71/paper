4.3.1JASD方案
在室内LED密集部署的场景下，已经提出了空间调光技术，它可以有效的 克服模拟调光和数字调光的局限性。但是为了保障系统的调光精度，通常需要在 发送端采用较多的LED,相应地会导致系统信道相关性的提高。举例而言，对
66
于由4x4的LED阵列组成灯源，工作LED和LED总数均为整数，它们的比值 显然无法实现60%、80%等若干亮度等级，从而不能满足智能照明的高精度调光 需求。为此需要增加光源中的LED数目，从而实现更多的亮度等级，相应地会 导致系统中用户信道相关性的提高。
针对单用户的可见光MIMO系统，已有研究提出了同时改变激活LED数目 与直流偏置的混合光OFDM (Hybrid Dimming OFDM, HD-OFDM)方案【⑺】。由 于同时利用了可见光MIMO信号的空间和模拟维度资源，HD-OFDM方案获得 了更多的调光自由度，从而可以利用较少的LED实现较高的调光精度。但是在 可见光多用户系统中，HD-OFDM无法消除多用户干扰，同时也无法基于用户信 道的相关性对工作LED集合进行优化。基于以上分析，本节将首先介绍JASD 方案的原理，并在下一小节介绍如何选择通信性能最优的工作LED,改善用户 信道的相关性。
由于直流偏置位于动态区间的中点时，DCO-OFDM信号可以获得最优的 通信性能口6刀。我们定义所有Nt个LED被激活且信号直流偏置为/。的状态为 100%调光等级。JASD将联合调节工作LED数目和信号的直流偏置4 ,可以从 空间和模拟两个维度实现系统亮度的调节。我们将空间调光的归一化调光等级定
义为:
少驯^100%
(4-15)
其中，右表示工作LED所采用的直流偏置，/。=(乙+4)/2定义为通信性能最优 的参考直流偏置。接下来需要在给定亮度等级的条件下，优化调光参数(〃”人)， 从而提升系统的通信性能。
由于光OFDM信号高PAPR和LED动态区间有限的特点。给定亮度〃的条 件下，削峰噪声成为影响可见光MU-MIMO-OFDM系统性能的主要因素。如何 设置系统的空间调光参数，使得发送端可见光信号的削峰噪声最小成为需 要解决的问题。给定系统参数LED的直流偏置介并假定发送端信号的电功率为 戊,基于Bussgang理论我们可以将系统工作LED的总削峰噪声建模为加和Ib 函数，用数学公式表示为：
P,如(〃,4)= 〃后仍-尸+=4)4-/4)4 +
口-2(%)%]+0(4)%-[”4)	(4-16)
-。(4)+口-。(4)]4+。(4)4]}
其中，尸=。(4)—。(4)，4 =(/「乙)/%，为了完成线性预 编码，工作LED数目需要满足：同时信号偏置Zb需要满足：
67
It<IB<IhO其中，斗表示用户PD总数，M为发送端的LED总数。基于以上 分析，最小化系统削峰噪声的优化问题可以表示为：
鬻?小3)
s.t. Nr<n,<N„ 且%为整数	(4-17)
由于该问题是一个整数优化问题，难以求得闭式解。因此，为了简化分析，本文 将分两步对该问题进行分析求解。
1	.首先，由于当信号的直流偏置高于或低于/0时都会增加信号的削峰噪声， 因此在调光过程中，应该尽可能保持不变或工作在/0的附近，通过改 变/将亮度调节到所需的调光等级附近。由给定的调光等级〃和LED总 数M,实际的工作LED数目可以通过四舍五入取整得到乂
然=阮］=［//花］	(4-18)
2	.接下来，为了实现所需的调光等级，需要通过调节直流偏置来补偿工作 LED数目取整操作造成的调光误差。基于(4-15)式，JASD方案所需的直 流偏置可以用数学公式表示为：
却二呼~	(4-19)
最终，我们可以在给定调光等级4的条件下通过以上两步分别求得系统所需 的工作LED数目M和信号的直流偏置/b。由于在求解调光参数的过程中直流偏 置始终在参考偏置々附近上下浮动，可以有效降低系统的削峰噪声，同时避免了 采用较多的LED以实现系统精确调光的需求。JASD方案相比于单一空间维度调 光可以有效降低用户信道的相关性；相比于传统的模拟调光，可以有效降低系统 的削峰噪声，改善通信性能。
d
反馈信道
ft
TAS-MMSV
JASD方案
调节直流偏置卜
0
图4-3可见光MU-MIMO-OFDM系统的JASD方案模块示意图
68
基于以上分析，可见光MU-MIMO-OFDM系统中的JASD方案系统模块示 意如图4-3表示。首先由(4-18)和(4-19)式依次得到给定亮度等级下系统的工作 LED数目M和信号的直流偏置Ib,接下来，需要设计TAS-MMSV天线选择算 法将利用发送端从上行反馈链路获得的信道状态信息(Channel State Information, CSI)确定最优的工作LED集合，从而得到由系统工作LED组成的信道矩阵H。 基于H,发送端可以得到每个用户的BD预编码矩阵W1,尸然后完成对 用户QAM符号向量％的预编。预编码后的复信号将先进行Hermitian对称变换， 以保证接下来经过IFFT变换之后得到的时域信号为实数。接下来，直流偏置" 将叠加在时域信号上，用于驱动LED完成强度调制，经电-光转换之后的可见光 信号将通过JASD确定的工作LED传送到接收端的各个用户。
可见光通信系统需要在满足人眼视觉安全的范围内调节室内照明的亮度等 级。通常人眼的视觉亮度由某一段时间内的系统平均光功率决定。根据中心极限 定理，当系统子载波数论64时，时域OFDM信号x,.服从均值为0的高斯分布。 双极性的OFDM信号苍叠加直流偏置组成LED的驱动电流，用数学公式表示为
由**＞仁L
(4-20)
因此，用户感受到的平均亮度可以用数学公式表示为: E[Z.] = E[ax; + /s] = /s
(4-21)
其中，E[.]表示随机变量的期望函数。根据第三章所述内容，LED线性响应的动 态区间可以表示为必,/〃],其中，4为输入电流的最小值，(为输入电流的最大 值。相应地，为了避免LED中的信号发生饱和或畸变，驱动电流W”需要工作在 动态区间范围内，即根据(4-20)式，信号向量七的幅度需要满 足：
|x,.|<A//a
(4-22)
QAM符号d,在发送端进行了功率归一化，信号幅度均匀地分布在[-1,1]范围内。 为了使预编码后的信号工作在LED的动态区间，发送端的预编码矩阵需要满足
(4-23)
根据(4-10)式，在每个子载波上，信号向量为中第夕个符号对应地被用户)的第q 个PD解调。由此可以得到用户,接收到信号的有效信噪比，用数学公式可以表 示为：
r
1 」(elec)
：R：W
幺 GbH log2 M
(4-24)
其中，Gb=(N-2)/N表示子载波利用率，表示用户/的等效 噪声。通常，系统的SNR下界由用户SNR的最小值所决定。由(4-24)式可以发 现，用户/的SNR由等效信道的奇异值(q = L..,N,J所决定。
时域信号向量…,%”了的电功率可以由(4-22)所表示：
根据上式，可以将接收端电信号的信噪比定义为：7 =月/。点,即，代入(4-24)式后
可以将用户的有效SNR公式改写为
N，J
s-
(4-26)
a2y
+*J
根据文献［167］的分析，最终我们可以将接收端用户/的可达BER,用数学公式表 示为：
BER, ----------
-4m log2(M)
,31og2(〃)	、
4(VM-2)(』og2(")
通?□(")’[ \(A/-1) 7，e，ec)
(4-27)
2	1	_22
其中，。(幻=/卷e 2办,2版为用户)的等效矩阵A,的奇异值，代表第q条 数据流的增益。
综合(4-26)和(4-27)式的分析可以发现，与传统的射频通信不同，在基于BD 预编码的可见光MU-MIMO-OFDM系统中，每个用户的有效SNR和BER性能 可以表示为用户等效矩阵的奇异值、工作LED数目M和时域信号幅度AZ的函 数。同时需要说明的是，这些参数在JASD方案中都会随着亮度等级的变化而改 变。例如，在空间维度上工作LED数目的改变会直接影响Na以及用户等效信道； 在信号的模拟维度上，直流偏置的调节会影响时域信号的幅度范围A/。因此， JASD方案在确定了实现所需亮度等级的工作LED数目”和信号直流偏置/b之 后，需要进一步研究如何确定通信性能最优的工作LED集合，从而提升系统在 不同亮度下的通信性能。
70
43.2班化最小奇异值的发瞬算法
根据4.3.2小节的分析，在基于BD预编码的可见光MU-MIMO-OFDM系统 中，用户的BER性能将同时受到工作LED数目和信号直流偏置的影响。在给定 系统的调光等级后需要研究如何优化上述调光参数，从而提升系统在不同亮度条 件下的通信性能。不同用户的空间分布不同，受用户和LED在室内空间相对位 置的影响，用户的信道状态各不相同。具体而言，预编码后用户的等效信道具有 不同的奇异值。通过工作LED的选择来优化用户等效信道矩阵的奇异值，可以 有效改善用户的通信性能。因此，本小节设计了最大化最小奇异值的发送天线选 择(Maxized Minimum Singular Value based Transmit Antenna Selection, TAS-MMSV)算法。
由(4-4)式可以发现乙。可以由工作LED和接收端用户PD组成的用户信道得 到。因此，与传统基于射频通信系统不同，采用JASD方案的可见光 MU-MIMO-OFDM系统的BER性能将由调光等级和工作LED集合共同决定。 在传统射频单用户MIMO系统中已经证明，用户的有效SNR下界是信道最小奇 异值(Minimum Singular Vdue, MSV)的单调函数。由于不同工作LED集合与 用户PD之间等效信道的奇异值各不相同，本小节的设计TAS-MMSV算法可以 确定每个亮度等级下最大化接收端SNR的工作LED集合，改善用户的BER性 能。
假设待定的工作LED集合SgSL并且满足|S|=N°。根据(4-10)式，由候选 工作LED集合S和用户PD构成的等效信道Ar可以用数学公式求得：
H.sv2=U.sAJiSV<7	(4-28)
A/©为对角矩阵,其元素为用户/等效信道的奇异值。由于接收端用户的有效SNR 的下界与等效信道矩阵最小奇异值的平方成正比1159］。为了提升用户信噪比下界,
优化通信性能，需要最大化用户等效信道的最小奇异值。首先计算
猬* =min(diag(A7.s))
(4-29)
(4-30)
由此可以得到用户/接收信号SNR的数学表示:
SNR7
*(需)
log2Af
接下来可以将最优工作LED集合S°pt选择问题等效地表示为
S如=argmaxSNR 片
S
71
(4-31)
TAS-MMSV将选取最大化参数(磴1『/可的集合s作为工作LED,从而最大化 接收SNR,改善用户的通信性能。
基于以上分析，本小节所提的TAS-MMSV算法可以用算法3如下表示为：
算法3最大化接收SNR的TAS-MMSV选择算法设计
1：输入：工作LED数目N“ =	,给定任意工作LED集合S e S',其中，网=N” ,
S，表示候选的C飞个工作LED集合。
2：基于(4-28)式，计算用户)的等效信道矩阵A)
3：基于(4-29)式，计算用户/的MSV
4：计算LED集合S的选择参数
min
Ks
=min j=L...K
5：确定最优工作LED集合
(m
S°pt =argmax ks
SeSt v
输出：S°pt即为所求最大化接收SNR的工作LED集合。
接下来我们将分析在JASD方案对用户信道相关性的改善。由于采用了 TAS-MMSV算法，JASD方案可以显著改善用户的等效信道矩阵。在发送端的工 作LED和接收端用户的PD位置固定的情况下，可见光MU-MIMO系统的信道 矩阵中每条链路的增益是确定的。信道相关性高意味着信道矩阵不是满秩或者信 道矩阵的条件数较大。与文献[181]类似，用户信道矩阵的条件数定义为：
cond(Hj = &弊	(4-32)
7.nun
其中，4 m.z和力min分别代表H,的最大和最小奇异值。
为了简便起见，我们假定系统所需的亮度等级为〃 = 40% ,系统的光源由4x4 的LED阵列组成。在该条件下，JASD将首先确定工作LED的数目 M=[40%xl6]=6；然后，通过TAS-MMSE算法得到工作LED集合，从而可以得 到用户1的信道矩阵，相应可以地表示为：
,fO.5397 0.4661 0.4301 0.4661 0.451 0.431 1
H, =10-5x	(4-33)
1	10.5558 0.5206 0.4789 0.4790 0.4756 0.4661
接下来通过对的奇异值分解，可以求得用户1信道的奇异值矩阵，用数学公 式表示为：
72
人1,40%=1。*
0.1668 0
0 0.0028
(4-34)
由此可以得到在40%亮度下用户1信道矩阵条件数：cond^ =58.915。采用相 同的方式，可以求得亮度等级〃 =60%条件下用户1的信道矩阵，经过奇异值分 解后，用户1的信道奇异值矩阵可以表示为：
Ai,60%=1。X
0.2178 0
0 0.0034
(4-35)
在60%亮度下，用户1信道矩阵的条件数为8nd=64.0588。
由于cond140% < cond16OT4可以发现，TAS-MMSV算法在低亮度条件下将激活 较少数目的工作LED并且可以增加用户等效信道的最小奇异值，因此有效地降 低了用户信道的相关性。
43.3方案实现和复杂度分析
为了评估所提方案的实用化价值，本小节将从工程实现方面分析JASD方案 的硬件需求，然后从复杂度方面与模拟调光(Analogue Dimming, AD)方案的计 算开销进行比较。其中，AD方案基于模拟域通过改变每个工作LED的直流偏 置实现亮度调节，不需要进行发送天线选择，并利用全部N个LED组成的信道 矩阵完成BD预编码。
在实现方面，JASD将基于3.3.3小节中的多LED单元照明装置、采用集中 控制的方式进行发送天线选择，确定工作LED集合，有效地提升系统容量。为 了获取的CSI完成BD预编码，JASD将首先在接收端完成信道估计然后通过红 外等方式实现上行链路，将CSI反馈给发送端。在本小节，考虑到室内可见光信 道的准静态特性，我们忽略信道估计过程中由于噪声和接收端的量化分析所引入 的误差，认为发送端能够获得准确的CSI。
图4-4 JASD的发送端实现模块框图
73
由于系统的预编码等过程集中在发送端完成，本小节将JASD的发送端实现 模块框图在图4-4中表示。如图所示，CSI可以通过反馈信道获得CSI,发送端 将首先根据亮度等级确定工作LED数目Na和直流偏置Ib,随后利用CSI根据算 法3确定工作LED集合S。其中，S将传送到BD预编码单元(BD precoding Unit, BDU),直流偏置/b将输入到偏置控制单元(Bias Control Unit* BCU)。BDU根 据S来计算每个用户的BD预编码矩阵,并存储。同时，BCU中将集成耦合驱 动模块，可以将时域OFDM的交流信号与直流偏置/b混合叠加，驱动LED工作 [,50]o接下来，发送端的用户QAM信号向量通过电力线(Power Line Communication, PLC)等骨干网产生，然后分别读取预先计算的吗完成预编码。 接下来,预编码后的复信号将分别进行Hermitian对称和IFFT变换得到时域信号 士，然后经过BCU耦合直流偏置/b并完成电光转换。最后，可见光信号将通过 工作LED发送给接收端的用户。
在复杂度方面，JASD方案有两个重要环节，一是确定工作LED数目和信号 直流偏置，二是发送天线选择。其中，发送天线选择将由于需要迭代运算将成为 算法复杂度的主要部分。在算法3中，对于给定的亮度等级存在个候选的 工作LED集合。为了选择最优的工作LED集合，需要完成2K次SVD分解运算 和K次矩阵乘法，可以通过浮点运算来表示。在执行SVD得到矩阵过程中 的需要完成M次浮点运算，在执行矩阵乘法H/V7的过程中需要完成忆次浮点 运算，在得到A,的过程中需要完成代次浮点运算。通常对一个/xB维的矩阵进 行SVD操作需要(94+8/喈+ 4/笈)次浮点运算。由于实际信道条件理想(信 道矩阵满秩)的工作LED集合数目不超过C吁，JASD的复杂度可以表示为：
•v/
< 嗡+8Ad风 +4M.应+21N：J	(4-36)
AD方案激活全部LED完成BD预编码，因此不需要进行发送天线选择，相 应地算法复杂度可以简化为：
CAD <刘9心 +8院风	+2N；此 + 2 W：,)	(4-37)
对比上式可以发现，JASD相比于AD由于执行发送天线选择所增加的算法复杂 度主要与系统灯源中的LED数目有关。因此，为了降低JASD的复杂度，系统 光源中的LED数目需要尽可能降低，从而降低发送天线选择所增加的系统资源 开销。
74
